{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","$","normalizeText","text","String","replace","REPLACE_REGEX","SPACE","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","LRUCache","DEFAULT_OPTIONS","defaultMeasureBox","window","Class","size","_size","_length","_map","put","value","map","entry","_head","_tail","newer","older","get","baselineMarkerSize","document","createElement","cssText","_cache","styleKey","cacheKey","cachedResult","baselineMarker","textStr","box","_baselineMarker","cloneNode","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","jQuery","sqr","renderSize","renderPos","pos","result","toHyphens","split","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","Return","ex","now","Date","getTime","RegExp","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","name","attrs","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","isNaN","ENTITIES","undefined","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","fromCharCode","amp","lt","gt","quot","apos","nbsp","parseXML","copyToClipboard","html","textarea","addClass","val","appendTo","focus","select","execCommand","remove","Command","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","NameCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","exec","setState","getState","state","rejectState","validationState","title","message","reason","type","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","canEditArrayFormula","clearContent","_getValidationState","EditCommand","_editRange","arrayFormula","activeCellSelection","withCultureDecimals","_exec","editRange","input","wrap","_adjustRowHeight","calc","ParseError","TextWrapCommand","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_delta","delta","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","_batch","self","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","_event","event","_clipboardContent","_content","_clipboardPasteRef","pasteRef","_sheet","activeSheet","preventDefault","status","canPaste","selection","triggerChange","recalc","menuInvoked","pasteOnMerged","overflow","pasteOnDisabled","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","paste","_view","CutCommand","_eventType","canCopy","cut","copy","multiSelection","CopyCommand","noop","ToolbarCopyCommand","AutoFillCommand","origin","_origin","intersectingArrayFormula","fillFrom","Range","FillError","ToolbarCutCommand","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","_expandedRange","_expand","_indexes","_undoOne","_restoreModifiedFormulas","formulas","layout","DeleteRowCommand","resize","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","_pos","count","base","AddColumnCommand","preventAddColumn","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","preventAddRow","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","cannotUndo","file","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper","27","37","39","35","36","32","attr","css","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","currentRange","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_sync","_focusTimeout","ev","clipboardData","getData","originalEvent","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","idx","_canInsertRef","afterPoint","canReplace","canInsertBetween","strictMode","refAtPoint","simplify","clone","relative","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","txt","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","insertNewline","eof","Mac","isAlphaNum","keyName","EventListener","13","38","33","34","46","113","navigator","platform","indexOf","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","Math","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","first","last","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","unique","at","lastRangeStart","ValueRange","toExcelFormat","cloneFormulaValue","deepClone","cloneFormulaTree","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","dateToNumber","culture","calendar","patterns","limitPrecision","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","prop","formula","fromJSON","si","iter","iterators","reduce","ret","addBorder","hBorders","leftBorders","rightBorders","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","absolute","adjust","toString","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","renameSheet","oldSheetName","newSheetName","display","trow","tcol","abs","arow","acol","forRow","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","min","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","move","cols","tr","u","empty","theRef","newRefs","splice","NULLREF","SHEETREF","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","setSelection","selTopLeft","selBottomRight","done","currentNavigationRange","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","isHiddenRow","isHiddenColumn","forEachMergedCell","merged","hint","preview","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hasRight","hasLeft","hideColumn","_count","hasBottom","hasTop","hideRow","unhideColumn","unhideRow","preventInsertRow","preventInsertColumn","newState","mergedCells","foreign","origRef","setStateData","stripStyle","borderObject","color","cellState","vBorders","getComputedStyle","borders","fontSize","background","italic","bold","textAlign","verticalAlign","parseHTML","table","ri","ci","td","rowSpan","colSpan","ignoreColspan","dr","dc","Matrix","getAttribute","parseTSV","Clipboard","_externalContent","_internalContent","iframe","className","_uid","guid","intersectsMerged","plain","destination","originActiveCell","rowDelta","colDelta","external","isExternal","_isInternal","doc","contentWindow","write","querySelector","internalHTML","internalPlain","find","partition","predicate","looksLikeANumber","getTextHeight","fontFamily","font-size","font-family","white-space","overflow-wrap","word-wrap","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","_set","noTrigger","_get","_resizedRef","existingFormat","t1","t2","existingFormatType","compile","currency","editorChange","isInEditMode","numberToDate","_useCultureDecimals","numberFormat","_","__","setArrayFormulaRange","_forFormulas","arrayFormulaRange","intersection","toJSON","_validation","_merge","mergedRef","vi","_properties","props","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","primary","secondary","cant","_getMergedCells","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","textHeight","sum","hasValue","defStyle","_defaultCellStyle","flag","draw","each","CalcError","argmax","sameRef","constructor","compileArgumentChecks","functionName","args","comp","wantNulls","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","round","err","main","Function","toPrecision","maybeRoundFloatErrors","withErrorHandling","makeSyncFunction","check","doit","xargs","arrays","getNA","makeAsyncFunction","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","validDate","da","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","makeDateFormat","parseExactDate","binaryCompare","exports","Context","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","_resolve","error","asMatrix","_arrayArg","onFormula","fetch","context","pending","add","getRefCells","cellValues","getRefData","fetchName","nameValue","ValidationFormulaContext","fname","bool","h","isRange","hiddenInfo","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","reset","affectedSheet","operation","formulaMoves","formulaRow","formulaCol","newFormulaRow","newFormulaCol","formulaSheet","prevRefs","prevRange","newRef","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","pow","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","_reinit","headerHeight","headerWidth","defaultCellStyle","Axis","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forValidations","adjustNames","selectedHeaders","allRows","allCols","nextRef","isEnabledRow","isEnabledColumn","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","maxRow","maxCol","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","clearDefaultStyle","json","positions","viewSelection","hyperlinks","src","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","useCultureDecimals","dot","withDecimalSeparator","outerWidth","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","_outerWidth","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","_sheetsGroup","marginLeft","scrollWidth","ceil","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","closeCallback","removedSheetName","dlg","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","setDecimalSeparator","sep","SEPARATORS","DEC","ARG","COL","OPERATORS","OPERATORS_COMMA","OPERATORS_STANDARD","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","allowEOF","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","ast","parseNameDefinition","def","defAST","nameRef","makeFormula","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsRef","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsNameRef","makeContinuation","cpsIf","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","escaped","rx","parseSqref","getNumberRegexp","comma","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","_separators","p","monthFirst","rxnum","rxcur","suffix","has_currency","has_percent","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","strings","relationships","theme","items","loading","ERROR_LOG","readStrings","readRelationships","readTheme","byType","readStyles","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","localSheetId","SEL_DEFINED_NAME","vbProcedure","withErrorLog","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","addAutoFilter","filters","formulaRange","isArrayFormula","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","sharedFormulas","nCols","prevCellRef","relsFile","closed","styleIndex","stop","acRef","SEL_FORMULA","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","colId","and","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","getFilterVal","percent","blank","leave","failed","SEL_VALIDATION","SEL_VALIDATION_INSANE","sqref","showErrorMessage","MAP_EXCEL_OPERATOR","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","SEL_VALUE","SEL_STRING","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_FORMULA2_INSANE","SEL_VALIDATION_SQREF_INSANE","ourOp","equal","notEqual","greaterThanOrEqual","lessThanOrEqual","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","setFormat","formatCode","setFill","setFont","setBorder","side","BORDER_WIDTHS","shouldSet","applyName","xf","inlineStyles","xfId","namedStyles","fonts","indent","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","font","fill","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","arr","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","0","11","12","14","15","16","17","18","19","21","22","45","47","48","49","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","sheetParamsFromJSON","or","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetCommandRequest","_inputForRef","execute","commandOptions","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","names","localName","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","nameForRef","PDFMixin","_drawPDF","drawing","exportPDF","proxyTarget","fail","area","fsheet","frow","fcol","states","arrayRange","tlRow","tlCol","currentFormula","vrow","vcol","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum","alt+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","mouseup","*+cut","*+paste","*+copy","esc","alt+enter","shift+ctrl+enter","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","deactivate","showError","activateEditor","_lastEditorValue","_activeTooltip","clientHeight","isEditorDisabled","resetEditorValue","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","casual","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","onEditorEsc","openCustomEditor","_selectionMode","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","clientX","clientY","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","append","clipBoardValue","onPaste","hasHTML","hasPlainText","DOMStringList","types","onCopy","scrollRight","getBoundingClientRect","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","_saveEditorValue","onEditorArrayFormula","onEditorBarFocus","rect","activeCellRectangle","onEditorCellFocus","onEditorBlur","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDraw","toHSV","outline","backgroundColor","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","applyIndent","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","messages","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","tabs","_height","_width","addColumn","addRow","Node","toDomTree","offset","ContextMenu","contextMenuConfig","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","enableClipboard","isClipboardDeactivated","_resize","actionBar","formulaBar","parents","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","sheetsBarHeight","quickAccessAdjust","prependTo","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","_headerWidth","frozen","locate","w","isRowResizer","_headerHeight","isFilterIcon","theGrid","filterIconRect","isAutoFill","isEditButton","ed","activeCellCustomEditor","_editorInLastColumn","selecting","clientWidth","paneAt","indexVisible","containingPane","refreshTools","totalHeight","totalWidth","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","reopenEditor","dialogOptions","errorMessages","focusButton","ESC","onClose","_retry","registered","_filterMenuColumn","resizeDirection","scrollbar","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","activeCellRange","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","_activeFormulaColor","_directionClasses","vert","rendered","borderWidth","transform","horiz","_start","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","selectionClasses","_renderCustomEditorButton","cssClass","autoFillRectangle","toDiv","_axis","btnClass","isLastColumn","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","disableDates","kendoStaticList","getKendoStaticList","read","PaneGrid","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","decimal","decimalPart","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","TEXT","section","found","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","iv","chf","formatDec","decimals","intpart","decpart","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","PI","rad","deg","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","denomitator","string","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","whipNumberArrays","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","COLOR_PICKER_MESSAGES","ColorChooser","BorderPalette","borderPalette","colorPicker","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","iconClass","dialogName","togglable","separator","formatCells","handleClick","_expandTools","tools","toolbarName","_addSeparators","tool","_nextTool","activeElement","blur","removeClass","click","activeIndex","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","showText","toolIcon","attributes","aria-label","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","registerComponent","ToolBarButton","_dialogName","_title","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_defineButtons","_commandPalette","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","quickAccessToolBar","hasOwnProperty","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","inArray","basicErrorDialog","register","MessageDialog","messageId","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","ConfirmationDialog","ValidationErrorDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","getter","confirm","_confirmed","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","model","stopPropagation","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getterIdx","distinctValues","query","itemVisible","filterSpread","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","valuesFilter","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","oldRect","newRect","barInput","cellInput","_triggerUpdate","_rect","noChange","inputType","linearRegression","findSeries","findStep","forEachSeries","getType","lst","findStringList","stringLists","strl","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","srcRange","srcIdx","destRange","CLASS_NAMES","comboBoxTitle","comboElement","transport","success","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","rowHeights","colWidths","pageWidth","scaleFactor","hyCoords","boxWidth","boxHeight","headerCells","nonEmpty","relrow","relcol","rh","cw","shouldDrawCell","emptyCells","orlast","orderCoords","orderCells","assign","sameBorder","drawLayout","addPage","page","bordersGroup","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","moveTo","lineTo","stroke","guideColor","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","paddingLeft","paddingRight","vtrans","text_group","CONT","boxSizing","lineHeight","padding","makeFontDef","createTextNode","drawDOM","paper","getPaperOptions","multiPage","Container","pb","addVert","addHoriz","drawTabularData","textWidth","charWidth","mkCell","headerBackground","headerColor","oddBackground","evenBackground","useGridFormat","defineFont","getFontFaces","charWidthFunction","columnTitles","columnWidths","label","CACHE_CHAR_WIDTH","geometry","widths","NS","Spreadsheet","F10","F11","I","U","H","A","DELETE","R","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","redoTool","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","plugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;CAwBC,SAAUA,EAAGC,QACVA,OAAO,sBAAuB,cAAeD,IAC/C,YACG,SAAUE,GACP,GAAIC,GAAgBD,EAAME,WAAWC,QACjCC,KAAM,SAAUC,GACZL,EAAME,WAAWI,GAAGF,KAAKG,KAAKC,KAAMH,GACpCG,KAAKC,SAETC,QACI,OACA,QAEJC,KAAM,SAAUC,GACZJ,KAAKK,MAAQL,KAAKK,MAAMC,MAAM,EAAGN,KAAKO,oBAAsB,GAC5DP,KAAKO,oBAAsBP,KAAKK,MAAMF,KAAKC,GAAW,GAE1DI,KAAM,WACF,GAAIR,KAAKS,UAAW,CAChB,GAAIL,GAAUJ,KAAKK,MAAML,KAAKO,sBAC9BH,GAAQI,OACRR,KAAKU,QAAQ,QAAUN,QAASA,MAGxCO,KAAM,WACF,GAAIX,KAAKY,UAAW,CAChB,GAAIR,GAAUJ,KAAKK,QAAQL,KAAKO,oBAChCH,GAAQO,OACRX,KAAKU,QAAQ,QAAUN,QAASA,MAGxCH,MAAO,WACHD,KAAKK,SACLL,KAAKO,wBAETE,QAAS,WACL,MAAOT,MAAKO,qBAAuB,GAEvCK,QAAS,WACL,MAAOZ,MAAKO,qBAAuBP,KAAKK,MAAMQ,OAAS,IAG/DrB,GAAMsB,WAAWtB,GAASuB,MAAQtB,cAAeA,MACnDD,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,qBAAsB,cAAeD,IAC9C,YACG,SAAU8B,GAqDP,QAASC,GAAcC,GACnB,OAAcA,EAAPC,IAAaC,QAAQC,EAAeC,GAE/C,QAASC,GAAUC,GAAnB,GAEaC,GADLC,IACJ,KAASD,IAAOD,GACZE,EAAM3B,KAAK0B,EAAMD,EAAOC,GAE5B,OAAOC,GAAMC,OAAOC,KAAK,IAE7B,QAASC,GAAQC,GAAjB,GAEaC,GADLC,EAAO,UACX,KAASD,EAAI,EAAGA,EAAID,EAAIrB,SAAUsB,EAC9BC,IAASA,GAAQ,IAAMA,GAAQ,IAAMA,GAAQ,IAAMA,GAAQ,IAAMA,GAAQ,IACzEA,GAAQF,EAAIG,WAAWF,EAE3B,OAAOC,KAAS,EAEpB,QAASE,KACL,OACIC,MAAO,EACPC,OAAQ,EACRC,SAAU,GA0DlB,QAASC,GAAYpB,EAAMqB,EAAOC,GAC9B,MAAOC,GAAYC,QAAQC,QAAQzB,EAAMqB,EAAOC,GAtIvD,GAEOI,GAiDAvB,EACAC,EA0BAuB,EACAC,EAKAL,CAnFJM,QAAO3D,MAAMuB,KAAOoC,OAAO3D,MAAMuB,SAC7BiC,EAAWxD,MAAM4D,MAAMzD,QACvBC,KAAM,SAAUyD,GACZrD,KAAKsD,MAAQD,EACbrD,KAAKuD,QAAU,EACfvD,KAAKwD,SAETC,IAAK,SAAU5B,EAAK6B,GAAf,GACGC,GAAM3D,KAAKwD,KACXI,GACA/B,IAAKA,EACL6B,MAAOA,EAEXC,GAAI9B,GAAO+B,EACN5D,KAAK6D,OAGN7D,KAAK8D,MAAMC,MAAQH,EACnBA,EAAMI,MAAQhE,KAAK8D,MACnB9D,KAAK8D,MAAQF,GAJb5D,KAAK6D,MAAQ7D,KAAK8D,MAAQF,EAM1B5D,KAAKuD,SAAWvD,KAAKsD,OACrBK,EAAI3D,KAAK6D,MAAMhC,KAAO,KACtB7B,KAAK6D,MAAQ7D,KAAK6D,MAAME,MACxB/D,KAAK6D,MAAMG,MAAQ,MAEnBhE,KAAKuD,WAGbU,IAAK,SAAUpC,GACX,GAAI+B,GAAQ5D,KAAKwD,KAAK3B,EACtB,IAAI+B,EAeA,MAdIA,KAAU5D,KAAK6D,OAASD,IAAU5D,KAAK8D,QACvC9D,KAAK6D,MAAQD,EAAMG,MACnB/D,KAAK6D,MAAMG,MAAQ,MAEnBJ,IAAU5D,KAAK8D,QACXF,EAAMI,QACNJ,EAAMI,MAAMD,MAAQH,EAAMG,MAC1BH,EAAMG,MAAMC,MAAQJ,EAAMI,OAE9BJ,EAAMI,MAAQhE,KAAK8D,MACnBF,EAAMG,MAAQ,KACd/D,KAAK8D,MAAMC,MAAQH,EACnB5D,KAAK8D,MAAQF,GAEVA,EAAMF,SAIrBjC,EAAgB,eAChBC,EAAQ,IA0BRuB,GAAoBiB,mBAAoB,GAEpB,mBAAbC,YACPjB,EAAoBiB,SAASC,cAAc,OAC3ClB,EAAkBP,MAAM0B,QAAU,wQAElCxB,EAAcrD,MAAM4D,MAAMzD,QAC1BC,KAAM,SAAUC,GACZG,KAAKsE,OAAS,GAAItB,GAAS,KAC3BhD,KAAKH,QAAUuB,EAAEzB,UAAWsD,EAAiBpD,IAEjDkD,QAAS,SAAUzB,EAAMqB,EAAO9C,GAAvB,GAOD0E,GACAC,EACAC,EAIApB,EACAT,EACA8B,EACK7C,EACD6B,EAKJiB,CAlBJ,IAHgB,SAAZ9E,IACAA,OAECyB,EACD,MAAOgB,IAKX,IAHIiC,EAAW5C,EAAUgB,GACrB6B,EAAWvC,EAAQX,EAAOiD,GAC1BE,EAAezE,KAAKsE,OAAOL,IAAIO,GAE/B,MAAOC,EAEPpB,GAAOf,IACPM,EAAa/C,EAAQ+E,KAAO1B,EAC5BwB,EAAiB1E,KAAK6E,kBAAkBC,WAAU,EACtD,KAASjD,IAAOc,GACRe,EAAQf,EAAMd,GACG,SAAV6B,IACPd,EAAWD,MAAMd,GAAO6B,EAgBhC,OAbIiB,GAAU9E,EAAQwB,iBAAkB,EAAQA,EAAcC,GAAeA,EAAPC,GACtEqB,EAAWmC,YAAcJ,EACzB/B,EAAWoC,YAAYN,GACvBP,SAASc,KAAKD,YAAYpC,GACtB+B,EAAQ9D,SACRwC,EAAKd,MAAQK,EAAWsC,YAAclF,KAAKH,QAAQqE,mBACnDb,EAAKb,OAASI,EAAWuC,aACzB9B,EAAKZ,SAAWiC,EAAeU,UAAYpF,KAAKH,QAAQqE,oBAExDb,EAAKd,MAAQ,GAAKc,EAAKb,OAAS,GAChCxC,KAAKsE,OAAOb,IAAIe,EAAUnB,GAE9BT,EAAWyC,WAAWC,YAAY1C,GAC3BS,GAEXwB,gBAAiB,WACb,GAAIU,GAASpB,SAASC,cAAc,MAEpC,OADAmB,GAAO5C,MAAM0B,QAAU,0DAA4DrE,KAAKH,QAAQqE,mBAAqB,eAAiBlE,KAAKH,QAAQqE,mBAAqB,uBACjKqB,KAGf1C,EAAYC,QAAU,GAAID,GAI1BrD,MAAMsB,WAAWtB,MAAMuB,MACnBiC,SAAUA,EACVH,YAAaA,EACbH,YAAaA,EACbf,UAAWA,EACXM,QAASA,EACTZ,cAAeA,KAErB8B,OAAO3D,MAAMgG,SACC,kBAAVjG,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,aAAc,cAAeD,IACtC,WAwKE,MAvKC,YAEG,QAASmG,GAAI/B,GACT,MAAOA,GAAQA,EAQnB,QAASgC,GAAWrC,GAIhB,MAHoB,gBAATA,KACPA,GAAQ,MAELA,EAEX,QAASsC,GAAUC,GAAnB,GAGY9D,GACKK,EAHT0D,IACJ,IAAID,EAEA,IADI9D,EAAQtC,EAAMsG,UAAUF,GAAKG,MAAM,KAC9B5D,EAAI,EAAGA,EAAIL,EAAMjB,OAAQsB,IAC9B0D,EAAO1F,KAAK,SAAW2B,EAAMK,GAGrC,OAAO0D,GAAO7D,KAAK,KAEvB,QAASgE,GAAcC,GA8DnB,IA9DJ,GACQC,IACAC,EAAG,IACHC,GAAI,IACJC,IAAK,IACLC,EAAG,KACHC,GAAI,KACJC,IAAK,KACLC,EAAG,MACHC,GAAI,MACJC,IAAK,MACLC,EAAG,KACHC,GAAI,KACJC,IAAK,KACLC,EAAG,IACHC,GAAI,IACJC,IAAK,IACLC,EAAG,KACHC,GAAI,KACJC,IAAK,KACLC,EAAG,MACHC,GAAI,MACJC,IAAK,MACLC,EAAG,OACHC,GAAI,OACJC,IAAK,OACLC,EAAG,KACHC,GAAI,KACJC,IAAK,KACLC,IAAM,KAENC,GACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GAEAC,EAAQ,GACL/B,EAAI,GACHA,EAAI8B,EAAO,GACXA,EAAOE,SAEPD,GAAS9B,EAAS6B,EAAO,IACzB9B,GAAK8B,EAAO,GAGpB,OAAOC,GAEX,QAASE,GAAcC,GAAvB,GAEQC,GASA1E,EAAW2E,EACNlG,EACDmG,CADR,KAXAH,EAAIA,EAAEI,cACFH,GACAjG,EAAG,EACHmG,EAAG,EACHE,EAAG,GACHC,EAAG,GACHC,EAAG,IACHC,EAAG,IACHC,EAAG,KAEHlF,EAAQ,EAAG2E,EAAO,EACblG,EAAI,EAAGA,EAAIgG,EAAEtH,SAAUsB,EAAG,CAE/B,GADImG,EAAIF,EAAOD,EAAEU,OAAO1G,KACnBmG,EACD,MAAO,KAEX5E,IAAS4E,EACLA,EAAID,IACJ3E,GAAS,EAAI2E,GAEjBA,EAAOC,EAEX,MAAO5E,GAEX,QAASoF,GAAQxJ,GACb,GAAIyJ,GAAQC,OAAOC,OAAO,KAC1B,OAAO,YAAA,GAEM9G,GADL+G,EAAK,EACT,KAAS/G,EAAIgH,UAAUtI,SAAUsB,GAAK,GAClC+G,GAAM,IAAMC,UAAUhH,EAE1B,OAAO+G,KAAMH,GAAQA,EAAMG,GAAMH,EAAMG,GAAM5J,EAAE8J,MAAMpJ,KAAMmJ,YAGnE,QAASE,GAAgBC,GACrB,MAAOC,GAAkBC,KAAKF,GAElC,QAASG,GAASnK,EAAGoK,GAWjB,QAASC,GAAOjG,GACZ1D,KAAK0D,MAAQA,EAXjB,IACI,MAAOpE,GAAES,KAAK2J,EAAK,SAAUhG,GACzB,KAAM,IAAIiG,GAAOjG,KAEvB,MAAOkG,GACL,GAAIA,YAAcD,GACd,MAAOC,GAAGlG,KAEd,MAAMkG,IAlJjB,GAqKOL,GApKA/J,EAAQ2D,OAAO3D,MAAOsB,EAAatB,EAAMsB,WAIzC+I,EAAMC,KAAKD,GACVA,KACDA,EAAM,WACF,OAAO,GAAIC,OAAOC,YAgJ1BjJ,EAAWtB,GACPuB,MACI8I,IAAKA,EACLlE,UAAWA,EACXD,WAAYA,EACZD,IAAKA,EACLyC,cAAeA,EACflC,cAAeA,EACf8C,QAASA,EACTO,gBAAiBA,EACjBI,SAAUA,KAGdF,EAAwBS,OAAO,y2JAEhC7G,OAAO3D,OACE,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,kBACH,aACA,aACDD,IACL,WACE,YAUA,SAAS2K,GAAK/H,GAAd,GAEaC,GADL+H,IACJ,KAAS/H,EAAI,EAAGA,EAAID,EAAIrB,SAAUsB,EAC9B+H,EAAI/J,KAAK+B,EAAIG,WAAWF,GAE5B,OAAO+H,GAEX,QAASC,GAAKD,EAAKE,GACXA,EAAO,OACPA,GAAQ,MACRF,EAAI/J,KAAKiK,IAAS,GAAK,KAAO,MAAO,MAAe,KAAPA,IAE7CF,EAAI/J,KAAKiK,GAsBjB,QAASC,GAAMC,EAAMC,GAkBjB,QAASC,GAASvF,GACd,GAAImF,GAAOE,EAAKG,IACH,KAAPL,EAAa,IAEC,IAAPA,EAAa,IAEN,IAAPA,EAAa,IAGtBnF,EAAK9E,KAAKiK,GAFVD,EAAKlF,GAAc,GAAPmF,IAAc,EAAoB,GAAhBE,EAAKG,MAFnCN,EAAKlF,GAAc,GAAPmF,IAAc,IAAsB,GAAhBE,EAAKG,OAAkB,EAAoB,GAAhBH,EAAKG,MAFhEN,EAAKlF,GAAc,EAAPmF,IAAa,IAAsB,GAAhBE,EAAKG,OAAkB,IAAsB,GAAhBH,EAAKG,OAAkB,EAAoB,GAAhBH,EAAKG,MASpG,QAASC,GAAMC,GACX,KAAUC,OAAMD,EAAM,QAAUF,GAEpC,QAASI,GAAUC,GAEf,IADA,GAAIC,MACGN,EAAQH,EAAKzJ,QAAUiK,EAAKR,EAAKG,KACpCM,EAAE5K,KAAKmK,EAAKG,KAEhB,OAAOM,GAEX,QAASC,GAAeF,GACpB,MAAOG,GAAO7B,MAAM,EAAGyB,EAAUC,IAErC,QAASI,KACLL,EAAUM,GAEd,QAASC,GAAIL,GAAb,GAEa5I,GADLkJ,EAAOZ,CACX,KAAStI,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EAC5B,GAAImI,EAAKG,MAAYM,EAAE5I,GAEnB,MADAsI,GAAQY,GACD,CAGf,OAAON,GAEX,QAASO,GAAKlB,GACLgB,EAAIhB,IACLM,EAAM,aAAeN,EAAKpI,KAAK,OAGvC,QAASmJ,GAAaf,GAClB,MAAe,IAARA,GAAqB,IAARA,GAAsB,IAARA,GAAsB,IAARA,EAEpD,QAASmB,GAAQnB,GACb,MAAOA,IAAQ,IAAMA,GAAQ,GAEjC,QAASoB,GAAWpB,GAChB,MAAOA,IAAQ,IAAMA,GAAQ,KAAOA,GAAQ,KAAO,IAAMA,GAAQ,IAErE,QAASqB,GAAYrB,GACjB,MAAe,KAARA,GAAsB,IAARA,IAAeA,GAAQ,KAAO,IAAMA,GAAQ,IAErE,QAASsB,GAAOtB,GACZ,MAAe,KAARA,GAAcmB,EAAQnB,IAASqB,EAAYrB,GAEtD,QAASuB,KAEL,IADA,GAAI1G,MACGwF,EAAQH,EAAKzJ,QAAQ,CACxB,GAAIuK,EAAIQ,GACJ,MAAO7L,GAAK,UAAWkL,EAAO7B,MAAM,EAAGnE,GAE3CuF,GAASvF,IAGjB,QAAS4G,KACL,GAAIC,GAAMC,CACNX,GAAIY,GACJC,IACOb,EAAIc,GACXP,KAEAG,EAAOK,IACPJ,EAAQK,EAASN,GACjBzL,EAAMF,KAAK4L,GACPX,EAAIiB,GACJtM,EAAK,QAAS+L,EAAMC,GAAO,IAE3BT,EAAKgB,GACLvM,EAAK,QAAS+L,EAAMC,GACpBQ,EAAWT,GACPA,GAAQK,KACRzB,EAAM,mBAEV3K,EAAK,QAAS+L,EAAMC,GACpBb,IACAI,EAAKgB,IAETjM,EAAMmM,OAGd,QAASD,GAAWT,GAEhB,IADA,GAAI7G,MACGwF,EAAQH,EAAKzJ,QAAQ,CACxB,GAAIuK,EAAIqB,GACJ,MAAOxH,GAAKpE,QAAUd,EAAK,OAAQkL,EAAO7B,MAAM,EAAGnE,GAChD,IAAImG,EAAIsB,GACX,KAAOjC,EAAQH,EAAKzJ,SAAWuK,EAAIuB,IAC/BnC,EAASvF,OAENmG,GAAIwB,IACP3H,EAAKpE,QACLd,EAAK,OAAQkL,EAAO7B,MAAM,EAAGnE,IAEjC4G,IACA5G,MACOmG,EAAIyB,GACXC,EAAU7H,GAEVuF,EAASvF,GAGjByF,EAAM,gBAAkBoB,GAE5B,QAASK,KAIL,MAHKV,GAAYnB,EAAKG,KAClBC,EAAM,sBAEHM,EAAeU,GAE1B,QAASqB,KAAT,GAKQ9H,GAJA+H,EAAQ5B,EAAI6B,IAAU7B,EAAI8B,EAK9B,KAJKF,GACDtC,EAAM,oBAENzF,KACGwF,EAAQH,EAAKzJ,QAAQ,CACxB,GAAIuK,EAAI4B,GACJ,MAAO/B,GAAO7B,MAAM,EAAGnE,EAChBmG,GAAIyB,GACXC,EAAU7H,GAEVuF,EAASvF,GAGjByF,EAAM,qBAEV,QAASoC,GAAU7H,GAAnB,GACQmF,GAWI0B,CAVJV,GAAI+B,IAEA/C,EADAgB,EAAIgC,IAAgBhC,EAAIiC,GACjBC,SAAStC,EAAeQ,GAAa,IAErC8B,SAAStC,EAAeO,GAAU,IAEzCgC,MAAMnD,IACNM,EAAM,wBAGNoB,EAAOK,IACX/B,EAAOoD,EAAS1B,GACH2B,SAATrD,GACAM,EAAM,kBAAoBoB,IAGlC3B,EAAKlF,EAAMmF,GACXkB,EAAKoC,GAET,QAASzB,KACLlM,EAAK,OAAQoM,IAAWC,KACxBd,EAAKqC,GAET,QAASvB,GAASN,GAEd,IAFJ,GAIY1B,GAHJzG,GAAQiK,KAAM9B,GACXrB,EAAQH,EAAKzJ,SAChBqK,IACId,EAAOE,EAAKG,GACJ,IAARL,GAAsB,IAARA,GAAsB,IAARA,IAGhCzG,EAAIwI,MAAcb,EAAKuC,GAAQd,IAEnC,OAAOpJ,GAEX,QAAS5D,GAAK+N,EAAMC,EAAOC,EAAMC,GAC7B,GAAI3O,GAAIiL,GAAaA,EAAUuD,EAC3BxO,IACAA,EAAES,KAAK6B,EAAQmM,EAAOC,EAAMC,GArMxC,GACQxD,GAAQ,EACRpK,KACAuB,GACAsM,GAAI,SAAUC,GAEV,IADA,GAAIhM,GAAI9B,EAAMQ,OAAQuN,EAAID,EAAStN,SAC1BsB,GAAK,KAAOiM,GAAK,GACtB,GAAI/N,EAAM8B,GAAGyL,MAAQO,EAASC,IAAqB,KAAfD,EAASC,GACzC,OAAO,CAGf,OAAOA,GAAI,EAAI/N,EAAMA,EAAMQ,OAAS,GAAK,MAE7CwN,KAAM,WACF,KAAMC,IAEVjO,MAAOA,GAwLPkO,IAKJ,KAJA/D,EAAS+D,GACK,OAAVA,EAAI,KACJ9D,EAAQ,GAELA,EAAQH,EAAKzJ,QAChBqK,IACAI,EAAKsB,GACLf,IACAX,IA9PV,GAEMD,GAAS1J,OAAOiN,aAChBhB,GACAiB,IAAO,GACPC,GAAM,GACNC,GAAM,GACNC,KAAQ,GACRC,KAAQ,GACRC,KAAQ,KAiBRpC,EAAczC,EAAK,aACnB0C,EAAY1C,EAAK,OACjB2B,EAAc3B,EAAK,OACnBiC,EAAgBjC,EAAK,OACrBoC,EAAgBpC,EAAK,MACrBwC,EAAUxC,EAAK,MACf0D,EAAkB1D,EAAK,MACvB+B,EAAgB/B,EAAK,KACrB2C,EAAY3C,EAAK,KACjBqC,EAAerC,EAAK,KACpByD,EAAYzD,EAAK,KACjB4D,EAAQ5D,EAAK,KACb4C,EAAY5C,EAAK,KACjBgD,EAAQhD,EAAK,KACbiD,EAAajD,EAAK,KAClBkD,EAAQlD,EAAK,KACbmD,EAAcnD,EAAK,KACnBoD,EAAcpD,EAAK,KACnBqE,IAqNJ9O,OAAMuB,KAAKgO,SAAW,WAClB,IACI,MAAO1E,GAAMjB,MAAMpJ,KAAMmJ,WAC3B,MAAOS,GACL,GAAIA,IAAO0E,EACP,KAAM1E,MAIF,kBAAVrK,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,wBACH,aACA,eACA,eACA,aACA,kBACDD,IACL,YACG,SAAUE,GAyhBP,QAASwP,GAAgBC,GACrB,GAAIC,GAAW/K,SAASC,cAAc,WACtChD,GAAE8N,GAAUC,SAAS,2BAA2BC,IAAIH,GAAMI,SAASlL,SAASc,MAAMqK,QAAQC,SAC1FpL,SAASqL,YAAY,QACrBpO,EAAE8N,GAAUO,SA7hBnB,GAIOrO,GACAsO,EA8CAC,EA4DAC,EAkiBAC,EAkGAC,EAqDAC,EAgGAC,CAv4BAxQ,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVkK,EAAUlQ,EAAM6Q,YAAYX,QAAUlQ,EAAM4D,MAAMzD,QAClDC,KAAM,SAAUC,GACZG,KAAKH,QAAUA,EACfG,KAAKsQ,UAAYzQ,EAAQ0Q,SACzBvQ,KAAKwQ,UAAY3Q,GAAWA,EAAQ4Q,SACpCzQ,KAAK0Q,WAETC,MAAO,SAAUA,GAIb,MAHclD,UAAVkD,GACA3Q,KAAK4Q,UAAUD,GAEZ3Q,KAAK6Q,QAEhBD,UAAW,SAAUD,GACjB3Q,KAAK6Q,OAASF,GAElBhQ,KAAM,WACFX,KAAK2Q,QAAQpB,SACbvP,KAAK8Q,QAETtQ,KAAM,WACFR,KAAK+Q,SAAS/Q,KAAK0Q,SAEvBM,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK2Q,QAAQK,SAAShR,KAAKwQ,YAE7CO,SAAU,SAAUE,GAChBjR,KAAK2Q,QAAQI,SAASE,IAE1BC,YAAa,SAAUC,GAEnB,MADAnR,MAAKQ,QAED4Q,MAAOD,EAAgBC,MACvBnM,KAAMkM,EAAgBE,QACtBC,OAAQ,QACRC,KAAM,oBAGdC,aAAc,SAAUC,GAAV,GACNd,GAAQ3Q,KAAK2Q,QACbe,EAAMf,EAAMgB,IAChBD,GAAIE,QAAQ,SAAUF,GAClBf,EAAMkB,QAAQD,QAAQF,EAAII,aAAcL,EAASM,KAAK/R,QACxD+R,KAAK/R,UAGX2P,EAAqBD,EAAQ/P,QAC7BC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKgS,QAAUnS,EAAQoS,OACvBjS,KAAKkS,OAASrS,EAAQ6D,OAE1BoN,KAAM,WACF9Q,KAAKgR,WACLhR,KAAK+Q,SAAS/Q,KAAKkS,WAG3B1S,EAAM6Q,YAAY8B,mBAAqBxC,EAAmBhQ,QACtDqR,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK2Q,QAAQkB,QAAQO,YAAYpS,KAAKgS,UAExDjB,SAAU,SAAUE,GAChBjR,KAAK2Q,QAAQkB,QAAQO,YAAYpS,KAAKgS,QAASf,MAGvDzR,EAAM6Q,YAAYgC,iBAAmB1C,EAAmBhQ,QACpDqR,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK2Q,QAAQkB,QAAQS,UAAUtS,KAAKgS,UAEtDjB,SAAU,SAAUE,GAChBjR,KAAK2Q,QAAQkB,QAAQS,UAAUtS,KAAKgS,QAASf,MAGrDzR,EAAM6Q,YAAYkC,iBAAmB7C,EAAQ/P,QACzCC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKwS,MAAQ3S,EAAQ4S,MAEzB3B,KAAM,WACF,GAAIH,GAAQ3Q,KAAK2Q,OACjB3Q,MAAK0S,UAAY/B,EAAM8B,OACvBzS,KAAK2S,eAAiBhC,EAAMiC,YAC5BjC,EAAM8B,KAAKzS,KAAKwS,OAChB7B,EAAMiC,WAAU,GACK,MAAjBjC,EAAMjN,UACN1D,KAAK6S,cAAe,EACpBlC,EAAMjN,MAAM1D,KAAKwS,SAGzBhS,KAAM,WACF,GAAImQ,GAAQ3Q,KAAK2Q,OACjBA,GAAM8B,KAAKzS,KAAK0S,WAChB/B,EAAMiC,UAAU5S,KAAK2S,gBACjB3S,KAAK6S,cACLlC,EAAMjN,MAAM,SAIxBlE,EAAM6Q,YAAYyC,uBAAyBnD,EAAmBhQ,QAC1DqR,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK6Q,OAAOgB,QAAQkB,iBAEtChC,SAAU,SAAUzI,GAChBtI,KAAK6Q,OAAOgB,QAAQkB,cAAczK,MAGtCsH,EAAwBpQ,EAAM6Q,YAAYT,sBAAwBF,EAAQ/P,QAC1EiR,UAAW,SAAUD,GACjBjB,EAAQsD,UAAUpC,UAAU7Q,KAAKC,KAAM2Q,EAAMsC,oBAEjDrT,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKkS,OAASrS,EAAQ6D,OAE1BoN,KAAM,WACF,GAAIH,GAAQ3Q,KAAK2Q,OACbA,GAAMuC,WACNlT,KAAKgR,WACyB,WAA1BhR,KAAKH,QAAQ4Q,UACbzQ,KAAKsQ,UAAU5P,QAAQ,gBAAkBiQ,MAAOA,IAEpDA,EAAM3Q,KAAKwQ,WAAWxQ,KAAKkS,YAIvC1S,EAAM6Q,YAAY8C,oBAAsBzD,EAAQ/P,QAC5CmR,KAAM,WAAA,GAcEH,GAEAQ,CAfJ,OAAKnR,MAAK2Q,QAAQuC,SAMblT,KAAK2Q,QAAQyC,uBAMlBpT,KAAKgR,WACDL,EAAQ3Q,KAAK2Q,QAAQsC,kBACzBtC,EAAM0C,eACFlC,EAAkBR,EAAM2C,sBACxBnC,EACOnR,KAAKkR,YAAYC,GAD5B,SARQG,OAAQ,QACRC,KAAM,oBAPND,OAAQ,QACRC,KAAM,2BAkBtB/R,EAAM6Q,YAAYkD,YAAc3D,EAAsBjQ,QAClDC,KAAM,SAAUC,GACZA,EAAQ4Q,SAAW5Q,EAAQ4Q,UAAY,QACvCb,EAAsB9P,GAAGF,KAAKG,KAAKC,KAAMH,IAE7C+Q,UAAW,SAAUD,GACjBf,EAAsBoD,UAAUpC,UAAUxH,MAAMpJ,KAAMmJ,WACtDnJ,KAAKwT,WAAaxT,KAAKH,QAAQ4T,aAAe9C,EAAQA,EAAMkB,QAAQ6B,uBAExE1C,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK2Q,QAAQK,YAE/BF,KAAM,WACF,MAAO9Q,MAAK2Q,QAAQkB,QAAQ8B,oBAAoB3T,KAAK4T,MAAM7B,KAAK/R,QAEpE4T,MAAO,WAAA,GAeClQ,GAiBIyN,EA/BJsC,EAAezT,KAAKH,QAAQ4T,aAC5BI,EAAY7T,KAAKwT,UACrB,KAAKK,EAAUX,SACX,OACI5B,OAAQ,QACRC,KAAM,gBAGd,KAAKsC,EAAUT,sBACX,OACI9B,OAAQ,QACRC,KAAM,kBAKd,IAFI7N,EAAQ1D,KAAKkS,OACjBlS,KAAKgR,WACiB,SAAlBhR,KAAKwQ,UAEL,WADAqD,GAAUnQ,MAAMA,EAGpB,KAYI,GAXAmQ,EAAUpB,KAAK,MACD,KAAV/O,EACAmQ,EAAUnQ,MAAM,OAEhBmQ,EAAUC,MAAMpQ,GAAS+P,aAAcA,IACnC,KAAKjK,KAAKqK,EAAUnQ,UACpBmQ,EAAUE,MAAK,IAGvBF,EAAUG,mBACN7C,EAAkB0C,EAAUP,sBAE5B,MAAOtT,MAAKkR,YAAYC,GAE9B,MAAOvH,GACL,GAAIA,YAAcpK,GAAM6Q,YAAY4D,KAAKC,WACrC,OACI9C,MAAO,mBACPnM,KAAM2E,EAAK,GACX0H,OAAQ,QAGZ,MAAM1H,OAKtBpK,EAAM6Q,YAAY8D,gBAAkBvE,EAAsBjQ,QACtDC,KAAM,SAAUC,GACZA,EAAQ4Q,SAAW,OACnBb,EAAsB9P,GAAGF,KAAKG,KAAKC,KAAMH,GACzCG,KAAKkS,OAASrS,EAAQ6D,OAE1BsN,SAAU,WACN,GAAIsB,KACJtS,MAAK2Q,QAAQyD,WAAW,SAAUzD,GAC9B,GAAIlG,GAAQkG,EAAM0D,UAAUC,GAC5BhC,GAAU7H,GAASkG,EAAMkB,QAAQS,UAAU7H,KAE/CzK,KAAK0Q,OAAS1Q,KAAK2Q,QAAQK,SAAShR,KAAKwQ,WACzCxQ,KAAKuU,WAAajC,GAEtB9R,KAAM,WAAA,GAIO8T,GAHLzC,EAAQ7R,KAAK2Q,QAAQkB,QACrBS,EAAYtS,KAAKuU,UACrBvU,MAAK2Q,QAAQI,SAAS/Q,KAAK0Q,OAC3B,KAAS4D,IAAOhC,GACZT,EAAMS,UAAUgC,EAAKhC,EAAUgC,OAI3C9U,EAAM6Q,YAAYmE,sBAAwB9E,EAAQ/P,QAC9CC,KAAM,SAAUC,GACZG,KAAKyU,OAAS5U,EAAQ6D,MACtB7D,EAAQ4Q,SAAW,SACnBf,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,IAE/BiR,KAAM,WAAA,GACEe,GAAQ7R,KAAK2Q,QAAQkB,QACrB6C,EAAQ1U,KAAKyU,OACbE,EAAanV,EAAM6Q,YAAYsE,UACnC3U,MAAKgR,WACLa,EAAM+C,MAAM,WACR5U,KAAK2Q,QAAQkE,YAAY,SAAUP,EAAKQ,EAAKC,GAApB,GAGbrR,GAFJsR,EAASD,EAAKC,MACbA,KACGtR,EAAQqR,EAAKrR,MACG,gBAATA,IAAqB,KAAK8F,KAAK9F,KACtCsR,EAAS,MAActR,EAAPnC,IAAcwE,MAAM,KAAK,GAAGvE,QAAQ,MAAO,QAG/DwT,GAAUN,EAAQ,KAClBM,EAASL,EAAWM,eAAeD,GAAU,IAAKN,GAClD7C,EAAMlB,MAAM2D,EAAKQ,GAAKE,OAAOA,OAGvCjD,KAAK/R,UAGfR,EAAM6Q,YAAY6E,oBAAsBxF,EAAQ/P,QAC5CC,KAAM,SAAUC,GACZA,EAAQ4Q,SAAW,SACnBf,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKmV,MAAQtV,EAAQuV,OACrBpV,KAAKqV,OAASxV,EAAQ8C,OAE1B2S,OAAQ,SAAUhW,GACd,MAAOU,MAAK2Q,QAAQkB,QAAQ+C,MAAMtV,OAEtCwR,KAAM,WACF,GAAIyE,GAAOvV,IACXuV,GAAKvE,WACLuE,EAAKD,OAAO,WACRC,EAAKA,EAAKJ,OAAOI,EAAKF,WAG9BG,UAAW,WACPxV,KAAK2Q,QAAQ8E,cAAc,MAC3BzV,KAAK0V,eAAe,OAExBC,WAAY,SAAUhT,GAClB3C,KAAK2Q,QAAQ8E,cAAc9S,GAC3B3C,KAAK0V,eAAe/S,IAExBiT,WAAY,SAAUjT,GAClB3C,KAAK2Q,QAAQkF,aAAaC,WAAWnT,IAEzCoT,YAAa,SAAUpT,GACnB3C,KAAK2Q,QAAQqF,cAAcC,YAAYtT,IAE3CuT,UAAW,SAAUvT,GACjB3C,KAAK2Q,QAAQwF,SAASC,UAAUzT,IAEpC0T,aAAc,SAAU1T,GACpB3C,KAAK2Q,QAAQ2F,YAAYC,aAAa5T,IAE1C+S,eAAgB,SAAU/S,GACtB,GAAIgO,GAAQ3Q,KAAK2Q,OACjBA,GAAMkF,aAAaC,WAAWnT,GAC9BgO,EAAMwF,SAASC,UAAUzT,GACzBgO,EAAMqF,cAAcC,YAAYtT,GAChCgO,EAAM2F,YAAYC,aAAa5T,IAEnC8S,cAAe,SAAU9S,GACrB3C,KAAK2Q,QAAQ8E,cAAc9S,GAC3B3C,KAAK0V,eAAe,OAExBc,wBAAyB,SAAU7T,GAC/B3C,KAAK2Q,QAAQ6F,wBAAwB7T,IAEzC8T,sBAAuB,SAAU9T,GAC7B3C,KAAK2Q,QAAQ8F,sBAAsB9T,MAG3CnD,EAAM6Q,YAAYqG,iBAAmBhH,EAAQ/P,QACzCC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKmV,MAAQtV,EAAQ6D,OAEzBoN,KAAM,WACF9Q,KAAKgR,WACLhR,KAAKA,KAAKmV,UAEdwB,SAAU,SAAUjF,GAChB1R,KAAK2Q,QAAQkB,QAAQ+E,WAAWlF,IAEpCV,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK2Q,QAAQK,YAE/BxQ,KAAM,WACiB,YAAfR,KAAKmV,QACLnV,KAAK2Q,QAAQkG,UACb7W,KAAK2W,SAAS3W,KAAK2Q,QAAQ0D,YAE/BrU,KAAK2Q,QAAQI,SAAS/Q,KAAK0Q,SAE/BoG,MAAO,WAAA,GACCnG,GAAQ3Q,KAAK2Q,QACbe,EAAMf,EAAMgB,IAChBhB,GAAMoG,QACN/W,KAAK2W,SAASjF,IAElBsF,aAAc,WACV,GAAItF,GAAM1R,KAAK2Q,QAAQwF,SAASxE,IAChC3R,MAAK2Q,QAAQyD,WAAW,SAAUzD,GAC9BA,EAAMoG,UAEV/W,KAAK2W,SAASjF,IAElBuF,WAAY,WACR,GAAIvF,GAAM1R,KAAK2Q,QAAQkF,aAAalE,IACpC3R,MAAK2Q,QAAQuG,cAAc,SAAUvG,GACjCA,EAAMoG,UAEV/W,KAAK2W,SAASjF,IAElBmF,QAAS,WAAA,GACDlG,GAAQ3Q,KAAK2Q,QACbe,EAAMf,EAAMgB,KAAK0C,OACrB1D,GAAMkG,UACN7W,KAAK2W,SAASjF,MAGtBlS,EAAM6Q,YAAY8G,mBAAqBzH,EAAQ/P,QAC3CC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKmV,MAAQtV,EAAQ6D,OAEzBoN,KAAM,WACF9Q,KAAKgR,WACLhR,KAAKoX,SAAWpX,KAAK2Q,QAAQ0D,UAC7BrU,KAAKA,KAAKmV,UAEdnE,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAK2Q,QAAQkB,QAAQb,YAEvCxQ,KAAM,WACFR,KAAK2Q,QAAQkB,QAAQd,SAAS/Q,KAAK0Q,SAEvC2G,MAAO,WAAA,GACChD,GAAUrU,KAAKoX,SACfvF,EAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAMyF,cAAcjD,EAAQS,KAAKyC,WAAWlD,EAAQC,MAExDkD,KAAM,WAAA,GACEnD,GAAUrU,KAAKoX,SACfvF,EAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAM0F,WAAWlD,EAAQC,MAE7BmD,QAAS,WAAA,GACDpD,GAAUrU,KAAKoX,SACfvF,EAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAMyF,cAAcjD,EAAQS,MAEhC4C,SAAU,WACN,GAAI7F,GAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAM0F,WAAW,GAAGD,cAAc,MAG1C9X,EAAM6Q,YAAYsH,aAAejI,EAAQ/P,QACrCC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAK4X,WAAa/X,EAAQ0Q,SAASsH,YACnC7X,KAAK4X,WAAWvN,QAChBrK,KAAK8X,OAASjY,EAAQkY,MACtB/X,KAAKgY,kBAAoBhY,KAAK4X,WAAWK,SACzCjY,KAAKkY,mBAAqBlY,KAAK4X,WAAWO,WAC1CnY,KAAKoY,OAASpY,KAAKsQ,UAAU+H,cAC7BrY,KAAK6Q,OAAS7Q,KAAKoY,OAAOzH,MAAM3Q,KAAK4X,WAAWO,YAChDnY,KAAK0Q,OAAS1Q,KAAK6Q,OAAOG,YAE9BF,KAAM,WACF,MAAO9Q,MAAK2Q,QAAQkB,QAAQ8B,oBAAoB3T,KAAK4T,MAAM7B,KAAK/R,QAEpE4T,MAAO,WAAA,GA8BCjD,GACA2H,EA9BAC,EAASvY,KAAK4X,WAAWY,UAC7B,OAAKD,GAAOC,UA4BR7H,EAAQ3Q,KAAKsQ,UAAU+H,cAAcI,YACrCH,EAAiBtY,KAAKsQ,UAAU5P,QAAQ,SAAWiQ,MAAOA,SAC1D2H,EACAtY,KAAK8X,OAAOQ,kBAEZtY,KAAKoY,OAAOzH,MAAM3Q,KAAKkY,oBAAoBnH,SAAS/Q,KAAKgY,kBAAmBhY,KAAK4X,YACjF5X,KAAKoY,OAAOM,eACRC,QAAQ,EACRjH,IAAK1R,KAAKkY,qBAEdvH,EAAMqD,sBArCFuE,EAAOK,aAEHtH,OAAQ,QACRC,KAAM,eAGVgH,EAAOM,eAEHvH,OAAQ,QACRC,KAAM,gBAGVgH,EAAOO,UAEHxH,OAAQ,QACRC,KAAM,YAGVgH,EAAOQ,iBACP/Y,KAAK8X,OAAOQ,kBAERhH,OAAQ,QACRC,KAAM,0BAGLD,OAAQ,YAgB7B9R,EAAM6Q,YAAY2I,uBAAyBtJ,EAAQ/P,QAC/CmR,KAAM,WAAA,GACEjR,GAAUG,KAAKH,QACfgS,EAAQ7R,KAAKsQ,UAAU+H,cACvB1H,EAAQ9Q,EAAQ8Q,OAASkB,EAAMlB,MAAM9Q,EAAQoZ,SACjDtI,GAAMqD,sBAGdxU,EAAM6Q,YAAY6I,oBAAsBxJ,EAAQ/P,QAC5CmR,KAAM,WACF,MAAItR,GAAMyQ,QAAQ4H,UAAUsB,OACxBnZ,KAAKsQ,UAAU8I,MAAMvB,UAAUvI,QAAQC,aACvCpL,UAASqL,YAAY,WAGjB8B,OAAQ,QACRC,KAAM,kBAKtB/R,EAAM6Q,YAAYgJ,WAAa3J,EAAQ/P,QACnC2Z,WAAY,MACZ1Z,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAK4X,WAAa/X,EAAQ0Q,SAASsH,YACnC7X,KAAK8X,OAASjY,EAAQkY,OAE1BjH,KAAM,WAAA,GAgBEH,GAWA2H,EA1BAC,EAASvY,KAAK4X,WAAW2B,SAC7B,IAAKhB,EAAOgB,QAAZ,CAeA,GADI5I,EAAQ3Q,KAAKsQ,UAAU+H,cAAcI,YAClB,OAAnBzY,KAAKsZ,WAAqB,CAC1B,IAAK3I,EAAMuC,SAEP,MADAlT,MAAK8X,OAAOQ,kBAERhH,OAAQ,QACRC,KAAM,uBAGdvR,MAAKgR,WAELsH,EAAiBtY,KAAKsQ,UAAU5P,QAAQV,KAAKsZ,YAAc3I,MAAOA,IAClE2H,EACAtY,KAAK8X,OAAOQ,iBACc,OAAnBtY,KAAKsZ,WACZtZ,KAAK4X,WAAW4B,MAEhBxZ,KAAK4X,WAAW6B,WA/BpB,CACI,GAAIlB,EAAOK,YACP,OACItH,OAAQ,QACRC,KAAM,cAEP,IAAIgH,EAAOmB,eACd,OACIpI,OAAQ,QACRC,KAAM,4BA0B1B/R,EAAM6Q,YAAYsJ,YAAcna,EAAM6Q,YAAYgJ,WAAW1Z,QACzD2Z,WAAY,OACZ9Y,KAAMY,EAAEwY,OAQZpa,EAAM6Q,YAAYwJ,mBAAqBnK,EAAQ/P,QAC3CC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAK4X,WAAa/X,EAAQ0Q,SAASsH,aAEvCrX,KAAMY,EAAEwY,KACR9I,KAAM,WACF,IAAItR,EAAMyQ,QAAQ4H,UAAU4B,KAKxB,OACInI,OAAQ,QACRC,KAAM,cANV,IAAIsG,GAAY7X,KAAKsQ,UAAU8I,MAAMvB,SACrC7I,GAAgB6I,EAAU5I,QAC1B4I,EAAUnX,QAAQ,WAS9BlB,EAAM6Q,YAAYyJ,gBAAkBpK,EAAQ/P,QACxCC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,IAE/Bka,OAAQ,SAAUA,GACd/Z,KAAKga,QAAUD,GAEnBjJ,KAAM,WACF,GAAIH,GAAQ3Q,KAAK2Q,OACjB,KAAKA,EAAMuC,SACP,OACI5B,OAAQ,QACRC,KAAM,gBAGd,IAAIZ,EAAMsJ,2BACN,OACI3I,OAAQ,QACRC,KAAM,kBAGdvR,MAAKgR,UACL,KACIL,EAAMuJ,SAASla,KAAKga,SACtB,MAAOpQ,GACL,GAAIA,YAAcpK,GAAM6Q,YAAY8J,MAAMC,UACtC,OACI9I,OAAQ,QACRC,KAAM3H,EAAGQ,KAGjB,MAAMR,OAIlBpK,EAAM6Q,YAAYgK,kBAAoB3K,EAAQ/P,QAC1CC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAK4X,WAAa/X,EAAQ0Q,SAASsH,aAEvC/G,KAAM,WACF,IAAItR,EAAMyQ,QAAQ4H,UAAU4B,KAKxB,OACInI,OAAQ,QACRC,KAAM,cANV,IAAIsG,GAAY7X,KAAKsQ,UAAU8I,MAAMvB,SACrC7I,GAAgB6I,EAAU5I,QAC1B4I,EAAUnX,QAAQ,UAS9BlB,EAAM6Q,YAAYiK,cAAgB5K,EAAQ/P,QACtCa,KAAM,WACFR,KAAK2Q,QAAQ4J,OAAOva,KAAK0Q,SAE7BI,KAAM,WACF,GAAIH,GAAQ3Q,KAAK2Q,OACjB3Q,MAAK0Q,OAASC,EAAM6J,YACpB7J,EAAM4J,QAAQva,KAAK0Q,WAG3BlR,EAAM6Q,YAAYoK,YAAc/K,EAAQ/P,QACpCa,KAAM,WACF,GAAIqR,GAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAMd,SAAS/Q,KAAK0Q,SAExBI,KAAM,WAAA,GAUEQ,GATAX,EAAQ3Q,KAAK2Q,QACbkB,EAAQlB,EAAMkB,QACd+E,EAAa/E,EAAM+E,aACnB9B,EAAM9U,KAAKH,QAAQgS,MAAQ+E,EAAWvC,QAAQS,IAAM9U,KAAKH,QAAQ6a,QAAU,EAC3EC,EAAmC,QAAvB3a,KAAKH,QAAQ6D,KAM7B,OALA1D,MAAK0Q,OAASmB,EAAMb,WAChBhR,KAAKH,QAAQgS,QACblB,EAAQ3Q,KAAK4a,gBAEbtJ,EAASX,EAAMkK,aAGXvJ,OAAQ,QACRC,KAAMD,EAAOlH,UAGrBuG,GAAM5O,MACF2Y,OAAQ5F,EACR6F,UAAWA,KAGnBC,YAAa,WACT,GAAI/I,GAAQ7R,KAAK2Q,QAAQkB,OACzB,OAAO,IAAIrS,GAAM6Q,YAAY8J,MAAMtI,EAAMiJ,UAAWjJ,MAGxDhC,EAAqBrQ,EAAM6Q,YAAYR,mBAAqBH,EAAQ/P,QACpE+a,OAAQ,WACJ,MAAO1a,MAAKH,QAAQ6a,QAAU,GAElCla,KAAM,WACF,GAAIqR,GAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAMkJ,YAAY/a,KAAK0a,UACnB1a,KAAK0Q,OAAO7P,QACZb,KAAK2Q,QAAQ4J,OAAOva,KAAK0Q,SAGjCM,SAAU,WAAA,GACFa,GAAQ7R,KAAK2Q,QAAQkB,QACrB/O,EAAU+O,EAAM0I,QAChBzX,KACA9C,KAAK0Q,OAAS5N,EAAQ2U,QAAQ8C,OAAO,SAAU7R,GAC3C,MAAOA,GAAE+B,OAASzK,KAAK0a,UACzB3I,KAAK/R,SAGf8Q,KAAM,WAAA,GAIEjR,GACAmb,EAJArK,EAAQ3Q,KAAK2Q,QACb+J,EAAS1a,KAAK0a,SACd5X,EAAU6N,EAAMkB,QAAQ0I,SAGxBU,GAAS,CACTjb,MAAKH,QAAQqb,YACbF,GACIN,OAAQA,EACRH,OAAQ,GAAI/a,GAAM6Q,YAAY8K,YAAYnb,KAAKH,QAAQqb,cAEpDlb,KAAKH,QAAQub,eACpBJ,GACIN,OAAQA,EACRH,OAAQ,GAAI/a,GAAM6Q,YAAYgL,aAAarb,KAAKH,QAAQub,gBAGhEpb,KAAKgR,WACDlO,GAAWA,EAAQ4O,IAAI4J,GAAG3K,EAAMgB,OAAS7O,EAAQ2U,QAAQ5W,QACzDiC,EAAQ2U,QAAQ7F,QAAQ,SAAU2J,GAC1BA,EAAQ9Q,QAAUiQ,IAClBO,GAAS,KAGjBpb,EAAUiD,EAAQ2U,QAAQ9T,IAAI,SAAU4X,GACpC,MAAOA,GAAQ9Q,QAAUiQ,EAASM,GAC9BN,OAAQa,EAAQ9Q,MAChB8P,OAAQgB,EAAQhB,UAGnBU,GACDpb,EAAQM,KAAK6a,IAGjBnb,EAAUmb,EAEdrK,EAAM4J,OAAO1a,MAGrBL,EAAM6Q,YAAYmL,mBAAqB3L,EAAmBlQ,QACtDmR,KAAM,WAAA,GACEH,GAAQ3Q,KAAK2Q,QACb+J,EAAS1a,KAAK0a,QAClB1a,MAAKgR,WACLL,EAAMoK,YAAYL,MAG1Blb,EAAM6Q,YAAYoL,gBAAkB/L,EAAQ/P,QACxCC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAK0b,KAAO7b,EAAQ6b,MAExBlb,KAAM,WACF,GAAIqR,GAAQ7R,KAAK2Q,QAAQkB,OACzBA,GAAM8J,aAAa3b,KAAK0Q,SAE5BI,KAAM,WACF,GAAIe,GAAQ7R,KAAK2Q,QAAQkB,OACzB7R,MAAK0Q,OAASmB,EAAM+J,eACH,OAAb5b,KAAK0b,KACL7J,EAAMgK,cAAcC,mBAEpBjK,EAAMgK,cAAcE,yBAIhCvc,EAAM6Q,YAAY2L,kBAAoBxc,EAAM6Q,YAAYoL,gBAAgB9b,QACpEmR,KAAM,WACF,GAAIe,GAAQ7R,KAAK2Q,QAAQkB,OACzB7R,MAAK0Q,OAASmB,EAAM+J,eACH,OAAb5b,KAAK0b,KACL7J,EAAMgK,cAAcI,qBAEpBpK,EAAMgK,cAAcK,2BAI5BpM,EAAgBJ,EAAQ/P,QACxBmR,KAAM,WACF9Q,KAAKmc,eAAiBnc,KAAKoc,QAAQpc,KAAK2Q,SACxC3Q,KAAK0Q,OAAS1Q,KAAKmc,eAAenL,WAClChR,KAAKqc,SAAWrc,KAAK4T,MAAM5T,KAAKmc,eAAetK,UAEnDrR,KAAM,WAAA,GACE+U,GAAOvV,KACP2Q,EAAQ4E,EAAK4G,eACbtK,EAAQlB,EAAMkB,OAClBA,GAAM+C,MAAM,WACRW,EAAK8G,SAASzK,QAAQ,SAAUpJ,GAC5B+M,EAAK+G,SAASzK,EAAOrJ,GACrBqJ,EAAM0K,yBAAyB/T,EAAEgU,YAErC7L,EAAMI,SAASwE,EAAK7E,UAEpB+L,QAAQ,EACR9D,QAAQ,EACRjH,IAAKf,EAAMgB,UAIvBnS,EAAM6Q,YAAYqM,iBAAmB5M,EAAcnQ,QAC/Cyc,QAAS,SAAUzL,GACf,MAAOA,GAAMgM,QACTC,OAAOC,EAAAA,GACPC,QAAQD,EAAAA,MAGhBjJ,MAAO,SAAU/B,GACb,MAAOA,GAAMgK,cAAckB,sBAE/BT,SAAU,SAAUzK,EAAOrJ,GACvBqJ,EAAMmL,UAAUxU,EAAEiC,OAClBoH,EAAMS,UAAU9J,EAAEiC,MAAOjC,EAAEhG,WAGnChD,EAAM6Q,YAAY4M,oBAAsBnN,EAAcnQ,QAClDyc,QAAS,SAAUzL,GACf,MAAOA,GAAMgM,QACTO,MAAML,EAAAA,GACNM,SAASN,EAAAA,MAGjBjJ,MAAO,SAAU/B,GACb,MAAOA,GAAMgK,cAAcuB,yBAE/Bd,SAAU,SAAUzK,EAAOrJ,GACvBqJ,EAAMwL,aAAa7U,EAAEiC,OACrBoH,EAAMO,YAAY5J,EAAEiC,MAAOjC,EAAEjG,UAGjCwN,EAAaL,EAAQ/P,QACrBC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKkS,OAASrS,EAAQ6D,OAE1BlD,KAAM,WAAA,GACE+U,GAAOvV,KACP6R,EAAQ0D,EAAK5E,QAAQkB,OACzBA,GAAM+C,MAAM,WACR,IAAK,GAAIzS,GAAIoT,EAAK+H,KAAKC,QAASpb,GAAK,GACjCoT,EAAK+G,SAASzK,EAAO0D,EAAK+H,KAAKE,QAGnCf,QAAQ,EACR9D,QAAQ,OAIpBnZ,EAAM6Q,YAAYoN,iBAAmB1N,EAAWpQ,QAC5CmR,KAAM,WAAA,GACEe,GAAQ7R,KAAK2Q,QAAQkB,QACrBhM,EAASgM,EAAMgK,cAAc6B,kBACjC,OAAI7X,GACOA,OAGP7F,KAAKsd,KADW,SAAhBtd,KAAKkS,OACOL,EAAMgK,cAAc8B,gBAEpB9L,EAAMgK,cAAc+B,mBAGxCtB,SAAU,SAAUzK,EAAOpH,GACvBoH,EAAMgM,aAAapT,MAG3BjL,EAAM6Q,YAAYyN,cAAgB/N,EAAWpQ,QACzCmR,KAAM,WAAA,GACEe,GAAQ7R,KAAK2Q,QAAQkB,QACrBhM,EAASgM,EAAMgK,cAAckC,eACjC,OAAIlY,GACOA,OAGP7F,KAAKsd,KADW,UAAhBtd,KAAKkS,OACOL,EAAMgK,cAAcmC,cAEpBnM,EAAMgK,cAAcoC,gBAGxC3B,SAAU,SAAUzK,EAAOpH,GACvBoH,EAAMqM,UAAUzT,MAGxBjL,EAAM6Q,YAAY8N,sBAAwBzO,EAAQ/P,QAC9CC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKkS,OAASrS,EAAQ6D,OAE1BoN,KAAM,WACF,GAAIyE,GAAOvV,KAAM6R,EAAQ0D,EAAK5E,QAAQkB,OACtCA,GAAM8B,oBAAoB,WACtB4B,EAAK5E,QAAQyN,WAAW7I,EAAKrD,aAIzC1S,EAAM6Q,YAAYgO,YAAc3O,EAAQ/P,QACpC2e,YAAY,EACZxN,KAAM,WAAA,GAQEP,GAPAgO,EAAOve,KAAKH,QAAQ0e,IACxB,OAAmC,QAA/BA,EAAKzS,KAAK0S,MAAM,YAEZlN,OAAQ,QACRC,KAAM,oBAGVhB,EAAWvQ,KAAKH,QAAQ0Q,aAC5BA,GAASkO,SAASze,KAAKH,QAAQ0e,MAAMG,KAAK,WACtC,GAAIC,GAASpO,EAASqO,iBAClBD,IAAUA,EAAO9d,QACjB0P,EAAS6I,MAAMyF,WAAW,eAAiBF,OAAQA,UAKnEnf,EAAM6Q,YAAYyO,cAAgBpP,EAAQ/P,QACtCmR,KAAM,WACF,GAAIiO,GAAW/e,KAAKH,QAAQiM,KAAO9L,KAAKH,QAAQmf,SACjB,WAA3Bhf,KAAKH,QAAQmf,UACbhf,KAAKH,QAAQ0Q,SAAS0O,aAAcF,SAAUA,IACZ,SAA3B/e,KAAKH,QAAQmf,WACpBhf,KAAKH,QAAQ0Q,SAAS2O,UAAU9d,EAAEzB,OAAOK,KAAKH,QAAQsf,KAClD5O,SAAUvQ,KAAKH,QAAQ0Q,SACvBwO,SAAUA,QAKtB/O,EAAcN,EAAQ/P,QACtBC,KAAM,SAAUC,GACZ6P,EAAQ5P,GAAGF,KAAKG,KAAKC,KAAMH,GAC3BG,KAAKof,MAAQvf,EAAQiM,KACrB9L,KAAKkS,OAASrS,EAAQ6D,OAE1BsN,SAAU,WACNhR,KAAK0Q,OAAS1Q,KAAKsQ,UAAU+O,eAAerf,KAAKof,QAErDrO,SAAU,WACN/Q,KAAKsQ,UAAU+O,eAAerf,KAAKof,MAAOpf,KAAK0Q,QAC/C1Q,KAAKsQ,UAAU5P,QAAQ,UAAYiY,QAAQ,OAGnDnZ,EAAM6Q,YAAYiP,kBAAoBtP,EAAYrQ,QAC9CmR,KAAM,WACF9Q,KAAKgR,UACL,KACIhR,KAAKsQ,UAAUiP,WAAWvf,KAAKof,MAAOpf,KAAKkS,QAC3ClS,KAAKsQ,UAAU5P,QAAQ,UAAYiY,QAAQ,IAC7C,MAAO/O,GACL,OACIwH,MAAO,QACPnM,KAAM2E,EAAK,GACX0H,OAAQ,aAKxB9R,EAAM6Q,YAAYmP,kBAAoBxP,EAAYrQ,QAC9CmR,KAAM,WACF9Q,KAAKgR,WACLhR,KAAKsQ,UAAUmP,aAAazf,KAAKof,OACjCpf,KAAKsQ,UAAU5P,QAAQ,UAAYiY,QAAQ,SAGrDnZ,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,0BAA2B,cAAeD,IACnD,YACG,SAAUE,GAAV,GAIO4B,GACAse,EACAC,CALAngB,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVka,GAAeE,QAAS,6BACxBD,EAAangB,EAAMqgB,GAAGC,OAAOngB,QAC7BC,KAAM,SAAU2b,EAAS1b,GACrBL,EAAMqgB,GAAGC,OAAO/f,KAAKC,KAAMub,EAAS1b,GACpC0b,EAAUvb,KAAKub,QAAQpM,SAASwQ,EAAWD,WAAWE,SACtD5f,KAAK+f,aAAe,GAAIvgB,GAAM6Q,YAAY2P,aAAa5e,EAAE,UAAUiO,SAASkM,KAEhF0E,QAAS,WACDjgB,KAAK+f,cACL/f,KAAK+f,aAAaE,UAEtBjgB,KAAK+f,aAAe,QAG5BvgB,EAAM6Q,YAAYsP,WAAaA,EAC/Bve,EAAEzB,QAAO,EAAMggB,GAAcD,WAAYA,MAC3Cvc,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,4BAA6B,cAAeD,IACrD,YACG,SAAUE,EAAO2D,GA+qBd,QAAS+c,GAAY5W,GACjB,MAAa,KAANA,GAAmB,KAANA,GAAmB,KAANA,EAErC,QAAS6W,GAAa7W,GAClB,MAAa,KAANA,GAAmB,KAANA,GAAmB,KAANA,EAErC,QAAS8W,GAAgBC,EAAOC,GAC5B,MAAe,KAARA,EAAuB,KAATD,EAAuB,KAARC,EAAuB,KAATD,EAAuB,KAARC,GAAuB,KAATD,EAEnF,QAASE,GAAQ3a,EAAKqM,GAClB,MAAOrM,GAAI4a,OAASvO,EAAOuO,OAAS5a,EAAI6a,KAAOxO,EAAOwO,IAE1D,QAASC,GAAc5U,GACnB,MAAOtM,GAAM6Q,YAAY4D,KAAK0M,QAAQC,MAAM9U,EAAKvD,eAErD,QAASsY,GAAaC,EAAMC,GACxB,SAAKD,IAASC,KAGG,OAAbD,EAAKvP,MAA8B,OAAbwP,EAAKxP,KACpBuP,EAAKpP,IAAI4J,GAAGyF,EAAKrP,KAEjBoP,EAAKpd,QAAUqd,EAAKrd,OArsBtC,GAIOtC,GACA0e,EACAkB,EACAC,EACAvB,EAIAwB,EAUAC,EAQAC,EACApB,CA9BAxgB,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVsa,EAAStgB,EAAMqgB,GAAGC,OAClBkB,EAAK,qBACLC,EAAOzhB,EAAMyhB,KACbvB,GACAE,QAAS,8BACTyB,YAAa,8BAEbH,GACA,cACA,YACA,eACA,aACA,cACA,iBACA,iBACA,eAEAC,GACAG,GAAI,MACJC,GAAI,OACJC,GAAI,QACJC,GAAI,MACJC,GAAI,OACJC,GAAI,YAEJP,EAAwB,mBACxBpB,EAAeF,EAAOngB,QACtBC,KAAM,SAAU2b,EAAS1b,GACrBigB,EAAO/f,KAAKC,KAAMub,EAAS1b,GAC3B0b,EAAUvb,KAAKub,QACfA,EAAQpM,SAAS6Q,EAAaN,WAAWE,SAASgC,KAAK,mBAAmB,GAAMA,KAAK,cAAc,GAAOC,IAAI,cAAe,OACzH7hB,KAAKH,QAAQiiB,WACbvG,EAAQwG,GAAG,QAAS/hB,KAAKgiB,MAAMjQ,KAAK/R,OAExCA,KAAKiiB,oBACLjiB,KAAKkiB,iBACLliB,KAAKmiB,iBACLniB,KAAKoiB,eACLpiB,KAAKqiB,SACLriB,KAAKsiB,WACL/G,EAAQwG,GAAG,UAAW/hB,KAAKuiB,SAASxQ,KAAK/R,OAAO+hB,GAAG,QAAS/hB,KAAKwiB,OAAOzQ,KAAK/R,OAAO+hB,GAAG,OAAQ/hB,KAAKyiB,MAAM1Q,KAAK/R,OAAO+hB,GAAG,cAAe/hB,KAAK0iB,OAAO3Q,KAAK/R,OAAO+hB,GAAG,QAAS/hB,KAAK2iB,OAAO5Q,KAAK/R,OAAO+hB,GAAG,QAAS/hB,KAAK4iB,OAAO7Q,KAAK/R,QAErOH,SACIiM,KAAM,eACNgW,WAAW,EACXe,eAAgB,aAChBC,aAAc,GACdC,UAAW,GAEf7iB,QACI,QACA,SAEJgT,OAAQ,SAAUA,GACd,MAAezF,UAAXyF,EACgD,SAAzClT,KAAKub,QAAQqG,KAAK,oBAEzB1O,EACAlT,KAAKub,QAAQqG,KAAK,kBAAmB1O,GAErClT,KAAKub,QAAQyH,WAAW,uBAE5BhjB,MAAKub,QAAQ0H,YAAY,oBAAqB/P,KAElDgQ,OAAQ,WAiBJ,QAASC,GAAOC,EAAYxd,GACxB,KACK,QAASyd,GAAKC,GACX,GAAIA,IAASF,EACT,KAAMxd,EACH,IAAqB,GAAjB0d,EAAKC,SACZ,IAAK,GAAIphB,GAAImhB,EAAKE,WAAYrhB,EAAGA,EAAIA,EAAEshB,YACnCJ,EAAKlhB,OAEe,IAAjBmhB,EAAKC,WACZ3d,GAAO0d,EAAKI,UAAU7iB,SAE5B8iB,GACJ,MAAOlZ,GACL,MAAOA,IA/BX,GAOQ8D,GANRoV,EAAM3jB,KAAKub,QAAQ,GACnBqI,EAAMzgB,EAAO0gB,eACb9Y,EAAIoY,EAAOS,EAAIE,UAAWF,EAAIG,aAC9BC,EAAIb,EAAOS,EAAIK,WAAYL,EAAIM,aACnC,IAAS,MAALnZ,GAAkB,MAALiZ,EAMb,MALIjZ,GAAIiZ,IACAzV,EAAMxD,EACVA,EAAIiZ,EACJA,EAAIzV,IAGJiS,MAAOzV,EACP0V,IAAKuD,EACLG,UAAWpZ,GAAKiZ,IAqB5BI,OAAQ,SAAU5D,EAAOC,GAmBrB,QAAS4D,GAAOtZ,EAAGiZ,GACf,MAAOjZ,GAAEuZ,aAAeN,EAAEM,aAAevZ,EAAEwZ,WAAaP,EAAEO,WAAaxZ,EAAEyZ,gBAAkBR,EAAES,cAAgB1Z,EAAE0Z,cAAgBT,EAAES;CAErI,QAAStB,GAAOG,EAAM1d,GAClB,KACK,QAASyd,GAAKC,GAAd,GAEWoB,GAMKviB,CAPb,IAAqB,GAAjBmhB,EAAKC,SAAe,CAEpB,GADImB,EAAMpB,EAAKI,UAAU7iB,OACrB6jB,GAAO9e,EACP,KAAM0d,EAEV1d,IAAO8e,MACJ,IAAqB,GAAjBpB,EAAKC,SACZ,IAASphB,EAAImhB,EAAKE,WAAYrhB,EAAGA,EAAIA,EAAEshB,YACnCJ,EAAKlhB,IAGfmhB,GACJ,MAAOqB,GACL,OACIrB,KAAMqB,EACN/e,IAAKA,IAxCb,GASI+K,GAGAiT,EACAgB,EAZJC,EAAM7kB,KAAKub,QAAQ,EACvBiF,GAAQ2C,EAAO0B,EAAKrE,GAEhBC,EADO,MAAPA,EACM0C,EAAO0B,EAAKpE,GAEZD,EAENA,GAASC,IACL9P,EAAQxM,SAAS2gB,cACrBnU,EAAMoU,SAASvE,EAAM8C,KAAM9C,EAAM5a,KACjC+K,EAAMqU,OAAOvE,EAAI6C,KAAM7C,EAAI7a,KACvBge,EAAMzgB,EAAO0gB,eACbe,EAAehB,EAAIqB,WAAW,GAC9BZ,EAAO1T,EAAOiU,KACdhB,EAAIsB,kBACJtB,EAAIuB,SAASxU,MA6BzB8P,IAAK,WACDzgB,KAAKokB,OAAOpkB,KAAKa,WAErBukB,KAAM,WACFplB,KAAKokB,OAAO,IAEhB7U,OAAQ,WACJvP,KAAKokB,OAAO,EAAGpkB,KAAKa,WAExBA,OAAQ,WACJ,MAAOb,MAAK0D,QAAQ7C,QAExBshB,eAAgB,WAAA,GAERze,GACK7B,EAFLgE,IAEJ,KAAShE,IAAOrC,GAAM6Q,YAAY4D,KAAK0M,QAAQC,MACtCQ,EAAsB5X,KAAK3H,KAC5B6B,EAAQ7B,EAAIwjB,cACZxf,EAAO1F,MACHuD,MAAOA,EACPpC,KAAMoC,IAIlB1D,MAAKslB,cAAgB,GAAI9lB,GAAM8K,KAAKib,YAAajb,KAAMzE,KAE3Duc,aAAc,WACVpiB,KAAKwlB,KAAO,GAAIhmB,GAAMqgB,GAAG4F,WAAWrkB,EAAE,UAAU+N,SAAS6Q,EAAaN,WAAW2B,aAAaqE,YAAY1lB,KAAKub,UAC3GoK,UAAU,EACVC,YAAY,EACZC,OAAQ7lB,KAAK8lB,mBAAmB/T,KAAK/R,MACrC+lB,WAAY/lB,KAAKslB,cACjBU,eAAgB,QAChBC,SAAU,kBAEdjmB,KAAKwlB,KAAKjK,QAAQwG,GAAG,YAAa,SAAUmE,GACxCA,EAAE5N,oBAGVwN,mBAAoB,WAAA,GAKZK,GACAC,EACAC,EANAC,EAAWtmB,KAAKumB,eACfD,KAAYtmB,KAAKwmB,QAGlBL,EAAcG,EAASG,MACvBL,EAAapmB,KAAKwlB,KAAK9hB,QAAQ,GAC/B2iB,GACA7kB,SAAS,EACTilB,MAAON,EACP1F,IAAK0F,EAAY1F,KAEhB6F,EAASI,WAAyC,KAA5BJ,EAASI,UAAUhjB,QAC1C0iB,GAAc,KAElBpmB,KAAK2mB,WAAWN,EAAKD,GACrBpmB,KAAK4mB,MAAMvG,UAEfgC,OAAQ,WACJriB,KAAK4mB,MAAQ,GAAIpnB,GAAMqgB,GAAGgH,MAAM7mB,KAAKwlB,KAAKjK,SAAWuL,OAAQ9mB,KAAKub,WAEtEkH,MAAO,WACHziB,KAAK4mB,MAAMvG,QACX0G,aAAa/mB,KAAKgnB,UAClBhnB,KAAKU,QAAQ,SAEjBumB,WAAY,WACR,MAAO,KAAKzd,KAAKxJ,KAAK0D,UAE1B6e,SAAU,SAAU2D,GAChB,GAAIrkB,GAAMqkB,EAAEgB,OACR/F,GAAUtf,IACV7B,KAAK4mB,MAAMvG,QACXrgB,KAAKmnB,YAAa,GACXnnB,KAAKonB,MAAMvlB,KAClB7B,KAAKmnB,YAAa,EAClBjB,EAAE5N,kBAENtY,KAAKqnB,gBAAkBC,WAAWtnB,KAAKunB,iBAAiBxV,KAAK/R,QAEjEwiB,OAAQ,WAAA,GAEA9e,GADAkjB,EAAQ5mB,KAAK4mB,KAEb5mB,MAAKinB,eAAiBjnB,KAAKmnB,aAC3BzjB,IAAU1D,KAAKumB,qBAAuBE,WAAa/iB,MACnD1D,KAAKua,OAAO7W,GACPA,GAAU1D,KAAKslB,cAAckC,OAAO3mB,QAGrC+lB,EAAMA,EAAMa,UAAY,WAAa,UACrCznB,KAAKwlB,KAAKkC,cAHVd,EAAMvG,SAMdrgB,KAAKmnB,YAAa,EAClBnnB,KAAKunB,mBACLvnB,KAAKU,QAAQ,UAEjBgiB,OAAQ,WACJ1iB,KAAKunB,oBAET5E,OAAQ,WACJ2E,WAAWtnB,KAAK2nB,MAAM5V,KAAK/R,OAC3BA,KAAK4nB,cAAgBN,WAAWtnB,KAAKunB,iBAAiBxV,KAAK/R,OAC3DA,KAAKU,QAAQ,UAEjBkiB,OAAQ,SAAUiF,GAAV,GAEAjiB,GACAtE,EAMA8N,CARJyY,GAAGvP,iBACC1S,EAAM5F,KAAKkjB,SAGX5hB,EADA9B,EAAMyQ,QAAQC,QAAQC,KACfhN,EAAO2kB,cAAcC,QAAQ,QAE7BF,EAAGG,cAAcF,cAAcC,QAAQ,cAE9C3Y,EAAMpP,KAAK0D,QACf0L,EAAMA,EAAI6Y,OAAO,EAAGriB,EAAI4a,OAASlf,EAAO8N,EAAI6Y,OAAOriB,EAAI6a,KACvDzgB,KAAK0D,MAAM0L,GACXpP,KAAKokB,OAAOxe,EAAI4a,MAAQlf,EAAKT,QAC7Bb,KAAKgiB,SAEToF,MAAO,SAAUvlB,GAAV,GACC2jB,GAAOxlB,KAAKwlB,KACZoB,EAAQ5mB,KAAK4mB,KACjB,IAAIA,EAAMa,UAAW,CACjB,GAAI5lB,IAAQof,EAAKiH,KAKb,MAJA1C,GAAK2C,YACA3C,EAAKlW,SACNkW,EAAKkC,cAEF,CAEX,IAAI7lB,IAAQof,EAAKmH,GAKb,MAJA5C,GAAK6C,YACA7C,EAAKlW,SACNkW,EAAK8C,aAEF,CAEX,IAAIzmB,IAAQof,EAAKsH,MAGb,MAFA/C,GAAKjW,OAAOiW,EAAKlW,SACjBsX,EAAMvG,SACC,CAEX,IAAIxe,IAAQof,EAAKuH,IAGb,MAFAhD,GAAKjW,OAAOiW,EAAKlW,SACjBsX,EAAMvG,SACC,CAEX,IAAIxe,IAAQof,EAAKwH,OAEb,MADAjD,GAAKkC,cACE,CAEX,IAAI7lB,IAAQof,EAAKyH,SAEb,MADAlD,GAAK8C,aACE,EAGf,MAAOzmB,KAAQof,EAAKsH,OAAS1mB,IAAQof,EAAKuH,KAE9CjC,cAAe,WAAA,GAMPoC,GACAC,EACKzmB,EAPL0mB,EAAQ7oB,KAAKkjB,SACbxf,EAAQ1D,KAAK0D,OACjB,KAAKA,IAAUmlB,IAAUA,EAAM1E,UAC3B,MAAO,KAIX,KAFIwE,EAASnpB,EAAM6Q,YAAY4D,KAAK6U,SAASplB,EAAO1D,KAAKsU,MAAOtU,KAAK8U,OAE5D3S,EAAI,EAAGA,EAAIwmB,EAAO9nB,SAAUsB,EAEjC,GADAymB,EAAMD,EAAOxmB,GACToe,EAAQqI,EAAKC,IAAU,qBAAqBrf,KAAKof,EAAIrX,MACrD,OACIkV,MAAOmC,EACPlC,UAAWiC,EAAOxmB,EAAI,GAIlC,OAAO,OAEXwlB,MAAO,WACC3nB,KAAK+oB,eAAiB/oB,KAAKgpB,YAC3BhpB,KAAK+oB,cAAcrlB,MAAM1D,KAAK0D,UAGtCulB,eAAgB,WACZ,GAAIC,GAAiB1pB,EAAM2pB,kBAAkBnpB,KAAKub,QAAQ,GAAI2F,EAC9DgI,GAAeE,SAAW,WAC1BF,EAAeG,WAAa,SAC5BH,EAAeI,WAAa,MAC5BJ,EAAehM,UACfgM,EAAetM,WACf5c,KAAKupB,MAAQnoB,EAAE,oCAAsCygB,IAAIqH,GAAgBxD,YAAY1lB,KAAKub,UAE9F+G,SAAU,WACNtiB,KAAKwpB,aAAepoB,EAAE,oFAAoFskB,YAAY1lB,KAAKub,UAE/HkO,QAAS,SAAU/lB,GACf1D,KAAKwpB,aAAaloB,KAAKoC,IAE3BgmB,cAAe,SAAUC,GACrB3pB,KAAKwpB,aAAaI,OAAOD,IAE7BX,SAAU,WACN,MAAOhpB,MAAKub,QAAQ,KAAO/b,EAAMqqB,kBAErCtP,OAAQ,SAAU7W,IACTA,GAASA,EAAM7C,OAASb,KAAKH,QAAQkjB,YAG1C/iB,KAAKwmB,OAAQ,EACbxmB,KAAKwlB,KAAKjW,WACVvP,KAAKwmB,OAAQ,EACbxmB,KAAKslB,cAAc/K,QACfuP,MAAO9pB,KAAKwlB,KAAK3lB,QAAQmmB,eACzB+D,SAAU/pB,KAAKH,QAAQgjB,eACvBnf,MAAOA,MAGfsmB,KAAM,WACFhqB,KAAKkT,QAAO,GACZlT,KAAKub,QAAQyO,OACbhqB,KAAKwpB,aAAaQ,QAEtBL,KAAM,WACF3pB,KAAKkT,QAAO,GACZlT,KAAKub,QAAQoO,QAEjBrV,IAAK,WACD,GAAItU,KAAK4W,WACL,MAAO5W,MAAK4W,WAAWtC,KAG/BQ,IAAK,WACD,GAAI9U,KAAK4W,WACL,MAAO5W,MAAK4W,WAAW9B,KAG/BsU,SAAU,SAAUa,GACXA,IAGLjqB,KAAK2pB,OACL3pB,KAAKub,QAAQsG,KACT3E,IAAO+M,EAAU/M,IAAM,EAAI,KAC3BN,KAAQqN,EAAUrN,KAAO,EAAI,OAEjC5c,KAAKwpB,aAAa3H,KACd3E,IAAO+M,EAAU/M,IAAMld,KAAKwpB,aAAahnB,SAAW,GAAK,KACzDoa,KAAQqN,EAAUrN,SAG1BD,OAAQ,SAAUsN,GACTA,GAGLjqB,KAAKub,QAAQsG,KACTtf,MAAO0nB,EAAU1nB,MAAQ,EACzBC,OAAQynB,EAAUznB,OAAS,KAGnC0nB,aAAc,SAAUC,GAAV,GAGNC,GAFAvkB,EAAS7F,KAAKqqB,cAAcF,GAC5B1D,EAAQ5gB,GAAUA,EAAO4gB,KAE7B,IAAIA,EACA,IAAK2D,EAAM,EAAGA,EAAMpqB,KAAKkiB,cAAcrhB,OAAQupB,IAC3C,GAAIvJ,EAAa4F,EAAOzmB,KAAKkiB,cAAckI,IACvC,MAAO,KAInB,OAAOvkB,IAEXwkB,cAAe,SAAUF,GAwBrB,QAASG,GAAW1B,GAChB,MAAOA,GAAIpI,MAAQqI,EAAMrI,MAE7B,QAAS+J,GAAW3B,GAChB,GAAIA,EAAK,CACL,GAAI,6BAA6Bpf,KAAKof,EAAIrX,MACtC,OACI/P,SAAS,EACTilB,MAAOmC,EACPnI,IAAKmI,EAAInI,IAGjB,IAAI,yBAAyBjX,KAAKof,EAAIrX,MAClC,MAAIqX,GAAInI,KAAOoI,EAAMpI,IACV+J,EAAiB5B,EAAKD,EAAOxmB,EAAI,IAErCqoB,EAAiB7B,EAAOxmB,EAAI,GAAIymB,IAInD,QAAS4B,GAAiB5N,EAAME,GAC5B,GAAY,MAARF,EACA,MAAO,KAEX,IAAa,MAATE,EACA,MAAI,oBAAoBtT,KAAKoT,EAAKrL,OAAS2O,EAAYtD,EAAKlZ,QAEpD+iB,MAAO7J,EACP6D,IAAKoI,EAAMpI,KAGZ,IAEX,IAAIgK,GACA,GAAiB,MAAb7N,EAAKrL,MAAgB,gBAAgB/H,KAAKsT,EAAMvL,MAChD,OACIkV,MAAO7J,EACP6D,IAAKoI,EAAMpI,SAGhB,CACH,GAAiB,YAAb7D,EAAKrL,KACL,OACIkV,MAAO7J,EACP6D,IAAKoI,EAAMpI,IAGnB,IAAI,gBAAgBjX,KAAKoT,EAAKrL,OAAS,WAAW/H,KAAKoT,EAAKlZ,OACxD,OACI+iB,MAAO7J,EACP6D,IAAKoI,EAAMpI,IAGnB,IAAI,eAAejX,KAAKoT,EAAKrL,MACzB,OACIkV,MAAO7J,EACPpb,SAAS,EACTif,IAAK7D,EAAK6D,IAGlB,IAAI,eAAejX,KAAKsT,EAAMvL,MAC1B,OACIkV,MAAO3J,EACPtb,SAAS,EACTif,IAAK3D,EAAM2D,KAIvB,OAAO,EA5FA,GAIPgK,GACA5B,EACAF,EAAQC,EAMCzmB,CAXb,IAAInC,KAAK4mB,MAAMa,UACX,MAAO,KAKX,IAHIgD,EAAaN,EACbtB,EAAQ7oB,KAAKkjB,SAEb2F,GAAS7oB,KAAKinB,aAAc,CAC5B,GAAoB,IAAhB4B,EAAMrI,MACN,MAAO,KAGX,KADAmI,EAASnpB,EAAM6Q,YAAY4D,KAAK6U,SAAS9oB,KAAK0D,QAAS1D,KAAKsU,MAAOtU,KAAK8U,OAC/D3S,EAAI,EAAGA,EAAIwmB,EAAO9nB,SAAUsB,EAAG,CAEpC,GADAymB,EAAMD,EAAOxmB,GACToe,EAAQqI,EAAKC,GACb,MAAO0B,GAAW3B,EAEtB,IAAI0B,EAAW1B,GACX,MAAO4B,GAAiB7B,EAAOxmB,EAAI,GAAIymB,GAG/C,MAAO4B,GAAiB5B,EAAK,MAEjC,MAAO,OAwEX8B,WAAY,SAAU7Y,GAAV,GAGAH,GAFJlJ,EAAIxI,KAAKqqB,eACT7hB,KACIkJ,EAAMG,EAAM4G,YAAY9G,KAAKgZ,WAAWC,QAAQC,SAAS,EAAG,EAAG,GAC/DhZ,IAAU7R,KAAKqY,cACf3G,EAAMA,EAAIoZ,SAASjZ,EAAM/F,QAAQ,IAErC9L,KAAK2mB,WAAWne,EAAGkJ,EAAIqZ,MAAM,EAAG,MAGxCpE,WAAY,SAAUN,EAAK2E,GAAf,GAKJnC,GAJAnlB,EAAQ1D,KAAK0D,QACbklB,EAAMvC,EAAII,MACVwE,EAAOvnB,EAAMukB,OAAO5B,EAAI5F,IAC5B/c,GAAQA,EAAMukB,OAAO,EAAG5B,EAAI7kB,QAAUonB,EAAIpI,MAAQ6F,EAAI5F,KAAOuK,EACzDnC,EAAQnlB,EAAM7C,OAClB6C,GAASunB,EACTjrB,KAAKkS,OAAOxO,GACZ1D,KAAKokB,OAAOyE,GACZ7oB,KAAKgiB,QACLhiB,KAAKunB,oBAET2D,SAAU,SAAUnL,GAAV,GAG+BoL,GAFjC5V,EAAOvV,KACPorB,EAAY,QAAUpK,EACtBqK,EAAU9V,EAAKoS,MAAM5V,KAAKwD,EAC1B/V,GAAMyQ,QAAQC,QAAQC,OACtBib,EAAY,UAAYpK,EACxBmK,EAAY,WACR7D,WAAW+D,KAGnB9V,EAAKwT,cAAgBhJ,EACrBxK,EAAKgG,QAAQ+P,IAAIF,GAAWrJ,GAAGqJ,EAAWD,GAAaE,IAE3DrJ,MAAO,WAAA,GAECzf,GAAOC,EADP+Y,EAAUvb,KAAKub,OAEdvb,MAAKupB,OACNvpB,KAAKipB,iBAETjpB,KAAKupB,MAAMta,KAAKsM,EAAQtM,QACxB1M,EAAQvC,KAAKupB,MAAMhnB,QAAUvC,KAAKH,QAAQijB,aAC1CtgB,EAASxC,KAAKupB,MAAM/mB,SAChBD,EAAQgZ,EAAQhZ,SAChBgZ,EAAQhZ,MAAMA,GAEdC,EAAS+Y,EAAQ/Y,UACjB+Y,EAAQ/Y,OAAOA,GAEnBxC,KAAK2nB,SAETzV,OAAQ,SAAUxO,GACd1D,KAAKub,QAAQja,KAAKoC,IAEtBA,MAAO,SAAUA,GACb,GAAc+J,SAAV/J,EAAqB,CACrB,GAAI6nB,GAAMvrB,KAAKub,QAAQ,GAAGiQ,SAC1B,OAAOD,GAAI/pB,QAAQ,MAAO,IAE9BxB,KAAKkS,OAAOxO,GACZ1D,KAAKunB,oBAETkE,gBAAiB,WACb,MAAOzrB,MAAKiiB,iBAAiB3hB,SAEjCinB,iBAAkB,WAAA,GAQVpB,GAPAvgB,EAAM5F,KAAKkjB,SACXxf,EAAQ1D,KAAK0D,QACbgoB,EAAalsB,EAAM6Q,YAAYsb,KAAKjM,WAAWkM,OAC/CH,KACAI,EAAW,EACXC,KACAnD,IAEJ,KAAI/iB,GAAQA,EAAIue,UAAhB,CAGA,IAAK,KAAK3a,KAAK9F,GASX,OARI1D,KAAKkiB,cAAcrhB,QAAUb,KAAKiiB,iBAAiBphB,UACnDb,KAAKkiB,iBACLliB,KAAKiiB,oBACLjiB,KAAKub,QAAQja,KAAKoC,SAElB1D,KAAK4mB,OACL5mB,KAAK4mB,MAAMvG,QAIfsI,GAASnpB,EAAM6Q,YAAY4D,KAAK6U,SAASplB,EAAO1D,KAAKsU,MAAOtU,KAAK8U,OACjE6T,EAAO/W,QAAQ,SAAUgX,GAQrB,GAPAA,EAAImD,QAAS,EACbnD,EAAIoD,KAAO,YAAcpD,EAAIrX,MACb,OAAZqX,EAAIrX,OACJqX,EAAIqD,WAAaP,EAAWG,IAAaH,EAAW7qB,QACpD+nB,EAAIoD,IAAI7rB,KAAKyoB,EAAIqD,YACjBR,EAAgBtrB,KAAKyoB,IAErBhjB,GAAmB,QAAZgjB,EAAIrX,KACX,GAAI2O,EAAY0I,EAAIllB,OAChBooB,EAAOI,QAAQtD,OACZ,IAAIzI,EAAayI,EAAIllB,OAAQ,CAChC,GAAI4c,GAAOwL,EAAO7jB,OACdqY,GACIF,EAAgBwI,EAAIllB,MAAO4c,EAAK5c,QAC5B6c,EAAQqI,EAAKhjB,IAAQ2a,EAAQD,EAAM1a,MACnCgjB,EAAIoD,IAAI7rB,KAAK,wBACbmgB,EAAK0L,IAAI7rB,KAAK,0BAGlByoB,EAAIoD,IAAI7rB,KAAK,kBACbmgB,EAAK0L,IAAI7rB,KAAK,mBAGlByoB,EAAIoD,IAAI7rB,KAAK,kBAIrByF,GAAO2a,EAAQqI,EAAKhjB,KACpBgjB,EAAIoD,IAAI7rB,KAAK,qBACbyoB,EAAImD,QAAS,EACb5F,EAAcyC,GAEF,QAAZA,EAAIrX,MAAmBmP,EAAckI,EAAIllB,QAAYkC,GAAQ2a,EAAQqI,EAAKhjB,IAC1EgjB,EAAIoD,IAAI7rB,KAAK,oBAGrBwoB,EAAOwD,UAAUva,QAAQ,SAAUgX,GAAV,GACjBpI,GAAQoI,EAAIpI,MAAOC,EAAMmI,EAAInI,IAC7Bnf,EAAO9B,EAAM4sB,WAAW1oB,EAAM2oB,UAAU7L,EAAOC,GACnD/c,GAAQA,EAAMukB,OAAO,EAAGzH,GAAS,gBAAmBoI,EAAIoD,IAAIhqB,KAAK,KAAO,KAAQV,EAAO,UAAYoC,EAAMukB,OAAOxH,KAEpHzgB,KAAKub,QAAQtM,KAAKvL,GAElBkC,GACA5F,KAAKokB,OAAOxe,EAAI4a,MAAO5a,EAAI6a,KAE3B0F,GAAe,yBAAyB3c,KAAK2c,EAAY5U,OACzDvR,KAAKssB,iBAAiB3D,GAE1B3oB,KAAKiiB,iBAAmBwJ,IAE5Ba,iBAAkB,SAAU3D,GACxB,GAAIyB,GAAKxB,CAET,KADA5oB,KAAKkiB,iBACAkI,EAAM,EAAGA,EAAMzB,EAAO9nB,OAAQupB,IAC/BxB,EAAMD,EAAOyB,GACT,6BAA6B5gB,KAAKof,EAAIrX,OACtCvR,KAAKkiB,cAAc/hB,KAAKyoB,IAIpC3I,QAAS,WACLjgB,KAAK+oB,cAAgB,KACrB/oB,KAAKub,QAAQ+P,IAAItK,GACjB+F,aAAa/mB,KAAK4nB,eAClBb,aAAa/mB,KAAKqnB,iBAClBrnB,KAAKwpB,aAAe,KACpBxpB,KAAKupB,MAAQ,KACbvpB,KAAK4mB,MAAM3G,UACXjgB,KAAK4mB,MAAQ,KACb9G,EAAOhgB,GAAGmgB,QAAQlgB,KAAKC,OAE3BusB,cAAe,WAAA,GACPnd,GAAMpP,KAAK0D,QACXkC,EAAM5F,KAAKkjB,SACXsJ,EAAM5mB,EAAI6a,KAAOrR,EAAIvO,MACzBuO,GAAMA,EAAI6Y,OAAO,EAAGriB,EAAI4a,QAAUgM,EAAM,OAAS,KAAOpd,EAAI6Y,OAAOriB,EAAI6a,MACvEzgB,KAAK0D,MAAM0L,GACXpP,KAAKokB,OAAOxe,EAAI4a,MAAQ,MA4BhChhB,EAAM6Q,YAAY2P,aAAeA,EACjC5e,EAAEzB,QAAO,EAAMqgB,GAAgBN,WAAYA,MAC7ClgB,MAAO2D,SACO,kBAAV5D,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,6BAA8B,cAAeD,IACtD,YACG,SAAUE,GAAV,GAIO4B,GACA+f,EAiBAsL,EACAC,EAMAC,EAWAC,CAvCAptB,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACV2b,GACA3Z,EAAG,YACHG,EAAG,MACHklB,GAAI,QACJvL,GAAI,MACJC,GAAI,OACJuL,GAAI,KACJtL,GAAI,QACJ3a,GAAI,OACJ4a,GAAI,MACJC,GAAI,OACJC,GAAI,WACJoL,GAAI,SACJC,GAAI,WACJC,GAAI,SACJC,IAAK,SAELT,EAAMU,UAAUC,SAAS/H,cAAcgI,QAAQ,QAAU,EACzDX,EAAa,SAAUxF,GACvB,MAAIA,GAAU,IAAMA,EAAU,IAAMA,EAAU,IAAMA,EAAU,IAAMA,EAAU,IAAMA,EAAU,KAAOA,EAAU,KAAOA,EAAU,KAAOA,EAAU,KAAOA,EAAU,KAAmB,MAAZA,GAKzKyF,EAAU,SAAU5U,GAAV,GACNmP,GAAUnP,EAAMmP,QAChBpb,EAAOqV,EAAU+F,EAOrB,QANKpb,GAAQ4gB,EAAWxF,KACpBpb,EAAO,cAENA,GAAQiM,EAAMlW,KAA2B,GAApBkW,EAAMlW,IAAIhB,SAChCiL,EAAO,aAEJA,GAEP8gB,EAAgBptB,EAAM4D,MAAMzD,QAC5BC,KAAM,SAAUqS,EAAQqb,EAAUC,GAW9B,GAVAvtB,KAAKwtB,aACLxtB,KAAKiS,OAASA,EACdjS,KAAKytB,UAAYH,GAAYnqB,OAC7BnD,KAAK0tB,aAAe1tB,KAAK2tB,QAAQ5b,KAAK/R,MACtCA,KAAK4tB,WAAa5tB,KAAK6tB,MAAM9b,KAAK/R,MAClCA,KAAK8tB,UAAY,EACjB9tB,KAAK+tB,eAAiB,KACtB9b,EAAO8P,GAAG,UAAW/hB,KAAK0tB,cAC1Bzb,EAAO8P,GAAG,yEAA0E/hB,KAAK4tB,YACzFxsB,EAAE+C,SAAS6pB,iBAAiBjM,GAAG,oBAAqB/hB,KAAK4tB,YACrDL,EACA,IAAK,GAAI1rB,KAAO0rB,GACZvtB,KAAK+hB,GAAGlgB,EAAK0rB,EAAS1rB,KAIlC8rB,QAAS,SAAUzH,GACflmB,KAAKiuB,YAAY/H,EAAGyG,EAAQzG,EAAE8B,iBAElC6F,MAAO,SAAU3H,GAAV,GACCgI,GAMA3c,EAiBI4c,EACAC,EACAC,CAxBJnI,GAAEoI,MACFJ,EAAwB,GAAXhI,EAAEoI,MACRpI,EAAEqI,SACTL,EAAyB,GAAZhI,EAAEqI,QAEfhd,EAAO2U,EAAE3U,KACA,cAATA,IACI2c,EACA3c,EAAO,iBAEPvR,KAAK+tB,gBACDvlB,EAAG0d,EAAEsI,MACLC,EAAGvI,EAAEwI,QAIJ,YAATnd,IACK2c,IACDluB,KAAK+tB,eAAiB,OAGjB,cAATxc,GAAwBvR,KAAK+tB,iBACzBI,EAAKnuB,KAAK+tB,eAAevlB,EAAI0d,EAAEsI,MAC/BJ,EAAKpuB,KAAK+tB,eAAeU,EAAIvI,EAAEwI,MAC/BL,EAAWM,KAAKC,KAAKT,EAAKA,EAAKC,EAAKA,GACpCC,EAAWruB,KAAK8tB,YAChBvc,EAAO,cAGfvR,KAAKiuB,YAAY/H,EAAG3U,IAExB0c,YAAa,SAAU/H,EAAGpa,GAAb,GAaL+iB,GAIAxD,EAhBAyD,EAAW,EACf5I,GAAE6I,IAAMtC,EAAMvG,EAAE8I,QAAU9I,EAAE+I,UAAY/I,EAAEgJ,OACtChJ,EAAEgJ,SACFJ,GAAY,QAEZ5I,EAAEiJ,WACFL,GAAY,UAEZ5I,EAAE+I,UACFH,GAAY,SAEhBA,GAAYhjB,EACR+iB,EAAkB7uB,KAAKwtB,UAAU,KAAO1hB,GACxC+iB,GACAA,EAAgB9uB,KAAKC,KAAKytB,UAAWvH,EAAG4I,GAExCzD,EAAUrrB,KAAKwtB,UAAUsB,GACzBzD,GACAA,EAAQtrB,KAAKC,KAAKytB,UAAWvH,EAAG4I,IAGxC/M,GAAI,SAAUhK,EAAOtG,GACjB,GAAI8b,GAAWvtB,KAAKwtB,SACI,iBAAb/b,KACPA,EAAWzR,KAAKytB,UAAUhc,IAET,gBAAVsG,KACPA,EAAQA,EAAMhS,MAAM,MAExBgS,EAAMnG,QAAQ,SAAUsU,GACpBqH,EAASrH,GAAKzU,KAGtBwO,QAAS,WACLjgB,KAAKiS,OAAOqZ,IAAI,UAAWtrB,KAAK0tB,cAChC1tB,KAAKiS,OAAOqZ,IAAI,UAAWtrB,KAAK4tB,YAChCxsB,EAAE+C,SAAS6pB,iBAAiB1C,IAAI,oBAAqBtrB,KAAK4tB,eAGlEpuB,EAAM6Q,YAAYuc,cAAgBA,IACpCzpB,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,yBAA0B,cAAeD,IAClD,YACG,SAAUE,GAiBP,QAAS4vB,GAAK9L,GACV,GAAIA,EAAK1G,KAAKyS,QAAU/L,EAAK+L,MAAO,CAChC,GAAIC,GAAOhM,CACXA,GAAOA,EAAK1G,KACZ0S,EAAK1S,KAAO0G,EAAKxG,MACjBwG,EAAKxG,MAAQwS,EAEjB,MAAOhM,GAEX,QAASvd,GAAMud,GACX,GAAIA,EAAKxG,MAAMA,MAAMuS,QAAU/L,EAAK+L,MAAO,CACvC,GAAIC,GAAOhM,CACXA,GAAOA,EAAKxG,MACZwS,EAAKxS,MAAQwG,EAAK1G,KAClB0G,EAAK1G,KAAO0S,EACZhM,EAAK+L,OAAS,EAElB,MAAO/L,GAEX,QAASiM,GAAOjM,EAAM5f,GAClB,MAAI4f,KAASkM,EACF,GAAIC,GAAc,EAAG/rB,EAAO8rB,EAASA,IACrClM,EAAK5f,MAAMgsB,MAAQhsB,EAAMgsB,MAChCpM,EAAK1G,KAAO2S,EAAOjM,EAAK1G,KAAMlZ,GAE9B4f,EAAKxG,MAAQyS,EAAOjM,EAAKxG,MAAOpZ,GAE7BqC,EAAMqpB,EAAK9L,KAEtB,QAAS7T,GAAO6T,EAAM5f,GAAtB,GAIQisB,GAGQC,CANZ,IAAItM,IAASkM,EACT,MAAOlM,EAGX,IADIqM,EAAOrM,EAAK5f,MAAMgsB,MAAQhsB,EAAMgsB,MACvB,IAATC,EACA,GAAIrM,EAAK1G,OAAS4S,GAAWlM,EAAKxG,QAAU0S,EAAS,CAEjD,IADII,EAAOtM,EAAK1G,KACTgT,EAAK9S,QAAU0S,GAClBI,EAAOA,EAAK9S,KAEhBwG,GAAK5f,MAAQksB,EAAKlsB,MAClB4f,EAAK1G,KAAOnN,EAAO6T,EAAK1G,KAAM0G,EAAK5f,WAEnC4f,GADOA,EAAK1G,OAAS4S,EACdlM,EAAKxG,MAELwG,EAAK1G,SAET+S,GAAO,EACdrM,EAAK1G,KAAOnN,EAAO6T,EAAK1G,KAAMlZ,GAE9B4f,EAAKxG,MAAQrN,EAAO6T,EAAKxG,MAAOpZ,EAapC,QAXI4f,EAAK1G,KAAKyS,MAAQ/L,EAAK+L,MAAQ,GAAK/L,EAAKxG,MAAMuS,MAAQ/L,EAAK+L,MAAQ,KACpE/L,EAAK+L,OAAS,EACV/L,EAAKxG,MAAMuS,MAAQ/L,EAAK+L,QACxB/L,EAAKxG,MAAMuS,MAAQ/L,EAAK+L,OAE5B/L,EAAO8L,EAAK9L,GACZA,EAAKxG,MAAQsS,EAAK9L,EAAKxG,OACvBwG,EAAKxG,MAAMA,MAAQsS,EAAK9L,EAAKxG,MAAMA,OACnCwG,EAAOvd,EAAMud,GACbA,EAAKxG,MAAQ/W,EAAMud,EAAKxG,QAErBwG,EAyEX,QAASvb,GAAOub,EAAMzd,GACdyd,IAASkM,IAGbznB,EAAOub,EAAK1G,KAAM/W,GAClBA,EAAO1F,KAAKmjB,EAAK5f,OACjBqE,EAAOub,EAAKxG,MAAOjX,IAEvB,QAASgqB,GAAavM,EAAM3S,EAAOmf,GAC/B,GAAIxM,IAASkM,EAAb,CAGA,GAAI9rB,GAAQ4f,EAAK5f,KACbiN,GAAM+e,MAAQhsB,EAAMgsB,OACpBG,EAAavM,EAAK1G,KAAMjM,EAAOmf,GAE/BpsB,EAAMqsB,WAAWpf,IACjBmf,EAAO3vB,KAAKuD,GAEZiN,EAAM8P,IAAM/c,EAAM+c,KAClBoP,EAAavM,EAAKxG,MAAOnM,EAAOmf,IAGxC,QAASnsB,GAAIqsB,EAAMC,EAAMxe,GACjBwe,IAAST,IAGb7rB,EAAIqsB,EAAMC,EAAKrT,KAAMnL,GACrBue,EAAKT,OAAO9d,EAASwe,EAAKvsB,QAC1BC,EAAIqsB,EAAMC,EAAKnT,MAAOrL,IAtL7B,GAIOge,GAQAD,EAsEArV,EAaA+V,EAyFAC,EAoJAC,EAyBAC,CApWA7wB,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9Dqf,EAAgBjwB,EAAM4D,MAAMzD,QAC5BC,KAAM,SAAcyvB,EAAO3rB,EAAOkZ,EAAME,GACpC9c,KAAKqvB,MAAQA,EACbrvB,KAAK0D,MAAQA,EACb1D,KAAK4c,KAAOA,EACZ5c,KAAK8c,MAAQA,KAGjB0S,EAAU,GAAI,YACdxvB,KAAK4c,KAAO5c,KACZA,KAAK8c,MAAQ9c,KACbA,KAAKqvB,MAAQ,GAmEblV,EAAQ3a,EAAM4D,MAAMzD,QACpBC,KAAM,SAAoB8vB,EAAOjP,EAAK/c,GAClC1D,KAAK0vB,MAAQA,EACb1vB,KAAKygB,IAAMA,EACXzgB,KAAK0D,MAAQA,GAEjBqsB,WAAY,SAAUpf,GAClB,MAAOA,GAAM+e,OAAS1vB,KAAKygB,KAAO9P,EAAM8P,KAAOzgB,KAAK0vB,OAExD9E,MAAO,WACH,MAAO,IAAIzQ,GAAMna,KAAK0vB,MAAO1vB,KAAKygB,IAAKzgB,KAAK0D,UAGhDwsB,EAAY1wB,EAAM4D,MAAMzD,QACxBC,KAAM,WACFI,KAAKiwB,KAAOT,GAEhBD,OAAQ,SAAU7rB,GACd1D,KAAKiwB,KAAOV,EAAOvvB,KAAKiwB,KAAMvsB,IAElC+L,OAAQ,SAAU/L,GACd1D,KAAKiwB,KAAOxgB,EAAOzP,KAAKiwB,KAAMvsB,IAElC4sB,UAAW,SAAU5sB,GAEjB,IADA,GAAI4f,GAAOtjB,KAAKiwB,KACT3M,GAAQkM,GACX,GAAI9rB,EAAQ4f,EAAK5f,MAAMgsB,MACnBpM,EAAOA,EAAK1G,SACT,CAAA,KAAIlZ,EAAQ4f,EAAK5f,MAAM+c,KAG1B,MAAO6C,GAAK5f,KAFZ4f,GAAOA,EAAKxG,MAKpB,MAAO,OAEX/U,OAAQ,WACJ,GAAIlC,KAEJ,OADAkC,GAAO/H,KAAKiwB,KAAMpqB,GACXA,GAEXgqB,aAAc,SAAUH,EAAOjP,GAC3B,GAAIqP,KAEJ,OADAD,GAAa7vB,KAAKiwB,KAAM,GAAI9V,GAAMuV,EAAOjP,GAAMqP,GACxCA,GAEXnsB,IAAK,SAAU8N,GACX,GAAIue,GAAO,GAAIE,EAEf,OADAvsB,GAAIqsB,EAAMhwB,KAAKiwB,KAAMxe,GACdue,GAEXpF,MAAO,WACH,MAAO5qB,MAAK2D,IAAI,SAAUD,GACtB,MAAOA,GAAMknB,WAGrB2F,MAAO,WAEH,IADA,GAAIA,GAAQvwB,KAAKiwB,KACVM,EAAM3T,MAAQ4S,GACjBe,EAAQA,EAAM3T,IAElB,OAAO2T,IAEXC,KAAM,WAEF,IADA,GAAIA,GAAOxwB,KAAKiwB,KACTO,EAAK1T,OAAS0S,GACjBgB,EAAOA,EAAK1T,KAEhB,OAAO0T,MAkCXL,EAAY3wB,EAAM4D,MAAMzD,QACxBC,KAAM,SAAU8vB,EAAOjP,EAAK/c,GACZ+J,SAARgT,EACAzgB,KAAKgwB,KAAON,GAEZ1vB,KAAKgwB,KAAO,GAAIE,GAChBlwB,KAAKgwB,KAAKT,OAAO,GAAIpV,GAAMuV,EAAOjP,EAAK/c,MAG/CqE,OAAQ,WACJ,MAAO/H,MAAKgwB,KAAKjoB,UAErBpE,IAAK,SAAU8N,GACX,MAAO,IAAI0e,GAAUnwB,KAAKgwB,KAAKrsB,IAAI8N,KAEvCoe,aAAc,SAAUH,EAAOjP,GAC3B,MAAOzgB,MAAKgwB,KAAKH,aAAaH,EAAOjP,IAEzC8P,MAAO,WACH,MAAOvwB,MAAKgwB,KAAKO,QAAQ7sB,OAE7B8sB,KAAM,WACF,MAAOxwB,MAAKgwB,KAAKQ,OAAO9sB,OAE5B6rB,OAAQ,SAAUG,EAAOjP,EAAK/c,GAC1B,MAAO1D,MAAKgwB,KAAKT,OAAO,GAAIpV,GAAMuV,EAAOjP,EAAK/c,KAElDA,MAAO,SAAUgsB,EAAOjP,EAAK/c,GAAtB,GAOCosB,GAEIW,EAAwBC,EAenBvuB,EAAOtB,EACR8P,EACAggB,EACAC,EACAC,CA3BZ,IAAcpjB,SAAV/J,EAIA,MAHY+J,UAARgT,IACAA,EAAMiP,GAEH1vB,KAAK6vB,aAAaH,EAAOjP,GAAK,GAAG/c,KAG5C,IADIosB,EAAS9vB,KAAKgwB,KAAKH,aAAaH,EAAQ,EAAGjP,EAAM,GACjDqP,EAAOjvB,OAgBP,IAfI4vB,EAAaX,EAAO,GAAIY,EAAYZ,EAAOA,EAAOjvB,OAAS,GAC3D4vB,EAAWhQ,IAAMiP,IACbe,EAAW/sB,QAAUA,EACrBgsB,EAAQe,EAAWf,MAEnBI,EAAO7nB,SAGXyoB,EAAUhB,MAAQjP,IACdiQ,EAAUhtB,QAAUA,EACpB+c,EAAMiQ,EAAUjQ,IAEhBqP,EAAOtjB,OAGNrK,EAAI,EAAGtB,EAASivB,EAAOjvB,OAAQsB,EAAItB,EAAQsB,IAC5CwO,EAAQmf,EAAO3tB,GACfwuB,EAAahgB,EAAMjN,MACnBktB,EAAajgB,EAAM+e,MACnBmB,EAAWlgB,EAAM8P,IACrBzgB,KAAKgwB,KAAKvgB,OAAOkB,GACbigB,EAAalB,IACTiB,IAAejtB,EACf1D,KAAKuvB,OAAOqB,EAAYlB,EAAQ,EAAGiB,GAEnCjB,EAAQkB,GAGZC,EAAWpQ,IACPkQ,IAAejtB,EACf1D,KAAKuvB,OAAO9O,EAAM,EAAGoQ,EAAUF,GAE/BlQ,EAAMoQ,EAKtB7wB,MAAKuvB,OAAOG,EAAOjP,EAAK/c,IAE5BotB,eAAgB,SAAUpB,EAAOjP,GAAjB,GAIHte,GAHL2tB,EAAS9vB,KAAK6vB,aAAaH,EAAOjP,GAClC5a,KACAkrB,EAAa,CACjB,KAAS5uB,EAAIutB,EAAOvtB,GAAKse,EAAKte,IACtB2tB,EAAOiB,GAAYtQ,IAAMte,GACzB4uB,IAEJlrB,EAAO1F,MACHsK,MAAOtI,EAAIutB,EACXhsB,MAAOosB,EAAOiB,GAAYrtB,OAGlC,OAAOmC,IAEXmrB,cAAe,SAAUtB,EAAOjP,EAAKwQ,EAAeC,GAArC,GACPrrB,GAAS7F,KAAK8wB,eAAepB,EAAOjP,GACpC0Q,EAAW,SAAUpmB,EAAGiZ,GACxB,MAAIjZ,GAAErH,QAAUsgB,EAAEtgB,MACPqH,EAAEN,MAAQuZ,EAAEvZ,MAEhBwmB,EAAclmB,EAAErH,MAAOsgB,EAAEtgB,OAapC,OAXIwtB,KACAC,EAAW,SAAUpmB,EAAGiZ,GAAb,GACHxb,GAAI0oB,EAAQnmB,EAAEN,OACdgkB,EAAIyC,EAAQlN,EAAEvZ,MAClB,OAAIjC,GAAE9E,QAAU+qB,EAAE/qB,MACPutB,EAAclmB,EAAErH,MAAOsgB,EAAEtgB,OAE7BqH,EAAEN,MAAQuZ,EAAEvZ,QAG3B5E,EAAO9D,KAAKovB,GACLtrB,GAEX9D,KAAM,SAAU2tB,EAAOjP,EAAKyQ,GAAtB,GAIEnpB,GACK5F,EAAOuiB,CAJhB,IAA6C,IAAzC1kB,KAAK6vB,aAAaH,EAAOjP,GAAK5f,OAIlC,IADIkH,EAAS/H,KAAK8wB,eAAepB,EAAOjP,GAC/Bte,EAAI,EAAGuiB,EAAMwM,EAAQrwB,OAAQsB,EAAIuiB,EAAKviB,IAC3CnC,KAAK0D,MAAMvB,EAAIutB,EAAOvtB,EAAIutB,EAAO3nB,EAAOmpB,EAAQ/uB,GAAGsI,OAAO/G,QAGlE+V,KAAM,SAAU2X,EAAaC,EAAWC,GAAlC,GAGE7Q,GACKte,EAAOuiB,EACRkM,EAIAC,EARJ9oB,EAAS/H,KAAK6vB,aAAauB,EAAaC,GACxC3B,EAAQ4B,CAEZ,KAASnvB,EAAI,EAAGuiB,EAAM3c,EAAOlH,OAAQsB,EAAIuiB,EAAKviB,IACtCyuB,EAAa7oB,EAAO5F,GAAGutB,MACvBkB,EAAaQ,IACbR,EAAaQ,GAEbP,EAAW9oB,EAAO5F,GAAGse,IACrBoQ,EAAWQ,IACXR,EAAWQ,GAEf5Q,EAAMiP,GAASmB,EAAWD,GAC1B5wB,KAAK0D,MAAMgsB,EAAOjP,EAAK1Y,EAAO5F,GAAGuB,OACjCgsB,IAAUjP,GAGlB8Q,SAAU,SAAU7B,EAAOjP,GACvB,MAAO,IAAI2P,GAASV,EAAOjP,EAAKzgB,KAAK6vB,aAAaH,EAAOjP,KAE7DzP,SAAU,WACN,MAAOhR,MAAKgwB,KAAKpF,SAErB7Z,SAAU,SAAUE,GAChBjR,KAAKgwB,KAAO/e,EAAM2Z,WAGtBwF,EAAW5wB,EAAM4D,MAAMzD,QACvBC,KAAM,SAAU8vB,EAAOjP,EAAKqP,GACxB9vB,KAAK0vB,MAAQA,EACb1vB,KAAKygB,IAAMA,EACXzgB,KAAKyK,MAAQ,EACbzK,KAAK8vB,OAASA,GAElB0B,OAAQ,WACJ,MAAOxxB,MAAK8vB,OAAOnsB,IAAI,SAAUgN,GAC7B,MAAOA,GAAMjN,SAGrB+tB,GAAI,SAAUhnB,GACV,KAAOzK,KAAK8vB,OAAO9vB,KAAKyK,QAAUzK,KAAK8vB,OAAO9vB,KAAKyK,OAAOgW,IAAMhW,GAC5DzK,KAAKyK,OAET,OAAOzK,MAAK8vB,OAAO9vB,KAAKyK,QAAUzK,KAAK8vB,OAAO9vB,KAAKyK,OAAO/G,OAE9DkO,QAAS,SAAUH,GACf,IAAK,GAAItP,GAAInC,KAAK0vB,MAAOvtB,GAAKnC,KAAKygB,IAAKte,IACpCsP,EAASzR,KAAKyxB,GAAGtvB,GAAIA,EAEzBnC,MAAKyK,MAAQ,KAGjB4lB,EAAkBF,EAAUxwB,QAC5BC,KAAM,SAAU8vB,EAAOjP,EAAK/c,GACxB1D,KAAKgwB,KAAO,GAAIE,GAChBlwB,KAAK2Q,MAAQ,GAAIwJ,GAAMuV,EAAOjP,EAAK/c,IAEvCmsB,aAAc,SAAUH,EAAOjP,GAAjB,GAGN9P,GAIKxO,EAAOuiB,EANZoL,EAAS9vB,KAAKgwB,KAAKH,aAAaH,EAAOjP,GACvC5a,IAEJ,KAAKiqB,EAAOjvB,OACR,OAAQb,KAAK2Q,MAEjB,KAASxO,EAAI,EAAGuiB,EAAMoL,EAAOjvB,OAAQsB,EAAIuiB,EAAKviB,IAC1CwO,EAAQmf,EAAO3tB,GACXwO,EAAM+e,MAAQA,GACd7pB,EAAO1F,KAAK,GAAIga,GAAMuV,EAAO/e,EAAM+e,MAAQ,EAAG1vB,KAAK2Q,MAAMjN,QAE7DmC,EAAO1F,KAAKwQ,GACZ+e,EAAQ/e,EAAM8P,IAAM,CAKxB,OAHI9P,GAAM8P,IAAMA,GACZ5a,EAAO1F,KAAK,GAAIga,GAAMxJ,EAAM8P,IAAM,EAAGA,EAAKzgB,KAAK2Q,MAAMjN,QAElDmC,GAEX0pB,OAAQ,SAAUG,EAAOjP,EAAK/c,GACtBA,IAAU1D,KAAK2Q,MAAMjN,OACrB1D,KAAKgwB,KAAKT,OAAO,GAAIpV,GAAMuV,EAAOjP,EAAK/c,KAG/CguB,eAAgB,WACZ,GAAIpO,GAAOtjB,KAAKgwB,KAAKC,IACrB,IAAI3M,IAASkM,EACT,MAAOxvB,MAAK2Q,MAAM+e,KAEtB,MAAOpM,EAAKxG,QAAU0S,GAClBlM,EAAOA,EAAKxG,KAEhB,OAAOwG,GAAK5f,MAAM+c,IAAM,KAGhCjhB,EAAM6Q,YAAY6f,UAAYA,EAC9B1wB,EAAM6Q,YAAY8f,UAAYA,EAC9B3wB,EAAM6Q,YAAYggB,gBAAkBA,EACpC7wB,EAAM6Q,YAAYshB,WAAaxX,IACjC3a,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,2BAA4B,cAAeD,IACpD,YACG,SAAUE,GAqDP,QAASoyB,GAAc5c,GACnB,MAAOA,GAAOxT,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KAAKA,QAAQ,KAAM,SA+StE,QAASqwB,GAAkBrpB,GAGvB,MAFAA,GAAIA,EAAEoiB,QACNpiB,EAAE9E,MAAQ8E,EAAE9E,MAAMouB,YACXtpB,EAEX,QAASupB,KACL,GAAI/B,GAAOhwB,KAAK2D,IAAIkuB,EAEpB,OADA7B,GAAKpF,MAAQmH,EACN/B,EA7Wd,GAIOgC,GAwBAC,EAQAC,CAnCA1yB,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9D4hB,EAAWxyB,EAAM4D,MAAMzD,QACvBC,KAAM,SAAU4lB,GACZxlB,KAAKwlB,KAAOA,GAEhBvhB,IAAK,SAAUwG,GACX,MAAOzK,MAAKqK,MAAMrK,KAAKwlB,KAAK9hB,MAAM+G,EAAOA,KAE7C0nB,IAAK,SAAUzC,EAAOjP,EAAK/c,GACT+J,SAAV/J,IACAA,EAAQ+c,EACRA,EAAMiP,GAEV1vB,KAAKwlB,KAAK9hB,MAAMgsB,EAAOjP,EAAK/c,IAEhC2G,MAAO,SAAU3G,GACb,MAAOA,IAEX+V,KAAM,SAAUiW,EAAOjP,EAAK2R,GACxBpyB,KAAKwlB,KAAK/L,KAAKiW,EAAOjP,EAAK2R,IAE/Bb,SAAU,SAAU7B,EAAOjP,GACvB,MAAOzgB,MAAKwlB,KAAK+L,SAAS7B,EAAOjP,MAGrCwR,EAAeD,EAASryB,QACxBwyB,IAAK,SAAUzC,EAAOjP,EAAK/c,GACvB1D,KAAKwlB,KAAK9hB,MAAMgsB,EAAOjP,EAAK4R,KAAKC,UAAU5uB,KAE/C2G,MAAO,SAAU3G,GACb,MAAO2uB,MAAKhoB,MAAM3G,MAGtBwuB,EAAgBF,EAASryB,QACzBC,KAAM,SAAUmI,EAAQwqB,GACpBP,EAAShf,UAAUpT,KAAKG,KAAKC,KAAM+H,GACnC/H,KAAKuyB,QAAUA,GAEnBJ,IAAK,SAAUzC,EAAOjP,EAAK/c,GACnBA,YAAiBoG,OACjBpG,EAAQlE,EAAM6Q,YAAYmiB,aAAa9uB,GAClC1D,KAAKuyB,QAAQ7uB,MAAMgsB,EAAOjP,IAC3BzgB,KAAKuyB,QAAQ7uB,MAAMgsB,EAAOjP,EAAKmR,EAAcpyB,EAAMizB,UAAUC,SAASC,SAAShqB,KAE5D,gBAATjF,KACdA,EAAQlE,EAAM6Q,YAAY4D,KAAK0M,QAAQiS,eAAelvB,IAE1D1D,KAAKwlB,KAAK9hB,MAAMgsB,EAAOjP,EAAK/c,MAMpClE,EAAM6Q,YAAYwiB,YAAcrzB,EAAM4D,MAAMzD,QACxCmzB,QAEQriB,SAAUuhB,EACVlmB,KAAM,SACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUyhB,EACVpmB,KAAM,QACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,EACdC,QAAS,WAGTxiB,SAAUuhB,EACVlmB,KAAM,UACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,aACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUwhB,EACVnmB,KAAM,WACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUwhB,EACVnmB,KAAM,WACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,QACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,aACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,YACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,WACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,SACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,OACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,YACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,SACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,gBACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,OACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,aACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,SACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,OACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGdviB,SAAUuhB,EACVlmB,KAAM,SACNpI,MAAO,KACPqvB,UAAU,EACVC,cAAc,IAGtBpzB,KAAM,SAAUszB,EAAUC,EAAaC,GACnCA,EAAgBA,KAChB,IAAIC,GAAYH,EAAWC,EAAc,CACzCnzB,MAAKkzB,SAAWA,EAChBlzB,KAAKmzB,YAAcA,EACnBnzB,KAAKqzB,UAAYA,EACjBrzB,KAAKszB,cACLtzB,KAAKuzB,SACLvzB,KAAK8yB,MAAMlhB,QAAQ,SAAU4hB,GAAV,GAOXC,GANA3nB,EAAO0nB,EAAK1nB,KACZpI,EAAQ0vB,EAActnB,EACZ2B,UAAV/J,IACAA,EAAQ8vB,EAAK9vB,OAEjB1D,KAAKuzB,MAAMznB,GAAQ,GAAItM,GAAM6Q,YAAYggB,gBAAgB,EAAGgD,EAAW3vB,GACnE+vB,EAAOzzB,KAAKszB,WAAWxnB,GAAQ,GAAI0nB,GAAK/iB,SAASzQ,KAAKuzB,MAAMznB,GAAO9L,KAAKuzB,MAAMC,EAAKP,UACvFQ,EAAKD,KAAOA,GACbxzB,MACHA,KAAKuzB,MAAMG,QAAQ1D,KAAKpF,MAAQmH,EAChC/xB,KAAKuzB,MAAMnV,WAAW4R,KAAKpF,MAAQmH,GAEvC/gB,SAAU,WACN,GAAIC,KAIJ,OAHAjR,MAAK8yB,MAAMlhB,QAAQ,SAAU4hB,GACzBviB,EAAMuiB,EAAK1nB,MAAQ9L,KAAKuzB,MAAMC,EAAK1nB,MAAMkF,YAC1ChR,MACIiR,GAEXF,SAAU,SAAUE,GAChBjR,KAAK8yB,MAAMlhB,QAAQ,SAAU4hB,GACzBxzB,KAAKuzB,MAAMC,EAAK1nB,MAAMiF,SAASE,EAAMuiB,EAAK1nB,QAC3C9L,OAEPiE,IAAK,SAAU6H,EAAMrB,GACjB,GAAcgD,SAAVhD,EACA,MAAOzK,MAAKuzB,MAAMznB,EAEtB,QAAQA,GACR,IAAK,cACDrB,GAASzK,KAAKkzB,QAClB,KAAK,aACDpnB,EAAO,UACP,MACJ,KAAK,eACDrB,GACJ,KAAK,YACDqB,EAAO,WAGX,MAAOrB,GAAQzK,KAAKqzB,UAAY,KAAOrzB,KAAKszB,WAAWxnB,GAAM7H,IAAIwG,IAErE0nB,IAAK,SAAUrmB,EAAM4jB,EAAOjP,EAAK/c,GAC7B,OAAQoI,GACR,IAAK,cACD4jB,GAAS1vB,KAAKkzB,SACdzS,GAAOzgB,KAAKkzB,QAChB,KAAK,aACDpnB,EAAO,UACP,MACJ,KAAK,eACD4jB,IACAjP,GACJ,KAAK,YACD3U,EAAO,WAGP4jB,GAASjP,GAAOA,GAAOzgB,KAAKqzB,WAC5BrzB,KAAKszB,WAAWxnB,GAAMqmB,IAAIzC,EAAOjP,EAAK/c,IAG9CiwB,SAAU,SAAUlpB,EAAO/G,GAAjB,GACGkwB,GACDJ,CADR,KAASI,EAAK,EAAGA,EAAK5zB,KAAK8yB,MAAMjyB,OAAQ+yB,IACjCJ,EAAOxzB,KAAK8yB,MAAMc,GAClBJ,EAAKR,cACoBvlB,SAArB/J,EAAM8vB,EAAK1nB,OACX9L,KAAKmyB,IAAIqB,EAAK1nB,KAAMrB,EAAOA,EAAO/G,EAAM8vB,EAAK1nB,OAAO,IAK5D,aACA,cACA,YACA,gBACF8F,QAAQ,SAAUoS,GACCvW,SAAb/J,EAAMsgB,IACNhkB,KAAKmyB,IAAInO,EAAGvZ,EAAOA,EAAO/G,EAAMsgB,KAErChkB,OAEPyZ,KAAM,SAAU2X,EAAaC,EAAWC,GACpCtxB,KAAK8yB,MAAMlhB,QAAQ,SAAU4hB,GACzBxzB,KAAKszB,WAAWE,EAAK1nB,MAAM2N,KAAK2X,EAAaC,EAAWC,IACzDtxB,OAEPuxB,SAAU,SAAUzlB,EAAM4jB,EAAOjP,GAAvB,GACFgT,GAAOzzB,KAAKszB,WAAWxnB,GACvB+nB,EAAOJ,EAAKlC,SAAS7B,EAAOjP,GAAMgR,EAAKoC,EAAKpC,GAC5C4B,EAAYrzB,KAAKqzB,SAMrB,OALAQ,GAAKpC,GAAK,SAAUhnB,GAChB,MAAOA,GAAQ4oB,EAAY,KAAOI,EAAKppB,MAAMonB,EAAG1xB,KAAK8zB,EAAMppB,KAE/DopB,EAAK/nB,KAAOA,EACZ+nB,EAAKnwB,MAAQ+vB,EAAKD,KAAK9vB,MAChBmwB,GAEXd,SAAU,WACN,MAAO/yB,MAAK8yB,MAAMvY,OAAO,SAAUiZ,GAC/B,MAAOA,GAAKT,WACbpvB,IAAI,SAAU6vB,GACb,MAAOxzB,MAAKuzB,MAAMC,EAAK1nB,OACxB9L,OAEP8zB,UAAW,SAAUpE,EAAOjP,GACxB,MAAOzgB,MAAK8yB,MAAMiB,OAAO,SAAUC,EAAKR,GAIpC,MAHIA,GAAKR,cACLgB,EAAI7zB,KAAKH,KAAKuxB,SAASiC,EAAK1nB,KAAM4jB,EAAOjP,IAEtCuT,GACTjiB,KAAK/R,WAEX4R,QAAS,SAAU8d,EAAOjP,EAAKhP,GAM3B,QAASwiB,GAAUnoB,EAAMylB,EAAU9mB,GAC/B,GAAI2E,GAAMmiB,EAASE,GAAGhnB,EAClB2E,KAAQmiB,EAAS7tB,QACjBqE,EAAO+D,GAAQsD,GATlB,GAKDrH,GAAQ0C,EASCtI,EACDovB,EACA7tB,EAfRowB,EAAY9zB,KAAK8zB,UAAUpE,EAAOjP,GAClCyT,EAAWl0B,KAAKuxB,SAAS,WAAY7B,EAAOjP,EAAM,GAClD0T,EAAcn0B,KAAKuxB,SAAS,WAAY7B,EAAOjP,GAC/C2T,EAAep0B,KAAKuxB,SAAS,WAAY7B,EAAQ1vB,KAAKkzB,SAAUzS,EAAMzgB,KAAKkzB,SAQ/E,KAAKzoB,EAAQilB,EAAOjlB,GAASgW,EAAKhW,IAAS,CAEvC,IADA1C,KACS5F,EAAI,EAAGA,EAAI2xB,EAAUjzB,OAAQsB,IAC9BovB,EAAWuC,EAAU3xB,GACrBuB,EAAQ6tB,EAASE,GAAGhnB,GACpB/G,IAAU6tB,EAAS7tB,QACnBqE,EAAOwpB,EAASzlB,MAAQpI,EAGhCuwB,GAAU,aAAcE,EAAa1pB,GACrCwpB,EAAU,cAAeG,EAAc3pB,EAAQzK,KAAKkzB,UACpDe,EAAU,YAAaC,EAAUzpB,IAC5BA,EAAQ,GAAKzK,KAAKkzB,UACnBe,EAAU,eAAgBC,EAAUzpB,EAAQ,GAEhDgH,EAAS1J,KAGjBssB,gBAAiB,SAAU5iB,GACvB,IAAK,GAAI3F,KAAQ9L,MAAKszB,WAClB7hB,EAASzR,KAAKszB,WAAWxnB,OAcrCtM,EAAM6Q,YAAYikB,eAAiB90B,EAAM6Q,YAAYwiB,YAAY7f,UAAU8f,MAAMiB,OAAO,SAAUhpB,EAAGyoB,GAIjG,MAHIA,GAAKR,cACLjoB,EAAE5K,KAAKqzB,EAAK1nB,MAETf,IAEP,YACA,cACA,eACA,iBAEN5H,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,0BAA2B,cAAeD,IACnD,WACE,YAMA,SAASi1B,GAAWC,GAChB,GAAIC,GAAS9F,KAAK+F,MAAMF,EAAW,IAAM,CACzC,QAAQC,GAAU,EAAIF,EAAWE,GAAU,IAAMlzB,OAAOiN,aAAa,GAAKgmB,EAAW,IAEzF,QAASG,GAAa9iB,GAClB,MAAI,sBAAsBrI,KAAKqI,GACpBA,EAEJ,IAAOA,EAAMrQ,QAAQ,QAAS,OAAU,IAEnD,QAASozB,GAAW/iB,EAAOyC,EAAKQ,EAAK+f,GACjC,GAAIC,GAAK,EAeT,SAdExgB,EACGygB,SAASzgB,GAEI,MAAPugB,GAAuB,EAANA,IACxBvgB,EAAM,IAAMA,GAFZA,EAAM,GAILygB,SAASjgB,IAGVggB,EAAKP,EAAWzf,GACL,MAAP+f,GAAuB,EAANA,IACjBC,EAAK,IAAMA,IAJfhgB,EAAM,GAONjD,EACO8iB,EAAa9iB,GAAS,IAAMijB,EAAKxgB,EAEjCwgB,EAAKxgB,EApCtB,GAKMjE,GACAjN,EAiCA4xB,EA6IAC,EAYAC,EAgBAC,EAwIAC,EA6RAC,CAnnBA71B,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DC,EAAc7Q,MAAM6Q,YACpBjN,EAAQ5D,MAAM4D,MAiCd4xB,EAAM5xB,EAAMzD,QACZ4R,KAAM,MACNM,MAAO,GACP+Y,MAAO,WACH,MAAO5qB,OAEXs1B,SAAU,WACN,MAAOt1B,MAAKu1B,WAEhB5K,SAAU,WACN,MAAO3qB,OAEX8qB,SAAU,SAAUjZ,EAAOyjB,GAKvB,MAJAt1B,MAAK6R,MAAQA,EACG,MAAZyjB,IACAt1B,KAAKu1B,UAAYD,GAEdt1B,MAEXw1B,SAAU,WACN,MAAOx1B,OAEX6qB,SAAU,WACN,MAAO7qB,OAEXy1B,OAAQ,WACJ,MAAOz1B,OAEX01B,SAAU,WACN,MAAO11B,MAAK6qB,SAAS,EAAG,EAAG,EAAG,GAAGE,MAAM,EAAG,IAE9CnZ,QAAS,SAAUH,EAAU/H,GACzB+H,EAAS1R,KAAK2J,EAAK1J,OAEvB2D,IAAK,SAAU8N,EAAU/H,GACrB,MAAO+H,GAAS1R,KAAK2J,EAAK1J,OAE9B+vB,WAAY,SAAUre,GAClB,MAAO1R,MAAK21B,UAAUjkB,KAASujB,GAEnCW,OAAQ,WACJ,OAAO,GAEXC,MAAO,WACH,MAAO71B,OAEX81B,SAAU,WACN,MAAO91B,OAEXuwB,MAAO,WACH,MAAOvwB,OAEX0wB,UAAW,WACP,MAAO1wB,OAEXqD,KAAM,WACF,MAAO,IAEX0yB,QAAS,WACL,MAAO/1B,OAEXg2B,eAAgB,WACZ,MAAO,IAEXC,mBAAoB,WAChB,MAAO,IAEX3a,GAAI,SAAU4a,GAAV,GAqBQC,GACAC,EAIKj0B,EAAOuiB,EAzBhB2R,EAAKr2B,KACLs2B,EAAKJ,CACT,IAAIG,IAAOpB,GAAQqB,IAAOrB,EACtB,MAAOoB,KAAOC,CAMlB,KAJIA,YAAcnB,IAAWmB,YAAclB,MAAciB,YAAclB,OACnEkB,EAAKH,EACLI,EAAKt2B,MAELq2B,YAAclB,GAEd,MADAmB,GAAKA,EAAG3L,WACD2L,YAAcnB,IAAWkB,EAAG/hB,KAAOgiB,EAAGhiB,KAAO+hB,EAAGvhB,KAAOwhB,EAAGxhB,KAAOuhB,EAAGxkB,OAASykB,EAAGzkB,KACpF,IAAIwkB,YAAcjB,GAAU,CAC/B,GAAIkB,YAAclB,GACd,MAAOkB,GAAGjiB,QAAQiH,GAAG+a,EAAGhiB,UAAYiiB,EAAGC,YAAYjb,GAAG+a,EAAGE,YAE7D,IAAID,YAAcjB,GACd,MAAOiB,GAAGE,UAAYH,EAAG/a,GAAGgb,EAAGG,KAAK,QAErC,IAAIJ,YAAchB,IAAYiB,YAAcjB,GAAU,CAGzD,GAFIc,EAAQE,EAAGI,KACXL,EAAQE,EAAGG,KACXN,EAAMt1B,QAAUu1B,EAAMv1B,OACtB,OAAO,CAEX,KAASsB,EAAI,EAAGuiB,EAAMyR,EAAMt1B,OAAQsB,EAAIuiB,EAAKviB,IACzC,IAAKg0B,EAAMh0B,GAAGmZ,GAAG8a,EAAMj0B,IACnB,OAAO,CAGf,QAAO,EAEX,MAAOk0B,KAAOC,GAElBI,OAAQ,SAAUhlB,GACd,MAAO,IAAI2jB,IACPr1B,KACA0R,KAGRilB,UAAW,SAAUlsB,EAAOiH,GACxB,MAAOA,IAEXklB,mBAAoB,SAAUnlB,GAC1BzR,KAAK62B,iBAAiB,MAAOplB,IAEjCqlB,gBAAiB,SAAUrlB,GACvBzR,KAAK62B,iBAAiB,MAAOplB,IAEjColB,iBAAkB,SAAUnb,EAAMjK,GAAhB,GACVslB,MACAC,EAAkB,QAATtb,EAAiB,aAAe,eAC7C1b,MAAKg3B,GAAQ,SAAUtlB,GACnB,GAAIjH,GAAQiH,EAAI6e,QAAQ7U,EACpBqb,GAAO1J,QAAQ5iB,SACfssB,EAAO52B,KAAKsK,KAGpBssB,EAAOh1B,KAAK,SAAUgJ,EAAGiZ,GACrB,MAAOjZ,GAAIiZ,EAAI,EAAIjZ,EAAIiZ,KAAS,IACjCpS,QAAQH,IAEfwlB,MAAO,WACH,OAAO,GAEXC,YAAa,SAAUC,EAAcC,GACjC,GAAIp3B,KAAK6R,OAAS7R,KAAK6R,MAAMtJ,eAAiB4uB,EAAa5uB,cAEvD,MADAvI,MAAK6R,MAAQulB,GACN,KAInBpC,EAAIqC,QAAUzC,EACVK,EAAO,IAAKD,EAAIr1B,QAChBC,KAAM,aAENmrB,MAAO,WACH,MAAO,UAEXzP,GAAI,SAAU5J,GACV,MAAOA,KAAQ1R,MAEnB4R,QAAS,gBAGTsjB,EAAUF,EAAIr1B,QACd+R,IAAK,OACL9R,KAAM,SAAiBkM,GACnB9L,KAAK8L,KAAOA,GAEhB8e,MAAO,WACH,MAAO,IAAIsK,GAAQl1B,KAAK8L,MAAMgf,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE5DvK,MAAO,WACH,GAAIiJ,GAAMW,EAAa30B,KAAK8L,KAI5B,OAHI9L,MAAKs1B,aACLtB,EAAMW,EAAa30B,KAAK6R,OAAS,IAAMmiB,GAEpCA,KAGXmB,EAAUH,EAAIr1B,QACd+R,IAAK,OACL9R,KAAM,SAAiB0U,EAAKQ,EAAK+f,GAC7B70B,KAAKsU,IAAMA,EACXtU,KAAK8U,IAAMA,EACX9U,KAAK60B,IAAMA,GAAO,GAEtBjK,MAAO,WACH,MAAO,IAAIuK,GAAQn1B,KAAKsU,IAAKtU,KAAK8U,IAAK9U,KAAK60B,KAAK/J,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE/EK,UAAW,SAAUjkB,GACjB,MAAIA,aAAeyjB,GACXn1B,KAAKsb,GAAG5J,GACD1R,KAEAi1B,EAGRvjB,EAAIikB,UAAU31B,OAEzB+qB,MAAO,SAAUuM,EAAMC,EAAMxI,GAAtB,GACiDyI,GAE5C3lB,EAFJiD,EAAM9U,KAAK8U,IAAKR,EAAMtU,KAAKsU,IAAKugB,EAAM70B,KAAK60B,GAC/C,OAAY,OAARyC,GAAgBzC,GACZhjB,EAAQ7R,KAAKs1B,WAAaX,EAAa30B,KAAK6R,OAAS,IAAM,GAE3DiD,EADAigB,SAASjgB,GACG,EAAN+f,EAAU,KAAO/f,EAAM,IAAM,KAAOA,EAAM,GAE1C,GAGNR,EADAygB,SAASzgB,GACG,EAANugB,EAAU,KAAOvgB,EAAM,IAAM,KAAOA,EAAM,GAE1C,GAEHzC,EAAQyC,EAAMQ,IAErB0iB,EAAMx3B,KAAKw1B,SAAS8B,EAAMC,GACtBxI,GACAza,EAAMkjB,EAAIljB,IAAM,QAChBQ,EAAM0iB,EAAI1iB,IAAM,MACZR,EAAM,IACNA,GAAO,SAEPQ,EAAM,IACNA,GAAO,OAEJ8f,EAAW50B,KAAKu1B,WAAav1B,KAAK6R,MAAOyC,EAAKQ,EAAK+f,IAEvD2C,EAAIP,QAAUrC,EAAW50B,KAAKu1B,WAAav1B,KAAK6R,MAAO2lB,EAAIljB,IAAKkjB,EAAI1iB,IAAK+f,GAAO,UAG/FW,SAAU,SAAUiC,EAAMC,GACtB,GAAI1D,GAAMh0B,KAAK4qB,OACf,OAAIoJ,GAAIa,KAAM,EACHb,GAEG,EAAVA,EAAIa,MACJb,EAAIlf,KAAOkf,EAAIlf,IAAM4iB,GAAQ,OAEnB,EAAV1D,EAAIa,MACJb,EAAI1f,KAAO0f,EAAI1f,IAAMmjB,GAAQ,SAEjCzD,EAAIa,IAAM,EACHb,IAEXliB,WAAY,WACR,MAAO,IAAIsjB,GAASp1B,KAAMA,OAE9B6qB,SAAU,SAAU4M,EAAMC,EAAM7C,GAAtB,GAIFvgB,GACAQ,CACJ,OALW,OAAP+f,IACAA,EAAM70B,KAAK60B,KAEXvgB,EAAY,EAANugB,EAAU70B,KAAKsU,IAAMmjB,EAAOz3B,KAAKsU,IACvCQ,EAAY,EAAN+f,EAAU70B,KAAK8U,IAAM4iB,EAAO13B,KAAK8U,IACpC,GAAIqgB,GAAQ7gB,EAAKQ,EAAK+f,GAAK/J,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAEhE9yB,OAAQ,WACJ,MAAO,IAEXD,MAAO,WACH,MAAO,IAEXmzB,SAAU,WACN,MAAOd,GAAW,KAAM50B,KAAKsU,IAAKtU,KAAK8U,IAAK,IAEhD8gB,OAAQ,WACJ,OAAO,GAEX/f,WAAY,WACR,MAAO7V,OAEXgW,YAAa,WACT,MAAOhW,OAEXmW,OAAQ,WACJ,MAAOnW,OAEXsW,UAAW,WACP,MAAOtW,OAEXoU,WAAY,SAAU3C,GAClBA,EAASzR,KAAK8R,eAElBoF,cAAe,SAAUzF,GACrBA,EAASzR,KAAK8R,eAElB2jB,OAAQ,SAAUnhB,EAAKQ,EAAKwiB,EAAMC,EAAMI,EAAQjI,EAAOhb,GACnD,GAAIhD,GAAM1R,KAAKw1B,SAASlhB,EAAKQ,EAC7B,IAAI6iB,GACA,GAAIjmB,EAAI4C,KAAOob,EAAO,CAClB,GAAIhb,EAAQ,GAAKhD,EAAI4C,IAAMob,EAAQhb,EAC/B,MAAOugB,EAEXvjB,GAAI4C,KAAOI,OAGf,IAAIhD,EAAIoD,KAAO4a,EAAO,CAClB,GAAIhb,EAAQ,GAAKhD,EAAIoD,IAAM4a,EAAQhb,EAC/B,MAAOugB,EAEXvjB,GAAIoD,KAAOJ,EAMnB,MAHY,OAAR4iB,GAAwB,MAARC,IAChB7lB,EAAMA,EAAImZ,SAASyM,EAAMC,EAAMv3B,KAAK60B,MAEjCnjB,GAEXulB,MAAO,WACH,GAAIj3B,KAAK60B,IACL,KAAUjqB,OAAM,uCAEpB,IAAIkK,GAAM9U,KAAK8U,IAAKR,EAAMtU,KAAKsU,GAC/B,SAASygB,SAASjgB,IAAQA,EAAM,GAAKigB,SAASzgB,IAAQA,EAAM,MAGhE8gB,EAAWJ,EAAIr1B,QACf+R,IAAK,QACL9R,KAAM,SAAkBg4B,EAAIC,GACpBD,EAAGrC,WAAasC,EAAGtC,WAAaqC,EAAG/lB,MAAMtJ,eAAiBsvB,EAAGhmB,MAAMtJ,gBACnEvI,KAAK83B,SAAWD,EAAGhmB,OAEvB7R,KAAKqU,QAAU,GAAI8gB,GAAQyC,EAAGtjB,IAAKsjB,EAAG9iB,IAAK8iB,EAAG/C,KAC9C70B,KAAKu2B,YAAc,GAAIpB,GAAQ0C,EAAGvjB,IAAKujB,EAAG/iB,IAAK+iB,EAAGhD,KAClD70B,KAAK+3B,aAETnN,MAAO,WACH,MAAO,IAAIwK,GAASp1B,KAAKqU,QAAQuW,QAAS5qB,KAAKu2B,YAAY3L,SAASE,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAElG0C,eAAgB,SAAUrnB,GACtB,MAAO3Q,MAAKi4B,cAActnB,EAAM0D,UAAYrU,KAAKi4B,cAActnB,EAAM4lB,cAEzE0B,cAAe,SAAUljB,GACrB,MAAOA,GAAKlD,OAAS7R,KAAK6R,OAASkD,EAAKT,KAAOtU,KAAKqU,QAAQC,KAAOS,EAAKD,KAAO9U,KAAKqU,QAAQS,KAAOC,EAAKT,KAAOtU,KAAKu2B,YAAYjiB,KAAOS,EAAKD,KAAO9U,KAAKu2B,YAAYzhB,KAExKojB,SAAU,SAAUxmB,GAChB,GAAIA,YAAeymB,OAAO,CACtB,GAAIC,GAAOp4B,IACX,OAAO0R,GAAI2mB,KAAK,SAAU1mB,GACtB,MAAOymB,GAAKF,SAASvmB,KAG7B,MAAID,aAAeyjB,GACRn1B,KAAKi4B,cAAcvmB,GAE1BA,YAAe0jB,IACRp1B,KAAKg4B,eAAetmB,IAInC4mB,gBAAiB,SAAU5mB,GAAV,GAIT6mB,GACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,CAVJ,OAAI94B,MAAK6R,OAASH,EAAIG,MACXojB,GAEPsD,EAASv4B,KAAKqU,QAAQS,IACtB0jB,EAAQx4B,KAAKqU,QAAQC,IACrBmkB,EAAUz4B,KAAKu2B,YAAYzhB,IAC3B4jB,EAAW14B,KAAKu2B,YAAYjiB,IAC5BqkB,EAASjnB,EAAI2C,QAAQS,IACrB8jB,EAAQlnB,EAAI2C,QAAQC,IACpBukB,EAAUnnB,EAAI6kB,YAAYzhB,IAC1BgkB,EAAWpnB,EAAI6kB,YAAYjiB,IAC3BikB,GAAUM,GAAWF,GAAUF,GAAWD,GAASM,GAAYF,GAASF,EACjE,GAAItD,GAAS,GAAID,GAAQxG,KAAKoK,IAAIP,EAAOI,GAAQjK,KAAKoK,IAAIR,EAAQI,IAAU,GAAIxD,GAAQxG,KAAKqK,IAAIN,EAAUI,GAAWnK,KAAKqK,IAAIP,EAASI,KAAW/N,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,YAE7KL,IAGfU,UAAW,SAAUjkB,GACjB,MAAIA,aAAeyjB,GACRn1B,KAAKi4B,cAAcvmB,GAAOA,EAAMujB,EAEvCvjB,YAAe0jB,GACRp1B,KAAKs4B,gBAAgB5mB,GAAKiZ,WAEjCjZ,YAAe2jB,GACR3jB,EAAIikB,UAAU31B,MAElBi1B,GAEXtK,SAAU,WACN,MAAI3qB,MAAK41B,SACE,GAAIT,GAAQn1B,KAAKqU,QAAQC,IAAKtU,KAAKqU,QAAQS,IAAK9U,KAAKqU,QAAQwgB,KAAK/J,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,YAEhGt1B,MAEX+3B,UAAW,WAAA,GAKHxpB,GAJAxD,EAAI/K,KAAKqU,QAAS2P,EAAIhkB,KAAKu2B,YAC3BF,EAAKtrB,EAAEuJ,IAAK2kB,EAAKluB,EAAE+J,IAAKwhB,EAAKtS,EAAE1P,IAAK4kB,EAAKlV,EAAElP,IAC3CqkB,EAAc,EAARpuB,EAAE8pB,IAASuE,EAAc,EAARruB,EAAE8pB,IACzBwE,EAAc,EAARrV,EAAE6Q,IAASyE,EAAc,EAARtV,EAAE6Q,IACpB0E,GAAU,CAyBnB,OAxBIJ,KAAQE,GAAOD,IAAQE,IACnBjD,EAAKC,IACLiD,GAAU,EACVhrB,EAAM8nB,EACNA,EAAKC,EACLA,EAAK/nB,EACLA,EAAM4qB,EACNA,EAAME,EACNA,EAAM9qB,GAEN0qB,EAAKC,IACLK,GAAU,EACVhrB,EAAM0qB,EACNA,EAAKC,EACLA,EAAK3qB,EACLA,EAAM6qB,EACNA,EAAME,EACNA,EAAM/qB,GAENgrB,IACAv5B,KAAKqU,QAAU,GAAI8gB,GAAQkB,EAAI4C,EAAIG,EAAMD,GACzCn5B,KAAKu2B,YAAc,GAAIpB,GAAQmB,EAAI4C,EAAII,EAAMD,KAG9Cr5B,MAEX+qB,MAAO,SAAUuM,EAAMC,EAAMxI,GACzB,GAAIA,GAAO/uB,KAAKw1B,SAAS8B,EAAMC,GAAMN,QAAS,CAC1C,GAAIjD,GAAMh0B,KAAKqU,QAAQ0W,MAAMuM,EAAMC,EAAMxI,GAAO,IAAM/uB,KAAKu2B,YAAYxL,MAAMuM,EAAMC,EAAMxI,EAIzF,OAHI/uB,MAAKs1B,aACLtB,EAAMW,EAAa30B,KAAK6R,QAAU7R,KAAK83B,SAAW,IAAMnD,EAAa30B,KAAK83B,UAAY,IAAM,IAAM9D,GAE/FA,EAEX,MAAO,SAEXwB,SAAU,SAAUiC,EAAMC,GACtB,MAAO,IAAItC,GAASp1B,KAAKqU,QAAQmhB,SAASiC,EAAMC,GAAO13B,KAAKu2B,YAAYf,SAASiC,EAAMC,IAAO5M,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE5HzK,SAAU,SAAU4M,EAAMC,EAAM8B,EAAOC,GAInC,MAHa,OAATA,IACAA,EAAQD,GAEL,GAAIpE,GAASp1B,KAAKqU,QAAQwW,SAAS4M,EAAMC,EAAM8B,GAAQx5B,KAAKu2B,YAAY1L,SAAS4M,EAAMC,EAAM+B,IAAQ3O,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE1I9yB,OAAQ,WACJ,GAAIxC,KAAKqU,QAAQwgB,KAAO70B,KAAKu2B,YAAY1B,IACrC,KAAUjqB,OAAM,qCAEpB,OAAO5K,MAAKu2B,YAAYjiB,IAAMtU,KAAKqU,QAAQC,IAAM,GAErD/R,MAAO,WACH,GAAIvC,KAAKqU,QAAQwgB,KAAO70B,KAAKu2B,YAAY1B,IACrC,KAAUjqB,OAAM,qCAEpB,OAAO5K,MAAKu2B,YAAYzhB,IAAM9U,KAAKqU,QAAQS,IAAM,GAErD4kB,SAAU,WACN,MAAO15B,MAAKqU,QAAQvC,cAExB+D,WAAY,WACR,MAAO,IAAIuf,GAASp1B,KAAKqU,QAAS,GAAI8gB,GAAQn1B,KAAKu2B,YAAYjiB,IAAKtU,KAAKqU,QAAQS,OAErFkB,YAAa,WACT,MAAO,IAAIof,GAAS,GAAID,GAAQn1B,KAAKqU,QAAQC,IAAKtU,KAAKu2B,YAAYzhB,KAAM9U,KAAKu2B,cAElFpgB,OAAQ,WACJ,MAAO,IAAIif,GAASp1B,KAAKqU,QAAS,GAAI8gB,GAAQn1B,KAAKqU,QAAQC,IAAKtU,KAAKu2B,YAAYzhB,OAErFwB,UAAW,WACP,MAAO,IAAI8e,GAAS,GAAID,GAAQn1B,KAAKu2B,YAAYjiB,IAAKtU,KAAKqU,QAAQS,KAAM9U,KAAKu2B,cAElFzkB,WAAY,WACR,MAAO9R,OAEX61B,MAAO,SAAUvhB,GAEb,MADAA,IAAOqa,KAAKoK,IAAI,EAAG/4B,KAAKqU,QAAQC,KACzB,GAAI8gB,GAAS,GAAID,GAAQ7gB,EAAKtU,KAAKqU,QAAQS,KAAM,GAAIqgB,GAAQ7gB,EAAKtU,KAAKu2B,YAAYzhB,MAAMgW,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE9HQ,SAAU,SAAUhhB,GAEhB,MADAA,IAAO6Z,KAAKoK,IAAI,EAAG/4B,KAAKqU,QAAQS,KACzB,GAAIsgB,GAAS,GAAID,GAAQn1B,KAAKqU,QAAQC,IAAKQ,GAAM,GAAIqgB,GAAQn1B,KAAKu2B,YAAYjiB,IAAKQ,IAAMgW,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE9HqE,OAAQ,SAAUrlB,EAAKQ,GAGnB,MAFAR,IAAOqa,KAAKoK,IAAI,EAAG/4B,KAAKqU,QAAQC,KAChCQ,GAAO6Z,KAAKoK,IAAI,EAAG/4B,KAAKqU,QAAQS,KACzB,GAAIqgB,GAAQ7gB,EAAKQ,EAAK,GAAGgW,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE9DlhB,WAAY,SAAU3C,GAAV,GAKCtP,GAJLy3B,EAAW55B,KAAKqU,QAAQC,IACxBulB,EAAS75B,KAAKu2B,YAAYjiB,IAC1BwlB,EAAW95B,KAAKqU,QAAQS,IACxBilB,EAAS/5B,KAAKu2B,YAAYzhB,GAC9B,KAAS3S,EAAIy3B,EAAUz3B,GAAK03B,EAAQ13B,IAChCsP,EAAS,GAAI2jB,GAAS,GAAID,GAAQhzB,EAAG23B,GAAW,GAAI3E,GAAQhzB,EAAG43B,MAGvE7iB,cAAe,SAAUzF,GAAV,GAKFtP,GAJLy3B,EAAW55B,KAAKqU,QAAQC,IACxBulB,EAAS75B,KAAKu2B,YAAYjiB,IAC1BwlB,EAAW95B,KAAKqU,QAAQS,IACxBilB,EAAS/5B,KAAKu2B,YAAYzhB,GAC9B,KAAS3S,EAAI23B,EAAU33B,GAAK43B,EAAQ53B,IAChCsP,EAAS,GAAI2jB,GAAS,GAAID,GAAQyE,EAAUz3B,GAAI,GAAIgzB,GAAQ0E,EAAQ13B,MAG5E0tB,aAAc,SAAU4G,GACpB,MAAOA,GAAKlc,OAAO,SAAU7I,GACzB,MAAOA,GAAII,aAAaie,WAAW/vB,OACpCA,OAEPg6B,MAAO,SAAUvD,EAAMhlB,GAAhB,GA6BC5L,GA5BAgqB,EAAe7vB,KAAK6vB,aAAa4G,GACjCwD,EAAaj6B,KAAKqU,QAAQC,IAC1B4lB,EAAal6B,KAAKqU,QAAQS,IAC1BqlB,EAAiBn6B,KAAKu2B,YAAYjiB,IAClC8lB,EAAiBp6B,KAAKu2B,YAAYzhB,IAClCulB,GAAW,CAwBf,OAvBAxK,GAAaje,QAAQ,SAAUF,GAC3BA,EAAMA,EAAII,aACNJ,EAAI2C,QAAQC,IAAM2lB,IAClBI,GAAW,EACXJ,EAAavoB,EAAI2C,QAAQC,KAEzB5C,EAAI2C,QAAQS,IAAMolB,IAClBG,GAAW,EACXH,EAAaxoB,EAAI2C,QAAQS,KAEzBpD,EAAI6kB,YAAYjiB,IAAM6lB,IACtBE,GAAW,EACXF,EAAiBzoB,EAAI6kB,YAAYjiB,KAEjC5C,EAAI6kB,YAAYzhB,IAAMslB,IACtBC,GAAW,EACXD,EAAiB1oB,EAAI6kB,YAAYzhB,KAEjCrD,GACAA,EAASC,KAGb7L,EAAS,GAAIuvB,GAAS,GAAID,GAAQ8E,EAAYC,GAAa,GAAI/E,GAAQgF,EAAgBC,IACvFC,EACOx0B,EAAOm0B,MAAMvD,EAAMhlB,GAEnB5L,GAGf8W,OAAQ,SAAU9c,GAEd,QAASy6B,GAAI52B,GACT,MAAOA,IAAS,EAHhB,GACA62B,GAAQ5L,KAAKoK,IAAIhnB,KAAK4c,KAAM,GAI5BzR,EAAMld,KAAKqU,QAAQC,IAAMgmB,EAAIz6B,EAAQqd,KACrCN,EAAO5c,KAAKqU,QAAQS,IAAMwlB,EAAIz6B,EAAQ+c,MACtCO,EAASnd,KAAKu2B,YAAYjiB,IAAMgmB,EAAIz6B,EAAQsd,QAC5CL,EAAQ9c,KAAKu2B,YAAYzhB,IAAMwlB,EAAIz6B,EAAQid,MAC/C,OAAIF,GAAO,GAAKE,EAAQ,GAAKI,EAAM,GAAKC,EAAS,EACtC8X,EACA/X,GAAOC,GAAUP,GAAQE,EACzB,GAAIsY,GAAS,GAAID,GAAQoF,EAAMrd,GAAMqd,EAAM3d,IAAQ,GAAIuY,GAAQoF,EAAMpd,GAASod,EAAMzd,KAEpFmY,GAGfuF,KAAM,SAAUhjB,EAAMijB,GAClB,MAAO,IAAIrF,GAAS,GAAID,GAAQn1B,KAAKqU,QAAQC,IAAMkD,EAAMxX,KAAKqU,QAAQS,IAAM2lB,GAAO,GAAItF,GAAQn1B,KAAKu2B,YAAYjiB,IAAMkD,EAAMxX,KAAKu2B,YAAYzhB,IAAM2lB,KAEvJlK,MAAO,WACH,MAAOvwB,MAAKqU,QAAQuW,QAAQE,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,aAE1DM,OAAQ,WACJ,OAAQ51B,KAAK83B,UAAY93B,KAAKqU,QAAQiH,GAAGtb,KAAKu2B,cAElDb,SAAU,WACN,MAAO11B,MAAKqU,QAAU,IAAMrU,KAAKu2B,aAErCd,OAAQ,SAAUnhB,EAAKQ,EAAKwiB,EAAMC,EAAMI,EAAQjI,EAAOhb,GAA/C,GACAkjB,GAAK53B,KAAKqU,QAAQohB,OAAOnhB,EAAKQ,EAAKwiB,EAAMC,EAAMI,EAAQjI,EAAOhb,GAC9DgmB,EAAK16B,KAAKu2B,YAAYd,OAAOnhB,EAAKQ,EAAKwiB,EAAMC,EAAMI,EAAQjI,EAAOhb,EACtE,OAAIkjB,KAAO3C,GAAQyF,IAAOzF,EACfA,GAEP2C,IAAO3C,GACP2C,EAAK53B,KAAKqU,QAAQmhB,SAASlhB,EAAKQ,GAC5B6iB,EACAC,EAAGtjB,IAAMob,EAETkI,EAAG9iB,IAAM4a,EAED,MAAR4H,GAAwB,MAARC,IAChBK,EAAKA,EAAG/M,SAASyM,EAAMC,EAAMv3B,KAAKqU,QAAQwgB,OAEvC6F,IAAOzF,IACdyF,EAAK16B,KAAKu2B,YAAYf,SAASlhB,EAAKQ,GAChC6iB,EACA+C,EAAGpmB,IAAMob,EAAQ,EAEjBgL,EAAG5lB,IAAM4a,EAAQ,EAET,MAAR4H,GAAwB,MAARC,IAChBmD,EAAKA,EAAG7P,SAASyM,EAAMC,EAAMv3B,KAAKu2B,YAAY1B,OAG/C,GAAIO,GAASwC,EAAI8C,GAAI5P,SAAS9qB,KAAK6R,MAAO7R,KAAKs1B,YAAY3K,aAEtEsM,MAAO,WACH,MAAOj3B,MAAKqU,QAAQ4iB,SAAWj3B,KAAKu2B,YAAYU,WAGpD5B,EAAWL,EAAIr1B,QACfC,KAAM,SAAkB62B,GACpBz2B,KAAKy2B,KAAOA,EACZz2B,KAAKa,OAAS41B,EAAK51B,QAEvB+pB,MAAO,WACH,MAAO,IAAIyK,GAASr1B,KAAKy2B,KAAKn2B,UAElCq1B,UAAW,SAAUjkB,GAAV,GAEEvP,GACDqG,EAFJuC,IACJ,KAAS5I,EAAI,EAAGA,EAAInC,KAAKa,SAAUsB,EAC3BqG,EAAIkJ,EAAIikB,UAAU31B,KAAKy2B,KAAKt0B,IAC5BqG,IAAMysB,GACNlqB,EAAE5K,KAAKqI,EAGf,OAAIuC,GAAElK,OAAS,EACJ,GAAIw0B,GAAStqB,GAAG4f,WAEpBsK,GAEXtK,SAAU,WACN,GAAIgQ,GAAI,GAAItF,GAASr1B,KAAKy2B,KAAK1C,OAAO,SAAUhpB,EAAG2G,GAK/C,MAJAA,GAAMA,EAAIiZ,WACNjZ,IAAQujB,GACRlqB,EAAE5K,KAAKuR,GAEJ3G,OAEX,OAAI4vB,GAAEC,QACK3F,EAEP0F,EAAEnE,SACKmE,EAAElE,KAAK,GAEXkE,GAEXnF,SAAU,SAAUiC,EAAMC;AACtB,MAAO,IAAIrC,GAASr1B,KAAKy2B,KAAK9yB,IAAI,SAAU+N,GACxC,MAAOA,GAAI8jB,SAASiC,EAAMC,OAGlC9lB,QAAS,SAAUH,EAAU/H,GACzB1J,KAAKy2B,KAAK7kB,QAAQ,SAAUF,GACpBA,YAAe2jB,GACf3jB,EAAIE,QAAQH,EAAU/H,GAEtB+H,EAAS1R,KAAK2J,EAAKgI,IAExBhI,IAEPoI,WAAY,WACR,MAAO9R,MAAKy2B,KAAK,GAAG3kB,cAExBomB,SAAU,SAAU2C,GAChB,MAAO76B,MAAKy2B,KAAK4B,KAAK,SAAU3mB,GAC5B,MAAOA,GAAIwmB,SAAS2C,MAG5Bl3B,IAAK,SAAU8N,EAAU/H,GACrB,GAAI+sB,KAIJ,OAHAz2B,MAAK4R,QAAQ,SAAUF,GACnB+kB,EAAKt2B,KAAKsR,EAAS1R,KAAK2J,EAAKgI,MAE1B,GAAI2jB,GAASoB,IAExBlG,MAAO,WACH,MAAOvwB,MAAKy2B,KAAK,GAAGlG,SAExBG,UAAW,WACP,MAAO1wB,MAAKy2B,KAAKz2B,KAAKa,OAAS,IAEnCwC,KAAM,WACF,MAAOrD,MAAKa,QAEhB21B,OAAQ,WACJ,MAAsB,IAAfx2B,KAAKa,QAEhB+5B,MAAO,WACH,MAAuB,KAAhB56B,KAAKa,QAEhB+0B,OAAQ,WACJ,MAAO51B,MAAKw2B,UAAYx2B,KAAKy2B,KAAK,GAAGb,UAEzCG,QAAS,SAAUtrB,GACf,MAAOzK,MAAKy2B,KAAKhsB,IAErBurB,eAAgB,SAAUvrB,GACtB,MAAIA,KAAUzK,KAAKa,OAAS,EACjB,EAEA4J,EAAQ,GAGvBwrB,mBAAoB,SAAUxrB,GAC1B,MAAc,KAAVA,EACOzK,KAAKa,OAAS,EAEd4J,EAAQ,GAGvBisB,OAAQ,SAAUhlB,GACd,MAAO,IAAI2jB,GAASr1B,KAAKy2B,KAAKC,QAAQhlB,MAE1CqZ,MAAO,SAAUzW,EAAKQ,EAAKia,GACvB,MAAO/uB,MAAKy2B,KAAK9yB,IAAI,SAAU+N,GAC3B,MAAOA,GAAIqZ,MAAMzW,EAAKQ,EAAKia,KAC5B/sB,KAAK,MAEZ20B,UAAW,SAAUlsB,EAAOiH,GACxB,GAAIopB,GAAU96B,KAAKy2B,KAAKn2B,OAExB,OADAw6B,GAAQC,OAAOtwB,EAAO,EAAGiH,GAClB,GAAI2jB,GAASyF,IAExBjlB,WAAY,WACR,MAAO7V,MAAK2D,IAAI,SAAU+N,GACtB,MAAOA,GAAImE,gBAGnBG,YAAa,WACT,MAAOhW,MAAK2D,IAAI,SAAU+N,GACtB,MAAOA,GAAIsE,iBAGnBG,OAAQ,WACJ,MAAOnW,MAAK2D,IAAI,SAAU+N,GACtB,MAAOA,GAAIyE,YAGnBG,UAAW,WACP,MAAOtW,MAAK2D,IAAI,SAAU+N,GACtB,MAAOA,GAAI4E,eAGnBlC,WAAY,SAAU3C,GAClBzR,KAAK4R,QAAQ,SAAUF,GACnBA,EAAI0C,WAAW3C,MAGvByF,cAAe,SAAUzF,GACrBzR,KAAK4R,QAAQ,SAAUF,GACnBA,EAAIwF,cAAczF,MAG1BgkB,OAAQ,SAAUnhB,EAAKQ,EAAKwiB,EAAMC,EAAMI,EAAQjI,EAAOhb,GACnD,MAAO1U,MAAK2D,IAAI,SAAU+N,GACtB,MAAOA,GAAI+jB,OAAOnhB,EAAKQ,EAAKwiB,EAAMC,EAAMI,EAAQjI,EAAOhb,KACxDiW,YAEP+K,SAAU,WACN,MAAO11B,MAAKy2B,KAAK9yB,IAAI,SAAU+N,GAC3B,MAAOA,GAAAA,IACR1P,KAAK,OAEZi1B,MAAO,WACH,IAAK,GAAI90B,GAAInC,KAAKy2B,KAAK51B,SAAUsB,GAAK,GAClC,GAAInC,KAAKy2B,KAAKt0B,GAAG80B,QACb,OAAO,CAGf,QAAO,GAEXC,YAAa,SAAUC,EAAcC,GACjCp3B,KAAKy2B,KAAK7kB,QAAQ,SAAUF,GACxBA,EAAIwlB,YAAYC,EAAcC,QAI1C/mB,EAAY2qB,QAAU/F,EACtB5kB,EAAY4qB,SAAW,GAAI7F,GAAS,GAAID,GAAQ,EAAG,GAAI,GAAIA,GAAQtY,EAAAA,EAAUA,EAAAA,IAC7ExM,EAAY6qB,SAAW,GAAI/F,GAAQ,EAAG,GACtC9kB,EAAY2kB,IAAMA,EAClB3kB,EAAY6kB,QAAUA,EACtB7kB,EAAY8kB,QAAUA,EACtB9kB,EAAY+kB,SAAWA,EACvB/kB,EAAYglB,SAAWA,EACvBhlB,EAAY4qB,SAASlQ,MAAQ,WACzB,MAAO,YAEK,kBAAVxrB,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,kCAAmC,cAAeD,IAC3D,YACG,SAAUE,GAAV,GAIO41B,GACAD,EACAgG,CALA37B,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DglB,EAAW51B,EAAM6Q,YAAY+kB,SAC7BD,EAAU31B,EAAM6Q,YAAY8kB,QAC5BgG,EAAqB37B,EAAM4D,MAAMzD,QACjCC,KAAM,SAAUw7B,GACZp7B,KAAKq7B,MAAQD,GAEjBE,eAAgB,SAAU5L,EAAOjP,EAAKjY,EAAGimB,GAAzB,GACR8M,GAAYv7B,KAAKq7B,MAAMpR,UAAUyF,EAAM5d,cACvC0pB,EAAUx7B,KAAKq7B,MAAMpR,UAAUxJ,EAAI3O,aACvC,OAAO6c,MAAK6I,IAAIgE,EAAQ/M,GAAK8M,EAAU9M,IAAME,KAAK6I,IAAI+D,EAAU/yB,GAAKgzB,EAAQhzB,KAEjFizB,aAAc,SAAUhjB,EAAWijB,GAArB,GAGNC,GAQAC,EAAOC,EAAUC,EAAcC,EAc3BC,EASAC,EAjCJ5nB,EAAUoE,EAAUpE,QACpBkiB,EAAc9d,EAAU8d,YAExB2F,EAAQR,EAAOpnB,KAAOD,EAAQC,IAC9B6nB,EAAUT,EAAO5mB,KAAOT,EAAQS,GA6CpC,OA3CI6mB,GADAO,EACWC,EAAU,EAAI,EAEdA,EAAU,EAAI,EAGZ,IAAbR,GACAC,EAAQvnB,EACRwnB,EAAWtF,EACXwF,EAAYL,EAAOpnB,IAAMunB,EAASvnB,KAAOonB,EAAO5mB,IAAM+mB,EAAS/mB,IAC3DinB,IACAL,EAAS,GAAIvG,GAAQxG,KAAKoK,IAAI2C,EAAOpnB,IAAKunB,EAASvnB,KAAMqa,KAAKoK,IAAI2C,EAAO5mB,IAAK+mB,EAAS/mB,OAGvFgnB,EADA97B,KAAKs7B,eAAeO,EAAUH,EAAQ,QAAS,UAChC,GAAIvG,GAAQuG,EAAOpnB,IAAKunB,EAAS/mB,KAEjC,GAAIqgB,GAAQ0G,EAASvnB,IAAKonB,EAAO5mB,MAEhC,IAAb6mB,GACHK,EAAa,GAAI7G,GAAQ9gB,EAAQS,IAAKyhB,EAAYjiB,KAClDonB,EAAOpnB,IAAMiiB,EAAYjiB,KAAOtU,KAAKs7B,eAAeU,EAAYN,EAAQ,OAAQ,WAChFE,EAAQvnB,EACRynB,EAAe,GAAI3G,GAAQuG,EAAOpnB,IAAKiiB,EAAYzhB,OAEnD8mB,EAAQrF,EACRuF,EAAe,GAAI3G,GAAQ9gB,EAAQC,IAAKonB,EAAO5mB,OAE/B,IAAb6mB,GACHM,EAAW,GAAI9G,GAAQ9gB,EAAQC,IAAKiiB,EAAYzhB,KAChD4mB,EAAO5mB,IAAMyhB,EAAYzhB,MAAQ9U,KAAKs7B,eAAeW,EAAUP,EAAQ,QAAS,QAChFE,EAAQvnB,EACRynB,EAAe,GAAI3G,GAAQoB,EAAYjiB,IAAKonB,EAAO5mB,OAEnD8mB,EAAQrF,EACRuF,EAAe,GAAI3G,GAAQuG,EAAOpnB,IAAKD,EAAQS,QAGnD8mB,EAAQrF,EAEJuF,EADA97B,KAAKs7B,eAAejnB,EAASqnB,EAAQ,OAAQ,OAC9B,GAAIvG,GAAQuG,EAAOpnB,IAAKD,EAAQS,KAEhC,GAAIqgB,GAAQ9gB,EAAQC,IAAKonB,EAAO5mB,MAGhD9U,KAAKq7B,MAAMtD,UAAU,GAAI3C,GAASwG,EAAOE,OAGxDt8B,EAAM6Q,YAAY8qB,mBAAqBA,IACzC37B,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,yBACH,aACA,kCACDD,IACL,YACG,SAAUE,GAAV,GAIO41B,GACAD,EACAiH,EA8BAC,CAnCA78B,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DglB,EAAW51B,EAAM6Q,YAAY+kB,SAC7BD,EAAU31B,EAAM6Q,YAAY8kB,QAC5BiH,EAAgB58B,EAAM4D,MAAMzD,QAC5BC,KAAM,SAAUkqB,EAAOpO,EAAM4gB,EAAatC,GACtCh6B,KAAKs8B,YAAcA,EACnBt8B,KAAKu8B,SAAW,SAAU9xB,GAAV,GACR3H,GAAUk3B,EAAMh6B,KAAK2Q,MAAMlG,IAC3BkG,EAAQ3Q,KAAK2Q,MAAM+K,EAAK8gB,YAAY15B,EAAQuR,QAAQyV,IACxD,OAAOkQ,GAAMrpB,GAAO0D,QAAQyV,IAEhC9pB,KAAKy8B,UAAY,SAAUhyB,GAAV,GACT3H,GAAUk3B,EAAMh6B,KAAK2Q,MAAMlG,IAC3BkG,EAAQ3Q,KAAK2Q,MAAM+K,EAAKghB,YAAY55B,EAAQyzB,YAAYzM,IAC5D,OAAOkQ,GAAMrpB,GAAO4lB,YAAYzM,IAEpC9pB,KAAK28B,SAAW,SAAUlyB,GACtB,GAAIkG,GAAQqpB,EAAMh6B,KAAK2Q,MAAMlG,GAC7B,OAAOiR,GAAKghB,YAAY/rB,EAAM4lB,YAAYzM,KAE9C9pB,KAAK48B,UAAY,SAAUnyB,GACvB,GAAIkG,GAAQqpB,EAAMh6B,KAAK2Q,MAAMlG,GAC7B,OAAOiR,GAAK8gB,YAAY7rB,EAAM0D,QAAQyV,MAG9C+S,SAAU,SAAU3f,EAAKC,GACrBnd,KAAKkd,IAAMA,EACXld,KAAKmd,OAASA,GAElBxM,MAAO,SAAUlG,GACb,MAAOzK,MAAKs8B,YAAY7xB,EAAOzK,KAAKkd,IAAKld,KAAKmd,WAGlDkf,EAAiB78B,EAAM4D,MAAMzD,QAC7BC,KAAM,SAAUiS,GACZ7R,KAAKoY,OAASvG,EACd7R,KAAKyX,QAAUzX,KAAKoY,OAAOijB,MAAMyB,SACjC98B,KAAK+8B,mBAAqB,GAAIv9B,GAAM6Q,YAAY8qB,mBAAmBtpB,EAAMwpB,OACzEr7B,KAAKg9B,QAAU,GAAIZ,GAAc,MAAOp8B,KAAKoY,OAAOijB,MAAMyB,SAAU98B,KAAKi9B,YAAYlrB,KAAK/R,MAAOA,KAAKg6B,MAAMjoB,KAAK/R,OACjHA,KAAKk9B,QAAU,GAAId,GAAc,MAAOp8B,KAAKoY,OAAOijB,MAAM8B,MAAOn9B,KAAKo9B,SAASrrB,KAAK/R,MAAOA,KAAKg6B,MAAMjoB,KAAK/R,QAE/GwC,OAAQ,SAAUA,GACdxC,KAAKq9B,gBAAkB76B,GAE3Bw3B,MAAO,SAAUtoB,GACb,MAAO1R,MAAKoY,OAAOklB,gBAAgB5rB,IAEvCurB,YAAa,SAAUnoB,EAAKqB,EAAQG,GAChC,MAAOtW,MAAKoY,OAAOzG,KAAKwE,EAAQrB,EAAKwB,EAAYH,EAAQ,IAE7DinB,SAAU,SAAU9oB,EAAKipB,EAASC,GAC9B,MAAOx9B,MAAKoY,OAAOzG,KAAK2C,EAAKipB,EAAS,EAAGC,EAAWD,IAExDE,6BAA8B,WAC1B,MAAOz9B,MAAKoY,OAAO7I,SAAS2oB,SAASl4B,KAAKoY,OAAOslB,eAErDC,kBAAmB,SAAUj6B,GACzB,GAAI+U,GAAYzY,KAAKoY,OAAOK,WAC5B6O,YAAW,WACP7O,EAAU/U,MAAMA,QAGxBk6B,UAAW,WACP59B,KAAKoY,OAAO7I,OAAOvP,KAAKoY,OAAO0C,YAEnCvL,OAAQ,SAAUmC,EAAKmsB,EAAMC,GACzBpsB,EAAM1R,KAAK+9B,WAAWrsB,EAAKmsB,GACvBC,IACApsB,EAAM1R,KAAKoY,OAAO7I,SAASmnB,OAAOhlB,IAEtC1R,KAAKoY,OAAO7I,OAAOmC,IAEvBqsB,WAAY,SAAUrsB,EAAKmsB,GACvB,GAAIzC,GAAOp7B,KAAKoY,OAAOijB,KACvB,QAAQwC,GACR,IAAK,QACDnsB,EAAM0pB,EAAKrD,UAAUrmB,EACrB,MACJ,KAAK,MACDA,EAAM0pB,EAAK4C,OAAOtsB,EAAI4C,IACtB,MACJ,KAAK,SACD5C,EAAM0pB,EAAK6C,OAAOvsB,EAAIoD,IACtB,MACJ,KAAK,QACDpD,EAAM1R,KAAKoY,OAAO0C,UAGtB,MAAOpJ,IAEXwsB,eAAgB,SAAUxsB,EAAKmsB,EAAMC,EAAe3O,GAChD,GAAY,YAAR0O,EACA79B,KAAKoY,OAAO+lB,oBACT,IAAIhP,GAAoB,SAAR0O,EAAiB,CACpC,GAAIltB,GAAQ,GAAIykB,GAASp1B,KAAKoY,OAAOxB,aAAa2Z,QAAS7e,EAC3D1R,MAAKoY,OAAO7I,OAAOoB,GAAO,GAAO,GACjC3Q,KAAKoY,OAAO8lB,qBAEZl+B,MAAKoY,OAAO8lB,iBACZl+B,KAAKuP,OAAOmC,EAAKmsB,EAAMC,IAG/BM,kBAAmB,WACfp+B,KAAKoY,OAAOgmB,qBAEhBC,qBAAsB,SAAU3sB,EAAKmsB,GACjC,GAAIhsB,GAAQ7R,KAAKoY,MACZvG,GAAMtC,SAAS2oB,SAASl4B,KAAK+9B,WAAWrsB,EAAKmsB,KAC9C79B,KAAKuP,OAAOmC,EAAKmsB,IAGzBS,gBAAiB,SAAUC,GAAV,GAWTC,GAiFAC,EA3FAC,EAAY1+B,KAAK2+B,mBAAmBJ,GACpC1sB,EAAQ7R,KAAKoY,OACbwmB,EAAiB5+B,KAAKq9B,gBACtB7lB,EAAO3F,EAAMwpB,MAAM8B,MACnB1lB,EAAU5F,EAAMwpB,MAAMyB,SACtB+B,EAAoBhtB,EAAMitB,gCAC1BrmB,EAAY5G,EAAMtC,SAASuC,aAC3B8E,EAAa/E,EAAM+E,aACnBvC,EAAUwqB,EAAkBxqB,QAAQuW,QACpC2L,EAAcsI,EAAkBtI,YAAY3L,OAIhD,QAFA5qB,KAAKg9B,QAAQH,SAASpkB,EAAUpE,QAAQC,IAAKmE,EAAU8d,YAAYjiB,KACnEtU,KAAKk9B,QAAQL,SAASpkB,EAAUpE,QAAQS,IAAK2D,EAAU8d,YAAYzhB,KAC3D4pB,GACR,IAAK,cACDrqB,EAAQS,IAAM9U,KAAKg9B,QAAQT,SAASloB,EAAQS,KAC5C0pB,EAAanqB,CACb,MACJ,KAAK,eACDA,EAAQS,IAAM9U,KAAKg9B,QAAQL,SAAStoB,EAAQS,KAC5C0pB,EAAanqB,CACb,MACJ,KAAK,eACDkiB,EAAYzhB,IAAM9U,KAAKg9B,QAAQP,UAAUlG,EAAYzhB,KACrD0pB,EAAajI,CACb,MACJ,KAAK,cACDA,EAAYzhB,IAAM9U,KAAKg9B,QAAQJ,UAAUrG,EAAYzhB,KACrD0pB,EAAajI,CACb,MACJ,KAAK,YACDliB,EAAQC,IAAMtU,KAAKk9B,QAAQX,SAASloB,EAAQC,KAC5CkqB,EAAanqB,CACb,MACJ,KAAK,cACDA,EAAQC,IAAMtU,KAAKk9B,QAAQP,SAAStoB,EAAQC,KAC5CkqB,EAAanqB,CACb,MACJ,KAAK,cACDkiB,EAAYjiB,IAAMtU,KAAKk9B,QAAQT,UAAUlG,EAAYjiB,KACrDkqB,EAAajI,CACb,MACJ,KAAK,YACDA,EAAYjiB,IAAMtU,KAAKk9B,QAAQN,UAAUrG,EAAYjiB,KACrDkqB,EAAajI,CACb,MACJ,KAAK,iBACDliB,EAAQC,IAAMkD,EAAKunB,SAAS1qB,EAAQC,IAAKsqB,EACzC,MACJ,KAAK,iBACDrI,EAAYjiB,IAAMkD,EAAKunB,SAASxI,EAAYjiB,IAAKsqB,EACjD,MACJ,KAAK,mBACDrI,EAAYjiB,IAAMkD,EAAKwnB,SAASzI,EAAYjiB,IAAKsqB,EACjD,MACJ,KAAK,mBACDvqB,EAAQC,IAAMkD,EAAKwnB,SAAS3qB,EAAQC,IAAKsqB,EACzC,MACJ,KAAK,YACDvqB,EAAQS,IAAM2C,EAAQwnB,eACtB1I,EAAYzhB,IAAM8B,EAAW2f,YAAYzhB,IACzC0pB,EAAanqB,CACb,MACJ,KAAK,WACDkiB,EAAYzhB,IAAM2C,EAAQynB,cAC1B7qB,EAAQS,IAAM8B,EAAWvC,QAAQS,IACjC0pB,EAAajI,CACb,MACJ,KAAK,YACDliB,EAAQC,IAAMkD,EAAKynB,eACnB1I,EAAYjiB,IAAMsC,EAAW2f,YAAYjiB,IACzCkqB,EAAanqB,CACb,MACJ,KAAK,WACDkiB,EAAYjiB,IAAMkD,EAAK0nB,cACvB7qB,EAAQC,IAAMsC,EAAWvC,QAAQC,IACjCkqB,EAAajI,CACb,MACJ,KAAK,OACDA,EAAYjiB,IAAMkD,EAAK0nB,cACvB3I,EAAYzhB,IAAM2C,EAAQynB,cAC1B7qB,EAAUuC,EAAWvC,QACrBmqB,EAAajI,CACb,MACJ,KAAK,QACDliB,EAAQC,IAAMkD,EAAKynB,eACnB5qB,EAAQS,IAAM2C,EAAQwnB,eACtB1I,EAAc3f,EAAW2f,YACzBiI,EAAanqB,EAIjB,MADIoqB,GAAe,GAAIrJ,GAAS/gB,EAASkiB,GACpCv2B,KAAKg6B,MAAMyE,GAAc1O,WAAWnZ,IAIrC4nB,GACA3sB,EAAMvC,MAAMkvB,OAEhBx+B,MAAKm/B,4BAA4BV,QAN7Bz+B,MAAKs+B,gBAAgBI,EAAUl9B,QAAQ,SAAU,YAQzD49B,eAAgB,SAAUV,GAAV,GACR7sB,GAAQ7R,KAAKoY,OACbxB,EAAa/E,EAAM+E,aACnBvC,EAAUuC,EAAWvC,QACrBkiB,EAAc3f,EAAW2f,YACzBxhB,EAAOlD,EAAMwtB,qBACb7nB,EAAO3F,EAAMwpB,MAAM8B,MACnB1lB,EAAU5F,EAAMwpB,MAAMyB,SACtBxoB,EAAMS,EAAKT,IACXoG,EAAS3F,EAAKD,GAClB,QAAQ4pB,GACR,IAAK,OACDhkB,EAASjD,EAAQ+kB,YAAYnoB,EAAQS,IACrC,MACJ,KAAK,KACDR,EAAMkD,EAAKglB,YAAYnoB,EAAQC,IAC/B,MACJ,KAAK,QACDoG,EAASjD,EAAQilB,YAAYnG,EAAYzhB,IACzC,MACJ,KAAK,OACDR,EAAMkD,EAAKklB,YAAYnG,EAAYjiB,IACnC,MACJ,KAAK,YACDoG,EAASjD,EAAQwnB,cACjB,MACJ,KAAK,WACDvkB,EAASjD,EAAQynB,aACjB,MACJ,KAAK,YACD5qB,EAAMkD,EAAKynB,cACX,MACJ,KAAK,WACD3qB,EAAMkD,EAAK0nB,aACX,MACJ,KAAK,OACD5qB,EAAMkD,EAAK0nB,cACXxkB,EAASjD,EAAQynB,aACjB,MACJ,KAAK,QACD5qB,EAAMkD,EAAKynB,eACXvkB,EAASjD,EAAQwnB,cACjB,MACJ,KAAK,YACD3qB,EAAMkD,EAAKwnB,SAASzI,EAAYjiB,IAAKtU,KAAKq9B,gBAC1C,MACJ,KAAK,YACD/oB,EAAMkD,EAAKunB,SAASxI,EAAYjiB,IAAKtU,KAAKq9B,iBAG9CxrB,EAAMtC,OAAO,GAAI4lB,GAAQ7gB,EAAKoG,KAElC4kB,oBAAqB,SAAUZ,GAa3B,QAASa,GAAa3b,GAClB4b,EAAa5b,EAAIvP,QACjBorB,EAAiB7b,EAAI2S,YAfR,GASbiJ,GAAYC,EAGZlxB,EAMAmxB,EAEI58B,EAnBJ+O,EAAQ7R,KAAKoY,OACbxB,EAAa/E,EAAM+E,aACnBvC,EAAUuC,EAAWvC,QACrBU,EAAOlD,EAAMwtB,qBACb7nB,EAAO3F,EAAMwpB,MAAM8B,MACnB1lB,EAAU5F,EAAMwpB,MAAMyB,SACtBxoB,EAAMS,EAAKT,IACXoG,EAAS3F,EAAKD,IAEdolB,EAAa7lB,EAAQS,IACrBmlB,EAAa5lB,EAAQC,GAQzB,KAFAirB,EAAa1tB,EAAM8tB,0BACfD,GAAO,GACHA,GAAM,CAEV,OADI58B,EAAU,GAAIqyB,GAAQ7gB,EAAKoG,GACvBgkB,GACR,IAAK,OACGe,EAAenkB,GAAGxY,IAClBy8B,EAAa1tB,EAAM+tB,uBACnBtrB,EAAMkrB,EAAWlrB,IACjBoG,EAAS8kB,EAAW1qB,MAEpB4F,EAASjD,EAAQilB,YAAYxC,IACzBxf,GAAUwf,GAAcxf,EAAS+kB,EAAe3qB,OAChD4F,EAAS8kB,EAAW1qB,IACpBvG,EAAMiJ,EAAKklB,YAAYpoB,GAEnBA,EADA/F,GAAO+F,GAAO/F,EAAMkxB,EAAenrB,IAC7BkrB,EAAWlrB,IAEX/F,GAIlB,MACJ,KAAK,WACGixB,EAAWlkB,GAAGxY,IACdy8B,EAAa1tB,EAAMguB,2BACnBvrB,EAAMmrB,EAAenrB,IACrBoG,EAAS+kB,EAAe3qB,MAExB4F,EAASjD,EAAQ+kB,YAAYtC,IACzBxf,GAAUwf,GAAcxf,EAAS8kB,EAAW1qB,OAC5C4F,EAAS+kB,EAAe3qB,IACxBvG,EAAMiJ,EAAKglB,YAAYloB,GAEnBA,EADA/F,GAAO+F,GAAO/F,EAAMixB,EAAWlrB,IACzBmrB,EAAenrB,IAEf/F,GAIlB,MACJ,KAAK,QACGkxB,EAAenkB,GAAGxY,IAClBy8B,EAAa1tB,EAAM+tB,uBACnBtrB,EAAMkrB,EAAWlrB,IACjBoG,EAAS8kB,EAAW1qB,MAEpBR,EAAMkD,EAAKklB,YAAYzC,IACnB3lB,GAAO2lB,GAAc3lB,EAAMmrB,EAAenrB,OAC1CA,EAAMkrB,EAAWlrB,IACjB/F,EAAMkJ,EAAQilB,YAAYhiB,GAEtBA,EADAnM,GAAOmM,GAAUnM,EAAMkxB,EAAe3qB,IAC7B0qB,EAAW1qB,IAEXvG,GAIrB,MACJ,KAAK,QACGixB,EAAWlkB,GAAGxY,IACdy8B,EAAa1tB,EAAMguB,2BACnBvrB,EAAMmrB,EAAenrB,IACrBoG,EAAS+kB,EAAe3qB,MAExBR,EAAMkD,EAAKglB,YAAYvC,IACnB3lB,GAAO2lB,GAAc3lB,EAAMkrB,EAAWlrB,OACtCA,EAAMmrB,EAAenrB,IACrB/F,EAAMkJ,EAAQ+kB,YAAY9hB,GAEtBA,EADAnM,GAAOmM,GAAUnM,EAAMixB,EAAW1qB,IACzB2qB,EAAe3qB,IAEfvG,GAIrB,MACJ,SACI,KAAU3D,OAAM,6BAA+B8zB,GAEnDgB,GAAQ1/B,KAAK8/B,WAAWxrB,EAAKoG,GAC7Bwf,EAAaxf,EACbuf,EAAa3lB,EAEbzC,EAAMkuB,sBACNluB,EAAMtC,OAAO,GAAI4lB,GAAQ7gB,EAAKoG,IAE9B7I,EAAM+E,WAAW,GAAIue,GAAQ7gB,EAAKoG,KAG1CslB,gBAAiB,SAAUtuB,EAAKmsB,GAAf,GAcTjnB,GAbA/E,EAAQ7R,KAAKoY,OACbgjB,EAAOvpB,EAAMwpB,KACjB,OAAa,aAATwC,MACA79B,MAAKigC,eAAevuB,IAGX,UAATmsB,EACAnsB,EAAM0pB,EAAKrD,UAAUrmB,GACL,QAATmsB,EACPnsB,EAAM0pB,EAAK4C,OAAOtsB,EAAI4C,KAAKiiB,YACX,WAATsH,IACPnsB,EAAM0pB,EAAK6C,OAAOvsB,EAAIoD,KAAKyhB,aAE3B3f,EAAa/E,EAAMwtB,qBAAqBvtB,iBAC5C9R,MAAKm/B,4BAA4B,GAAI/J,GAASxe,EAAWvC,QAAS3C,MAEtEouB,WAAY,SAAUxrB,EAAKQ,GAAf,GAIJpD,GACAwuB,CAJJ,UAAIlgC,KAAKoY,OAAO+nB,YAAY7rB,KAAQtU,KAAKoY,OAAOgoB,eAAetrB,MAG3DpD,EAAM,GAAIyjB,GAAQ7gB,EAAKQ,GACvBorB,GAAW,EACflgC,KAAKoY,OAAOioB,kBAAkB,SAAUC,GAChCA,EAAOvQ,WAAWre,KAAS4uB,EAAO5G,WAAWpe,GAAG5J,KAChDwuB,GAAW,KAGZA,IAEXD,eAAgB,SAAUvuB,GAAV,GAMR6uB,GAAM7B,EAEF8B,EAPJ3uB,EAAQ7R,KAAKoY,OACbK,EAAY5G,EAAMtC,SAClBwK,EAASlI,EAAM4uB,gBACfC,EAAO1gC,KAAK+8B,mBAAmBtB,aAAahjB,EAAW/G,GACvDivB,EAAQ3gC,KAAK2gC,MAAMloB,EAAWioB,EAE7BC,KACGH,EAAU3uB,EAAMlB,MAAM+vB,GAAME,iBAAiB/uB,EAAMlB,MAAMoJ,IACzDymB,IACA9B,EAAY8B,EAAQ9B,UACpB6B,EAAOC,EAAQD,OAGvB1uB,EAAMgvB,eAAeH,EAAMC,EAAOJ,EAAM7B,IAE5CC,mBAAoB,SAAUJ,GAAV,GACZ9lB,GAAYzY,KAAKoY,OAAO0oB,wBACxBlqB,EAAa5W,KAAKoY,OAAOxB,aACzBmqB,EAAWnqB,EAAWvC,QAAQS,KAAO2D,EAAUpE,QAAQS,IACvDksB,EAAYpqB,EAAW2f,YAAYzhB,KAAO2D,EAAU8d,YAAYzhB,IAChEmsB,EAAUrqB,EAAWvC,QAAQC,KAAOmE,EAAUpE,QAAQC,IACtD4sB,EAAatqB,EAAW2f,YAAYjiB,KAAOmE,EAAU8d,YAAYjiB,GACrE,QAAQiqB,GACR,IAAK,OACDA,EAASyC,EAAY,cAAgB,aACrC,MACJ,KAAK,QACDzC,EAASwC,EAAW,eAAiB,cACrC,MACJ,KAAK,KACDxC,EAAS2C,EAAa,YAAc,WACpC,MACJ,KAAK,OACD3C,EAAS0C,EAAU,cAAgB,aACnC,MACJ,KAAK,YACD1C,EAAS2C,EAAa,iBAAmB,gBACzC,MACJ,KAAK,YACD3C,EAAS0C,EAAU,mBAAqB,mBAG5C,MAAO1C,IAEXY,4BAA6B,SAAUztB,GACnC,GAAIG,GAAQ7R,KAAKoY,MACjBvG,GAAMtC,OAAOsC,EAAMsvB,iBAAiBxK,UAAU9kB,EAAMuvB,sBAAuB1vB,IAAM,IAErFivB,MAAO,SAAUloB,EAAW4oB,GAArB,GACCV,GAGQrqB,EAGAgrB,CAIZ,OATID,GAAOhtB,QAAQiH,GAAG7C,EAAUpE,WACxBgtB,EAAO9K,YAAYjiB,IAAMmE,EAAU8d,YAAYjiB,KAC3CgC,EAAYtW,KAAKk9B,QAAQT,UAAU4E,EAAO9K,YAAYjiB,KAC1DqsB,EAAQ,GAAIvL,GAAS,GAAID,GAAQ7e,EAAWmC,EAAUpE,QAAQS,KAAM2D,EAAU8d,cACvE8K,EAAO9K,YAAYzhB,IAAM2D,EAAU8d,YAAYzhB,MAClDwsB,EAAYthC,KAAKg9B,QAAQP,UAAU4E,EAAO9K,YAAYzhB,KAC1D6rB,EAAQ,GAAIvL,GAAS,GAAID,GAAQ1c,EAAUpE,QAAQC,IAAKgtB,GAAY7oB,EAAU8d,eAG/EoK,KAGfnhC,EAAM6Q,YAAYgsB,eAAiBA,IACrC78B,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,2BAA4B,cAAeD,IACpD,YACG,SAAUE,GACP,KAAIA,EAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,GAAlE,CAGA,GAAImxB,GAAc/hC,EAAM4D,MAAMzD,QAC1BC,KAAM,SAAUiS,GACZ7R,KAAKoY,OAASvG,GAElB2vB,sBAAuB,SAAU/vB,GAC7B,GAAII,GAAQ7R,KAAKoY,MACjBvG,GAAM+C,MAAM,WACR/C,EAAMtC,SAASqnB,mBAAmB,SAAUnsB,EAAOtI,GAC/CsP,EAASI,EAAOpH,EAAOtI,OAG3Bsa,QAAQ,EACR9D,QAAQ,KAGhB8oB,mBAAoB,SAAUhwB,GAC1B,GAAII,GAAQ7R,KAAKoY,MACjBvG,GAAM+C,MAAM,WACR/C,EAAMtC,SAASunB,gBAAgB,SAAUrsB,EAAOtI,GAC5CsP,EAASI,EAAOpH,EAAOtI,OAG3Bsa,QAAQ,EACR9D,QAAQ,KAGhB+oB,sBAAuB,SAAUhwB,GAC7B,MAAO1R,MAAKoY,OAAOijB,MAAMyB,SAAS6E,eAAejwB,EAAI2C,QAAQS,IAAKpD,EAAI6kB,YAAYzhB,MAEtF8sB,mBAAoB,SAAUlwB,GAC1B,MAAO1R,MAAKoY,OAAOijB,MAAM8B,MAAMwE,eAAejwB,EAAI2C,QAAQC,IAAK5C,EAAI6kB,YAAYjiB,MAEnFutB,+BAAgC,WAC5B,MAAO7hC,MAAK0hC,sBAAsB1hC,KAAKoY,OAAO7I,WAElDuyB,4BAA6B,WACzB,MAAO9hC,MAAK4hC,mBAAmB5hC,KAAKoY,OAAO7I,WAE/C6N,sBAAuB,WACnB,GAAI2kB,MAAcrtB,EAAQ,CAiB1B,OAhBA1U,MAAKwhC,sBAAsB,SAAU3vB,EAAOpH,GAExC,GADAA,GAASiK,GACL7C,EAAMuuB,eAAe31B,GAAzB,CAGAiK,GACA,IAAI8H,KACJulB,GAAQ7V,SACJzhB,MAAOA,EACP+R,SAAUA,EACVja,MAAOsP,EAAMO,YAAY3H,KAE7BoH,EAAMmwB,sBAAsBxlB,EAAU,WAClC3K,EAAMgM,aAAapT,QAGpBs3B,GAEXhlB,mBAAoB,WAChB,GAAIglB,MAAcrtB,EAAQ,CAiB1B,OAhBA1U,MAAKyhC,mBAAmB,SAAU5vB,EAAOpH,GAErC,GADAA,GAASiK,GACL7C,EAAMsuB,YAAY11B,GAAtB,CAGAiK,GACA,IAAI8H,KACJulB,GAAQ7V,SACJzhB,MAAOA,EACP+R,SAAUA,EACVha,OAAQqP,EAAMS,UAAU7H,KAE5BoH,EAAMmwB,sBAAsBxlB,EAAU,WAClC3K,EAAMqM,UAAUzT,QAGjBs3B,GAEXhmB,oBAAqB,WAAA,GAIblK,GACAH,EACAkL,EACAE,EACA8G,EAEIqe,EACAC,CAFR,KARAliC,KAAKwhC,sBAAsB,SAAU3vB,EAAOpH,GACxCoH,EAAMswB,WAAW13B,KAEjBoH,EAAQ7R,KAAKoY,OACb1G,EAAMG,EAAMtC,SAASuC,aACrB8K,EAAOlL,EAAI2C,QAAQS,IACnBgI,EAAQpL,EAAI6kB,YAAYzhB,IACxB8O,EAAM,OACG,CAGT,GAFIqe,EAAWnlB,EAAQjL,EAAMirB,SAASsF,OAClCF,EAAUtlB,GAAQ,GACjBslB,IAAYD,EACb,KAEJ,IAAIA,IAAapwB,EAAMuuB,eAAetjB,GAAQ,CAC1C8G,EAAM9G,CACN,OAEJ,GAAIolB,IAAYrwB,EAAMuuB,eAAexjB,GAAO,CACxCgH,EAAMhH,CACN,OAEJA,IACAE,IAEQ,OAAR8G,IACAlS,EAAM,GAAIlS,GAAM6Q,YAAY+kB,SAAS,GAAI51B,GAAM6Q,YAAY8kB,QAAQ,EAAGvR,GAAM,GAAIpkB,GAAM6Q,YAAY8kB,QAAQtjB,EAAMsrB,MAAMiF,OAAS,EAAGxe,IAClI/R,EAAMlB,MAAMe,GAAKnC,WAGzBuM,iBAAkB,WAAA,GAIVjK,GACAH,EACAwL,EACAC,EACAyG,EAEIye,EACAC,CAFR,KARAtiC,KAAKyhC,mBAAmB,SAAU5vB,EAAOpH,GACrCoH,EAAM0wB,QAAQ93B,KAEdoH,EAAQ7R,KAAKoY,OACb1G,EAAMG,EAAMtC,SAASuC,aACrBoL,EAAMxL,EAAI2C,QAAQC,IAClB6I,EAASzL,EAAI6kB,YAAYjiB,IACzBsP,EAAM,OACG,CAGT,GAFIye,EAAYllB,EAAStL,EAAMsrB,MAAMiF,OACjCE,EAASplB,GAAO,GACfolB,IAAWD,EACZ,KAEJ,IAAIA,IAAcxwB,EAAMsuB,YAAYhjB,GAAS,CACzCyG,EAAMzG,CACN,OAEJ,GAAImlB,IAAWzwB,EAAMsuB,YAAYjjB,GAAM,CACnC0G,EAAM1G,CACN,OAEJA,IACAC,IAEQ,OAARyG,IACAlS,EAAM,GAAIlS,GAAM6Q,YAAY+kB,SAAS,GAAI51B,GAAM6Q,YAAY8kB,QAAQvR,EAAK,GAAI,GAAIpkB,GAAM6Q,YAAY8kB,QAAQvR,EAAK/R,EAAMirB,SAASsF,OAAS,IACvIvwB,EAAMlB,MAAMe,GAAKnC,WAGzB2M,sBAAuB,WACnBlc,KAAKwhC,sBAAsB,SAAU3vB,EAAOpH,GACxCoH,EAAM2wB,aAAa/3B,MAG3BwR,mBAAoB,WAChBjc,KAAKyhC,mBAAmB,SAAU5vB,EAAOpH,GACrCoH,EAAM4wB,UAAUh4B,MAGxBsT,cAAe,WAAA,GACPpN,GAAQ3Q,KAAKoY,OAAO7I,SAASuC,aAC7BohB,EAAWviB,EAAMnO,QACrB,OAAOxC,MAAKoY,OAAOsqB,iBAAiB,EAAGxP,IAE3CxV,iBAAkB,WAAA,GACV/M,GAAQ3Q,KAAKoY,OAAO7I,SAASuC,aAC7BqhB,EAAcxiB,EAAMpO,OACxB,OAAOvC,MAAKoY,OAAOuqB,oBAAoB,EAAGxP,IAE9CxV,cAAe,WAAA,GAEPH,GADA3L,EAAQ7R,KAAKoY,OACPmF,EAAQ,CAalB,OAZA1L,GAAM+C,MAAM,WACR/C,EAAMtC,SAASqnB,mBAAmB,SAAUnsB,GACnC+S,IACDA,EAAO/S,GAEXoH,EAAMwL,aAAaG,KACjBD,MAGN5E,QAAQ,EACR8D,QAAQ,KAGRe,KAAMA,EACND,MAAOA,IAGfK,eAAgB,WAAA,GAERJ,GADA3L,EAAQ7R,KAAKoY,OACPmF,EAAQ,CAalB,OAZA1L,GAAM+C,MAAM,WACR/C,EAAMtC,SAASqnB,mBAAmB,SAAUnsB,GACxC+S,EAAO/S,EAAQ,IACb8S,GAEN,KAAK,GAAIpb,GAAI,EAAGA,EAAIob,IAASpb,EACzB0P,EAAMwL,aAAaG,KAGvB7E,QAAQ,EACR8D,QAAQ,KAGRe,KAAMA,EACND,MAAOA,IAGfS,YAAa,WAAA,GAELR,GADA3L,EAAQ7R,KAAKoY,OACPmF,EAAQ,CAalB,OAZA1L,GAAM+C,MAAM,WACR/C,EAAMtC,SAASunB,gBAAgB,SAAUrsB,GAChC+S,IACDA,EAAO/S,GAEXoH,EAAMmL,UAAUQ,KACdD,MAGN5E,QAAQ,EACR8D,QAAQ,KAGRe,KAAMA,EACND,MAAOA,IAGfU,YAAa,WAAA,GAELT,GADA3L,EAAQ7R,KAAKoY,OACPmF,EAAQ,CAalB,OAZA1L,GAAM+C,MAAM,WACR/C,EAAMtC,SAASunB,gBAAgB,SAAUrsB,GACrC+S,EAAO/S,EAAQ,IACb8S,GAEN,KAAK,GAAIpb,GAAI,EAAGA,EAAIob,IAASpb,EACzB0P,EAAMmL,UAAUQ,KAGpB7E,QAAQ,EACR8D,QAAQ,KAGRe,KAAMA,EACND,MAAOA,KAInB/d,GAAM6Q,YAAYkxB,YAAcA,IAClC/hC,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,yBAA0B,cAAeD,IAClD,YACG,SAAUE,GAoJP,QAASojC,KACL,GAAIlxB,GAAM,GAAIyjB,GAAQ,EAAG,EAAG,EAC5B,QACIzjB,IAAKA,EACLmxB,eACAv4B,QACAw4B,SAAS,EACTC,QAASrxB,EAAII,cAGrB,QAASkxB,GAAa/xB,EAAOqD,EAAKQ,EAAKpR,GAAvC,GAMQm0B,GALAvtB,EAAO2G,EAAM3G,OAAS2G,EAAM3G,QAC3BA,GAAKgK,KACNhK,EAAKgK,OAEThK,EAAKgK,GAAKQ,GAAOpR,EACbm0B,EAAK5mB,EAAM8xB,QAAQxM,YACvBsB,EAAGvjB,IAAMqa,KAAKoK,IAAIlB,EAAGvjB,IAAKA,GAC1BujB,EAAG/iB,IAAM6Z,KAAKoK,IAAIlB,EAAG/iB,IAAKA,GAE9B,QAASmuB,GAAWtgC,GAChB,MAAOA,GAAMnB,QAAQ,uBAAwB,IAEjD,QAAS0hC,GAAahiB,GAClB,GAAIxX,KAYJ,QAVI,eACA,cACA,aACA,aACFkI,QAAQ,SAAU/P,GAChB6H,EAAI7H,GAAgC,QAAzBqf,EAAOrf,EAAM,SAAqB,MACzCwB,KAAM,EACN8/B,MAAOjiB,EAAOrf,EAAM,YAGrB6H,EAEX,QAAS05B,GAAU9uB,EAAKQ,EAAKyG,EAAS2Y,EAAUmP,GAAhD,GACQniB,GAAS/d,OAAOmgC,iBAAiB/nB,GACjCja,EAAOia,EAAQiQ,UAAUhqB,QAAQ,MAAO,IACxC+hC,EAAUL,EAAahiB,GACvBjQ,GACAvN,MAAgB,KAATpC,EAAc,KAAOA,EAC5B8U,UAAWmtB,EAAQntB,WAAa8d,EAASjwB,IAAIqQ,EAAKQ,IAAQ,KAC1DyB,aAAcgtB,EAAQhtB,cAAgB2d,EAASjwB,IAAIqQ,EAAM,EAAGQ,IAAQ,KACpEgB,WAAYytB,EAAQztB,YAAcutB,EAASp/B,IAAIqQ,EAAKQ,IAAQ,KAC5DmB,YAAastB,EAAQttB,aAAeotB,EAASp/B,IAAIqQ,EAAKQ,EAAM,IAAM,KAClE0uB,SAAUl2B,SAAS4T,EAAO,aAAc,IA8B5C,OA5BAgT,GAAS/B,IAAI7d,EAAKQ,EAAK7D,EAAMmF,WAC7B8d,EAAS/B,IAAI7d,EAAM,EAAGQ,EAAK7D,EAAMsF,cACjC8sB,EAASlR,IAAI7d,EAAKQ,EAAK7D,EAAM6E,YAC7ButB,EAASlR,IAAI7d,EAAKQ,EAAM,EAAG7D,EAAMgF,aACE,iBAA/BiL,EAAO,qBAAyE,qBAA/BA,EAAO,sBACxDjQ,EAAMwyB,WAAaviB,EAAO,qBAET,iBAAjBA,EAAOiiB,OAA6C,qBAAjBjiB,EAAOiiB,QAC1ClyB,EAAMkyB,MAAQjiB,EAAOiiB,OAEQ,aAA7BjiB,EAAO,qBACPjQ,EAAM2B,WAAY,GAEM,UAAxBsO,EAAO,gBACPjQ,EAAMyyB,QAAS,GAEU,QAAzBxiB,EAAO,iBACPjQ,EAAM0yB,MAAO,GAEwB,UAArCV,EAAW/hB,EAAO,iBAClBjQ,EAAM2yB,UAAYX,EAAW/hB,EAAO,gBAEP,WAA7BA,EAAO,oBACPjQ,EAAM4yB,cAAgB3iB,EAAO,mBAEL,WAAxBA,EAAO,eACPjQ,EAAM8C,MAAO,GAEV9C,EAEX,QAAS6yB,GAAUC,GAAnB,GAGa5hC,GAGL+xB,EACAmP,EACKW,EACDtJ,EAEKuJ,EACDC,EACAC,EACAC,EAIAzhC,EACA0hC,EAKKC,EACIC,EAxBjBtzB,EAAQ2xB,IACRlD,KAAWprB,EAAM,EAAGQ,EAAM,CAC9B,KAAS3S,EAAI,EAAGA,EAAI4hC,EAAMvsB,KAAK3W,SAAUsB,EACrCu9B,EAAKv/B,QAIT,KAFI+zB,EAAW,GAAI10B,GAAM6Q,YAAY4D,KAAK0M,QAAQ6jB,OAC9CnB,EAAW,GAAI7jC,GAAM6Q,YAAY4D,KAAK0M,QAAQ6jB,OACzCR,EAAK,EAAGA,EAAKD,EAAMvsB,KAAK3W,SAAUmjC,IAAM1vB,EAG7C,IAFIomB,EAAKqJ,EAAMvsB,KAAKwsB,GACpBlvB,EAAM,EACGmvB,EAAK,EAAGA,EAAKvJ,EAAG5jB,MAAMjW,SAAUojC,EAAI,CAIzC,IAHIC,EAAKxJ,EAAG5jB,MAAMmtB,GACdE,EAAUD,EAAGC,QACbC,EAAUF,EAAGE,QACV1E,EAAKprB,GAAKQ,IACbA,GAQJ,KANInS,EAAQuhC,EAAGO,aAAa,SACxBJ,EAAgB,qBAAqB76B,KAAK7G,GAC9CqgC,EAAa/xB,EAAOqD,EAAKQ,EAAKsuB,EAAU9uB,EAAKQ,EAAKovB,EAAIhQ,EAAUmP,KAC5Dc,EAAU,GAAKC,EAAU,IAAMC,IAC/BpzB,EAAM4xB,YAAY1iC,KAAK,GAAA,GAAIX,GAAM6Q,YAAY+kB,SAAS,GAAID,GAAQ7gB,EAAKQ,GAAM,GAAIqgB,GAAQ7gB,EAAM6vB,EAAU,EAAGrvB,EAAMsvB,EAAU,KAEvHE,EAAKhwB,EAAM6vB,IAAWG,GAAMhwB,GACjC,IAASiwB,EAAKzvB,EAAMsvB,IAAWG,GAAMzvB,GAC7BwvB,EAAK5E,EAAK7+B,SACV6+B,EAAK4E,GAAIC,IAAM,EACTD,GAAMhwB,GAAOiwB,GAAMzvB,GACrBkuB,EAAa/xB,EAAOqzB,EAAIC,OAOhD,MAAOtzB,GAEX,QAASyzB,GAASp6B,GAAlB,GAKYkN,GACKwsB,EACDvJ,EACKwJ,EAPbhzB,EAAQ2xB,GACZ,IAAIt4B,EAAK+iB,QAAQ,YAAgB/iB,EAAK+iB,QAAQ,UAC1C2V,EAAa/xB,EAAO,EAAG,GAAKvN,MAAO4G,QAGnC,KADIkN,EAAOlN,EAAKvE,MAAM,MACbi+B,EAAK,EAAGA,EAAKxsB,EAAK3W,OAAQmjC,IAE/B,IADIvJ,EAAOjjB,EAAKwsB,GAAIj+B,MAAM,MACjBk+B,EAAK,EAAGA,EAAKxJ,EAAK55B,OAAQojC,IAC/BjB,EAAa/xB,EAAO+yB,EAAIC,GAAMvgC,MAAO+2B,EAAKwJ,IAItD,OAAOhzB,GAvRd,GAIO7P,GACA+zB,EACAwP,CALAnlC,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACV2vB,EAAU31B,EAAM6Q,YAAY8kB,QAC5BwP,EAAYnlC,EAAM4D,MAAMzD,QACxBC,KAAM,SAAU2Q,GACZvQ,KAAKiY,YACLjY,KAAK4kC,oBACL5kC,KAAK6kC,oBACL7kC,KAAKuQ,SAAWA,EAChBvQ,KAAK+Z,OAASva,EAAM6Q,YAAY2qB,QAChCh7B,KAAK8kC,OAAS3gC,SAASC,cAAc,UACrCpE,KAAK8kC,OAAOC,UAAY,gCACxB/kC,KAAK4Y,aAAc,EACnB5Y,KAAKglC,KAAOxlC,EAAMylC,OAClB9gC,SAASc,KAAKD,YAAYhF,KAAK8kC,SAEnC7kB,QAAS,WACL9b,SAASc,KAAKK,YAAYtF,KAAK8kC,SAEnCvrB,QAAS,WAAA,GACDhB,IAAWgB,SAAS,GACpBd,EAAYzY,KAAKuQ,SAAS8H,cAAc9I,QAY5C,OAXIkJ,KAAcjZ,EAAM6Q,YAAY2qB,UAChCziB,EAAOgB,SAAU,GAEjBd,YAAqBjZ,GAAM6Q,YAAYglB,WACvC9c,EAAOgB,SAAU,EACjBhB,EAAOmB,gBAAiB,GAExB1Z,KAAK4Y,cACLL,EAAOgB,SAAU,EACjBhB,EAAOK,aAAc,GAElBL,GAEXC,SAAU,WAAA,GACF3G,GAAQ7R,KAAKuQ,SAAS8H,cACtB3G,EAAM1R,KAAKmY,WACXxH,EAAQkB,EAAMlB,MAAMe,GACpB6G,GACAC,UAAU,EACVK,eAAe,EACfE,iBAAiB,EAkBrB,OAhBKpI,GAAMuC,WACPqF,EAAOC,UAAW,EAClBD,EAAOQ,iBAAkB,GAExBrH,EAAI4J,GAAGzJ,EAAMyrB,gBAAgB5rB,MAC9B6G,EAAOC,UAAW,EAClBD,EAAOM,eAAgB,GAEvB7Y,KAAK4Y,cACLL,EAAOC,UAAW,EAClBD,EAAOK,aAAc,IAErBlH,EAAI6kB,YAAYjiB,KAAOzC,EAAMsrB,MAAMiF,QAAU1wB,EAAI6kB,YAAYzhB,KAAOjD,EAAMirB,SAASsF,UACnF7pB,EAAOC,UAAW,EAClBD,EAAOO,UAAW,GAEfP,GAEX2sB,iBAAkB,WAAA,GAIVxzB,GAHAG,EAAQ7R,KAAKuQ,SAAS8H,aAI1B,OAHArY,MAAKqK,QACLrK,KAAK+Z,OAAS/Z,KAAKiY,SAAS8qB,QACxBrxB,EAAM1R,KAAKmY,YACPzG,EAAI4J,GAAGzJ,EAAMyrB,gBAAgB5rB,KAEzC+H,KAAM,WACF,GAAI5H,GAAQ7R,KAAKuQ,SAAS8H,aAC1BrY,MAAK+Z,OAASlI,EAAMtC,SACpBvP,KAAK6kC,iBAAmBhzB,EAAM4G,YAAYzH,iBACnChR,MAAK4kC,iBAAiB31B,WACtBjP,MAAK4kC,iBAAiBO,OAEjC3rB,IAAK,WACD,GAAI3H,GAAQ7R,KAAKuQ,SAAS8H,aAC1BrY,MAAKyZ,OACL5H,EAAMlB,MAAMkB,EAAMtC,UAAUtP,SAEhCkY,SAAU,WAAA,GAKFitB,GACAC,EACAC,EACAC,EAPA1zB,EAAQ7R,KAAKuQ,SAAS8H,aAC1B,OAAIrY,MAAK+Z,SAAWva,EAAM6Q,YAAY2qB,QAC3BnpB,EAAMtC,UAEb61B,EAAcvzB,EAAM+E,aAAa2Z,QACjC8U,EAAmBrlC,KAAK+Z,OAAOwW,QAC/B+U,EAAWD,EAAiB/wB,IAAM8wB,EAAY9wB,IAC9CixB,EAAWF,EAAiBvwB,IAAMswB,EAAYtwB,IAC3C9U,KAAK+Z,OAAO8Q,SAASya,EAAUC,EAAU,KAEpDpsB,MAAO,WAAA,GACCtH,GAAQ7R,KAAKuQ,SAAS8H,cACtBF,EAAWnY,KAAKmY,UACpBtG,GAAMlB,MAAMwH,GAAUpH,SAAS/Q,KAAKiY,SAAUjY,MAC9C6R,EAAM6G,eACFC,QAAQ,EACRjH,IAAKyG,KAGbqtB,SAAU,SAAUl7B,GAChB,MAAIA,KAASA,EAAK2E,MAAQ3E,EAAK66B,YAC3BnlC,KAAK4kC,iBAAmBt6B,GAEjBtK,KAAK4kC,kBAGpBa,WAAY,WACR,OAAQzlC,KAAK0lC,eAEjBr7B,MAAO,WAAA,GAKKC,GAEIq7B,EAIA5B,EAVR9yB,EAAQ2xB,GACR5iC,MAAK0lC,cACLz0B,EAAQjR,KAAK6kC,kBAETv6B,EAAOtK,KAAK4kC,iBACZt6B,EAAK2E,MACD02B,EAAM3lC,KAAK8kC,OAAOc,cAAczhC,SACpCwhC,EAAIrlB,OACJqlB,EAAIE,MAAMv7B,EAAK2E,MACf02B,EAAItlB,QACA0jB,EAAQ4B,EAAIG,cAAc,SAE1B70B,EADA8yB,EACQD,EAAUC,GAEVW,EAASp6B,EAAK66B,QAG1Bl0B,EAAQyzB,EAASp6B,EAAK66B,OAE1BnlC,KAAK+Z,OAAS9I,EAAM8xB,SAExB/iC,KAAKiY,SAAWhH,GAEpBy0B,YAAa,WAAA,GAILK,GACAC,CAJJ,OAAmCv4B,UAA/BzN,KAAK4kC,iBAAiB31B,OAGtB82B,IAAe3kC,EAAE,UAAU6N,KAAKjP,KAAK4kC,iBAAiB31B,MAAMg3B,KAAK,yBAA2BjmC,KAAKglC,MAAMnkC,OACvGmlC,IAAgB5kC,EAAE,UAAU6N,KAAKjP,KAAK4kC,iBAAiBO,OAAOc,KAAK,yBAA2BjmC,KAAKglC,MAAMnkC,OACtGklC,GAAgBC,MAG/BxmC,EAAM6Q,YAAYs0B,UAAYA,IAsIhCnlC,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,qBACH,aACA,oBACA,aACDD,IACL,YACG,SAAUE,GAmvBP,QAAS0mC,GAAU1lB,EAAOC,EAAK0lB,GAC3B,KAAO3lB,GAASC,GAAO0lB,EAAU3lB,IAC7BA,GAEJ,IAAIA,EAAQC,EACR,QAEJ,KAAK,GAAIte,GAAIqe,EAAQ,EAAGre,GAAKse,IAAOte,EAChC,GAAIgkC,EAAUhkC,GACV,QACQqe,MAAOA,EACPC,IAAKte,EAAI,IACVu0B,OAAOwP,EAAU/jC,EAAI,EAAGse,EAAK0lB,GAG5C,SACQ3lB,MAAOA,EACPC,IAAKA,IAQjB,QAASmR,GAAc5c,GACnB,MAAOA,GAAOxT,QAAQ,KAAM,KAAKA,QAAQ,KAAM,KAAKA,QAAQ,KAAM,SAEtE,QAAS4kC,GAAiBlkC,GACtB,OAAQ,KAAKsH,KAAKtH,IAAQ,iBAAiBsH,KAAKhK,EAAM6Q,YAAY4D,KAAK5J,MAAM,KAAM,EAAG,EAAGnI,GAAKqP,MAGlG,QAAS80B,GAAc/kC,EAAMiB,EAAO+jC,EAAY9C,EAAUzvB,GACtD,GAAImN,IACAhd,mBAAsB,EACtB3B,MAASwR,KAAS,EAAOxR,EAAQ,KAAO,OACxCgkC,aAAc/C,GAAY,IAAM,KAChCgD,cAAeF,GAAc,QAC7BG,cAAe1yB,KAAS,EAAO,WAAa,MAC5C2yB,gBAAiB3yB,KAAS,EAAO,aAAe,SAChD4yB,YAAa5yB,KAAS,EAAO,aAAe,SAEhD,OAAOvU,GAAMuB,KAAK2B,YAAYpB,EAAM4f,GAChCtc,IAAKhC,EACLvB,eAAe,IAChBmB,OAhyBV,GAIOpB,GACAi0B,EACAF,EACAC,EACAwR,EAkBAzsB,EAwvBAvX,CAjxBApD,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACV6vB,EAAW71B,EAAM6Q,YAAYglB,SAC7BF,EAAU31B,EAAM6Q,YAAY8kB,QAC5BC,EAAW51B,EAAM6Q,YAAY+kB,SAC7BwR,GACA,QACA,aACA,YACA,SACA,OACA,YACA,SACA,gBACA,aACA,SACA,OACA,SACA,YACA,cACA,eACA,cAEAzsB,EAAQ3a,EAAM4D,MAAMzD,QACpBC,KAAM,SAAU8R,EAAKG,GACjB7R,KAAKoY,OAASvG,EACd7R,KAAK2R,KAAOD,GAEhBkZ,MAAO,WACH,MAAO,IAAIzQ,GAAMna,KAAK2R,KAAKiZ,QAAS5qB,KAAKoY,SAE7CnF,gBAAiB,WAAA,GACTwjB,MACAlhB,EAAOvV,KAAM6R,EAAQ0D,EAAK6C,OAC1ByuB,EAAiBh1B,EAAMsuB,YAAYpuB,KAAKF,GACxCi1B,EAAiBj1B,EAAMuuB,eAAeruB,KAAKF,EAY/C,OAXA0D,GAAK5D,KAAKC,QAAQ,SAAUF,GAAV,GAEVkmB,GAAkBC,EAClBrgB,EACAijB,EACKt4B,EACIiM,CADb,KAJAsD,EAAM6D,EAAKwxB,WAAWr1B,EAAII,cACtB8lB,EAAKlmB,EAAI2C,QAASwjB,EAAKnmB,EAAI6kB,YAC3B/e,EAAO0uB,EAAUtO,EAAGtjB,IAAKujB,EAAGvjB,IAAKuyB,GACjCpM,EAAOyL,EAAUtO,EAAG9iB,IAAK+iB,EAAG/iB,IAAKgyB,GAC5B3kC,EAAI,EAAGA,EAAIqV,EAAK3W,SAAUsB,EAC/B,IAASiM,EAAI,EAAGA,EAAIqsB,EAAK55B,SAAUuN,EAC/BqoB,EAAKt2B,KAAK,GAAIi1B,GAAS,GAAID,GAAQ3d,EAAKrV,GAAGqe,MAAOia,EAAKrsB,GAAGoS,OAAQ,GAAI2U,GAAQ3d,EAAKrV,GAAGse,IAAKga,EAAKrsB,GAAGqS,SAIxG5O,EAAMlB,MAAM8lB,EAAK51B,OAAS,EAAI,GAAIw0B,GAASoB,GAAQA,EAAK,KAEnEsQ,WAAY,SAAUr1B,GAClB,MAAO1R,MAAKoY,OAAOijB,MAAMtD,UAAUrmB,IAEvCs1B,KAAM,SAAUl7B,EAAMpI,EAAOujC,GAAvB,GACE1xB,GAAOvV,KACP6R,EAAQ0D,EAAK6C,MAYjB,OAXA7C,GAAK5D,KAAKC,QAAQ,SAAUF,GACxBG,EAAMm1B,KAAKt1B,EAAII,aAAchG,EAAMpI,KAElCujC,GACDp1B,EAAM6G,eACFC,OAAgB,WAAR7M,GAA6B,SAARA,GAA2B,cAARA,EAChDpI,MAAOA,EACPiN,MAAO4E,EACP7D,IAAK6D,EAAK5D,OAGX4D,GAEX2xB,KAAM,SAAUp7B,GACZ,MAAO9L,MAAKoY,OAAO8uB,KAAKlnC,KAAK2R,KAAKG,aAAchG,IAEpD0E,UAAW,SAAU1E,EAAMpI,GACvB,MAAc+J,UAAV/J,EACO1D,KAAKknC,KAAKp7B,GAEV9L,KAAKgnC,KAAKl7B,EAAMpI,IAG/BA,MAAO,SAAUA,GAIb,MAHc+J,UAAV/J,GACA1D,KAAKgnC,KAAK,UAAW,MAAM,GAExBhnC,KAAKwQ,UAAU,QAAS9M,IAEnCiZ,OAAQ,SAAU+hB,GACd,GAAIhtB,GAAM1R,KAAKmnC,YAAYzI,EAC3B,OAAO,IAAIvkB,GAAMzI,EAAK1R,KAAKoY,SAE/B+uB,YAAa,SAAUzI,GACnB,MAAO1+B,MAAK2R,KAAKhO,IAAI,SAAU+N,GAC3B,MAAOA,GAAII,aAAa6K,OAAO+hB,MAGvC5qB,MAAO,SAAUpQ,EAAO7D,GAAjB,GAECunC,GAAsC5+B,EAElCovB,EAiCAlE,EACAniB,EAMY81B,EAEAC,CA3CpB,OAFAznC,GAAUuB,EAAEzB,QAAS8T,cAAc,GAAS5T,GACxCunC,EAAiBpnC,KAAKknC,KAAK,UACjBz5B,SAAV/J,GACIk0B,EAAK53B,KAAK2R,KAAKG,aAAauC,QAChC7L,EAAIhJ,EAAM6Q,YAAY4D,KAAK5J,MAAMrK,KAAKoY,OAAOtM,OAAQ8rB,EAAGtjB,IAAKsjB,EAAG9iB,IAAKpR,EAAO0jC,GAC5EpnC,KAAKoY,OAAOxD,MAAM,WAAA,GAKN2yB,GAJJ7T,EAAU,IACA,QAAVlrB,EAAE+I,KACFmiB,EAAUl0B,EAAM6Q,YAAY4D,KAAKuzB,QAAQh/B,GAChB,KAAlB4+B,GACHG,EAAqBH,GAAkB5nC,EAAM6Q,YAAYsE,WAAWpD,KAAK/I,EAAE9E,MAAO0jC,GACxE,QAAV5+B,EAAE+I,MAAwC,QAAtBg2B,EACpBvnC,KAAKgV,OAAOxM,EAAEwM,QAAU4c,EAAcpyB,EAAMizB,UAAUC,SAASC,SAAShqB,IACvD,WAAVH,EAAE+I,MAA2C,WAAtBg2B,EAC9BvnC,KAAKgV,OAAiB,IAAVxM,EAAE9E,QAA0B,IAAV8E,EAAE9E,MAAc,GAAK,KAAO,SACnD8E,EAAEwM,UACJoyB,GAAkB5+B,EAAEi/B,UAAkC,UAAtBF,GAA4C,UAAV/+B,EAAE+I,MAAoB/I,EAAEwM,OAAOnU,OAASumC,EAAevmC,SAC1Hb,KAAKgV,OAAOxM,EAAEwM,SAGL,UAAVxM,EAAE+I,OACT/I,EAAE9E,MAAQA,GAEd1D,KAAK0zB,QAAQA,EAAS7zB,EAAQ4T,cACzBigB,GACD1zB,KAAK0D,MAAM8E,EAAE9E,QAEnBqO,KAAK/R,OACH2Y,QAAQ,EACRjV,MAAOA,EACPgO,IAAK1R,KAAK2R,KACV+1B,aAAc1nC,KAAKoY,OAAOuvB,iBAEvB3nC,OAEP0D,EAAQ1D,KAAKknC,KAAK,SACdxT,EAAU1zB,KAAKknC,KAAK,WACpB31B,EAAO61B,IAAmB1T,GAAWl0B,EAAM6Q,YAAYsE,WAAWpD,KAAK7N,EAAO0jC,GAC9E1T,EACAhwB,EAAQ,IAAMgwB,EAGN0T,GAA0B,QAAR71B,IACd81B,EAAK7nC,EAAM6Q,YAAYsE,WAAWrT,KAAKoC,EAAO0jC,GAClD5+B,EAAIhJ,EAAM6Q,YAAY4D,KAAK5J,MAAM,KAAM,KAAM,KAAMg9B,EAAID,GACnDE,EAAK9nC,EAAM6Q,YAAYsE,WAAWrT,KAAKkH,EAAE9E,MAAO0jC,GAChDC,GAAMC,GACN5jC,EAAQ2jC,EAIH,SAAT91B,EACA7N,EAAQlE,EAAMk2B,SAASl2B,EAAM6Q,YAAYu3B,aAAalkC,GAAQlE,EAAMizB,UAAUC,SAASC,SAAShqB,GAChF,YAAT4I,EACP7N,EAAQlE,EAAM6Q,YAAY4D,KAAK0M,QAAQiS,eAAuB,IAARlvB,GAAe,IAC9C,gBAATA,KAAsB,QAAQ8F,KAAK9F,IAAU,oBAAoB8F,KAAK9F,IAAU0iC,EAAiB1iC,IAC/GA,EAAQ,IAAOA,EACR1D,KAAKoY,OAAOyvB,uBAAyC,gBAATnkC,IAAqBA,GAASirB,KAAK+F,MAAMhxB,KAC5FA,GAAeA,EAAPnC,IAAcC,QAAQ,IAAKhC,EAAMizB,UAAUqV,aAAa,OAGrEpkC,IAGfwP,OAAQ,SAAUxP,GACd,MAAc+J,UAAV/J,GACQlE,EAAMuB,KAAK0I,SAAS,SAAU4E,GAClCrO,KAAKoY,OAAOxG,QAAQ5R,KAAK2R,KAAM,SAAUo2B,EAAGC,EAAI19B,GACxCA,EAAK4I,UAAW,GAChB7E,GAAK,MAGdrO,MAEAA,KAAKwQ,UAAU,SAAU9M,IAEpCgwB,QAAS,SAAUhwB,EAAO+P,GAAjB,GAGGnU,GAIAoS,EANJ6D,EAAOvV,IACX,OAAcyN,UAAV/J,GACIpE,EAAIiW,EAAK2xB,KAAK,WACX5nC,EAAI,GAAKA,EAAI,OAEpBmU,GACI/B,EAAM1R,KAAK2R,KAAKG,aACpBpO,EAAQ6R,EAAK6C,OAAOzH,MAAMe,EAAI2C,SAAS2yB,KAAK,UAAWtjC,GAAOwjC,KAAK,WAC/DxjC,GACAA,EAAMukC,qBAAqBv2B,IAG/B6D,EAAKyxB,KAAK,UAAWtjC,GAElB6R,IAEX0E,yBAA0B,WACtB,GAAIvI,GAAM1R,KAAK2R,KAAKiZ,QAAQD,WAAWG,SAAS9qB,KAAKoY,OAAOtM,OAC5D,OAAOtM,GAAMuB,KAAK0I,SAAS,SAAU4E,GACjCrO,KAAKoY,OAAO8vB,aAAa,SAAU5oC,GAC/B,GAAI6I,GAAI7I,EAAE6oC,iBACNhgC,KAAMA,EAAIuJ,EAAIikB,UAAUxtB,MAAQ3I,EAAM6Q,YAAY2qB,SAClD3sB,GACIqlB,QAASp0B,EACT8oC,aAAcjgC,OAI3BnI,OAEPoT,oBAAqB,WACjB,GAAI5K,GAAIxI,KAAKia,0BACb,QAAIzR,GACOA,EAAEkrB,QAAQyU,kBAAkB7sB,GAAG9S,EAAE4/B,eAIhDhqB,WAAY,SAAU1a,GAClB,GAAc+J,SAAV/J,EAAqB,CACrB,GAAIpE,GAAIU,KAAKknC,KAAK,aAClB,OAAO5nC,GAAIA,EAAE+oC,SAAW,KAE5B,MAAOroC,MAAKwQ,UAAU,aAAc9M,IAExC4P,oBAAqB,WAAA,GAMb2wB,GAAID,EAGI5lB,EARR1M,EAAM1R,KAAK2R,KAAKG,aAChBmoB,EAAavoB,EAAI2C,QAAQC,IACzB4lB,EAAaxoB,EAAI2C,QAAQS,IACzBqlB,EAAiBzoB,EAAI6kB,YAAYjiB,IACjC8lB,EAAiB1oB,EAAI6kB,YAAYzhB,GAErC,KAAKmvB,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACxC,IAAKD,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IAExC,GADI5lB,EAAape,KAAKoY,OAAOkwB,YAAYtE,EAAIC,GACzC7lB,GAAkC,WAApBA,EAAW7M,MAAqB6M,EAAW1a,SAAU,EACnE,MAAO0a,EAInB,QAAO,GAEXrH,MAAO,WAEH,MADA/W,MAAK2R,KAAO3R,KAAKoY,OAAOmwB,OAAOvoC,KAAK2R,MAC7B3R,MAEX6W,QAAS,WACL,GAAIgsB,GAAc7iC,KAAKoY,OAAOslB,YAO9B,OANA19B,MAAK2R,KAAKC,QAAQ,SAAUF,GACxBA,EAAII,aAAa+d,aAAagT,GAAajxB,QAAQ,SAAU42B,GACzD3F,EAAY9H,OAAO8H,EAAYxV,QAAQmb,GAAY,OAG3DxoC,KAAKoY,OAAOM,kBACL1Y,MAEXuP,OAAQ,WAEJ,MADAvP,MAAKoY,OAAO7I,OAAOvP,KAAK2R,MACjB3R,MAEX+H,OAAQ,SAAUA,GAAV,GAWA2J,GACAuoB,EACAC,EACAC,EACAC,EACA6J,EAAID,EAGKyE,EAaGn0B,EAEI5Q,CAjCpB,IAAI1D,KAAK2R,eAAgB0jB,GACrB,KAAUzqB,OAAM,mCAEpB,IAAI5K,KAAK2R,OAASnS,EAAM6Q,YAAY2qB,QAAS,CACzC,GAAevtB,SAAX1F,EACA,KAAU6C,OAAM,2BAEhB,UASR,GANI8G,EAAM1R,KAAK2R,KAAKG,aAChBmoB,EAAavoB,EAAI2C,QAAQC,IACzB4lB,EAAaxoB,EAAI2C,QAAQS,IACzBqlB,EAAiBzoB,EAAI6kB,YAAYjiB,IACjC8lB,EAAiB1oB,EAAI6kB,YAAYzhB,IAEtBrH,SAAX1F,EAAsB,CAEtB,IADAA,EAAaowB,MAAMzmB,EAAIlP,UACdimC,EAAK,EAAGA,EAAK1gC,EAAOlH,OAAQ4nC,IACjC1gC,EAAO0gC,GAAUtQ,MAAMzmB,EAAInP,QAE/B,KAAK0hC,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACxC,IAAKD,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACxCj8B,EAAOi8B,EAAK/J,GAAYgK,EAAK/J,GAAcl6B,KAAKoY,OAAOlG,OAAO8xB,EAAIC,EAG1E,OAAOl8B,GAGP,IADA/H,KAAKoY,OAAO4uB,KAAKt1B,EAAK,UAAW,MAC5BuyB,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACxC,IAAKD,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACpC1vB,EAAMvM,EAAOi8B,EAAK/J,GAClB3lB,IACI5Q,EAAQ4Q,EAAI2vB,EAAK/J,GACPzsB,SAAV/J,GACA1D,KAAKoY,OAAOlG,OAAO8xB,EAAIC,EAAIvgC,GAS3C,OAJA1D,MAAKoY,OAAOM,eACRC,QAAQ,EACRjH,IAAKA,IAEF1R,MAGf0oC,YAAa,SAAUC,GAAV,GAWLj3B,GACAuoB,EACAC,EACAC,EACAC,EACA6J,EAAID,EACJnyB,EAWIvH,EAEAs+B,EAcQt0B,CA3ChB,IAAItU,KAAK2R,eAAgB0jB,GACrB,KAAUzqB,OAAM,mCAEpB,IAAI5K,KAAK2R,OAASnS,EAAM6Q,YAAY2qB,QAAS,CACzC,GAAcvtB,SAAVk7B,EACA,KAAU/9B,OAAM,2BAEhB,UAUR,GAPI8G,EAAM1R,KAAK2R,KAAKG,aAChBmoB,EAAavoB,EAAI2C,QAAQC,IACzB4lB,EAAaxoB,EAAI2C,QAAQS,IACzBqlB,EAAiBzoB,EAAI6kB,YAAYjiB,IACjC8lB,EAAiB1oB,EAAI6kB,YAAYzhB,IAEjCjD,EAAQ7R,KAAKoY,OACH3K,SAAVk7B,EAQA,MAPAA,GAAYxQ,MAAMzmB,EAAIlP,UACtBqP,EAAMD,QAAQF,EAAK,SAAU4C,EAAKQ,EAAKxK,GACnCgK,GAAO2lB,EACPnlB,GAAOolB,CACP,IAAI2O,GAAOF,EAAMr0B,KAASq0B,EAAMr0B,MAChCu0B,GAAK/zB,GAAOxK,IAETq+B,CAaP,KAVAj3B,EAAMA,EAAIkZ,QACNge,EAAU,SAAUE,GACpB,GAAIC,GAAYz+B,EAAKw+B,EACrBp3B,GAAI2C,QAAQC,IAAM5C,EAAI6kB,YAAYjiB,IAAM0vB,EACxCtyB,EAAI2C,QAAQS,IAAMpD,EAAI6kB,YAAYzhB,IAAMmvB,EACxB,SAAZ6E,GACAj3B,EAAMm1B,KAAKt1B,EAAK,UAAW,MAE/BG,EAAMm1B,KAAKt1B,EAAKo3B,EAAUC,IAEzB9E,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACxC,IAAIpyB,EAAMuuB,eAAe6D,GAGzB,IAAKD,EAAK/J,EAAY+J,GAAM7J,EAAgB6J,IACpC1vB,EAAMq0B,EAAM3E,EAAK/J,GACjB3lB,IAAQzC,EAAMsuB,YAAY6D,KAC1B15B,EAAOgK,EAAI2vB,EAAK/J,GACZ5vB,GACAtB,OAAOiY,KAAK3W,GAAMsH,QAAQg3B,GAS1C,OAJA/2B,GAAM6G,eACFC,QAAQ,EACRjH,IAAK1R,KAAK2R,OAEP3R,MAGfC,MAAO,SAAUJ,GAAV,GAECmpC,GACAn3B,EACAP,CAsBJ,OAzBAzR,GAAUA,MACNmpC,EAAWnpC,EAAQmpC,WAAahgC,OAAOiY,KAAKphB,GAASgB,OACrDgR,EAAQ7R,KAAKoY,OACb9G,GACAqH,OAAQqwB,GAAYnpC,EAAQopC,aAC5Bv3B,IAAK1R,KAAK2R,MAEdE,EAAM+C,MAAM,WACJtD,EAAOqH,QACP3Y,KAAK0zB,QAAQ,MAEbsV,GACAhpC,KAAKoe,WAAW,OAEhB4qB,GAAYnpC,EAAQqpC,cACpBtC,EAAWh1B,QAAQ,SAAUpJ,GACnB3I,EAAQspC,aAAe,WAAW3/B,KAAKhB,IACzCxI,KAAKwI,GAAG,OAEduJ,KAAK/R,OACPA,KAAKwjC,SAAS,MACdxjC,KAAK+T,KAAK,MACV/T,KAAK6W,YAEX9E,KAAK/R,MAAOsR,GACPtR,MAEXqT,aAAc,WACV,MAAOrT,MAAKC,OAAQgpC,cAAc,KAEtCG,YAAa,WACT,MAAOppC,MAAKC,OAAQipC,YAAY,KAEpCG,WAAY,WACR,OAAQrpC,KAAK6a,YAEjBA,SAAU,WAAA,GAaFyuB,GACAC,EACAC,EACAjnC,EAAcC,EACdinC,CAhBJ,IAAIzpC,KAAK2R,eAAgB0jB,GACrB,OACIjrB,KAAM,4BACNiH,QAAS,mCAGjB,IAAIrR,KAAK2R,OAASnS,EAAM6Q,YAAY2qB,QAChC,OACI5wB,KAAM,kBACNiH,QAAS,2BAGbi4B,GAAKtpC,KAAKoY,OAAOsxB,gBAAgB1pC,KAAK2R,KAAKG,cAC3Cy3B,EAAUD,EAAGC,QACbC,EAAYF,EAAGE,UACfjnC,EAAQ,KAAMC,EAAS,KACvBinC,IACJ,KACIzpC,KAAKoY,OAAOxG,QAAQ5R,KAAM,SAAUsU,EAAKQ,GAAf,GAClB5L,GAAK,GAAIisB,GAAQ7gB,EAAKQ,GAAKiW,QAC3BuV,EAASiJ,EAAQrgC,EACrB,IAAIo3B,GACA,GAAc,OAAV/9B,EACAA,EAAQ+9B,EAAO/9B,QACfC,EAAS89B,EAAO99B,aACb,IAAMD,GAAS+9B,EAAO/9B,SAAWC,GAAU89B,EAAO99B,SACrD,KAAMinC,OAEP,KAAKD,EAAUtgC,IAAOogC,EAAGK,UAC5B,KAAMF,KAGhB,MAAO7/B,GACL,GAAIA,IAAO6/B,EACP,KAAM7/B,EAEV,QACIQ,KAAM,qBACNiH,QAAS,+DAGjB,OAAO,GAEXtP,KAAM,SAAUyxB,GACZ,GAAIliB,GAAStR,KAAK6a,UAClB,IAAIvJ,EACA,KAAU1G,OAAM0G,EAAOD,QAe3B,OAba5D,UAAT+lB,IACAA,GAAS9Y,OAAQ,IAErB8Y,EAAOA,YAAgB2E,OAAQ3E,GAAQA,GACvCxzB,KAAKoY,OAAOwxB,QAAQ5pC,KAAK2R,KAAKG,aAAc0hB,EAAK7vB,IAAI,SAAU6vB,EAAM/oB,GAIjE,MAHoB,gBAAT+oB,KACPA,GAAS9Y,OAAQ8Y,KAGjB/oB,MAAuBgD,SAAhB+lB,EAAK9Y,OAAuBjQ,EAAQ+oB,EAAK9Y,OAChDC,UAA8BlN,SAAnB+lB,EAAK7Y,WAAiC6Y,EAAK7Y,cAGvD3a,MAEX6pC,aAAc,WACV,QAAS7pC,KAAK2R,eAAgB0jB,KAElC9a,OAAQ,SAAUiZ,GACd,GAAIxzB,KAAK2R,eAAgB0jB,GACrB,KAAUzqB,OAAM,mCAapB,OAXI4oB,MAAS,EACTxzB,KAAK8pC,gBAELtW,EAAOA,KAAS,KAAYA,YAAgB2E,OAAQ3E,GAAQA,GAC5DxzB,KAAKoY,OAAO2xB,UAAU/pC,KAAK2R,KAAKG,aAAc0hB,EAAK7vB,IAAI,SAAU6vB,EAAM/oB,GACnE,OACIA,MAAuBgD,SAAhB+lB,EAAK9Y,OAAuBjQ,EAAQ+oB,EAAK9Y,OAChDH,OAAQiZ,EAAKjZ,YAIlBva,MAEX+a,YAAa,SAAUyY,GACnBxzB,KAAKoY,OAAO2C,YAAYyY,IAE5BsW,aAAc,WAAA,GAIG3nC,GAHToY,EAASva,KAAKoY,OAAOmC,SACrBiZ,IACJ,IAAIjZ,EAAQ,CACR,IAASpY,EAAI,EAAGA,EAAIoY,EAAO9C,QAAQ5W,OAAQsB,IACvCqxB,EAAKrzB,KAAKoa,EAAO9C,QAAQtV,GAAGsI,MAEhCzK,MAAKoY,OAAOxD,MAAM,WACd5U,KAAK+a,YAAYyY,GACjBxzB,KAAKgqC,QAAU,OAEfvtB,QAAQ,EACRlC,QAAQ,MAIpBC,UAAW,WACP,GAAID,GAASva,KAAKoY,OAAOmC,QACzB,SAASA,GAEb1E,WAAY,WACR,MAAO,IAAIsE,GAAMna,KAAK2R,KAAKkE,aAAc7V,KAAKoY,SAElDpC,YAAa,WACT,MAAO,IAAImE,GAAMna,KAAK2R,KAAKqE,cAAehW,KAAKoY,SAEnDjC,OAAQ,WACJ,MAAO,IAAIgE,GAAMna,KAAK2R,KAAKwE,SAAUnW,KAAKoY,SAE9C9B,UAAW,WACP,MAAO,IAAI6D,GAAMna,KAAK2R,KAAK2E,YAAatW,KAAKoY,SAEjDsC,OAAQ,SAAUA,GACd,MAAO,IAAIP,GAAMna,KAAK2R,KAAKmkB,SAASpb,GAAS1a,KAAKoY,SAEtD9D,IAAK,SAAUA,GACX,MAAO,IAAI6F,GAAMna,KAAK2R,KAAKkkB,MAAMvhB,GAAMtU,KAAKoY,SAEhDhE,WAAY,SAAU3C,GAClBzR,KAAK2R,KAAKyC,WAAW,SAAU1C,GAC3BD,EAAS,GAAI0I,GAAMzI,EAAK1R,KAAKoY,UAC/BrG,KAAK/R,QAEXkX,cAAe,SAAUzF,GACrBzR,KAAK2R,KAAKuF,cAAc,SAAUxF,GAC9BD,EAAS,GAAI0I,GAAMzI,EAAK1R,KAAKoY,UAC/BrG,KAAK/R,QAEX6R,MAAO,WACH,MAAO7R,MAAKoY,QAEhB/D,QAAS,WACL,MAAOrU,MAAK2R,KAAKG,aAAauC,SAElC41B,mBAAoB,WAAA,GACZp4B,GAAQ7R,KAAKoY,OACbyqB,IAMJ,OALAhxB,GAAM6rB,aAAa9rB,QAAQ,SAAUF,GAC7BA,EAAIqe,WAAW/vB,KAAK2R,OACpBkxB,EAAY1iC,KAAKuR,GAAAA,IAEvBK,KAAK/R,OACA6iC,GAEX7xB,SAAU,SAAUk5B,GAAV,GAQF5W,GAmBAhpB,EA1BA+J,EAAUrU,KAAK2R,KAAK4e,QACpBtf,GACAS,IAAK2C,EACL/J,QACAy4B,QAAS/iC,KAAK2R,KACd6F,KAAMxX,KAAKoY,OAAO+kB,MAAMnsB,WAsC5B,OAnCKk5B,GAID5W,EADwB,UAAjB4W,GAEH,QACA,WAEoB,WAAjBA,GAEH,aACA,YACA,cACA,iBAGUA,IAfd5W,EAAa9zB,EAAM6Q,YAAYikB,eAC/BrjB,EAAM4xB,YAAc7iC,KAAKiqC,sBAgBzB3/B,EAAO2G,EAAM3G,KACjBtK,KAAK6U,YAAY,SAAUP,EAAKQ,EAAKC,GAApB,GACTquB,MACAkB,EAAKhwB,EAAMD,EAAQC,IACnBiwB,EAAKzvB,EAAMT,EAAQS,GAClBxK,GAAKg6B,KACNh6B,EAAKg6B,OAETh6B,EAAKg6B,GAAIC,GAAMnB,EACf9P,EAAW1hB,QAAQ,SAAUnB,GACzB,GAAI/M,GAAiC,SAAlBqR,EAAKtE,GAA2B,KAAOsE,EAAKtE,IAC3D/M,YAAiBlE,GAAM6Q,YAAY4D,KAAK0M,QAAQwpB,SAAWzmC,YAAiBlE,GAAM6Q,YAAY+N,WAAWgsB,cACzG1mC,EAAQA,EAAMouB,aAElBsR,EAAU3yB,GAAY/M,MAGvBuN,GAEXF,SAAU,SAAUE,EAAO4G,GAAjB,GACFhG,GAAQ7R,KAAKoY,OACb2B,EAAS/Z,KAAK2R,KAAK4e,QACnB+U,EAAWr0B,EAAMS,IAAI4C,IAAMyF,EAAOzF,IAClCixB,EAAWt0B,EAAMS,IAAIoD,IAAMiF,EAAOjF,IAClCu1B,EAAoBxyB,IAAcA,EAAU4tB,aAC5C6E,EAAoBzyB,IAAcwyB,CACtCx4B,GAAM+C,MAAM,WAAA,GAOJN,GACAkG,CAPAvJ,GAAM4xB,aACN7iC,KAAK6W,UAEJgB,GACD7X,KAAKoY,OAAO+kB,MAAMpsB,SAASE,EAAMuG,MAEjClD,EAAMyF,EAAOzF,IACbkG,EAAYxa,KAAKwa,YACrBvJ,EAAM3G,KAAKsH,QAAQ,SAAUtH,EAAMg6B,GAC/B,KAAI9pB,GAAa6vB,GAAqBx4B,EAAMsuB,YAAYlvB,EAAMS,IAAI4C,IAAMgwB,IAAxE,CAGA,GAAIxvB,GAAMiF,EAAOjF,GACjBxK,GAAKsH,QAAQ,SAAUwxB,EAAWmB,GAArB,GAIL5zB,GAESF,CALb,MAAI+J,GAAa6vB,GAAqBx4B,EAAMuuB,eAAenvB,EAAMS,IAAIoD,IAAMyvB,IAA3E,CAIA,GADI5zB,EAAQkH,EAAYhG,EAAMlB,MAAM2D,EAAKQ,GAAOjD,EAAMlB,MAAMoJ,EAAOzF,IAAMgwB,EAAIvqB,EAAOjF,IAAMyvB,GACtF5zB,EAAMuC,SAAU,CAChB,IAASzC,IAAY2yB,GACD,SAAZ3yB,IACMoH,GAAyB,UAAZpH,GACfE,EAAMq2B,KAAKv2B,EAAU2yB,EAAU3yB,IAI3C,KAAK2yB,EAAU1P,QACX,GAAI4W,EACA,IAC2B,MAAnBlH,EAAU1/B,MACViN,EAAMq2B,KAAK,QAAS,MAEpBr2B,EAAMmD,MAAMsvB,EAAU1/B,OAE5B,MAAOkG,GACL+G,EAAMq2B,KAAK,QAAS5D,EAAU1/B,WAGlCiN,GAAMq2B,KAAK,QAAS5D,EAAU1/B,OAI1CoR,OAEJR,OAEArD,EAAM4xB,aACN5xB,EAAM4xB,YAAYjxB,QAAQ,SAAU0uB,GAChCA,EAASzuB,EAAMF,KAAK2uB,GAAQzV,SAASya,EAAUC,EAAU,GACzD1zB,EAAMlB,MAAM2vB,GAAQvpB,SACrB/W,OAET+R,KAAK/R,OACH2Y,QAAQ,EACRjH,IAAK1R,KAAK2R,QAGlBqC,iBAAkB,WAAA,GACVnC,GAAQ7R,KAAKoY,OACbkxB,EAAKz3B,EAAM63B,gBAAgB1pC,KAAK2R,KAAKG,cACrCy3B,EAAUD,EAAGC,QACbC,EAAYF,EAAGE,SACnBxpC,MAAKoU,WAAW,SAAUgpB,GAAV,GACR9oB,GAAM8oB,EAASzrB,KAAK0C,QAAQC,IAC5B9R,EAASqP,EAAMS,UAAUgC,EAC7B8oB,GAASvoB,YAAY,SAAUP,EAAKQ,EAAKC,GAApB,GAKburB,GACA/9B,EAMA+H,EAIAigC,EAfArhC,EAAK,GAAIisB,GAAQ7gB,EAAKQ,GAAKiW,OAC3Bye,GAAUtgC,KAGVo3B,EAASiJ,EAAQrgC,GAGjB3G,EADA+9B,EACQzuB,EAAMirB,SAAS0N,IAAIlK,EAAOjsB,QAAQS,IAAKwrB,EAAO/J,YAAYzhB,KAE1DjD,EAAMO,YAAY0C,GAE1BxK,EAAOyK,EAAKrR,MACZqR,EAAKC,QAAkB,MAAR1K,IACfA,EAAO9K,EAAM6Q,YAAYsE,WAAWK,OAAO1K,EAAMyK,EAAKC,SAEtDu1B,EAAa/qC,EAAM6Q,YAAYtP,KAAKslC,cAAc/7B,EAAM/H,EAAOwS,EAAKuxB,WAAYvxB,EAAKyuB,SAAUzuB,EAAKhB,MACxGvR,EAASmsB,KAAKoK,IAAIv2B,EAAQ+nC,MAE9B14B,EAAMS,UAAUgC,EAAK9R,MAG7BqS,YAAa,SAAUpD,GACnBzR,KAAK2R,KAAKC,QAAQ,SAAUF,GACxB1R,KAAKoY,OAAOxG,QAAQF,EAAII,aAAcL,EAASM,KAAK/R,QACtD+R,KAAK/R,QAEXyqC,SAAU,WACN,GAAIC,GAAW1qC,KAAKoY,OAAOuyB,iBAC3B,OAAOnrC,GAAMuB,KAAK0I,SAAS,SAAU4E,GACjCrO,KAAK6U,YAAY,SAAUP,EAAKQ,EAAKC,GAApB,GACJlT,GACDuN;AADR,IAASvN,IAAOkT,GACR3F,EAAM2F,EAAKlT,GACH4L,SAAR2B,GAA6B,OAARA,GAAgBA,IAAQs7B,EAAS7oC,IACtDwM,GAAK,MAIlBrO,OAEP+T,KAAM,SAAU62B,GACZ,MAAan9B,UAATm9B,IACS5qC,KAAKwQ,UAAU,SAE5BxQ,KAAKwQ,UAAU,OAAQo6B,GACV,OAATA,GACA5qC,KAAKgU,mBAEFhU,OAEXwjC,SAAU,SAAUngC,GAChB,MAAaoK,UAATpK,EACOrD,KAAKwQ,UAAU,aAE1BxQ,KAAKwQ,UAAU,WAAYnN,GACd,OAATA,GACArD,KAAKgU,mBAEFhU,OAEX6qC,KAAM,SAAUhrC,EAAS4R,GACrBzR,KAAKoY,OAAOyyB,KAAK7qC,KAAMH,EAAS4R,IAEpCgE,cAAe,SAAU/R,GACrB,MAAO1D,MAAKyW,sBAAsB/S,GAAO8S,wBAAwB9S,IAErE+S,sBAAuB,SAAU/S,GAQ7B,MAPA1D,MAAK2R,KAAKC,QAAQ,SAAUF,GACpBA,YAAe0jB,IAAY1jB,EAAInP,QAAU,IACzCmP,EAAMA,EAAIkZ,QACVlZ,EAAI2C,QAAQS,MACZ9U,KAAKoY,OAAOzH,MAAMe,GAAKs1B,KAAK,WAAYtjC,KAE7C1D,MACIA,MAEXwW,wBAAyB,SAAU9S,GAQ/B,MAPA1D,MAAK2R,KAAKC,QAAQ,SAAUF,GACpBA,YAAe0jB,IAAY1jB,EAAIlP,SAAW,IAC1CkP,EAAMA,EAAIkZ,QACVlZ,EAAI2C,QAAQC,MACZtU,KAAKoY,OAAOzH,MAAMe,GAAKs1B,KAAK,WAAYtjC,KAE7C1D,MACIA,QAuBfoB,EAAE0pC,KAAKlE,EAAY,SAAUzkC,EAAGsO,GAC5B0J,EAAMnH,UAAUvC,GAAY,SAAU/M,GAClC,MAAO1D,MAAKwQ,UAAUC,EAAU/M,MASpCd,EAAaxB,EAAE,sSAAqT,GAgBxU5B,EAAM6Q,YAAYtP,MAASslC,cAAeA,GAC1C7mC,EAAM6Q,YAAY8J,MAAQA,IAC5BhX,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,uBAAwB,0BAA2BD,IAC5D,WACE,YAcA,SAASyrC,GAAU3gC,GACf,MAAIA,aAAgB2gC,GACT3gC,OAEXpK,KAAKoK,KAAOA,GAgchB,QAAS4gC,GAAO7oC,EAAGse,EAAKnhB,GAEpB,IAFJ,GAGYgJ,GAFJywB,EAAMz5B,EAAE6C,GAAIyD,EAAMzD,IACbA,EAAIse,GACLnY,EAAIhJ,EAAE6C,GACNmG,EAAIywB,IACJA,EAAMzwB,EACN1C,EAAMzD,EAGd,OAAOyD,GAiKX,QAASqlC,GAAQ5U,EAAIC,GACjB,GAAID,EAAG6U,cAAgB5U,EAAG4U,YACtB,OAAO,CAEX,IAAI7U,YAAclB,GACd,MAAOkB,GAAGxkB,OAASykB,EAAGzkB,OAASwkB,EAAG/hB,KAAOgiB,EAAGhiB,KAAO+hB,EAAGvhB,KAAOwhB,EAAGxhB,KAAOuhB,EAAGxB,KAAOyB,EAAGzB,GAExF,IAAIwB,YAAcjB,GACd,MAAO6V,GAAQ5U,EAAGhiB,QAASiiB,EAAGjiB,UAAY42B,EAAQ5U,EAAGE,YAAaD,EAAGC,cAAgBF,EAAGyB,UAAYxB,EAAGwB,QAE3G,IAAIzB,YAAchB,GAAU,CACxB,GAAIlzB,GAAIk0B,EAAGI,KAAK51B,MAChB,IAAIsB,GAAKm0B,EAAGG,KAAK51B,OACb,OAAO,CAEX,QAASsB,GAAK,GACV,IAAK8oC,EAAQ5U,EAAGI,KAAKt0B,GAAIm0B,EAAGG,KAAKt0B,IAC7B,OAAO,EAInB,OAAO,EAuCX,QAASgpC,GAAsBC,EAAcC,GAqBzC,QAASC,GAAK9iC,GAAd,GAEQ4B,GAyBImH,EAEIg6B,EACAtlC,EA4BAulC,CAWZ,OApEA1/B,GAAOtD,EAAE,GACL4B,EAAO,KACP+tB,MAAMsT,QAAQ3/B,IACd4/B,GAAa,6BACbC,GAAW,6BACXvhC,GAAQ,yDACRA,GAAQ,6BACRA,GAAQ5B,EAAE7E,IAAI2nC,GAAMtpC,KAAK,IACzBoI,GAAQ,KACRA,GAAQ,wBACRuhC,GAAW,KACXD,GAAa,MACE,KAAR5/B,GACP4/B,GAAa,6BACbC,GAAW,6BACXvhC,GAAQ,sDACRA,GAAQ,yDACRA,GAAQ,QACRA,GAAQ5B,EAAElI,MAAM,GAAGqD,IAAI2nC,GAAMtpC,KAAK,IAClCoI,GAAQ,8BACRA,GAAQ,wBACRuhC,GAAW,KACXD,GAAa,MACE,KAAR5/B,EACP1B,GAAQ,SAAWwhC,EAAKpjC,EAAE,IAAM,kCAE5B+I,EAAO/I,EAAE,GACT2vB,MAAMsT,QAAQl6B,IAAS,aAAa/H,KAAK+H,EAAK,KAC1Cg6B,EAAY,KAAK/hC,KAAK+H,EAAK,IAC3BtL,EAAIsL,EAAK,GACbs6B,IACAzhC,GAAQ,aAAoB0B,EAAO,kCAC/B7F,IACAmE,GAAQ,SAAWnE,GAEvBmE,GAAQ,KAAOmhC,EAAY,QAAU,IAAM,2BAA6Bz/B,EAAO,MACtD,KAArByF,EAAK,GAAG1I,OAAO,KACfuB,GAAQ,QAAU0B,EAAO,iCAAmCA,EAAO,MAEvE1B,GAAQ,OAASwhC,EAAKr6B,EAAK,IAAM,eAAiBzF,EAAO,MACzD1B,GAAQ,eACRA,GAAQ,sBAEJA,GADAnE,EACQ,QAAUA,EAAI,KAEd,oBAEZmE,GAAQ,eAAiB0B,EAAO,sEAChC6/B,GAAW,mCACI,QAARp6B,EACPnH,GAAQ,iDAEJ0hC,EAAgB,MAAMtiC,KAAKsC,MAC3BigC,GAAe,EACfjgC,EAAOA,EAAKmc,OAAO,IAEvB7d,GAAQ,QAAU0B,EAAO,iBACrB0/B,GAAa,EACb,KAAKhiC,KAAK+H,IACVA,EAAOA,EAAK0W,OAAO,EAAG1W,EAAK1Q,OAAS,GACpC2qC,GAAa,GAEbphC,GAAQ,QAAU0B,EAAO,kCAAoCA,EAAO,KAExE1B,GAAQ4hC,EAAUz6B,EAAMi6B,GAAc,eAAiB1/B,EAAO,QAGtE1B,GAAQ,KAGZ,QAASyhC,KACL,MAAII,GACO,IAAMngC,GAEjBogC,GAAa,EACbD,GAAS,EACTN,GAAW,8BACJ,KAAO7/B,EAAO,kBAAoBA,EAAO,MAEpD,QAASqgC,GAASC,GACd,MAAO,KAAOA,EAAQ,WAAaP,IAAU,oBAAwB//B,EAAO,aAAeA,EAAO,wBAA0B,WAAa+/B,IAAU,qBAAyB,YAAc//B,EAAO,qBAAyBA,EAAO,QAAUA,EAAO,gCAAuCA,EAAO,+CAAmDA,EAAO,qDAA4DA,EAAO,iDAAwDA,EAAO,0CAEhe,QAASkgC,GAAUz6B,EAAMi6B,GACrBS,GAAS,CACT,IAAIjY,GAAM,SAAW4X,EAAKr6B,GAAQ,OAalC,OAZI06B,KAAWT,IACXxX,GAAO,SAAWloB,EAAO,kCAAoCA,EAAO,MAExEkoB,GAAO,gCACFiY,IACDN,GAAW,SAGXD,GADAI,EACa,QAAUhgC,EAAO,oCAA2CA,EAAO,mBAA0BA,EAAO,+BAAsCA,EAAO,uCAA8CA,EAAO,wFAEtM,8CAEVkoB,EAEX,QAAS4X,GAAKr6B,GACV,GAAI4mB,MAAMsT,QAAQl6B,GAAO,CACrB,GAAe,MAAXA,EAAK,GACL,MAAO,IAAMA,EAAKjR,MAAM,GAAGqD,IAAIioC,GAAM5pC,KAAK,UAAY,GAE1D,IAAe,OAAXuP,EAAK,GACL,MAAO,IAAMA,EAAKjR,MAAM,GAAGqD,IAAIioC,GAAM5pC,KAAK,UAAY,GAE1D,IAAe,UAAXuP,EAAK,GACL,MAAO,IAAMA,EAAKjR,MAAM,GAAGqD,IAAI,SAAUyL,GACrC,MAAOy8B,KAAU,QAAUz8B,IAC5BpN,KAAK,UAAY,GAExB,IAAe,QAAXuP,EAAK,GACL,MAAO,IAAMq6B,EAAK,QAAU,SAAW9/B,EAAO,MAAQyF,EAAK,GAAK,mBAEpE,IAAe,WAAXA,EAAK,IAA8B,aAAXA,EAAK,GAC7B,MAAO,IAAMs6B,IAAU,OAASt6B,EAAK,GAAK,QAAezF,EAAO,OAASyF,EAAK,GAAK,mCAEvF,IAAe,aAAXA,EAAK,GACL,MAAO,IAAMs6B,IAAU,MAAQt6B,EAAK,GAAK,QAAezF,EAAO,MAAQyF,EAAK,GAAK,mCAErF,IAAe,aAAXA,EAAK,GACL,MAAO,IAAMs6B,IAAU,MAAQt6B,EAAK,GAAK,QAAezF,EAAO,OAASyF,EAAK,GAAK,mCAEtF,IAAe,aAAXA,EAAK,GACL,MAAO,IAAMs6B,IAAU,OAASt6B,EAAK,GAAK,QAAezF,EAAO,MAAQyF,EAAK,GAAK,mCAEtF,IAAe,UAAXA,EAAK,GAAgB,CACrB,GAAI86B,GAAM96B,EAAK,IAAM,KACrB,OAAO,KAAOA,EAAK,GAAK,qBAAuB8gB,KAAKC,UAAU+Z,GAAO,YAEzE,GAAe,OAAX96B,EAAK,GACL,MAAO,KAAOq6B,EAAKr6B,EAAK,IAAM,GAElC,MAAU3G,OAAM,iCAAmC2G,EAAK,IAE5D,GAAY,UAARA,GAA4B,YAARA,EACpB,MAAO46B,IAAS,EAEpB,IAAY,WAAR56B,EACA,MAAO,WAAas6B,IAAU,oBAAwB//B,EAAO,aAAeA,EAAO,mBAEvF,IAAY,WAARyF,GAA6B,QAARA,EACrB,MAAO,IAAM46B,IAAa,UAAYrgC,EAAO,gBAEjD,IAAY,WAARyF,EACA,MAAO,IAAM46B,GAAS,GAAQ,SAAWrgC,EAAO,2CAEpD,IAAY,WAARyF,EACA,MAAO,IAAM46B,GAAS,GAAQ,SAAWrgC,EAAO,yCAEpD,IAAY,YAARyF,EACA,MAAO,IAAM46B,IAAa,UAAYrgC,EAAO,+CAEjD,IAAY,YAARyF,EACA,MAAO,IAAM46B,GAAS,GAAQ,SAAWrgC,EAAO,wCAEpD,IAAY,aAARyF,EACA,MAAO,IAAM46B,IAAa,UAAYrgC,EAAO,8CAEjD,IAAY,UAARyF,EACA,MAAO,YAAcs6B,IAAU,2BAA+B//B,EAAO,4BAAgCA,EAAO,qBAAyBA,EAAO,qBAAyBA,EAAO,uBAAyBA,EAAO,yBAEhN,IAAY,WAARyF,EACA,MAAO,WAAas6B,IAAU,gBAElC,IAAY,WAARt6B,EACA,MAAO,WAAas6B,IAAU,6BAAiC//B,EAAO,oBAAwBA,EAAO,SAAWA,EAAO,mBAE3H,IAAY,UAARyF,EAEA,MADAs6B,KACO,wBAA0B//B,EAAO,UAAYA,EAAO,gBAE/D,IAAY,WAARyF,EACA,MAAO,wBAA0BzF,EAAO,UAAYA,EAAO,gBAE/D,IAAY,OAARyF,EACA,MAAO,KAAOzF,EAAO,oCAEzB,IAAY,QAARyF,EACA,MAAO,KAAOzF,EAAO,6CAA+CA,EAAO,yCAE/E,IAAY,QAARyF,EACA,MAAO,KAAOzF,EAAO,wCAEzB,IAAY,QAARyF,EACA,MAAO,IAAMs6B,IAAU,WAE3B,IAAY,YAARt6B,EACA,MAAO,IAAMs6B,IAAU,+BAE3B,IAAY,UAARt6B,EACA,MAAO,IAAMs6B,IAAU,qBAE3B,IAAY,YAARt6B,EACA,MAAO,oBAEX,IAAY,SAARA,EACA,MAAO,IAAMs6B,IAAU,gBAAkB//B,EAAO,UAEpD,MAAUlB,OAAM,yBAA4B2G,GA9NpD,GAGQzF,GAAMmgC,EAMN3sC,EARAosC,EAAY,yFACZC,EAAU,iEACIW,EAAO,kGAAuGJ,GAAa,EACzIJ,GAAgB,EAAOC,GAAe,CAgB1C,OAfAO,IAAQjB,EAAK1nC,IAAI2nC,GAAMtpC,KAAK,IAC5BsqC,GAAQ,qDACRA,GAAQ,mBACRZ,GAAa,2EAETQ,GACAP,GAAW,6CACXrsC,EAAQitC,SAAS,YAAa,QAASD,EAAOX,EAAUD,EAAY,sEAEpEpsC,EAAQitC,SAAS,YAAa,QAASD,EAAO,6BAElDhtC,EAAIA,EAAEyrC,EAAWnY,GACZmZ,SACMzsC,GAAEosC,UAENpsC,EA6MX,QAASszB,GAAe0H,GACpB,MAAOA,KAAQhtB,SAASgtB,EAAK,IAAMA,GAAOA,EAAIkS,YAAY,IAE9D,QAASC,GAAsBnS,GAC3B,MAAkB,gBAAPA,GACA1H,EAAe0H,GAEfA,EAGf,QAASoS,GAAkBhjC,EAAKpK,EAAG+rC,GAC/B,GAAIA,YAAgBN,GAChB,MAAOM,EAEX,KACI,MAAO/rC,GAAE8J,MAAMM,EAAK2hC,GACtB,MAAOzhC,GACL,GAAIA,YAAcmhC,GACd,MAAOnhC,EAEP,MAAMA,IAIlB,QAAS+iC,GAAiBthB,EAASsgB,EAASiB,EAAOlB,GAC/C,MAAO,UAAUj6B,EAAU45B,GACvB,QAASwB,KAAT,GAEYrkC,GAGI3C,EACKyO,EACIQ,EAgBjBg4B,EAdqB3qC,CARzB,IAAIupC,IACIljC,EAAIkjC,EAAU3rC,KAAKC,KAAMqrC,GAC7BA,EAAO7iC,EAAE6iC,KACL7iC,EAAEjG,MAAQ,GAAKiG,EAAEhG,OAAS,GAAG,CAE7B,IADIqD,EAAS,GAAI2+B,GAAOxkC,MACfsU,EAAM,EAAGA,EAAM9L,EAAEhG,SAAU8R,EAChC,IAASQ,EAAM,EAAGA,EAAMtM,EAAEjG,QAASuS,EAAK,CAEpC,IADIg4B,KACK3qC,EAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAE3B2qC,EAAM3qC,GADNqG,EAAEukC,OAAO5qC,GACEkpC,EAAKlpC,GAAG6qC,MAAM14B,EAAKQ,GAEnBu2B,EAAKlpC,EAGxB2qC,GAAQF,EAAM7sC,KAAKC,KAAM8sC,GACzBjnC,EAAOssB,IAAI7d,EAAKQ,EAAK43B,EAAkB1sC,KAAMqrB,EAASyhB,IAG9D,MAAOr7B,GAAS5L,GAGpBinC,EAAQF,EAAM7sC,KAAKC,KAAMqrC,GAC7B55B,EAASi7B,EAAkB1sC,KAAMqrB,EAASyhB,IAE1CnB,EACAA,EAAQ5rC,KAAKC,KAAMqrC,EAAMwB,GAEzBA,EAAK9sC,KAAKC,OAItB,QAASitC,GAAkB5hB,EAASsgB,EAASiB,EAAOlB,GAChD,MAAO,UAAUj6B,EAAU45B,GACvB,QAASwB,KAAT,GA0CQrkC,GArCQ3C,EACA0X,EACA2vB,EASK54B,EACIQ,EACDg4B,EACK3qC,CAlBzB,IAAIupC,IACIljC,EAAIkjC,EAAU3rC,KAAKC,KAAMqrC,GAC7BA,EAAO7iC,EAAE6iC,KACL7iC,EAAEjG,MAAQ,GAAKiG,EAAEhG,OAAS,GAY1B,IAXIqD,EAAS,GAAI2+B,GAAOxkC,MACpBud,EAAQ/U,EAAEjG,MAAQiG,EAAEhG,OACpB0qC,EAAe,SAAU54B,EAAKQ,GAC9B,MAAO,UAAUpR,GAGb,GAFAmC,EAAOssB,IAAI7d,EAAKQ,EAAKpR,KACnB6Z,EACY,IAAVA,EACA,MAAO9L,GAAS5L,KAInByO,EAAM,EAAGA,EAAM9L,EAAEhG,QAAU+a,EAAQ,IAAKjJ,EAC7C,IAASQ,EAAM,EAAGA,EAAMtM,EAAEjG,OAASgb,EAAQ,IAAKzI,EAAK,CAEjD,IADIg4B,KACK3qC,EAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAE3B2qC,EAAM3qC,GADNqG,EAAEukC,OAAO5qC,GACEkpC,EAAKlpC,GAAG6qC,MAAM14B,EAAKQ,GAEnBu2B,EAAKlpC,EAIxB,IADA2qC,EAAQF,EAAM7sC,KAAKC,KAAM8sC,GACrBA,YAAiB/B,IAGjB,GAFAllC,EAAOssB,IAAI7d,EAAKQ,EAAKg4B,KACnBvvB,EACY,IAAVA,EACA,MAAO9L,GAAS5L,OAGpBinC,GAAM5gB,QAAQghB,EAAa54B,EAAKQ,IAChCuW,EAAQjiB,MAAMpJ,KAAM8sC,OAOpCtkC,GAAIokC,EAAM7sC,KAAKC,KAAMqrC,GACrB7iC,YAAauiC,GACbt5B,EAASjJ,IAETA,EAAE0jB,QAAQza,GACV4Z,EAAQjiB,MAAMpJ,KAAMwI,IAGxBmjC,EACAA,EAAQ5rC,KAAKC,KAAMqrC,EAAMwB,GAEzBA,EAAK9sC,KAAKC,OAItB,QAASmtC,GAAerhC,EAAMshC,GAG1B,MAFAthC,GAAOA,EAAKvD,cACZqY,EAAM9U,GAAQshC,GAEV/B,KAAM,SAAUA,EAAMgC,GAAhB,GAaE/tC,GAZA8K,EAAO+gC,EAAsBr/B,EAAMu/B,EAcvC,OAbIgC,KACIjjC,EAAKshC,WACL4B,QAAQD,IAAIjjC,GAAAA,EAAKshC,WAEjBthC,EAAKuhC,SACL2B,QAAQD,IAAIjjC,GAAAA,EAAKuhC,SAEjBvhC,EAAKwiC,OACLU,QAAQD,IAAIjjC,GAAAA,EAAKwiC,QAGrBttC,EAAIshB,EAAM9U,GAAQ6gC,EAAiBS,EAAMhjC,EAAKuhC,QAASvhC,EAAKwiC,MAAOxiC,EAAKshC,WAC5EpsC,EAAEiuC,qBAAuBlC,EAClBrrC,MAEXwtC,UAAW,SAAUnC,EAAMgC,GAAhB,GAaH/tC,GAZA8K,EAAO+gC,EAAsBr/B,EAAMu/B,EAcvC,OAbIgC,KACIjjC,EAAKshC,WACL4B,QAAQD,IAAIjjC,GAAAA,EAAKshC,WAEjBthC,EAAKuhC,SACL2B,QAAQD,IAAIjjC,GAAAA,EAAKuhC,SAEjBvhC,EAAKwiC,OACLU,QAAQD,IAAIjjC,GAAAA,EAAKwiC,QAGrBttC,EAAIshB,EAAM9U,GAAQmhC,EAAkBG,EAAMhjC,EAAKuhC,QAASvhC,EAAKwiC,MAAOxiC,EAAKshC,WAC7EpsC,EAAEiuC,qBAAuBlC,EAClBrrC,OAInB,QAASytC,GAAiBhf,EAAG7lB,EAAGD,GAE5B,MADAC,MACQ,MAAQ6lB,EAAI,OAAS7lB,EAAI,IAAM,GAAK,IAAM,EAAI,IAAM,KAAOA,EAAI,EAAI,KAAOA,EAAI,IAAM,GAAK,IAAM,GAAK,IAAM,IAAM6lB,EAAI,OAAS7lB,EAAI,IAAM,GAAK,IAAM,IAAM,GAAK,EAAI,GAAKD,EAAI,MAEtL,QAAS+kC,GAAiBC,GACtB,GAAIllC,GAAGxC,EAAGmI,EAAGjM,EAAGyG,EAAGD,EAAG8lB,CAYtB,OAXAhmB,GAAIklC,EAAK,MACT1nC,EAAI,EAAIwC,EAAI,OAAS,EACrBA,IAAU,OAASxC,EAAI,GAAK,EAAI,EAChC9D,EAAI,KAAQsG,EAAI,GAAK,QAAU,EAC/BA,EAAIA,GAAK,KAAOtG,EAAI,EAAI,GAAK,GAC7BiM,EAAI,GAAK3F,EAAI,KAAO,EACpBE,EAAIF,GAAK,KAAO2F,EAAI,GAAK,GACzB3F,EAAI2F,EAAI,GAAK,EACbxF,EAAIwF,EAAI,EAAI,GAAK3F,EACjBgmB,EAAI,KAAOxoB,EAAI,IAAM9D,EAAIsG,EACzBG,KAEIglC,KAAMnf,EACNof,MAAOjlC,EACPklC,KAAMnlC,EACNolC,KAAMJ,EAAK,GAAK,EAChBK,IAAKC,EAAiBC,EAAWzf,IAAI7lB,GAAKD,GAgDlD,QAASulC,GAAWC,GAChB,MAAIA,GAAK,EACE,EAEPA,EAAK,IACE,EAEPA,EAAK,IACE,EAEJ,EAEX,QAASC,GAAWD,GAChB,MAAOD,GAAWC,GAAM,IAAM,IAElC,QAASE,GAAYF,EAAIG,GACrB,MAAOJ,GAAWC,IAAa,GAANG,EAAU,GAAKC,EAAcD,GAE1D,QAASE,GAAUL,EAAIG,EAAIG,GACvB,MAAOH,IAAM,GAAKA,GAAM,IAAMG,GAAM,GAAKA,GAAMJ,EAAYF,EAAIG,EAAK,GAExE,QAASI,GAAWC,GAChB,MAAOjB,IAA2B,EAATiB,GAAcC,GAE3C,QAASC,GAASjB,EAAMC,EAAOC,GAC3B,MAAOL,GAAiBG,EAAMC,EAAOC,GAAQc,EAKjD,QAASE,GAAWH,GAApB,GAKQI,GACAC,EAEAC,EAEAC,EATAC,EAAOR,GAAmB,EAATA,EAWrB,OAVIQ,GAAO,GACPA,IAEAJ,EAAKpgB,KAAKyd,MAAMgD,EAAYD,GAC5BH,EAAQrgB,KAAK+F,MAAMqa,EAAKM,GAC5BN,GAAMC,EAAQK,EACVJ,EAAUtgB,KAAK+F,MAAMqa,EAAKO,GAC9BP,GAAME,EAAUK,EACZJ,EAAUvgB,KAAK+F,MAAMqa,EAAK,KAC9BA,GAAgB,IAAVG,GAEFF,MAAOA,EACPC,QAASA,EACTC,QAASA,EACTK,aAAcR,GAGtB,QAASS,GAAab,GAClB,GAAIhmC,GAAI+lC,EAAWC,GAASc,EAAIX,EAAWH,EAC3C,OAAO,IAAI7kC,MAAKnB,EAAEilC,KAAMjlC,EAAEklC,MAAOllC,EAAEmlC,KAAM2B,EAAET,MAAOS,EAAER,QAASQ,EAAEP,QAASO,EAAEF,cAE9E,QAASG,GAASC,EAAIC,EAAIC,EAAId,GAC1B,OAAQY,GAAMC,GAAMC,EAAKd,EAAK,KAAQ,IAAM,IAAM,GAEtD,QAASe,GAAahC,GAClB,GAAIiC,GAAOL,EAAS5B,EAAKkC,WAAYlC,EAAKmC,aAAcnC,EAAKoC,aAAcpC,EAAKqC,kBAEhF,OADArC,GAAOe,EAASf,EAAKsC,cAAetC,EAAKuC,WAAYvC,EAAKwC,WACtDxC,EAAO,EACAA,EAAO,EAAIiC,EAEXjC,EAAOiC,EAGtB,QAASQ,GAAUruC,EAAK8S,GAIpB,MAHIA,KACAA,EAASxV,MAAM6Q,YAAYsE,WAAW67B,eAAex7B,IAElDxV,MAAMixC,eAAevuC,EAAK8S,IAAWxV,MAAMixC,eAAevuC,IAAQ1C,MAAMixC,eAAevuC,GAC1F,eACA,aACA,cACA,YACA,eACA,aACA,cACA,YACA,gBACA,cACA,eACA,aACA,UACA,SACA,YACA,WACA,UACA,WA0RR,QAASwuC,GAActD,GACnB,MAAO,UAAUxwB,EAAME,GAiBnB,MAhBmB,gBAARF,IAAoC,gBAATE,KAClCA,EAAiB,MAATA,EAAgB,GAAKA,EAAQ,IAEtB,gBAARF,IAAoC,gBAATE,KAClCF,EAAe,MAARA,EAAe,GAAKA,EAAO,IAEnB,gBAARA,IAA6B,MAATE,IAC3BA,EAAQ,GAEQ,gBAATA,IAA6B,MAARF,IAC5BA,EAAO,GAEQ,gBAARA,IAAoC,gBAATE,KAClCF,EAAOA,EAAKrU,cACZuU,EAAQA,EAAMvU,qBAEPuU,UAAgBF,GAChBwwB,EAAKxwB,EAAME,GAEX,GAAIiuB,GAAU,UApgDnC,GAKM92B,GACA5D,EAEAsgC,EACAvtC,EACA4xB,EACAG,EACAC,EACAC,EACAJ,EAUA2b,EA2NApM,EA2OA2F,EAsLAvpB,EA6bAguB,EACAL,EAcAN,EAyDAqB,EACAD,EACAD,EA6FAyB,EAQAC,EAUAC,CAxwCAvxC,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9D6D,KACA5D,EAAc7Q,MAAM6Q,YACxBA,EAAY4D,KAAOA,EACf08B,EAAU18B,EAAK0M,WACfvd,EAAQ5D,MAAM4D,MACd4xB,EAAM3kB,EAAY2kB,IAClBG,EAAU9kB,EAAY8kB,QACtBC,EAAW/kB,EAAY+kB,SACvBC,EAAWhlB,EAAYglB,SACvBJ,EAAO5kB,EAAY2qB,QAOvB+P,EAAU/3B,UAAU0iB,SAAW,WAC3B,MAAO,IAAM11B,KAAKoK,MAAqB,QAAbpK,KAAKoK,KAAiB,IAAM,MAEtDwmC,EAAUxtC,EAAMzD,QAChBC,KAAM,SAAiB6R,EAAUiiB,EAASmc,EAAImB,GAC1ChxC,KAAKyR,SAAWA,EAChBzR,KAAK0zB,QAAUA,EACf1zB,KAAK6vC,GAAKA,EACV7vC,KAAKgxC,OAASA,GAElBrF,QAAS,SAAUv8B,GACf,GAAImG,GAAOvV,IACPoP,aAAe4lB,GACfzf,EAAK07B,cAAc7hC,GAAM,WACrBmG,EAAK27B,SAAS9hC,KAGlBmG,EAAK27B,SAAS9hC,IAGtB+hC,MAAO,SAAU/hC,GACb,MAAO,IAAI27B,GAAU37B,IAEzB8hC,SAAU,SAAU9hC,GAEZA,EADQ3B,SAAR2B,EACM,KACC+oB,MAAMsT,QAAQr8B,GACfpP,KAAKoxC,SAAShiC,GAEdq9B,EAAsBr9B,EAEhC,IAAI9P,GAAIU,KAAK0zB,OACTp0B,GAAE6oC,kBACF/4B,EAAMpP,KAAKoxC,SAAShiC,IAAQpP,KAAKoxC,WAAWhiC,KACrCA,YAAegmB,KACtBhmB,EAAMpP,KAAKqxC,UAAUjiC,IAEzB9P,EAAEoE,MAAQ0L,EACNpP,KAAK6vC,GAAGyB,UAAUhyC,IAAMU,KAAKyR,UAC7BzR,KAAKyR,SAAS1R,KAAKT,EAAG8P,IAG9B6hC,aAAc,SAAUlmC,EAAGzL,GAmBvB,QAASiyC,GAAM7d,GACXA,EAAQ5iB,KAAK0gC,EAAQ3B,GAAI,aACd4B,GACHnyC,EAAES,KAAKyxC,IAEZA,GAEP,QAASE,GAAI3mC,GAAb,GACa5I,GACD4S,CADR,KAAS5S,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EACxB4S,EAAOhK,EAAE5I,GACT4S,EAAK2e,SACLlX,EAASrc,KAAK4U,EAAK2e,QAG3B,QAAO,EAjCD,GAgBD+d,GAA2BtvC,EAfhCqvC,EAAUxxC,KAAMwc,IAYpB,IAXC,QAAS6G,GAAKtY,GAAd,GACY5I,GACDqG,CADR,KAASrG,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EACxBqG,EAAIuC,EAAE5I,GACNqG,YAAawsB,IACb0c,EAAIF,EAAQG,YAAYnpC,IAExB2vB,MAAMsT,QAAQjjC,IACd6a,EAAK7a,IAGfuC,IACGyR,EAAS3b,OACV,MAAOvB,GAAES,KAAKyxC,EAElB,KAASC,EAAUj1B,EAAS3b,OAAQsB,EAAI,EAAGA,EAAIqa,EAAS3b,SAAUsB,EAC9DovC,EAAM/0B,EAASra,KAmBvByvC,WAAY,SAAU7mC,EAAGwgC,GAAb,GAECppC,GACDiN,EAFJ4kB,IACJ,KAAS7xB,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EACxBiN,EAAMrE,EAAE5I,GACRiN,YAAe4lB,IACf5lB,EAAMpP,KAAK6xC,WAAWziC,EAAKm8B,GAC3BvX,EAAMA,EAAI0C,OAAOtnB,IACV+oB,MAAMsT,QAAQr8B,GACrB4kB,EAAMA,EAAI0C,OAAO12B,KAAK4xC,WAAWxiC,EAAKm8B,IAC/Bn8B,YAAeo1B,GACtBxQ,EAAMA,EAAI0C,OAAO12B,KAAK4xC,WAAWxiC,EAAI9E,KAAMihC,IAE3CvX,EAAI7zB,KAAKiP,EAGjB,OAAO4kB,IAEX8d,UAAW,SAAUpgC,EAAKD,GAAf,GAKCo+B,GAJJvwC,EAAIU,KAAK0zB,QACTtkB,EAAMpP,KAAK6vC,GAAGkC,UAAUrgC,EAAKpS,EAAEuS,MAAOvS,EAAEgV,IAAKhV,EAAEwV,IAC/C1F,aAAe+6B,IACf/6B,EAAMA,EAAIwb,MAAMtrB,EAAEuS,MAAOvS,EAAEgV,IAAKhV,EAAEwV,KAAK,GACnC+6B,EAAK,GAAIx/B,GAAY2hC,yBAAyBhyC,KAAK6vC,GAAGt/B,UAC1DnB,EAAI0B,KAAK++B,EAAIp+B,EAAUzR,QAEnBoP,YAAe4lB,KACf5lB,EAAMA,EAAIomB,SAASl2B,EAAEgV,IAAKhV,EAAEwV,KACvB1F,EAAIyC,QACLzC,EAAIyC,MAAQvS,EAAEuS,QAGtBJ,EAAgB,MAAPrC,EAAc,GAAI27B,GAAU,QAAU37B,KAGvDy8B,MAAO,SAAUz8B,GACb,MAAIA,aAAe4lB,GACRh1B,KAAK6xC,WAAWziC,GAEpBA,GAEXg+B,KAAM,SAAU6E,EAAOxgC,EAAU45B,GAC7B4G,EAAQA,EAAM1pC,aACd,IAAIjJ,GAAIshB,EAAMqxB,EACd,OAAI3yC,GACOA,EAAES,KAAKC,KAAMyR,EAAU45B,OAElC55B,GAAS,GAAIs5B,GAAU,UAE3BmH,KAAM,SAAU9iC,GAIZ,MAHIA,aAAe4lB,KACf5lB,EAAMpP,KAAK6xC,WAAWziC,IAER,gBAAPA,GACqB,QAArBA,EAAI7G,cAEG,gBAAP6G,GACQ,IAARA,EAEO,iBAAPA,GACAA,EAEG,MAAPA,GAEXiiC,UAAW,SAAU3/B,GACjB,GAAIpS,GAAIU,KAAK0zB,OACb,QAAKp0B,EAAE6oC,mBAAqBz2B,YAAe0jB,GACnB,GAAhB1jB,EAAIlP,UAAiBlD,EAAEwV,KAAOpD,EAAI2C,QAAQS,KAAOxV,EAAEwV,KAAOpD,EAAI6kB,YAAYzhB,IACnE9U,KAAK6xC,WAAW,GAAI1c,GAAQzjB,EAAI2C,QAAQC,IAAKhV,EAAEwV,KAAKgW,SAASpZ,EAAIG,QAEzD,GAAfH,EAAInP,SAAgBjD,EAAEgV,KAAO5C,EAAI2C,QAAQC,KAAOhV,EAAEgV,KAAO5C,EAAI6kB,YAAYjiB,IAClEtU,KAAK6xC,WAAW,GAAI1c,GAAQ71B,EAAEgV,IAAK5C,EAAI2C,QAAQS,KAAKgW,SAASpZ,EAAIG,QAErE,GAAIk5B,GAAU,SAEd/qC,KAAKoxC,SAAS1/B,IAG7B0/B,SAAU,SAAUzgC,GAAV,GAIF4E,GAEIqiB,EACA1a,EAAcN,EACd9F,EAoBAlO,EAAsB0L,CA3B9B,OAAI3D,aAAiB6zB,GACV7zB,GAEP4E,EAAOvV,KACP2Q,YAAiBykB,IACbwC,EAAKjnB,EAAM0D,QACX6I,EAAM0a,EAAGtjB,IAAKsI,EAAOgb,EAAG9iB,IACxBgC,EAAQvB,EAAKo8B,YAAYhhC,GACzB/H,EAAI,GAAI47B,GAAOjvB,GACfwf,SAASpkB,EAAMpO,WACfqG,EAAErG,MAAQoO,EAAMpO,SAEhBwyB,SAASpkB,EAAMnO,YACfoG,EAAEpG,OAASmO,EAAMnO,UAEhBuyB,SAAS7X,KACVA,EAAM,GAEL6X,SAASnY,KACVA,EAAO,GAEX9F,EAAMlF,QAAQ,SAAUmD,GACpBnM,EAAEupB,IAAIpd,EAAKT,IAAM4I,EAAKnI,EAAKD,IAAM8H,EAAM7H,EAAKrR,SAEzCkF,GAEPuvB,MAAMsT,QAAQ96B,IAAUA,EAAM9P,OAAS,GACnC+H,EAAI,GAAI47B,GAAOjvB,GAAOjB,EAAM,EAChC3D,EAAMiB,QAAQ,SAAUi3B,GAAV,GACN/zB,GAAM,EACNq9B,EAAI,CACRtJ,GAAKj3B,QAAQ,SAAU+S,GACnB,GAAIytB,GAAUztB,YAAcyQ,EACxBzQ,aAAcqQ,KAAQod,IACtBztB,EAAKpP,EAAKs8B,WAAWltB,KAErBytB,GAAWja,MAAMsT,QAAQ9mB,MACzBA,EAAKpP,EAAK67B,SAASzsB,IAEnBA,YAAc6f,IACd7f,EAAGmmB,KAAK,SAAUnmB,EAAIxc,EAAGO,GACrBE,EAAEupB,IAAI7d,EAAMnM,EAAG2M,EAAMpM,EAAGic,KAE5BwtB,EAAIxjB,KAAKoK,IAAIoZ,EAAGxtB,EAAGniB,QACnBsS,GAAO6P,EAAGpiB,OAEVqG,EAAEupB,IAAI7d,EAAKQ,IAAO6P,KAG1BrQ,GAAO69B,IAEJvpC,GAzBX,SA4BJ+oC,YAAa,SAAUlb,EAAM4b,EAAY9G,GACrC,GAAIjsC,GAAIU,KAAK0zB,OACb,OAAO1zB,MAAK6vC,GAAG8B,YAAYlb,EAAM4b,EAAY/yC,EAAEuS,MAAOvS,EAAEgV,IAAKhV,EAAEwV,IAAKy2B,IAExEsG,WAAY,SAAUngC,EAAK65B,GACvB,GAAIjsC,GAAIU,KAAK0zB,OACb,OAAO1zB,MAAK6vC,GAAG9nB,QAAQrW,EAAKpS,EAAEuS,MAAOvS,EAAEgV,IAAKhV,EAAEwV,IAAKy2B,IAEvDh7B,SAAU,WACN,MAAOvQ,MAAK6vC,GAAGt/B,YAGnBi0B,EAASphC,EAAMzD,QACfC,KAAM,SAAgB4xC,GAClBxxC,KAAKwxC,QAAUA,EACfxxC,KAAKwC,OAAS,EACdxC,KAAKuC,MAAQ,EACbvC,KAAKsK,SAETsgB,MAAO,WACH,GAAIhiB,GAAI,GAAI47B,GAAOxkC,KAAKwxC,QAMxB,OALA5oC,GAAEpG,OAASxC,KAAKwC,OAChBoG,EAAErG,MAAQvC,KAAKuC,MACfqG,EAAE0B,KAAOtK,KAAKsK,KAAK3G,IAAI,SAAU2Q,GAC7B,MAAOA,GAAIhU,UAERsI,GAEX3E,IAAK,SAAUqQ,EAAKQ,GAAf,GACG+zB,GAAO7oC,KAAKsK,KAAKgK,GACjBlF,EAAMy5B,EAAOA,EAAK/zB,GAAO,IAC7B,OAAO1F,aAAe4lB,GAAMh1B,KAAKwxC,QAAQK,WAAWziC,GAAOA,GAE/D49B,MAAO,SAAU14B,EAAKQ,GAClB,MAAIR,GAAMtU,KAAKwC,QAAUsS,EAAM9U,KAAKuC,MACzBvC,KAAKiE,IAAIqQ,EAAKQ,GAElB,GAAIi2B,GAAU,QAEzB5Y,IAAK,SAAU7d,EAAKQ,EAAKxK,GACrB,GAAIu+B,GAAO7oC,KAAKsK,KAAKgK,EACT,OAARu0B,IACAA,EAAO7oC,KAAKsK,KAAKgK,OAErBu0B,EAAK/zB,GAAOxK,EACRgK,GAAOtU,KAAKwC,SACZxC,KAAKwC,OAAS8R,EAAM,GAEpBQ,GAAO9U,KAAKuC,QACZvC,KAAKuC,MAAQuS,EAAM,IAG3Bg2B,KAAM,SAAUxrC,EAAGgzC,GAAb,GACOh+B,GACIQ,EACD1F,CAFZ,KAASkF,EAAM,EAAGA,EAAMtU,KAAKwC,SAAU8R,EACnC,IAASQ,EAAM,EAAGA,EAAM9U,KAAKuC,QAASuS,EAElC,GADI1F,EAAMpP,KAAKiE,IAAIqQ,EAAKQ,IACpBw9B,GAAuB,MAAPljC,KAChBA,EAAM9P,EAAES,KAAKC,KAAKwxC,QAASpiC,EAAKkF,EAAKQ,GACzBrH,SAAR2B,GACA,MAAOA,IAM3BzL,IAAK,SAAUrE,EAAGgzC,GACd,GAAI1pC,GAAI,GAAI47B,GAAOxkC,KAAKwxC,QAIxB,OAHAxxC,MAAK8qC,KAAK,SAAUnmB,EAAIrQ,EAAKQ,GACzBlM,EAAEupB,IAAI7d,EAAKQ,EAAKxV,EAAES,KAAKC,KAAM2kB,EAAIrQ,EAAKQ,KACvCw9B,GACI1pC,GAEX2pC,QAAS,SAAUjzC,GAAV,GACIgV,GACDlF,CADR,KAASkF,EAAM,EAAGA,EAAMtU,KAAKwC,SAAU8R,EAEnC,GADIlF,EAAM9P,EAAES,KAAKC,KAAKwxC,QAASl9B,GACnB7G,SAAR2B,EACA,MAAOA,IAInBojC,QAAS,SAAUlzC,GAAV,GACIwV,GACD1F,CADR,KAAS0F,EAAM,EAAGA,EAAM9U,KAAKuC,QAASuS,EAElC,GADI1F,EAAM9P,EAAES,KAAKC,KAAKwxC,QAAS18B,GACnBrH,SAAR2B,EACA,MAAOA,IAInBqjC,OAAQ,SAAUnzC,GACd,GAAIsJ,GAAI,GAAI47B,GAAOxkC,KAAKwxC,QAIxB,OAHAxxC,MAAKuyC,QAAQ,SAAUj+B,GACnB1L,EAAEupB,IAAI7d,EAAK,EAAGhV,EAAES,KAAKC,KAAKwxC,QAASl9B,MAEhC1L,GAEX8pC,OAAQ,SAAUpzC,GACd,GAAIsJ,GAAI,GAAI47B,GAAOxkC,KAAKwxC,QAIxB,OAHAxxC,MAAKwyC,QAAQ,SAAU19B,GACnBlM,EAAEupB,IAAI,EAAGrd,EAAKxV,EAAES,KAAKC,KAAKwxC,QAAS18B,MAEhClM,GAEX8sB,SAAU,WACN,MAAOrD,MAAKC,UAAUtyB,KAAKsK,OAE/BqoC,UAAW,WACP,GAAI/pC,GAAI,GAAI47B,GAAOxkC,KAAKwxC,QAIxB,OAHAxxC,MAAK8qC,KAAK,SAAUnmB,EAAIrQ,EAAKQ,GACzBlM,EAAEupB,IAAIrd,EAAKR,EAAKqQ,KAEb/b,GAEXgqC,KAAM,SAAU3sC,GAAV,GAEE8E,GACK5I,EACDmS,EACKlG,CAFb,KAFApO,KAAKuC,MAAQvC,KAAKwC,OAASyD,EACvB8E,EAAI/K,KAAKsK,KAAW6tB,MAAMlyB,GACrB9D,EAAI8D,IAAK9D,GAAK,GAEnB,IADImS,EAAMvJ,EAAE5I,GAASg2B,MAAMlyB,GAClBmI,EAAInI,IAAKmI,GAAK,GACnBkG,EAAIlG,GAAKjM,GAAKiM,EAAI,EAAI,CAG9B,OAAOpO,OAEX6yC,SAAU,SAAU7uB,GAAV,GAEG1P,GACIQ,EACDg+B,EACK3wC,EACD4wC,EACAC,EANZjoC,EAAI/K,KAAM4I,EAAI,GAAI47B,GAAOz5B,EAAEymC,QAC/B,KAASl9B,EAAM,EAAGA,EAAMvJ,EAAEvI,SAAU8R,EAChC,IAASQ,EAAM,EAAGA,EAAMkP,EAAEzhB,QAASuS,EAAK,CAEpC,IADIg+B,EAAI,EACC3wC,EAAI,EAAGA,EAAI4I,EAAExI,QAASJ,EAAG,CAG9B,GAFI4wC,EAAKhoC,EAAE9G,IAAIqQ,EAAKnS,GAChB6wC,EAAKhvB,EAAE/f,IAAI9B,EAAG2S,GACD,gBAANi+B,IAA+B,gBAANC,GAChC,KAAM,IAAIjI,GAAU,QAExB+H,IAAKC,EAAKC,EAEdpqC,EAAEupB,IAAI7d,EAAKQ,EAAKg+B,GAGxB,MAAOlqC,IAEXqqC,KAAM,SAAUjvB,EAAG8uB,GAAb,GAGOx+B,GACIQ,EACDtM,EAAqBimB,EAJ7B1jB,EAAI/K,KAAM4I,EAAI,GAAI47B,GAAOz5B,EAAEymC,SAC3B0B,EAAOJ,KAAS,CACpB,KAASx+B,EAAM,EAAGA,EAAMvJ,EAAEvI,SAAU8R,EAChC,IAASQ,EAAM,EAAGA,EAAM/J,EAAExI,QAASuS,EAC3BtM,EAAIuC,EAAE9G,IAAIqQ,EAAKQ,GAAM2Z,EAAIzK,EAAE/f,IAAIqQ,EAAKQ,GACxClM,EAAEupB,IAAI7d,EAAKQ,EAAKtM,EAAI0qC,EAAOzkB,EAGnC,OAAO7lB,IAEXuqC,YAAa,WAAA,GAGEC,GAAGC,EAAGlxC,EAAGmxC,EAUJ7D,EAZZ1kC,EAAI/K,KAAK4qB,QAAQtgB,KACjBrE,EAAI8E,EAAElK,OACN8H,EAAI,CACR,KAAKyqC,EAAI,EAAGA,EAAIntC,EAAGmtC,IAAK,CACpB,IAAKC,EAAID,EAAGC,EAAIptC,IAAM8E,EAAEsoC,GAAGD,GAAIC,KAE/B,GAAIA,GAAKptC,EACL,MAAO,EAEX,IAAIotC,GAAKD,EAEL,IADAzqC,GAAKA,EACA2qC,EAAIF,EAAGE,EAAIrtC,EAAGqtC,IACX7D,EAAI1kC,EAAEqoC,GAAGE,GACbvoC,EAAEqoC,GAAGE,GAAKvoC,EAAEsoC,GAAGC,GACfvoC,EAAEsoC,GAAGC,GAAK7D,CAGlB,KAAKttC,EAAIixC,EAAI,EAAGjxC,EAAI8D,EAAG9D,IACnB,IAAKmxC,EAAIF,EAAI,EAAGE,EAAIrtC,EAAGqtC,IACnBvoC,EAAE5I,GAAGmxC,IAAMvoC,EAAEqoC,GAAGE,GAAKvoC,EAAE5I,GAAGixC,GAAKroC,EAAEqoC,GAAGA,EAG5CzqC,IAAKoC,EAAEqoC,GAAGA,GAEd,MAAOzqC,IAEX4qC,QAAS,WAAA,GAIDhlC,GAyBK+kC,EAvBDE,EAwBKrxC,EAEQiM,EAPR9O,EAxBT2G,EAAIjG,KAAKuC,MACTqG,EAAI5I,KAAKyzC,QAAQ,GAAIjP,GAAOxkC,KAAKwxC,SAASoB,KAAK3sC,IAC/C8E,EAAInC,EAAE0B,IAEV,KAASgpC,EAAI,EAAGA,EAAIrtC,IAAKqtC,EAAG,CAIxB,GAHIE,EAAOxI,EAAOsI,EAAGrtC,EAAG,SAAU9D,GAC9B,MAAO4I,GAAE5I,GAAGmxC,MAEXvoC,EAAEyoC,GAAMF,GACT,MAAO,KAOX,KALIA,GAAKE,IACLjlC,EAAMxD,EAAEuoC,GACRvoC,EAAEuoC,GAAKvoC,EAAEyoC,GACTzoC,EAAEyoC,GAAQjlC,GAELpM,EAAImxC,EAAI,EAAGnxC,EAAI8D,IAAK9D,EAAG,CAC5B,IAASiM,EAAIklC,EAAI,EAAGllC,EAAI,EAAInI,IAAKmI,EAC7BrD,EAAE5I,GAAGiM,IAAMrD,EAAEuoC,GAAGllC,GAAKrD,EAAE5I,GAAGmxC,GAAKvoC,EAAEuoC,GAAGA,EAExCvoC,GAAE5I,GAAGmxC,GAAK,GAGlB,IAASnxC,EAAI,EAAGA,EAAI8D,IAAK9D,EACrB,IAAS7C,EAAIyL,EAAE5I,GAAGA,GAAIiM,EAAI,EAAGA,EAAI,EAAInI,IAAKmI,EACtCrD,EAAE5I,GAAGiM,IAAM9O,CAGnB,KAASg0C,EAAIrtC,IAAKqtC,GAAK,GACnB,IAASnxC,EAAImxC,IAAKnxC,GAAK,GACnB,GAAI4I,EAAE5I,GAAGmxC,GACL,IAASllC,EAAI,EAAInI,IAAKmI,GAAKnI,GACvB8E,EAAE5I,GAAGiM,IAAMrD,EAAEuoC,GAAGllC,GAAKrD,EAAE5I,GAAGmxC,EAK1C,OAAO1qC,GAAEtI,MAAM,EAAG2F,EAAGA,EAAGA,IAE5BwtC,QAAS,SAAU7qC,GACf,GAAIorB,GAAMh0B,KAAK4qB,QAAS3kB,EAAI+tB,EAAIzxB,KAIhC,OAHAqG,GAAEkiC,KAAK,SAAU17B,EAAKkF,EAAKQ,GACvBkf,EAAI7B,IAAI7d,EAAKQ,EAAM7O,EAAGmJ,KAEnB4kB,GAEX1zB,MAAO,SAAUgU,EAAKQ,EAAKtS,EAAQD,GAA5B,GAEMJ,GACIiM,EAFTxF,EAAI,GAAI47B,GAAOxkC,KAAKwxC,QACxB,KAASrvC,EAAI,EAAGA,EAAIK,IAAUL,EAC1B,IAASiM,EAAI,EAAGA,EAAI7L,IAAS6L,EACzBxF,EAAEupB,IAAIhwB,EAAGiM,EAAGpO,KAAKiE,IAAIqQ,EAAMnS,EAAG2S,EAAM1G,GAG5C,OAAOxF,MAcXuhC,EAAU/mC,EAAMzD,QAChBC,KAAM,SAAiB62B,EAAMpL,EAASqoB,EAAS7hC,EAAOyC,EAAKQ,EAAKqzB,GAC5DnoC,KAAKy2B,KAAOA,EACZz2B,KAAKqrB,QAAUA,EACfrrB,KAAK+qB,MAAQ2oB,EACb1zC,KAAK2zC,QAAU,KACf3zC,KAAK6R,MAAQA,EACb7R,KAAKsU,IAAMA,EACXtU,KAAK8U,IAAMA,EACX9U,KAAK4zC,WACL5zC,KAAKyxC,SAAU,EACfzxC,KAAKmoC,kBAAoBA,GAE7BF,qBAAsB,SAAUv2B,GAC5B1R,KAAKmoC,kBAAoBz2B,EAAIkZ,QAAQE,SAAS9qB,KAAK6R,QAEvD+Y,MAAO,SAAU/Y,EAAOyC,EAAKQ,EAAK++B,GAA3B,GACCC,GAAUjiC,EAAMtJ,cAChBkuB,EAAOz2B,KAAKy2B,KACZ9lB,EAAQ3Q,KAAKmoC,iBAYjB,QAXI0L,GAAaC,GAAW9zC,KAAK6R,MAAMtJ,iBACnCkuB,EAAOA,EAAK9yB,IAAI,SAAU+N,GAItB,MAHKA,GAAI4jB,YAAgB5jB,EAAIG,OAASH,EAAIG,MAAMtJ,eAAiBurC,IAC7DpiC,EAAMA,EAAIkZ,QAAQE,SAASjZ,IAExBH,IAEPf,IACAA,EAAQA,EAAMia,QAAQE,SAASjZ,KAGhC,GAAIs4B,GAAQ1T,EAAMz2B,KAAKqrB,QAASrrB,KAAK+qB,MAAOlZ,EAAOyC,EAAKQ,EAAKnE,IAExEmhB,UAAW,WACP,GAAI2E,GAAOz2B,KAAKy2B,KAAK9yB,IAAI,SAAU+N,GAC/B,MAAOA,GAAIkZ,SAEf,OAAO,IAAIuf,GAAQ1T,EAAMz2B,KAAKqrB,QAASrrB,KAAK+qB,MAAO/qB,KAAK6R,MAAO7R,KAAKsU,IAAKtU,KAAK8U,IAAK9U,KAAKmoC,oBAE5FwD,QAAS,SAAUv8B,GACfpP,KAAKyxC,SAAU,EACfzxC,KAAK4zC,QAAQhiC,QAAQ,SAAUH,GAC3BA,EAASrC,MAGjB0B,KAAM,SAAU++B,EAAIp+B,EAAUsiC,GAAxB,GASM1tB,GACAgJ,EAcA2kB,CAvBR,IAAI,SAAWh0C,MACPyR,GACAA,EAASzR,KAAK0D,WAEf,CAMH,IALI+N,GACAzR,KAAK4zC,QAAQzzC,KAAKsR,GAElB4U,EAAM,GAAIuqB,GAAQ5wC,KAAK2rC,QAAS3rC,KAAM6vC,EAAIkE,GAC1C1kB,EAAQ,EACL0kB,GAAe,CAClB,GAAIA,EAAcrgB,UAAY1zB,KAG1B,MAFAA,MAAKyxC,SAAU,MACfprB,GAAIslB,QAAQ,GAAIZ,GAAU,YAG9BgJ,GAAgBA,EAAc/C,SAC5B3hB,EAEN,GAAIrvB,KAAKyxC,QACL,MAEJzxC,MAAKyxC,SAAU,EACXuC,EAAO,WACFh0C,KAAK2zC,UACN3zC,KAAK2zC,QAAU3zC,KAAKy2B,KAAK9yB,IAAI,SAAU+N,GACnC,MAAOA,GAAI8jB,SAASx1B,KAAKsU,IAAKtU,KAAK8U,MACpC9U,OAEPA,KAAKqrB,QAAQtrB,KAAKsmB,IACpBtU,KAAK/R,MACHqvB,EAAQ,GACR2kB,IAEA1sB,WAAW0sB,EAAM,KAI7BC,MAAO,WACHj0C,KAAK4zC,WACL5zC,KAAKyxC,SAAU,QACRzxC,MAAK0D,OAEhBwzB,YAAa,SAAUC,EAAcC,GACjCD,EAAeA,EAAa5uB,cAC5BvI,KAAK2zC,QAAU,KACX3zC,KAAK6R,MAAMtJ,eAAiB4uB,IAC5Bn3B,KAAK6R,MAAQulB,GAEjBp3B,KAAKy2B,KAAK7kB,QAAQ,SAAUF,GACxBA,EAAIwlB,YAAYC,EAAcC,MAGtC3B,OAAQ,SAAUye,EAAeC,EAAWzkB,EAAOhb,GAsC/C,QAAS+gB,GAAO/jB,GACZ,MAAIA,KAAQujB,EACDvjB,EAEPA,EAAIG,MAAMtJ,eAAiB2rC,GACvBE,IACiB,OAAbD,GAAsBE,GAAc3kB,IACpChe,EAAMA,EAAImZ,SAASnW,EAAO,IAEb,OAAby/B,GAAsBG,GAAc5kB,IACpChe,EAAMA,EAAImZ,SAAS,EAAGnW,KAGvBhD,GAEJA,EAAI+jB,OAAO4e,EAAYC,EAAYC,EAAeC,EAA4B,OAAbL,EAAoBzkB,EAAOhb,GArDnG,GAEA2/B,GACAC,EACAG,EACAL,EAWAG,EACAC,EAEAE,EACAra,EAQAsa,CAOJ,IAlCAT,EAAgBA,EAAc3rC,cAC1B8rC,EAAar0C,KAAKsU,IAClBggC,EAAat0C,KAAK8U,IAClB2/B,EAAez0C,KAAK6R,MAAMtJ,cAC1B6rC,GAAe,EACfK,GAAgBP,IACC,OAAbC,GAAsBE,GAAc3kB,IACpC1vB,KAAKsU,KAAOI,EACZ0/B,GAAe,GAEF,OAAbD,GAAsBG,GAAc5kB,IACpC1vB,KAAK8U,KAAOJ,EACZ0/B,GAAe,IAGnBG,EAAgBv0C,KAAKsU,IACrBkgC,EAAgBx0C,KAAK8U,IACzB9U,KAAK2zC,QAAU,KACXe,EAAW10C,KAAKy2B,KAChB4D,EAAW+Z,EACfp0C,KAAKy2B,KAAOie,EAAS/wC,IAAI,SAAU+N,GAC/B,GAAIkjC,GAASnf,EAAO/jB,EAIpB,OAHK2oB,IAAa4Q,EAAQ2J,EAAQljC,KAC9B2oB,GAAW,GAERua,IAEPD,EAAY30C,KAAKmoC,kBACjBwM,IACA30C,KAAKmoC,kBAAoB1S,EAAOkf,GAC3Bta,GAAa4Q,EAAQ0J,EAAW30C,KAAKmoC,qBACtC9N,GAAW,IAGfA,EACA,MAAO,IAAI8P,GAAQuK,EAAU10C,KAAKqrB,QAASrrB,KAAK+qB,MAAO/qB,KAAK6R,MAAOwiC,EAAYC,EAAYK,IAoBnGjf,SAAU,WACN,MAAO11B,MAAK+qB,MAAM/qB,KAAKsU,IAAKtU,KAAK8U,QA0BrC8L,EAAQ5X,OAAOC,OAAO,MAC1B2X,EAAM,MAAQ,SAAUnP,EAAU45B,GAApB,GACN91B,GAAOvV,KACP60C,EAAKxJ,EAAK,GAAIyJ,EAAKzJ,EAAK,GAAI1mB,EAAK0mB,EAAK,EAC1CrrC,MAAKixC,cAAc4D,GAAK,WACpB,GAAIE,GAAWx/B,EAAK67B,SAASyD,EACzBE,GACAD,EAAG,SAAUA,GACTnwB,EAAG,SAAUA,GAAV,GACKqwB,GAAWz/B,EAAK67B,SAAS0D,GACzBG,EAAW1/B,EAAK67B,SAASzsB,EAC7BlT,GAASsjC,EAASpxC,IAAI,SAAUyL,EAAKkF,EAAKQ,GACtC,MAAI1F,aAAe27B,GACR37B,EACAmG,EAAK28B,KAAK9iC,GACV4lC,EAAWA,EAAS/wC,IAAIqQ,EAAKQ,GAAOggC,EAEpCG,EAAWA,EAAShxC,IAAIqQ,EAAKQ,GAAO6P,UAM3DkwB,EAAK70C,KAAK6rC,MAAMgJ,GACZA,YAAc9J,GACdt5B,EAASojC,GACFt/B,EAAK28B,KAAK2C,GACjBC,EAAGrjC,GAEHkT,EAAGlT,OAKnBmP,EAAM,KAAO,SAAUnP,GACnBA,GAAU,EAAIkd,KAAKC,KAAK,IAAM,IA0Z9BggB,EAAYnB,EAAiB,KAAM,MACnCc,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEAN,IAEI,EACA,GACA,GACA,GACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,MAGA,EACA,GACA,GACA,GACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,MA8BJqB,EAAY,IACZD,EAAa,GAAKC,EAClBF,EAAY,GAAKC,EA6DrBsB,EAAQ5F,UAAYA,EACpB4F,EAAQxG,QAAUA,EAClBwG,EAAQnM,OAASA,EACjBmM,EAAQ9B,SAAWA,EACnB8B,EAAQjC,WAAaA,EACrBiC,EAAQjB,SAAWA,EACnBiB,EAAQ7B,WAAaA,EACrB6B,EAAQnB,aAAeA,EACvBmB,EAAQb,aAAeA,EACvBa,EAAQtC,YAAcA,EACtBsC,EAAQnC,UAAYA,EACpBmC,EAAQzC,WAAaA,EACrByC,EAAQvC,WAAaA,EACrBuC,EAAQJ,UAAYA,EACpBI,EAAQ/d,eAAiBA,EACzBviB,EAAYmiB,aAAesd,EAC3Bz/B,EAAYu3B,aAAe4H,EAC3Bn/B,EAAY88B,eAAiBA,EAC7B98B,EAAY06B,UAAYA,EACxB4F,EAAQxD,eAAiBA,EACzBwD,EAAQuE,YAAc,SAAUC,EAAOrpC,GACnC,GAAIspC,GAAOx0B,EAAM9U,EACjB,KAAKspC,EACD,KAAUxqC,OAAM,YAAckB,EAAO,sBAEpCspC,GAAKC,0BACND,EAAKC,yBAA2BvpC,IAEpCspC,EAAKC,wBAAwBl1C,KAAKg1C,GAClCv0B,EAAMu0B,GAASC,GAEnBzE,EAAQ/vB,MAAQA,EACZiwB,GACA,KACA,UAEI,OACA,IAGJC,IAEI,KACAD,IAGA,KACAA,IAGJE,IAEI,MAEI,KACA,YAEI,OACA,MAKR,MAEI,KACA,YAEI,OACA,MAKhB5D,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAOjZ,GAAIiZ,IACZqnB,KAAKyF,GACR3D,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAOjZ,GAAIiZ,IACZqnB,KAAKyF,GACR3D,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAOjZ,GAAIiZ,IACZqnB,KAAKyF,GACR3D,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAOjZ,GAAIiZ,IACZqnB,OAEK,KACAwF,IAGA,KACA,aAGR1D,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAO2K,MAAK2mB,IAAIvqC,EAAGiZ,KACpBqnB,KAAKyF,GACR3D,EAAe,UAAW,SAAUpiC,EAAGiZ,GAOnC,MANS,OAALjZ,IACAA,EAAI,IAEC,MAALiZ,IACAA,EAAI,IAED,GAAKjZ,EAAIiZ,IACjBqnB,OAEK,MAEI,KACA,SACA,SACA,UACA,UAIJ,MAEI,KACA,SACA,SACA,UACA,WAIZ8B,EAAe,UAAW,SAAUpiC,EAAGiZ,GAGnC,MAFAjZ,GAAiB,gBAANA,GAAiBA,EAAExC,cAAgBwC,EAC9CiZ,EAAiB,gBAANA,GAAiBA,EAAEzb,cAAgByb,EACvCjZ,IAAMiZ,IACdqnB,KAAK0F,GACR5D,EAAe,WAAY,SAAUpiC,EAAGiZ,GACpC,MAAOjZ,KAAMiZ,IACdqnB,KAAK0F,GACR5D,EAAe,UAAWuD,EAAc,SAAU3lC,EAAGiZ,GACjD,MAAOjZ,GAAIiZ,KACXqnB,KAAK0F,GACT5D,EAAe,WAAYuD,EAAc,SAAU3lC,EAAGiZ,GAClD,MAAOjZ,IAAKiZ,KACZqnB,KAAK0F,GACT5D,EAAe,UAAWuD,EAAc,SAAU3lC,EAAGiZ,GACjD,MAAOjZ,GAAIiZ,KACXqnB,KAAK0F,GACT5D,EAAe,WAAYuD,EAAc,SAAU3lC,EAAGiZ,GAClD,MAAOjZ,IAAKiZ,KACZqnB,KAAK0F,GACT5D,EAAe,SAAU,SAAUpiC,GAC/B,MAAOA,KACRsgC,OACK,KACAwF,KAER1D,EAAe,SAAU,SAAUpiC,GAC/B,OAAQA,IACTsgC,OACK,KACAwF,KAER1D,EAAe,SAAU,SAAUpiC,GAC/B,MAAOA,GAAI,MACZsgC,OACK,KACAwF,KAER1D,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAO,IAAIoR,GAASrqB,EAAGiZ,GAAG8G,SAAS/f,EAAE8G,OAAS7R,KAAK0zB,QAAQ7hB,MAAO9G,EAAEuqB,cACrE+V,OAEK,IACA,SAGA,IACA,UAGR8B,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAO,IAAIqR,IACPtqB,EACAiZ,MAELqnB,OAEK,IACA,QAGA,IACA,SAGR8B,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,MAAOjZ,GAAE4qB,UAAU3R,KACpBqnB,OAEK,IACA,QAGA,IACA,SAGR8B,EAAe,MAAO,SAAUpiC,GAC5B,OAAQ/K,KAAKkyC,KAAKnnC,KACnBsgC,OACK,MAEI,KACA,YAEI,OACA,OAIhB8B,EAAe,UAAW,SAAU/9B,GAChC,MAAIA,aAAe+lB,KACf/lB,EAAMpP,KAAK6xC,WAAWziC,GACR,MAAPA,KAGZi8B,OACK,SACA,eAER8B,EAAe,UAAW,SAAU/9B,GAChC,MAAOA,aAAe27B,KACvBM,OACK,SACA,aAER8B,EAAe,QAAS,SAAU/9B,GAC9B,MAAOA,aAAe27B,IAAyB,OAAZ37B,EAAIhF,OACxCihC,OACK,SACA,aAER8B,EAAe,OAAQ,SAAU/9B,GAC7B,MAAOA,aAAe27B,IAAyB,OAAZ37B,EAAIhF,OACxCihC,OACK,SACA,aAER8B,EAAe,YAAa,SAAU/9B,GAClC,MAAqB,iBAAPA,KACfi8B,OACK,SACA,aAER8B,EAAe,YAAa,SAAU/9B,GAClC,MAAqB,gBAAPA,KACfi8B,OACK,SACA,aAER8B,EAAe,SAAU,SAAU/9B,GAC/B,MAAqB,gBAAPA,KACfi8B,OACK,SACA,aAER8B,EAAe,WAAY,SAAU/9B,GACjC,MAAqB,gBAAPA,KACfi8B,OACK,SACA,aAER8B,EAAe,QAAS,SAAU/9B,GAC9B,MAAOA,aAAe+lB,IAAW/lB,YAAegmB,KACjDiW,OACK,SACA,eAERzqB,EAAM,YAAc,SAAUnP,EAAU45B,GACpCrrC,KAAK8xC,UAAUzG,EAAK,GAAI55B,MA2BZ,kBAAVlS,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,0BAA2B,uBAAwBD,IAC5D,WACE,YAyBA,SAASi2C,GAAkB1jC,EAAOyC,EAAKQ,EAAKsJ,GAA5C,GACQo3B,GACArkB,EACAskB,EACAC,CAmCJ,IAlC0B,gBAAft3B,KACPA,EAAaiU,KAAKhoB,MAAM+T,IAExBA,EAAWu3B,OACiB,SAAxBv3B,EAAWw3B,UAAwBx3B,EAAWy3B,kBAC9Cz3B,EAAWu3B,KAAOn2C,MAAMwV,OAAO8gC,EAAkB13B,EAAWu3B,MAC5Dv3B,EAAWy3B,iBAAkB,GAEL,SAAxBz3B,EAAWw3B,WACXH,EAAiBxhC,EAAK0M,QAAQ4vB,UAAUnyB,EAAWu3B,MAC/CF,IACAr3B,EAAWu3B,KAAOn2C,MAAMwV,OAAO+gC,EAAa33B,EAAWu3B,MACvDv3B,EAAW43B,iBAAkB,IAGrC53B,EAAWu3B,KAAO1hC,EAAKuzB,QAAQvzB,EAAKgiC,aAAapkC,EAAOyC,EAAKQ,EAAKsJ,EAAWu3B,QAE7Ev3B,EAAW83B,KACiB,SAAxB93B,EAAWw3B,WACXF,EAAezhC,EAAK0M,QAAQ4vB,UAAUnyB,EAAW83B,IAC7CR,IACAt3B,EAAW83B,GAAK12C,MAAMwV,OAAO+gC,EAAa33B,EAAW83B,IACrD93B,EAAW+3B,eAAgB,IAGnC/3B,EAAW83B,GAAKjiC,EAAKuzB,QAAQvzB,EAAKgiC,aAAapkC,EAAOyC,EAAKQ,EAAKsJ,EAAW83B,MAG3E/kB,EADuB,UAAvB/S,EAAWw3B,SACAjF,EAAQyF,oBAAoBC,OACT,QAAvBj4B,EAAWw3B,SACPjF,EAAQyF,oBAAoB5wB,KAE5BmrB,EAAQyF,oBAAoBh4B,EAAWk4B,eAEjDnlB,EACD,KAAM3xB,OAAMwV,OAAO,qCAAwCoJ,EAAWk4B,aAoB1E,OAlBAd,GAAoB,SAAUe,GAAV,GAWRjsC,GAVJksC,EAAUx2C,KAAKk2C,IAAMl2C,KAAKy2C,SAAWz2C,KAAKy2C,SAAWhpC,MAezD,OAduB,QAAnB8oC,GAA8C,KAAnBA,EAEvBv2C,KAAK0D,QADL1D,KAAK02C,WAKe,UAAjB12C,KAAK41C,SACZ51C,KAAK0D,MAAQytB,EAASolB,EAAgBv2C,KAAK22C,WAAYH,GAC/B,QAAjBx2C,KAAK41C,UACRtrC,EAAOtK,KAAK42C,eAChB52C,KAAK0D,MAAQytB,EAASolB,EAAgBjsC,EAAMksC,IAE5Cx2C,KAAK0D,MAAQytB,EAASolB,EAAgBv2C,KAAK22C,WAAYH,GAEpDx2C,KAAK0D,OAET,GAAIlE,OAAM6Q,YAAY+N,WAAWgsB,WAAWhpC,EAAEzB,OAAOye,GACxDiN,QAASmqB,EACT3jC,MAAOA,EACPyC,IAAKA,EACLQ,IAAKA,KA1Ff,GAMMzE,GACAsgC,EAEA18B,EACA7Q,EACA0yC,EACAC,EAiFA3L,EA3FAhpC,EAAI5B,MAAMgG,MACVhG,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DC,EAAc7Q,MAAM6Q,YACpBsgC,KACJtgC,EAAY+N,WAAauyB,EACrB18B,EAAO5D,EAAY4D,KACnB7Q,EAAQ5D,MAAM4D,MACd0yC,EAAmB,eACnBC,EAAc,mBAClB9hC,EAAK0M,QAAQwsB,eAAe,UAAW,SAAUvkC,GAI7C,MAHgB,gBAALA,KACPA,EAAI5I,KAAKoxC,UAAUxoC,EAAE7C,MAAM,cAExB6C,IACRyiC,OACK,KAEI,KACA,SACA,aAsERjB,EAAahnC,EAAMzD,QACnBC,KAAM,SAAoBC,GACtBG,KAAKqrB,QAAUxrB,EAAQwrB,QACvBrrB,KAAK21C,KAAO91C,EAAQ81C,KACpB31C,KAAKk2C,GAAKr2C,EAAQq2C,GAClBl2C,KAAK41C,SAAW/1C,EAAQ+1C,SACxB51C,KAAKs2C,aAAez2C,EAAQy2C,aAC5Bt2C,KAAKuR,KAAO1R,EAAQ0R,KAAO1R,EAAQ0R,KAAO,UAC1CvR,KAAK02C,aAAa72C,EAAQ62C,WAC1B12C,KAAKg2C,kBAAkBn2C,EAAQm2C,gBAC/Bh2C,KAAKm2C,gBAAgBt2C,EAAQs2C,cAC7Bn2C,KAAK62C,WAAah3C,EAAQg3C,WAC1B72C,KAAK61C,kBAAkBh2C,EAAQg2C,gBAC/B71C,KAAK6R,MAAQhS,EAAQgS,MACrB7R,KAAKsU,IAAMzU,EAAQyU,IACnBtU,KAAK8U,IAAMjV,EAAQiV,IACfjV,EAAQi3C,yBACR92C,KAAK82C,uBAAyBj3C,EAAQi3C,wBAEtCj3C,EAAQk3C,uBACR/2C,KAAK+2C,qBAAuBl3C,EAAQk3C,sBAEpCl3C,EAAQm3C,kBACRh3C,KAAKg3C,gBAAkBn3C,EAAQm3C,iBAE/Bn3C,EAAQo3C,gBACRj3C,KAAKi3C,cAAgBp3C,EAAQo3C,gBAGrCC,gBAAiB,SAAUliC,GAAV,GACT2gC,GAAO31C,KAAK21C,KAAO31C,KAAK22C,WAAa,GACrCT,EAAKl2C,KAAKk2C,GAAKl2C,KAAKy2C,SAAW,GAC/BU,EAAcn3C,KAAK21C,KAAO31C,GAAAA,KAAK21C,KAAkB,GACjDyB,EAAYp3C,KAAKk2C,GAAKl2C,GAAAA,KAAKk2C,GAAgB,GAC3CN,EAAW51C,KAAK41C,SAChBrkC,EAAOvR,KAAKuR,KACZ+kC,EAAet2C,KAAKs2C,YACxB,OAAO92C,OAAMwV,OAAOA,EAAQ2gC,EAAMO,EAAIiB,EAAaC,EAAWxB,EAAUrkC,EAAM+kC,IAElFe,aAAc,WACVr3C,KAAKoR,MAAQ,GACbpR,KAAKqR,QAAU,GACXrR,KAAK+2C,uBACL/2C,KAAKs3C,aAAet3C,KAAKk3C,gBAAgBl3C,KAAK+2C,uBAE9C/2C,KAAK82C,yBACL92C,KAAKu3C,eAAiBv3C,KAAKk3C,gBAAgBl3C,KAAK82C,yBAEhD92C,KAAKi3C,gBACLj3C,KAAKoR,MAAQpR,KAAKk3C,gBAAgBl3C,KAAKi3C,gBAEvCj3C,KAAKg3C,kBACLh3C,KAAKqR,QAAUrR,KAAKk3C,gBAAgBl3C,KAAKg3C,mBAGjDJ,aAAc,WAAA,GAINY,GACAr1C,EACAssB,EACAnkB,EAEImtC,CARR,KAAKz3C,KAAK22C,aAAe32C,KAAK22C,WAAWrsC,KACrC,QAMJ,KAJIktC,EAAOx3C,KAAK22C,WAAWrsC,KAGvBA,KACCnI,EAAI,EAAGA,EAAIq1C,EAAK32C,OAAQsB,IAEzB,GADIs1C,EAAQD,EAAKr1C,GAEb,IAAKssB,EAAI,EAAGA,EAAIgpB,EAAM52C,OAAQ4tB,IAC1BnkB,EAAKnK,KAAKs3C,EAAMhpB,GAI5B,OAAOnkB,IAEXsgB,MAAO,SAAU/Y,EAAOyC,EAAKQ,GACzB,GAAIjV,GAAUG,KAAK03C,aAOnB,OANI73C,GAAQ81C,OACR91C,EAAQ81C,KAAO91C,EAAQ81C,KAAK/qB,MAAM/Y,EAAOyC,EAAKQ,IAE9CjV,EAAQq2C,KACRr2C,EAAQq2C,GAAKr2C,EAAQq2C,GAAGtrB,MAAM/Y,EAAOyC,EAAKQ,IAEvC,GAAIs1B,GAAWhpC,EAAEzB,OAAOE,GAAWwrB,QAASrrB,KAAKqrB,UACpDxZ,MAAOA,EACPyC,IAAKA,EACLQ,IAAKA,MAGbgd,UAAW,WACP,GAAIxpB,GAAI,GAAI8hC,GAAWpqC,KAKvB,OAJAsI,GAAEqtC,KAAOrtC,EAAEqtC,KAAK7jB,YACZxpB,EAAE4tC,KACF5tC,EAAE4tC,GAAK5tC,EAAE4tC,GAAGpkB,aAETxpB,GAEXwI,KAAM,SAAU++B,EAAI8H,EAAcC,EAAenmC,GAE7C,QAASomC,GAASzoC,GAOd,MANIA,aAAe5P,OAAM6Q,YAAY2kB,MACjC5lB,EAAMygC,EAAG9nB,QAAQ3Y,GACb+oB,MAAMsT,QAAQr8B,KACdA,EAAMA,EAAI,KAGXA,EATT,GACEmG,GAAOvV,KAUP83C,EAAwB,SAAU1oC,GAClCmG,EAAKohC,WAAakB,EAASzoC,GAC3BmG,EAAK7R,MAAQ6R,EAAK8V,QAAQtrB,KAAKwV,EAAMoiC,EAAcC,GACnDriC,EAAK8hC,eACD5lC,GACAA,EAAS8D,EAAK7R,OAGlB6R,GAAK2gC,GACL3gC,EAAK2gC,GAAGplC,KAAK++B,EAAI,SAAUzgC,GACvBmG,EAAKkhC,SAAWoB,EAASzoC,GACzBmG,EAAKogC,KAAK7kC,KAAK++B,EAAIiI,KAGvBviC,EAAKogC,KAAK7kC,KAAK++B,EAAIiI,IAG3B7D,MAAO,WACCj0C,KAAK21C,MACL31C,KAAK21C,KAAK1B,QAEVj0C,KAAKk2C,IACLl2C,KAAKk2C,GAAGjC,cAELj0C,MAAK0D,OAEhB+xB,OAAQ,SAAUye,EAAeC,EAAWzkB,EAAOhb,GAA3C,GACAqjC,GAAUC,EAAQ3d,EA0Bd/xB,EAzBJ+rC,EAAar0C,KAAKsU,IAClBggC,EAAat0C,KAAK8U,GAOtB,IANI9U,KAAK21C,OACLoC,EAAW/3C,KAAK21C,KAAKlgB,OAAOye,EAAeC,EAAWzkB,EAAOhb,IAE7D1U,KAAKk2C,KACL8B,EAASh4C,KAAKk2C,GAAGzgB,OAAOye,EAAeC,EAAWzkB,EAAOhb,IAEzD1U,KAAK6R,MAAMtJ,eAAiB2rC,EAAc3rC,cAC1C,OAAQ4rC,GACR,IAAK,MACGE,GAAc3kB,IACd2K,GAAW,EACXr6B,KAAKsU,KAAOI,EAEhB,MACJ,KAAK,MACG4/B,GAAc5kB,IACd2K,GAAW,EACXr6B,KAAK8U,KAAOJ,GAKxB,GAAI2lB,GAAY0d,GAAYC,EAMxB,MALI1vC,GAAI,GAAI8hC,GAAWpqC,MACvBsI,EAAEqtC,KAAOoC,EACTzvC,EAAE4tC,GAAK8B,EACP1vC,EAAEgM,IAAM+/B,EACR/rC,EAAEwM,IAAMw/B,EACDhsC,GAGf+/B,OAAQ,WACJ,GAAIxoC,GAAUG,KAAK03C,aAuBnB,OAtBI73C,GAAQ81C,OACR91C,EAAQ81C,KAAO91C,GAAAA,EAAQ81C,KACE,SAArB91C,EAAQ+1C,WACR/1C,EAAQ81C,KAAO91C,EAAQ81C,KAAKn0C,QAAQ,qBAAsB,YACnD3B,GAAQg2C,iBAEM,SAArBh2C,EAAQ+1C,UACJ51C,KAAKg2C,kBACLn2C,EAAQ81C,KAAO91C,EAAQ81C,KAAKn0C,QAAQ,yBAA0B,YACvD3B,GAAQm2C,kBAIvBn2C,EAAQq2C,KACRr2C,EAAQq2C,GAAKr2C,GAAAA,EAAQq2C,GACI,SAArBr2C,EAAQ+1C,UACJ51C,KAAKm2C,gBACLt2C,EAAQq2C,GAAKr2C,EAAQq2C,GAAG10C,QAAQ,yBAA0B,YACnD3B,GAAQs2C,gBAIpBt2C,GAEX63C,YAAa,WACT,OACI/B,KAAM31C,KAAK21C,KACXO,GAAIl2C,KAAKk2C,GACTN,SAAU51C,KAAK41C,SACfrkC,KAAMvR,KAAKuR,KACX+kC,aAAct2C,KAAKs2C,aACnBhiC,IAAKtU,KAAKsU,IACVQ,IAAK9U,KAAK8U,IACVjD,MAAO7R,KAAK6R,MACZ6kC,WAAY12C,KAAK02C,WACjBb,gBAAiB71C,KAAK61C,gBACtBG,gBAAiBh2C,KAAKg2C,gBACtBG,cAAen2C,KAAKm2C,cACpBW,uBAAwB92C,KAAK82C,uBAC7BC,qBAAsB/2C,KAAK+2C,qBAC3BC,gBAAiBh3C,KAAKg3C,gBACtBC,cAAej3C,KAAKi3C,cACpBJ,WAAY72C,KAAK62C,eAI7BlG,EAAQnJ,QAAU+N,EAClB5E,EAAQyF,qBACJ6B,YAAa,SAAU1B,EAAgBZ,GACnC,MAAOY,GAAiBZ,GAE5BuC,SAAU,SAAU3B,EAAgBZ,GAChC,MAAOY,GAAiBZ,GAE5BwC,QAAS,SAAU5B,EAAgBZ,EAAMO,GACrC,MAAOK,IAAkBZ,GAAQY,GAAkBL,GAEvDkC,QAAS,SAAU7B,EAAgBZ,GAC/B,MAAOY,IAAkBZ,GAE7B0C,WAAY,SAAU9B,EAAgBZ,GAClC,MAAOY,IAAkBZ,GAE7B2C,qBAAsB,SAAU/B,EAAgBZ,GAC5C,MAAOY,IAAkBZ,GAE7B4C,kBAAmB,SAAUhC,EAAgBZ,GACzC,MAAOY,IAAkBZ,GAE7B6C,WAAY,SAAUjC,EAAgBZ,EAAMO,GACxC,MAAOK,GAAiBZ,GAAQY,EAAiBL,GAErDG,OAAQ,SAAUE,EAAgBZ,GAC9B,MAAOA,IAEXnwB,KAAM,SAAU+wB,EAAgBjsC,GAC5B,MAAOA,GAAK+iB,QAAQkpB,QAG5B5F,EAAQvG,WAAaA,IACL,kBAAV7qC,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,qBACH,aACA,cACA,sBACA,yBACA,0BACDD,IACL,YACG,SAAUE,GAAV,GAIO41B,GACAC,EACAF,EACAhb,EACAs+B,EACAC,EAyEAC,CAjFAn5C,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DglB,EAAW51B,EAAM6Q,YAAY+kB,SAC7BC,EAAW71B,EAAM6Q,YAAYglB,SAC7BF,EAAU31B,EAAM6Q,YAAY8kB,QAC5Bhb,EAAQ3a,EAAM6Q,YAAY8J,MAE1Bu+B,EAAYl5C,EAAM4D,MAAMzD,QACxBC,KAAM,SAAUiS,GACZ7R,KAAKoY,OAASvG,EACd7R,KAAKyY,UAAYjZ,EAAM6Q,YAAY6qB,SAASppB,aAC5C9R,KAAK6+B,kBAAoBr/B,EAAM6Q,YAAY6qB,SAASppB,aACpD9R,KAAK44C,YAAcp5C,EAAM6Q,YAAY6qB,SAASppB,aAC9C9R,KAAKq/B,mBAAqB7/B,EAAM6Q,YAAY6qB,UAEhD4F,sBAAuB,WACnB,MAAO9gC,MAAKyY,UAAUsd,QAAQ/1B,KAAKohC,qBAAqBtvB,cAE5D+mC,+BAAgC,WAC5B,MAAO74C,MAAK6+B,kBAAkB9I,QAAQ/1B,KAAKohC,qBAAqBtvB,cAEpE6tB,uBAAwB,WACpB,MAAI3/B,MAAK+/B,sBACE//B,KAAKoY,OAAO0C,UAEZ9a,KAAKyY,UAAUsd,QAAQ/1B,KAAKohC,qBAAqBtvB,cAGhE8tB,oBAAqB,WAIjB,MAHK5/B,MAAK+/B,wBACN//B,KAAKohC,oBAAsBphC,KAAKyY,UAAUud,eAAeh2B,KAAKohC,sBAE3DphC,KAAK2/B,0BAEhBE,wBAAyB,WAIrB,MAHK7/B,MAAK+/B,wBACN//B,KAAKohC,oBAAsBphC,KAAKyY,UAAUwd,mBAAmBj2B,KAAKohC,sBAE/DphC,KAAK2/B,0BAEhB/oB,WAAY,SAAUlF,GAUlB,MATIA,KACA1R,KAAKq/B,mBAAqB3tB,EAAI6e,QAC9BvwB,KAAK44C,YAAc54C,KAAKoY,OAAOklB,gBAAgB5rB,EAAII,cACnD9R,KAAKoY,OAAO9I,MAAMoC,GAClB1R,KAAKoY,OAAOM,eACR9B,YAAY,EACZ6B,WAAW,KAGZzY,KAAK44C,aAEhBrpC,OAAQ,SAAUmC,EAAKonC,EAAUC,GAC7B,GAAIrnC,EAAK,CACL,GAAIA,EAAI4J,GAAGtb,KAAK6+B,mBACZ,MAEJ7+B,MAAKoY,OAAO4gC,cAAc,GAAI7+B,GAAMzI,EAAK1R,KAAKoY,SAC9CpY,KAAK6+B,kBAAoBntB,EACzB1R,KAAKyY,UAAYqgC,EACbC,KAAqB,GACjBrnC,EAAIkkB,UACJ51B,KAAKoY,OAAOioB,kBAAkB3uB,EAAK,SAAU4uB,GACzC5uB,EAAM4uB,EAAOjsB,UAEjBrU,KAAK4W,WAAWlF,IAEhB1R,KAAK4W,WAAW5W,KAAKyY,UAAUiY,YAAYH,SAE/CvwB,KAAKohC,oBAAsBphC,KAAKyY,UAAUpV,OAAS,GAEnDrD,KAAKoY,OAAOM,eAAgBD,WAAW,IAG/C,MAAOzY,MAAKyY,WAEhBsnB,oBAAqB,WACjB,MAAO//B,MAAK44C,YAAYt9B,GAAGtb,KAAKyY,cAGpCkgC,EAAQn5C,EAAME,WAAWC,QACzBC,KAAM,WACFJ,EAAME,WAAWsT,UAAUpT,KAAKG,KAAKC,MACrCA,KAAKi5C,QAAQ7vC,MAAMpJ,KAAMmJ,YAE7BjJ,QACI,iBACA,iBACA,iBACA,YACA,eACA,YACA,eACA,UACA,aACA,YACA,eACA,UAEJ+4C,QAAS,SAAU/lB,EAAUC,EAAa7gB,EAAWF,EAAa8mC,EAAcC,EAAaC,GACzFA,EAAmBA,MACnBp5C,KAAK2qC,mBACDlH,WAAY2V,EAAiB3V,WAC7BN,MAAOiW,EAAiBjW,MACxBmD,WAAY8S,EAAiB9S,WAC7B9C,SAAU4V,EAAiB5V,SAC3BE,OAAQ0V,EAAiB1V,OACzBC,KAAMyV,EAAiBzV,KACvB/wB,UAAWwmC,EAAiBxmC,UAC5BmB,KAAMqlC,EAAiBrlC,KACvB8vB,cAAeuV,EAAiBvV,cAChCD,UAAWwV,EAAiBxV,WAEhC5jC,KAAKm9B,MAAQ,GAAI39B,GAAM6Q,YAAYgpC,KAAKnmB,EAAU5gB,GAClDtS,KAAK88B,SAAW,GAAIt9B,GAAM6Q,YAAYgpC,KAAKlmB,EAAa/gB,GACxDpS,KAAK09B,gBACL19B,KAAKs5C,YAAc,EACnBt5C,KAAKu5C,eAAiB,EACtBv5C,KAAKw5C,iBAAkB,EACvBx5C,KAAKgqC,QAAU,KACfhqC,KAAKy5C,gBAAiB,EACtBz5C,KAAK05C,gBAAkB,KACvB15C,KAAKq7B,MAAQ,GAAI77B,GAAM6Q,YAAYspC,KAAK35C,KAAKm9B,MAAOn9B,KAAK88B,SAAU5J,EAAUC,EAAa+lB,EAAcC,GACxGn5C,KAAK8a,UAAY9a,KAAKq7B,MAAMtD,UAAUv4B,EAAM6Q,YAAY4qB,UACxDj7B,KAAK0oC,YAAc,GAAIlpC,GAAM6Q,YAAYwiB,YAAYK,EAAUC,EAAanzB,KAAK2qC,mBACjF3qC,KAAK45C,QAAU,GAAIp6C,GAAM6Q,YAAYwpC,OAAO75C,KAAKq7B,MAAOr7B,KAAK0oC,YAAY3V;AACzE/yB,KAAK85C,eAAiB,GAAIpB,GAAU14C,MACpCA,KAAK+5C,eAAiB,GAAIrB,GAAU14C,MACpCA,KAAKg6C,uBAETC,gBAAiB,WACb,MAAOj6C,MAAKk6C,QAAUl6C,KAAK+5C,eAAiB/5C,KAAK85C,gBAErD3sB,UAAW,WAIP,MAHKntB,MAAKm6C,aACNn6C,KAAKm6C,WAAa,GAAI36C,GAAM6Q,YAAYgsB,eAAer8B,OAEpDA,KAAKm6C,YAEhBt+B,YAAa,WAIT,MAHK7b,MAAKo6C,eACNp6C,KAAKo6C,aAAe,GAAI56C,GAAM6Q,YAAYkxB,YAAYvhC,OAEnDA,KAAKo6C,cAEhBh7B,MAAO,SAAU1b,GACb,MAAKA,IAGL1D,KAAKq6C,WAAa32C,EACX1D,MAHIA,KAAKq6C,YAKpBvuC,KAAM,WACF,MAAO9L,MAAKof,SAEhB5O,UAAW,SAAU8pC,EAAU52C,EAAO4N,GAClC,MAAc7D,UAAV/J,EACO42C,KAEPA,EAAS52C,GACF1D,KAAK0Y,cAAcpH,KAGlCipC,OAAQ,SAAUzuC,EAAMpI,EAAO4N,GAC3B,MAAc7D,UAAV/J,EACO1D,KAAK8L,IAEZ9L,KAAK8L,GAAQpI,EACN1D,KAAK0Y,cAAcpH,KAGlCkpC,eAAgB,SAAU92C,GACtB,MAAc+J,UAAV/J,EACO1D,KAAKw5C,iBAEhBx5C,KAAKw5C,gBAAkB91C,EAChB1D,OAEX0Y,cAAe,SAAUpH,GAIrB,MAHKtR,MAAKw5C,iBACNx5C,KAAKU,QAAQ,SAAU4Q,GAEpBtR,MAEXg5C,cAAe,SAAUroC,GACrB3Q,KAAKU,QAAQ,UAAYiQ,MAAOA,KAEpC8pC,cAAe,SAAU10B,EAAYtO,GAC7BzX,KAAK06C,kBACL16C,KAAK06C,iBAAiBz6B,UAE1BjgB,KAAK06C,iBAAmB,GAAIl7C,GAAM6Q,YAAYsqC,uBAC1C50B,WAAYA,EACZlU,MAAO7R,KACPyX,QAASA,IAEbzX,KAAK+lB,WAAa/lB,KAAK06C,iBAAiB30B,YAE5Coc,WAAY,SAAUyY,GAClB,IAAI56C,KAAKU,QAAQ,cAAgB+J,MAAOmwC,IAGxC,MAAO56C,MAAKwQ,UAAUxQ,KAAK88B,SAAS9S,KAAKjY,KAAK/R,KAAK88B,UAAW8d,GAAen+B,QAAQ,KAEzF+lB,aAAc,SAAUoY,GACpB,IAAI56C,KAAKU,QAAQ,gBAAkB+J,MAAOmwC,IAG1C,MAAO56C,MAAKwQ,UAAUxQ,KAAK88B,SAAS+d,OAAO9oC,KAAK/R,KAAK88B,UAAW8d,GAAen+B,QAAQ,KAE3F2jB,eAAgB,SAAUwa,GACtB,MAAO56C,MAAKq7B,MAAMyB,SAASge,OAAOF,IAEtCG,WAAY,SAAUC,EAAgBC,GAA1B,GACJ7f,GAAOp7B,KAAKq7B,MACZnI,EAAWkI,EAAKlI,SAChBgoB,EAAiB9f,EAAKrD,UAAUijB,EAAe3mC,SAC/C8mC,EAAqB/f,EAAKrD,UAAUijB,EAAezkB,aACnD6kB,EAAYF,EAAepmC,IAAMoe,EAAWgoB,EAAe5mC,IAC3D+mC,EAAkBF,EAAmBrmC,IAAMoe,EAAWioB,EAAmB7mC,IACzEgnC,EAAcL,EAAUnmC,IAAMoe,EAAW+nB,EAAU3mC,GACvDtU,MAAK0oC,YAAYjvB,KAAK2hC,EAAWC,EAAiBC,IAEtDtZ,sBAAuB,SAAUyV,EAAOhmC,GAAjB,GAGfuiB,GAFA3oB,EAAOotC,CAIX,OAHAA,GAAoBhB,EAChBzjB,EAAMviB,IACVgnC,EAAoBptC,EACb2oB,GAEXzX,yBAA0B,SAAUk7B,GAChC,GAAI8D,GAAKv7C,KAAKsQ,SACdmnC,GAAM7lC,QAAQ,SAAUtS,GACpB,GAAqCmL,GAAjCoH,EAAQ0pC,EAAGC,YAAYl8C,EAAEuS,MACzBvS,aAAaE,GAAM6Q,YAAY4D,KAAK0M,QAAQwpB,UAC5C1/B,EAAQoH,EAAMwpB,MAAMogB,aAAan8C,GACjCuS,EAAM62B,YAAYvW,IAAI,UAAW1nB,EAAOA,EAAOnL,IAE/CA,YAAaE,GAAM6Q,YAAY+N,WAAWgsB,aAC1C3/B,EAAQoH,EAAMwpB,MAAMogB,aAAan8C,GACjCuS,EAAM62B,YAAYvW,IAAI,aAAc1nB,EAAOA,EAAOnL,OAI9Do8C,kBAAmB,SAAUvH,EAAWzkB,EAAOhb,EAAOmuB,GAAnC,GASPqR,GAiBJz7B,EAKAiD,CA9BJ1b,MAAK09B,aAAemF,EAAY9O,OAAO,SAAUhpB,EAAG2G,GAKhD,MAJAA,GAAMA,EAAI+jB,OAAO,KAAM,KAAM,KAAM,KAAmB,OAAb0e,EAAoBzkB,EAAOhb,GAChEhD,YAAe0jB,IACfrqB,EAAE5K,KAAKuR,GAEJ3G,OAEP/K,KAAKsQ,YACD4jC,EAAgBl0C,KAAKof,QACzBpf,KAAKsQ,UAAUqrC,QAAQ/pC,QAAQ,SAAUC,GACrCA,EAAMq2B,aAAa,SAAUxU,GACzB,GAAIrrB,GAAOqrB,EAAQ+B,OAAOye,EAAeC,EAAWzkB,EAAOhb,EACvDrM,IAAQowC,GACRA,EAAkBt4C,KAAKkI,KAG/BwJ,EAAM+pC,gBAAgB,SAAUx9B,GAC5B,GAAI/V,GAAO+V,EAAWqX,OAAOye,EAAeC,EAAWzkB,EAAOhb,EAC1DrM,IAAQowC,GACRA,EAAkBt4C,KAAKkI,OAInCrI,KAAKsQ,UAAUurC,YAAY3H,EAA4B,OAAbC,EAAoBzkB,EAAOhb,IAErE+D,EAAYzY,KAAKuP,SACrBkJ,EAAYA,EAAUgd,OAAO,KAAM,KAAM,KAAM,KAAmB,OAAb0e,EAAoBzkB,EAAOhb,GAC5E+D,IAAcjZ,EAAM6Q,YAAY2qB,SAChCh7B,KAAKuP,OAAOkJ,GAEZiD,EAAoB,OAAby4B,EAAqBn0C,KAAK88B,SAAW98B,KAAKm9B,MACrDzhB,EAAK+Z,OAAO/F,EAAOhb,IAEvBwzB,aAAc,SAAUz2B,GAAV,GACNk3B,GAAQ3oC,KAAK0oC,YACblsB,EAAWmsB,EAAM1kC,IAAI,WAAW8D,SAChC9B,EAAIuW,EAAS3b,MACjB2b,GAAS5K,QAAQ,SAAUtS,EAAG6C,GAC1BsP,EAAS1R,KAAKC,KAAMV,EAAEoE,MAAOvB,EAAG8D,IACjCjG,OAEP47C,gBAAiB,SAAUnqC,GACvB,GAAIk3B,GAAQ3oC,KAAK0oC,WACjBC,GAAM1kC,IAAI,cAAc8D,SAAS6J,QAAQ,SAAUtJ,GAC/CmJ,EAAS1R,KAAKC,KAAMsI,EAAE5E,QACvB1D,OAEP0iC,iBAAkB,SAAUzpB,EAAUsE,GAApB,GAQV6d,GACAzqB,CARJ,OAAI3Q,MAAK87C,kBAAkBC,SAEnBzqC,OAAQ,QACRC,KAAM,kCAGdgM,EAAQA,GAAS,EACb6d,EAAOp7B,KAAKq7B,MACZ1qB,EAAQ3Q,KAAK2Q,MAAMyqB,EAAKlI,SAAW3V,EAAO,EAAGA,EAAO6d,EAAKjI,eACzDxiB,EAAM85B,aAEFn5B,OAAQ,QACRC,KAAM,2BAKlBoxB,oBAAqB,SAAUnO,EAAUjX,GAApB,GAQb6d,GACAzqB,CARJ,OAAI3Q,MAAK87C,kBAAkBE,SAEnB1qC,OAAQ,QACRC,KAAM,kCAGdgM,EAAQA,GAAS,EACb6d,EAAOp7B,KAAKq7B,MACZ1qB,EAAQ3Q,KAAK2Q,MAAM,EAAGyqB,EAAKjI,YAAc5V,EAAO6d,EAAKlI,SAAU3V,KAC/D5M,EAAM85B,aAEFn5B,OAAQ,QACRC,KAAM,2BAKlByL,UAAW,SAAU/D,GACjB,GAAIpT,GAAS7F,KAAK0iC,iBAAiBzpB,EACnC,IAAIpT,EACA,KAAU+E,OAAM,8DAEpB,KAAI5K,KAAKU,QAAQ,aAAe+J,MAAOwO,IA+BvC,MA5BAjZ,MAAK4U,MAAM,WAAA,GAQHiuB,GACKoB,EACDvyB,EACA2C,EACAkiB,EACA0lB,EAZJ7gB,EAAOp7B,KAAKq7B,MACZlI,EAAciI,EAAKjI,YACnBD,EAAWkI,EAAKlI,SAChB3b,EAAavX,KAAKuX,YAKtB,KAJI0B,EAAW1B,GACXvX,KAAKuX,WAAWA,EAAa,GAE7BsrB,EAAc7iC,KAAK09B,aAAap9B,QAC3B2jC,EAAK,EAAGA,EAAK9Q,EAAa8Q,IAC3BvyB,EAAM,GAAI0jB,GAAS,GAAID,GAAQlc,EAAUgrB,GAAK,GAAI9O,GAAQlc,EAAUgrB,IACpE5vB,EAAU+mB,EAAKrD,UAAUrmB,EAAI2C,SAC7BkiB,EAAc6E,EAAKrD,UAAUrmB,EAAI6kB,aACjC0lB,EAAU,GAAI7mB,GAAS,GAAID,GAAQ9gB,EAAQC,IAAKD,EAAQS,KAAM,GAAIqgB,GAAQjC,EAAW,EAAGqD,EAAYzhB,MACxG9U,KAAK+6C,WAAWkB,EAAS,GAAI9mB,GAAQ9gB,EAAQC,IAAM,EAAGD,EAAQS,MAC9D,GAAIqF,GAAMzI,EAAK1R,MAAMC,OACjB+oC,UAAU,EACVG,aAAa,GAGrBnpC,MAAK07C,kBAAkB,MAAOziC,EAAU,EAAG4pB,KAE3ClqB,QAAQ,EACR8D,QAAQ,EACRO,WAAavS,MAAOwO,GACpBvH,IAAK,GAAI0jB,GAAS,GAAID,GAAQlc,EAAU,GAAI,GAAIkc,GAAQtY,EAAAA,EAAUA,EAAAA,MAEtE7c,KAAKU,QAAQ,kBAAoB+J,MAAOwO,IACjCjZ,MAEXk8C,aAAc,SAAUjjC,GACpB,GAAIvH,GAAM,GAAI0jB,GAAS,GAAID,GAAQlc,EAAU,GAAI,GAAIkc,GAAQlc,EAAUjZ,KAAKq7B,MAAMlI,aAClF,OAAO,IAAIhZ,GAAMzI,EAAK1R,MAAMkT,UAEhCgL,UAAW,SAAUjF,GACjB,IAAKjZ,KAAKk8C,aAAajjC,GACnB,MAAOjZ,KAEX,KAAIA,KAAKU,QAAQ,aAAe+J,MAAOwO,IAgCvC,MA7BAjZ,MAAK4U,MAAM,WAAA,GAOHiuB,GACKoB,EACDvyB,EAKA2C,EACAkiB,EACA0lB,EAEAd,EAjBJ/f,EAAOp7B,KAAKq7B,MACZlI,EAAciI,EAAKjI,YACnB5b,EAAavX,KAAKuX,YAKtB,KAJI0B,EAAW1B,GACXvX,KAAKuX,WAAWA,EAAa,GAE7BsrB,EAAc7iC,KAAK09B,aAAap9B,QAC3B2jC,EAAK,EAAGA,EAAK9Q,EAAa8Q,IAC3BvyB,EAAM,GAAI0jB,GAAS,GAAID,GAAQlc,EAAUgrB,GAAK,GAAI9O,GAAQlc,EAAUgrB,IACxE,GAAI9pB,GAAMzI,EAAK1R,MAAMC,OACjB+oC,UAAU,EACVG,aAAa,IAEb90B,EAAU+mB,EAAKrD,UAAUrmB,EAAI2C,SAC7BkiB,EAAc6E,EAAKrD,UAAUrmB,EAAI6kB,aACjC0lB,EAAU,GAAI7mB,GAAS,GAAID,GAAQ9gB,EAAQC,IAAM,EAAGD,EAAQS,KAAM,GAAIqgB,GAAQtY,EAAAA,EAAU0Z,EAAYzhB,MACxG9U,KAAK+6C,WAAWkB,EAAS5nC,GACrB8mC,EAAqB/f,EAAKrD,UAAUkkB,EAAQ1lB,aAChD,GAAIpc,GAAM,GAAIib,GAAS+lB,EAAoBA,GAAqBn7C,MAAMC,OAE1ED,MAAK07C,kBAAkB,MAAOziC,KAAc4pB,KAE5ClqB,QAAQ,EACR8D,QAAQ,EACRyB,WAAazT,MAAOwO,GACpBvH,IAAK,GAAI0jB,GAAS,GAAID,GAAQlc,EAAU,GAAI,GAAIkc,GAAQtY,EAAAA,EAAUA,EAAAA,MAEtE7c,KAAKU,QAAQ,kBAAoB+J,MAAOwO,IACjCjZ,MAEXqd,aAAc,SAAUu9B,GACpB,IAAI56C,KAAKU,QAAQ,gBAAkB+J,MAAOmwC,IAgC1C,MA7BA56C,MAAK4U,MAAM,WAAA,GAOHiuB,GACKoB,EACDvyB,EAQA2C,EACAkiB,EACA0lB,EAlBJ7gB,EAAOp7B,KAAKq7B,MACZlI,EAAciI,EAAKjI,YACnB7b,EAAgBtX,KAAKsX,eAKzB,KAJIsjC,EAActjC,GACdtX,KAAKsX,cAAcA,EAAgB,GAEnCurB,EAAc7iC,KAAK09B,aAAap9B,QAC3B2jC,EAAK9Q,EAAa8Q,GAAM2W,IACzBlpC,EAAM,GAAI0jB,GAAS,GAAID,GAAQ,EAAG8O,GAAK,GAAI9O,GAAQtY,EAAAA,EAAUonB,IACjE,GAAI9pB,GAAMzI,EAAK1R,MAAMC,OACjB+oC,UAAU,EACVG,aAAa,IAEblF,GAAM2W,GANgC3W,IAStC5vB,EAAU+mB,EAAKrD,UAAUrmB,EAAI2C,SAC7BkiB,EAAc6E,EAAKrD,UAAUrmB,EAAI6kB,aACjC0lB,EAAU,GAAI7mB,GAAS,GAAID,GAAQ9gB,EAAQC,IAAKD,EAAQS,IAAM,GAAI,GAAIqgB,GAAQoB,EAAYjiB,IAAKiiB,EAAYzhB,IAAM,IACrH9U,KAAK+6C,WAAWkB,EAAS5nC,EAE7BrU,MAAK07C,kBAAkB,MAAOd,EAAa,EAAG/X,KAE9ClqB,QAAQ,EACR8D,QAAQ,EACRY,cAAgB5S,MAAOmwC,GACvBlpC,IAAK,GAAI0jB,GAAS,GAAID,GAAQ,EAAGylB,GAAc,GAAIzlB,GAAQtY,EAAAA,EAAUA,EAAAA,MAElE7c,MAEXm8C,gBAAiB,SAAUvB,GACvB,GAAIlpC,GAAM,GAAI0jB,GAAS,GAAID,GAAQ,EAAGylB,GAAc,GAAIzlB,GAAQtY,EAAAA,EAAU+9B,GAC1E,OAAO,IAAIzgC,GAAMzI,EAAK1R,MAAMkT,UAEhC2K,aAAc,SAAU+8B,GACpB,IAAK56C,KAAKm8C,gBAAgBvB,GACtB,MAAO56C,KAEX,KAAIA,KAAKU,QAAQ,gBAAkB+J,MAAOmwC,IAgC1C,MA7BA56C,MAAK4U,MAAM,WAAA,GAOHiuB,GACKoB,EACDvyB,EAQA2C,EACAkiB,EACA0lB,EAlBJ7gB,EAAOp7B,KAAKq7B,MACZlI,EAAciI,EAAKjI,YACnB7b,EAAgBtX,KAAKsX,eAKzB,KAJIsjC,EAActjC,GACdtX,KAAKsX,cAAcA,EAAgB,GAEnCurB,EAAc7iC,KAAK09B,aAAap9B,QAC3B2jC,EAAK2W,EAAa3W,EAAK9Q,IACxBzhB,EAAM,GAAI0jB,GAAS,GAAID,GAAQ,EAAG8O,GAAK,GAAI9O,GAAQtY,EAAAA,EAAUonB,IACjE,GAAI9pB,GAAMzI,EAAK1R,MAAMC,OACjB+oC,UAAU,EACVG,aAAa,IAEblF,GAAM9Q,EAAc,GANiB8Q,IASrC5vB,EAAU+mB,EAAKrD,UAAUrmB,EAAI2C,SAC7BkiB,EAAc6E,EAAKrD,UAAUrmB,EAAI6kB,aACjC0lB,EAAU,GAAI7mB,GAAS,GAAID,GAAQ9gB,EAAQC,IAAKD,EAAQS,IAAM,GAAI,GAAIqgB,GAAQoB,EAAYjiB,IAAKiiB,EAAYzhB,IAAM,IACrH9U,KAAK+6C,WAAWkB,EAAS5nC,EAE7BrU,MAAK07C,kBAAkB,MAAOd,KAAiB/X,KAE/ClqB,QAAQ,EACR8D,QAAQ,EACRoB,cAAgBpT,MAAOmwC,GACvBlpC,IAAK,GAAI0jB,GAAS,GAAID,GAAQ,EAAGylB,GAAc,GAAIzlB,GAAQtY,EAAAA,EAAUA,EAAAA,MAElE7c,MAEXuiC,QAAS,SAAUtpB,GACf,IAAIjZ,KAAKU,QAAQ,WAAa+J,MAAOwO,IAGrC,MAAOjZ,MAAKwQ,UAAUxQ,KAAKm9B,MAAMnT,KAAKjY,KAAK/R,KAAKm9B,OAAQlkB,GAAYwD,QAAQ,KAEhFgmB,UAAW,SAAUxpB,GACjB,IAAIjZ,KAAKU,QAAQ,aAAe+J,MAAOwO,IAGvC,MAAOjZ,MAAKwQ,UAAUxQ,KAAKm9B,MAAM0d,OAAO9oC,KAAK/R,KAAKm9B,OAAQlkB,GAAYwD,QAAQ,KAElF0jB,YAAa,SAAUlnB,GACnB,MAAOjZ,MAAKq7B,MAAM8B,MAAM2d,OAAO7hC,IAEnC7G,YAAa,SAAUwoC,EAAar4C,GAChC,MAAOvC,MAAKwQ,UAAUxQ,KAAK88B,SAASp5B,MAAMqO,KAAK/R,KAAK88B,SAAU8d,EAAaA,GAAcr4C,GAASka,QAAQ,KAE9GnK,UAAW,SAAU2G,EAAUzW,GAC3B,MAAOxC,MAAKwQ,UAAUxQ,KAAKm9B,MAAMz5B,MAAMqO,KAAK/R,KAAKm9B,MAAOlkB,EAAUA,GAAWzW,GAAUia,QAAQ,KAEnGlF,WAAY,SAAU7T,GAClB,MAAO1D,MAAKu6C,OAAO,cAAe72C,GAAS+Y,QAAQ,KAEvDnF,cAAe,SAAU5T,GACrB,MAAO1D,MAAKu6C,OAAO,iBAAkB72C,GAAS+Y,QAAQ,KAE1D1J,cAAe,SAAUrP,GACrB,MAAO1D,MAAKu6C,OAAO,iBAAkB72C,GAAS+Y,QAAQ,KAE1D2/B,eAAgB,SAAU14C,GACtB,MAAO1D,MAAKu6C,OAAO,kBAAmB72C,GAAS+Y,QAAQ,KAE3D9K,KAAM,SAAU2C,EAAKoG,EAAQ2hC,EAASC,GAClC,GAAI5qC,GAAM,IACV,OAAI4C,aAAe9U,GAAM6Q,YAAY2kB,IAC1B1gB,EAEPA,YAAe9U,GAAM6Q,YAAY8J,MAC1B7F,EAAI3C,KAAKG,cAED,gBAARwC,GACP5C,EAAMlS,EAAM6Q,YAAY4D,KAAKsoC,eAAejoC,IAEvC+nC,IACDA,EAAU,GAETC,IACDA,EAAa,GAEjB5qC,EAAM,GAAI0jB,GAAS,GAAID,GAAQ7gB,EAAKoG,GAAS,GAAIya,GAAQ7gB,EAAM+nC,EAAU,EAAG3hC,EAAS4hC,EAAa,KAE/F5qC,IAEXf,MAAO,SAAU2D,EAAKoG,EAAQ2hC,EAASC,GACnC,MAAO,IAAIniC,GAAMna,KAAK2R,KAAK2C,EAAKoG,EAAQ2hC,EAASC,GAAat8C,OAElE0pC,gBAAiB,SAAU/4B,GAAV,GACTyqB,GAAOp7B,KAAKq7B,MACZkO,KACAC,KACAG,GAAY,CAahB,OAZA3pC,MAAKqgC,kBAAkB1vB,EAAO,SAAUe,GACpC,GAAI2C,GAAU3C,EAAI2C,OAClB+mB,GAAKxpB,QAAQF,EAAK,SAAU8qC,GACpBnoC,EAAQiH,GAAGkhC,IACXjT,EAAQiT,EAAQzxB,SAAWrZ,EAC3Bi4B,GAAY,GACLh5B,EAAMunB,SAASskB,KACtBhT,EAAUgT,EAAQzxB,SAAW1W,EAC7Bs1B,GAAY,QAKpBJ,QAASA,EACTC,UAAWA,EACXG,UAAWA,IAGnBtJ,kBAAmB,SAAU3uB,EAAKD,GAC9B,GAAImsB,IAAY,CACQ,UAAbnsB,IACPA,EAAWC,EACXksB,GAAY,GAEhB59B,KAAK09B,aAAa9rB,QAAQ,SAAU0uB,IAC5B1C,GAAa0C,EAAOvQ,WAAWre,KAC/BD,EAAS6uB,MAIrBmc,oBAAqB,SAAU/qC,EAAKD,GAAf,GAOTglB,GANJmH,GAAY,CACQ,UAAbnsB,IACPA,EAAWC,EACXksB,GAAY,GAEZ59B,KAAKgqC,UACDvT,KACJz2B,KAAKgqC,QAAQt4B,IAAIwF,cAAc,SAAUwlC,IACjC9e,GAAa8e,EAAU3sB,WAAWre,KAClC+kB,EAAKt2B,KAAKu8C,EAAUroC,WAG5BrU,KAAK09B,aAAa9rB,QAAQ,SAAU0uB,GAChC7J,EAAOA,EAAK9yB,IAAI,SAAU+N,GACtB,MAAI4uB,GAAOvQ,WAAWre,GACX4uB,EAEJ5uB,MAGf+kB,EAAK1C,OAAO,SAAgBluB,EAAQ0V,GAIhC,MAHI1V,GAAOwnB,QAAQ9R,GAAW,GAC1B1V,EAAO1F,KAAKob,GAET1V,OACJ+L,QAAQH,KAGvBG,QAAS,SAAUF,EAAKD,GAEpB,QAASkrC,GAAajrC,GAOlB,QAASkrC,GAAKl5C,GACV+N,EAASuyB,IAAMC,EAAIvgC,GAR3B,GAIQ2Q,GACAkiB,EACA0N,EAAID,EAMA6Y,EACAC,CAHR,KATMprC,YAAe0jB,KACjB1jB,EAAMA,EAAII,cAEVuC,EAAUkB,EAAK8lB,MAAMtD,UAAUrmB,EAAI2C,SACnCkiB,EAAchhB,EAAK8lB,MAAMtD,UAAUrmB,EAAI6kB,aAKtC0N,EAAK5vB,EAAQS,IAAKmvB,GAAM1N,EAAYzhB,IAAKmvB,IAC1CD,EAAK3vB,EAAQC,IACTuoC,EAAiBtnC,EAAK8lB,MAAM5wB,MAAMu5B,EAAIC,GACtC6Y,EAAevnC,EAAK8lB,MAAM5wB,MAAM8rB,EAAYjiB,IAAK2vB,GACrD1uB,EAAKmzB,YAAY92B,QAAQirC,EAAgBC,EAAcF,GAf/D,GAAIrnC,GAAOvV,IAkBL0R,aAAe0jB,KACjB1jB,EAAM6D,EAAK5D,KAAKD,IAEhBA,YAAe2jB,GACf3jB,EAAIE,QAAQ+qC,GAEZA,EAAajrC,IAGrBqrC,cAAe,SAAUC,GACrBh9C,KAAKi9C,iBAAmBD,EACxBh9C,KAAKk9C,mBAAoB,GAE7B/e,cAAe,WACXn+B,KAAKm9C,qBAAsB,CAC3B,IAAI1kC,GAAYzY,KAAKuP,QACrBvP,MAAKygC,gBAAkBhoB,EACvBzY,KAAKo9C,cAAgB3kC,EACrBzY,KAAK0Y,eAAgBD,WAAW,KAEpCooB,eAAgB,SAAUH,EAAMC,EAAOJ,EAAM7B,GACzC1+B,KAAKo9C,cAAgB1c,EACrB1gC,KAAKq9C,eAAiB1c,EACtB3gC,KAAKs9C,cAAgB/c,EACrBvgC,KAAKu9C,mBAAqB7e,EAC1B1+B,KAAK0Y,eAAgBD,WAAW,KAEpC+kC,YAAa,WACT,MAAOx9C,MAAKo9C,eAEhBK,cAAe,WACX,MAAOz9C,MAAKq9C,gBAEhBK,mBAAoB,WAChB,MAAO19C,MAAKm9C,qBAEhBQ,mBAAoB,WAChB,MAAO39C,MAAKk9C,mBAEhBU,iBAAkB,WAAA,GAGNC,GAEIC,CAJR99C,MAAKk9C,oBACLl9C,KAAKk9C,mBAAoB,EACrBW,EAAe79C,KAAK+9C,qBACpB/9C,KAAKi9C,kBAAoBY,GACrBC,EAAiB99C,KAAKg+C,uBACtBF,EAAehpC,QAAS+H,EAAAA,GACxB7c,KAAKU,QAAQ,kBACTN,QAAS,qBACTP,SACIoS,OAAQ6rC,EAAehpC,IACvBpR,MAAO1D,KAAKoS,YAAY0rC,EAAehpC,MAAQ9U,KAAKi9C,iBAAiBz0C,EAAIq1C,EAAar1C,MAI9FxI,KAAKU,QAAQ,kBACTN,QAAS,mBACTP,SACIoS,OAAQ6rC,EAAexpC,IACvB5Q,MAAO1D,KAAKsS,UAAUwrC,EAAexpC,MAAQtU,KAAKi9C,iBAAiBxuB,EAAIovB,EAAapvB,OAKhGzuB,KAAKU,QAAQ,UAAYic,QAAQ,MAI7CqhC,qBAAsB,WAClB,MAAOh+C,MAAKi+C,uBAEhBF,mBAAoB,SAAUG,GAK1B,MAJiBzwC,UAAbywC,IACAl+C,KAAKm+C,oBAAsBD,EAC3Bl+C,KAAKU,QAAQ,UAAYic,QAAQ,KAE9B3c,KAAKm+C,qBAEhBC,mBAAoB,WACZp+C,KAAKi+C,wBACLj+C,KAAKm+C,oBAAsB1wC,OAC3BzN,KAAKi+C,sBAAwBxwC,OAC7BzN,KAAKi9C,iBAAmBxvC,OACxBzN,KAAKU,QAAQ,UAAYic,QAAQ,MAGzC0hC,qBAAsB,SAAU3sC,GAC5B1R,KAAKi+C,sBAAwBvsC,EAC7B1R,KAAKU,QAAQ,UAAYic,QAAQ,KAErCuhB,eAAgB,WACZl+B,KAAKs+C,sBAAuB,GAEhClgB,kBAAmB,WAAA,GAQPsC,GACA3mB,CARJ/Z,MAAKs+C,uBACLt+C,KAAKs+C,sBAAuB,EAC5Bt+C,KAAKm+C,oBAAsB1wC,OAC3BzN,KAAKU,QAAQ,UAAY+X,WAAW,KAEpCzY,KAAKm9C,sBACLn9C,KAAKm9C,qBAAsB,EACvBzc,EAAO1gC,KAAKo9C,cACZrjC,EAAS/Z,KAAKygC,gBACdzgC,KAAKq9C,eACLr9C,KAAKU,QAAQ,kBACTN,QAAS,sBACTP,SAAW0+C,eAAgBv+C,KAAK2Q,MAAM3Q,KAAKq9C,mBAG1C3c,EAAKplB,GAAGvB,GAST/Z,KAAK0Y,eAAgBD,WAAW,IARhCzY,KAAKU,QAAQ,kBACTN,QAAS,kBACTP,SACI0+C,eAAgBv+C,KAAK2Q,MAAM+vB,GAC3B3mB,OAAQ/Z,KAAK2Q,MAAMoJ,MAOnC/Z,KAAKo9C,cAAgB,KACrBp9C,KAAKq9C,eAAiB,KACtBr9C,KAAKygC,gBAAkB,KACvBzgC,KAAKuP,OAAOmxB,KAGpB8d,oBAAqB,WACjB,MAAOx+C,MAAKs+C,sBAEhB/uC,OAAQ,SAAUmC,EAAKqnC,GAAf,GAEA0F,GADAC,EAAiB1+C,KAAKi6C,iBAO1B,OALIvoC,KACAA,EAAM1R,KAAK2R,KAAKD,GAChBA,EAAM1R,KAAKq7B,MAAMtD,UAAUrmB,GAC3B+sC,EAAcz+C,KAAKq7B,MAAMsjB,OAAOjtC,GAAOA,EAAM1R,KAAKs9B,gBAAgB5rB,IAE/DgtC,EAAenvC,OAAOmC,EAAK+sC,EAAa1F,IAEnD5X,eAAgB,WACZ,MAAOnhC,MAAKi6C,kBAAkBpb,mBAElCiC,sBAAuB,WACnB,MAAO9gC,MAAKi6C,kBAAkBnZ,yBAElChC,8BAA+B,WAC3B,MAAO9+B,MAAKi6C,kBAAkBpB,kCAElClZ,uBAAwB,WACpB,MAAO3/B,MAAKi6C,kBAAkBta,0BAElCC,oBAAqB,WACjB,MAAO5/B,MAAKi6C,kBAAkBra,uBAElCC,wBAAyB,WACrB,MAAO7/B,MAAKi6C,kBAAkBpa,2BAElCuB,oBAAqB,WACjB,MAAOphC,MAAKi6C,kBAAkB7Y,qBAElCxqB,WAAY,SAAUlF,GAClB,MAAO1R,MAAKi6C,kBAAkBrjC,WAAWlF,IAE7C2tB,mBAAoB,WAChB,MAAOr/B,MAAKi6C,kBAAkB5a,oBAElCU,oBAAqB,WACjB,MAAO//B,MAAKi6C,kBAAkBla,uBAElCzC,gBAAiB,SAAU5rB,GACvB,GAAImxB,GAAc7iC,KAAK09B,YACvB,OAAOhsB,GAAI/N,IAAI,SAAU+N,GACrB,MAAOA,GAAII,aAAakoB,MAAM6I,MAGtC+b,KAAM,SAAUltC,GAAV,GACEmtC,MACAzjB,EAAOp7B,KAAKq7B,KAIhB,OAHAr7B,MAAK0oC,YAAYrU,gBAAgB,SAAU5jB,GACvCouC,EAAM1+C,KAAKi7B,EAAKwjB,KAAKltC,EAAKjB,EAAS+U,SAEhCxlB,KAAKs9B,gBAAgB5rB,EAAI2C,QAAQvC,aAAakoB,MAAM6kB,KAE/DvvC,MAAO,SAAUoC,GACb,IAAIA,EAEG,CACH,GAAIpC,GAAQtP,KAAK2iB,MAEjB,OADA3iB,MAAK2iB,OAAS,KACPrT,EAJPtP,KAAK2iB,OAASjR,EAAII,cAO1B4B,oBAAqB,WACjB,MAAO,IAAIyG,GAAMna,KAAKq7B,MAAMtD,UAAU/3B,KAAK4W,cAAe5W,OAE9DyY,UAAW,WACP,MAAO,IAAI0B,GAAMna,KAAKq7B,MAAMtD,UAAU/3B,KAAKi6C,kBAAkBxhC,WAAYzY,OAE7E87C,gBAAiB,WAAA,GACTrjC,GAAYzY,KAAKuP,SACjBiI,KACAijB,KACAuhB,GAAU,EACVD,GAAU,EACV+C,EAAS9+C,KAAKq7B,MAAMnI,SAAW,EAC/B6rB,EAAS/+C,KAAKq7B,MAAMlI,YAAc,CAiCtC,OAhCA1a,GAAU7G,QAAQ,SAAUF,GAAV,GACVvP,GAIAo0B,EACAliB,EACA2qC,EACAC,EANAC,EAAW,UACXC,EAAW,SAcf,IAbAztC,EAAMA,EAAII,aACNykB,EAAc7kB,EAAI6kB,YAClBliB,EAAU3C,EAAI2C,QACd2qC,EAAe3qC,EAAQS,KAAO,GAAKyhB,EAAYzhB,KAAOiqC,EACtDE,EAAe5qC,EAAQC,KAAO,GAAKiiB,EAAYjiB,KAAOwqC,EACtDG,IACAlD,GAAU,EACVoD,EAAW,QAEXH,IACAhD,GAAU,EACVkD,EAAW,SAEVD,EACD,IAAK98C,EAAIkS,EAAQC,IAAKnS,GAAKo0B,EAAYjiB,IAAKnS,IACxB,SAAZqV,EAAKrV,KACLqV,EAAKrV,GAAK+8C,EAItB,KAAKF,EACD,IAAK78C,EAAIkS,EAAQS,IAAK3S,GAAKo0B,EAAYzhB,IAAK3S,IACxB,SAAZs4B,EAAKt4B,KACLs4B,EAAKt4B,GAAKg9C,MAMtB3nC,KAAMA,EACNijB,KAAMA,EACNshB,QAASA,EACTC,QAASA,EACToD,IAAKrD,GAAWC,IAGxBrU,aAAc,SAAU0X,GACpB,MAAiB5xC,UAAb4xC,EACOr/C,KAAKk6C,SAEhBl6C,KAAKk6C,QAAUmF,OACXA,IACAr/C,KAAK+5C,eAAethC,UAAYzY,KAAK85C,eAAerhC,UAAUmS,QAC9D5qB,KAAK+5C,eAAelb,kBAAoB7+B,KAAK85C,eAAejb,kBAAkBjU,QAC9E5qB,KAAK+5C,eAAenB,YAAc54C,KAAK85C,eAAelB,YAAYhuB,QAClE5qB,KAAK+5C,eAAe1a,mBAAqBr/B,KAAK85C,eAAeza,mBAAmBzU,YAGxF00B,sBAAuB,SAAU7mC,GAC7BzY,KAAKg6C,oBAAsBvhC,OAAiBnY,QAC5CN,KAAK0Y,eAAgBD,WAAW,KAEpC8mC,gBAAiB,WACb,MAAOv/C,MAAK85C,eAAelB,YAAY9mC,cAE3Cu2B,OAAQ,WAOJ,QAASmX,GAAkBzqC,GACvB/L,OAAOiY,KAAKm4B,GAAkBxnC,QAAQ,SAAU/P,GACxCkT,EAAKlT,KAASu3C,EAAiBv3C,UACxBkT,GAAKlT,KAVpB,GAqEA49C,GApEAC,KACAloC,EAAOxX,KAAKm9B,MAAMkL,OAAO,SAAUqX,GACnCjoC,EAAUzX,KAAK88B,SAASuL,OAAO,YAC/BsX,EAAgB3/C,KAAK85C,eACrB8F,KACAxG,EAAmBp5C,KAAK2qC,qBAoG5B,OA5FA3qC,MAAK4R,QAAQpS,EAAM6Q,YAAY4qB,SAAU,SAAU3mB,EAAKQ,EAAKC,GAEzD,GADAyqC,EAAkBzqC,GACe,IAA7B/L,OAAOiY,KAAKlM,GAAMlU,OAAtB,CAGIkU,EAAKtC,MACLmtC,EAAWz/C,MACPuR,IAAKlS,EAAM6Q,YAAY2kB,IAAIqC,QAAQ,KAAM/iB,EAAKQ,GAC9C7C,OAAQ8C,EAAKtC,MAGrB,IAAI2W,GAAWs2B,EAAUprC,EACR7G,UAAb2b,IACAA,EAAW5R,EAAK3W,OAChB2W,EAAKrX,MAAOsK,MAAO6J,IACnBorC,EAAUprC,GAAO8U,GAErB9U,EAAMkD,EAAK4R,GACXrU,EAAKtK,MAAQqK,EACKrH,SAAd6G,EAAIwC,QACJxC,EAAIwC,UAEJ/B,EAAK2e,UAED3e,EAAK2e,QADL3e,EAAK2e,QAAQyU,mBAET0X,IAAK9qC,GAAAA,EAAK2e,QACVhiB,IAAKqD,GAAAA,EAAK2e,QAAQyU,mBAGPpzB,GAAAA,EAAK2e,SAGxB3e,EAAKqJ,aACLrJ,EAAKqJ,WAAarJ,EAAKqJ,WAAWiqB,UAElCtzB,EAAKouB,QACLpuB,EAAKouB,MAAQ3jC,EAAMsgD,WAAW/qC,EAAKouB,OAAO4c,SAE1ChrC,EAAK0uB,aACL1uB,EAAK0uB,WAAajkC,EAAMsgD,WAAW/qC,EAAK0uB,YAAYsc,SAEpDhrC,EAAKqB,WAAarB,EAAKqB,UAAU+sB,QACjCpuB,EAAKqB,UAAU+sB,MAAQ3jC,EAAMsgD,WAAW/qC,EAAKqB,UAAU+sB,OAAO4c,SAE9DhrC,EAAKwB,cAAgBxB,EAAKwB,aAAa4sB,QACvCpuB,EAAKwB,aAAa4sB,MAAQ3jC,EAAMsgD,WAAW/qC,EAAKwB,aAAa4sB,OAAO4c,SAEpEhrC,EAAKkB,aAAelB,EAAKkB,YAAYktB,QACrCpuB,EAAKkB,YAAYktB,MAAQ3jC,EAAMsgD,WAAW/qC,EAAKkB,YAAYktB,OAAO4c,SAElEhrC,EAAKe,YAAcf,EAAKe,WAAWqtB,QACnCpuB,EAAKe,WAAWqtB,MAAQ3jC,EAAMsgD,WAAW/qC,EAAKe,WAAWqtB,OAAO4c,SAEpEzrC,EAAIwC,MAAM3W,KAAK4U,MAEf0qC,GACA3zC,KAAM9L,KAAKof,QACX5H,KAAMA,EACNC,QAASA,EACTgB,UAAWknC,GAAAA,EAAclnC,UACzB7B,WAAY+oC,GAAAA,EAAc/oC,aAC1BW,WAAYvX,KAAKuX,aACjBD,cAAetX,KAAKsX,gBACpBvE,cAAe/S,KAAK+S,gBACpBqpC,eAAgBp8C,KAAKo8C,iBACrBvZ,YAAa7iC,KAAK09B,aAAa/5B,IAAI,SAAU+N,GACzC,MAAOA,GAAAA,IAEXkuC,WAAYA,EACZxG,iBAAkBA,GAElBp5C,KAAKggD,QACLP,EAAK19C,MACD2P,IAAK1R,GAAAA,KAAKggD,MAAMtuC,IAChB+F,QAASzX,KAAKggD,MAAMvoC,QAAQ9T,IAAI,SAAU+W,GACtC,OACIjQ,MAAOiQ,EAAOjQ,MACdkQ,UAAWD,EAAOC,eAK9B3a,KAAKgqC,UACLyV,EAAKllC,QACD7I,IAAK1R,GAAAA,KAAKgqC,QAAQt4B,IAClB+F,QAASzX,KAAKgqC,QAAQvyB,QAAQ9T,IAAI,SAAU+W,GACxC,GAAIH,GAASG,EAAOH,OAAO8tB,QAE3B,OADA9tB,GAAO9P,MAAQiQ,EAAOjQ,MACf8P,MAIZklC,GAEX9rB,SAAU,SAAU8rB,GAChBz/C,KAAK4U,MAAM,WAAA,GAeMovB,GACD1vB,EACA2E,EAKSgrB,EACDlvB,EACA6lC,EAKInP,EACAoU,EACAnsB,EAkBhBusB,EAgBAvuC,EACA+F,CArDR,IAZkBhK,SAAdgyC,EAAK3zC,MACL9L,KAAKof,MAAMqgC,EAAK3zC,MAEO2B,SAAvBgyC,EAAKnoC,eACLtX,KAAKsX,cAAcmoC,EAAKnoC,eAEJ7J,SAApBgyC,EAAKloC,YACLvX,KAAKuX,WAAWkoC,EAAKloC,YAEJ9J,SAAjBgyC,EAAKhoC,SACLzX,KAAK88B,SAASnJ,SAAS,QAAS8rB,EAAKhoC,SAEvBhK,SAAdgyC,EAAKjoC,KAEL,IADAxX,KAAKm9B,MAAMxJ,SAAS,SAAU8rB,EAAKjoC,MAC1BwsB,EAAK,EAAGA,EAAKyb,EAAKjoC,KAAK3W,OAAQmjC,IAMpC,GALI1vB,EAAMmrC,EAAKjoC,KAAKwsB,GAChB/qB,EAAW3E,EAAI7J,MACFgD,SAAbwL,IACAA,EAAW+qB,GAEX1vB,EAAIwC,MACJ,IAASmtB,EAAK,EAAGA,EAAK3vB,EAAIwC,MAAMjW,OAAQojC,IAChClvB,EAAOT,EAAIwC,MAAMmtB,GACjB2W,EAAc7lC,EAAKtK,MACHgD,SAAhBmtC,IACAA,EAAc3W,GAEdlvB,EAAK2e,UACD+X,EAAiC,gBAAhB12B,GAAK2e,QACtBmsB,EAAMpU,EAAU12B,EAAK2e,QAAQmsB,IAAM9qC,EAAK2e,QACxCA,EAAU1zB,KAAKkgD,gBAAgBjnC,EAAU2hC,EAAaiF,GACtDpU,GACA/X,EAAQuU,qBAAqBzoC,EAAM6Q,YAAY4D,KAAKsoC,eAAexnC,EAAK2e,QAAQhiB,MAEpFqD,EAAK2e,QAAUA,GAEf3e,EAAKqJ,aACLrJ,EAAKqJ,WAAape,KAAKmgD,mBAAmBlnC,EAAU2hC,EAAa7lC,EAAKqJ,aAE1Epe,KAAK0oC,YAAY/U,SAAS3zB,KAAKq7B,MAAM5wB,MAAMwO,EAAU2hC,GAAc7lC,EAK/E0qC,GAAKhnC,YACLzY,KAAK85C,eAAerhC,UAAYzY,KAAK85C,eAAejb,kBAAoB7+B,KAAK2R,KAAK8tC,EAAKhnC,YAEvFgnC,EAAK7oC,aACDqpC,EAAgBjgD,KAAK2R,KAAK8tC,EAAK7oC,YACnC5W,KAAK85C,eAAelB,YAAcqH,EAAcnuC,aAChD9R,KAAK85C,eAAeza,mBAAqB4gB,EAAc1vB,SAEvDkvB,EAAK5c,aACL4c,EAAK5c,YAAYjxB,QAAQ,SAAUF,GAC/B1R,KAAK2Q,MAAMe,GAAKqF,SACjB/W,MAEHy/C,EAAK19C,OACL/B,KAAKggD,OACDtuC,IAAK1R,KAAK2R,KAAK8tC,EAAK19C,KAAK2P,KACzB+F,QAASgoC,EAAK19C,KAAK0V,QAAQnX,MAAM,KAGrCm/C,EAAKllC,SACD7I,EAAM+tC,EAAKllC,OAAO7I,IAClB+F,EAAkChK,SAAxBgyC,EAAKllC,OAAO9C,WAA6BgoC,EAAKllC,OAAO9C,QAC9D/F,GAGD1R,KAAKgqC,SACDt4B,IAAK1R,KAAK2R,KAAKD,GACf+F,QAASA,EAAQ9T,IAAI,SAAU+W,GAC3B,OACIjQ,MAAOiQ,EAAOjQ,MACd8P,OAAQ/a,EAAM6Q,YAAY+vC,OAAOn3C,OAAOyR,OAIpD1a,KAAKqgD,kBAXL7gD,EAAM8gD,aAAa,8BAAiCb,EAAK3zC,KAAO,yBAc7C2B,SAAvBgyC,EAAK1sC,gBACL/S,KAAKy5C,eAAiBgG,EAAK1sC,eAE/B/S,KAAK05C,gBAAkB+F,EAAKrD,iBAEhCp8C,KAAKm9B,MAAMojB,WACXvgD,KAAK88B,SAASyjB,YAElB7sB,QAAS,SAAUhiB,GACf,MAAO1R,MAAK0oC,YAAYzkC,IAAI,UAAWjE,KAAKq7B,MAAMogB,aAAa/pC,KAEnE0M,WAAY,SAAU1M,GAClB,MAAO1R,MAAK0oC,YAAYzkC,IAAI,aAAcjE,KAAKq7B,MAAMogB,aAAa/pC,KAEtE8uC,cAAe,WACXxgD,KAAKkoC,aAAa,SAAUxU,GACxBA,EAAQugB,WAGhBwM,iBAAkB,WACdzgD,KAAK47C,gBAAgB,SAAUx9B,GAC3BA,EAAW61B,WAGnBt7B,OAAQ,SAAU64B,EAAS//B,GAMvB,QAASuiC,KACLvC,IACItvC,GAAKob,GAAUk0B,GACfhgC,IATJ,GACA+K,GAAWxc,KAAK0oC,YAAYzkC,IAAI,WAAW8D,SAC3CwV,EAAQf,EAAS3b,OAAQ4wC,EAAU,EAAGtvC,EAAI,CAC9C,KAAKob,GAAS9L,EACV,MAAOA,IAQX,MAAOtP,EAAIob,GACPk0B,IACAj1B,EAASra,KAAKuB,MAAMoN,KAAK0gC,EAAS//B,EAAWuiC,EAAO,OAG5D0M,WAAY,SAAUlP,GAClB,GAAIj8B,GAAOvV,IACXA,MAAK47C,gBAAgB,SAAUx9B,GAAV,GACbo+B,GAAU,GAAIrnB,GAAQ/W,EAAW9J,IAAK8J,EAAWtJ,KACjDpD,EAAM,GAAI0jB,GAASonB,EAASA,EAChCp+B,GAAWtN,KAAK0gC,EAASj8B,EAAK2xB,KAAKx1B,EAAK,SAAU6D,EAAK2xB,KAAKx1B,EAAK,cAGzEQ,OAAQ,SAAUoC,EAAKQ,EAAKpR,GACxB,GAAI+G,GAAQzK,KAAKq7B,MAAM5wB,MAAM6J,EAAKQ,EAClC,OAAcrH,UAAV/J,EAGO1D,KAAK0oC,YAAYzkC,IAAI,QAASwG,OAFrCzK,MAAK0oC,YAAYvW,IAAI,QAAS1nB,EAAOA,EAAO/G,IAKpD4kC,YAAa,SAAUh0B,EAAKQ,GACxB,GAAIrK,GAAQzK,KAAKq7B,MAAM5wB,MAAM6J,EAAKQ,EAClC,OAAO9U,MAAK0oC,YAAYzkC,IAAI,aAAcwG,IAE9C01C,mBAAoB,SAAU7rC,EAAKQ,EAAKsJ,GACpC,MAAIA,aAAsB5e,GAAM6Q,YAAY+N,WAAWgsB,WAC5ChsB,EAAWwM,MAAM5qB,KAAKof,QAAS9K,EAAKQ,IAExB,MAAnBsJ,EAAWu3B,OACXv3B,EAAWu3B,MAAQv3B,EAAWu3B,KAAO,IAAIn0C,QAAQ,KAAM,KAEtC,MAAjB4c,EAAW83B,KACX93B,EAAW83B,IAAM93B,EAAW83B,GAAK,IAAI10C,QAAQ,KAAM,KAEhDhC,EAAM6Q,YAAY+N,WAAWopB,QAAQxnC,KAAKof,QAAS9K,EAAKQ,EAAKsJ,KAExE8hC,gBAAiB,SAAU5rC,EAAKQ,EAAKxV,GAGjC,MAFAA,GAAIA,EAAEkC,QAAQ,KAAM,IACpBlC,EAAIE,EAAM6Q,YAAY4D,KAAKgiC,aAAaj2C,KAAKof,QAAS9K,EAAKQ,EAAKxV,GACzDE,EAAM6Q,YAAY4D,KAAKuzB,QAAQloC,IAE1CqhD,mBAAoB,SAAUtsC,EAASkiB,EAAa7yB,EAAO+M,GAAvC,GACZwzB,GAAIvU,EAAOjP,EAIFhW,EAAe6J,CAH5B,KAAK2vB,EAAK5vB,EAAQS,IAAKmvB,GAAM1N,EAAYzhB,IAAKmvB,IAG1C,IAFAvU,EAAQ1vB,KAAKq7B,MAAM5wB,MAAM4J,EAAQC,IAAK2vB,GACtCxjB,EAAMzgB,KAAKq7B,MAAM5wB,MAAM8rB,EAAYjiB,IAAK2vB,GAC/Bx5B,EAAQilB,EAAOpb,EAAMD,EAAQC,IAAK7J,GAASgW,IAAOhW,IAAS6J,EAChE5Q,EAAQA,EAAMknB,MAAM5qB,KAAKof,QAAS9K,EAAK2vB,GACvCjkC,KAAK0oC,YAAYvW,IAAI1hB,EAAUhG,EAAOA,EAAO/G,EAGrD,OAAOA,IAEXsjC,KAAM,SAAUt1B,EAAK5F,EAAMpI,GAArB,GAGEugC,GAAIvU,EAAOjP,EAFXpM,EAAUrU,KAAKq7B,MAAMtD,UAAUrmB,EAAI2C,SACnCkiB,EAAcv2B,KAAKq7B,MAAMtD,UAAUrmB,EAAI6kB,YAK3C,IAHoB,gBAAT7yB,KACPA,EAAQlE,EAAM6Q,YAAY4D,KAAK0M,QAAQiS,eAAelvB,IAEtDA,GAAiB,WAARoI,EACW,gBAATpI,KACPA,EAAQ1D,KAAKkgD,gBAAgB7rC,EAAQC,IAAKD,EAAQS,IAAKpR,IAE3DA,EAAQ1D,KAAK2gD,mBAAmBtsC,EAASkiB,EAAa7yB,EAAO,eAC1D,IAAIA,GAAiB,cAARoI,EAChBpI,EAAQ1D,KAAKmgD,mBAAmB9rC,EAAQC,IAAKD,EAAQS,IAAKpR,GAC1DA,EAAQ1D,KAAK2gD,mBAAmBtsC,EAASkiB,EAAa7yB,EAAO,kBAE7D,KAAKugC,EAAK5vB,EAAQS,IAAKmvB,GAAM1N,EAAYzhB,IAAKmvB,IAC1CvU,EAAQ1vB,KAAKq7B,MAAM5wB,MAAM4J,EAAQC,IAAK2vB,GACtCxjB,EAAMzgB,KAAKq7B,MAAM5wB,MAAM8rB,EAAYjiB,IAAK2vB,GACxCjkC,KAAK0oC,YAAYvW,IAAIrmB,EAAM4jB,EAAOjP,EAAK/c,GAC3B,WAARoI,GACA9L,KAAK0oC,YAAYvW,IAAI,QAASzC,EAAOjP,EAAK,OAK1DymB,KAAM,SAAUx1B,EAAK5F,GAAf,GACEuI,GAAUrU,KAAKq7B,MAAMtD,UAAUrmB,EAAI2C,SACnC5J,EAAQzK,KAAKq7B,MAAM5wB,MAAM4J,EAAQC,IAAKD,EAAQS,IAClD,OAAO9U,MAAK0oC,YAAYzkC,IAAI6H,EAAMrB,IAEtCmK,MAAO,SAAUnD,EAAUH,GACvB,GAAIsvC,GAAY5gD,KAAKw6C,gBAGrB,OAFAx6C,MAAKw6C,gBAAe,GACpB/oC,EAAS1R,KAAKC,MACPA,KAAKw6C,eAAeoG,GAAWloC,cAAcpH,IAAYqH,QAAQ,KAE5EixB,QAAS,SAAUl4B,EAAK+F,GACpB,GAAIyZ,GAAU,IACdzZ,GAAQ7F,QAAQ,SAAU8I,GACtBwW,EAAUlxB,KAAK45C,QAAQiH,OAAOnvC,EAAKgJ,EAAOjQ,MAAOzK,KAAK0oC,YAAYzkC,IAAI,SAAUyW,EAAOC,UAAWuW,IACnGlxB,MACHA,KAAKggD,OACDtuC,IAAKA,EACL+F,QAASA,GAEbzX,KAAKqgD,iBACLrgD,KAAK4R,QAAQF,EAAK,SAAU4C,EAAKQ,EAAK6zB,GAApB,GAGNhZ,GAEID,EAJRgE,EAAUiV,EAAMjV,OAChBA,KACI/D,EAAOrb,EAAMof,EAAQpf,IACZ,IAATqb,IACID,EAAQC,EAAO,EAAI+D,EAAQpf,IAAMof,EAAQpf,IAAMqb,EACnD+D,EAAQ+B,OAAOz1B,KAAK8L,OAAQ,MAAO4jB,EAAOC,MAGpD5d,KAAK/R,OACPA,KAAK0Y,eAAgBC,QAAQ,KAEjC0nC,eAAgB,WACRrgD,KAAKgqC,SACLhqC,KAAK+pC,UAAU/pC,KAAKgqC,QAAQt4B,IAAK1R,KAAKgqC,QAAQvyB,UAGtDsyB,UAAW,SAAUr4B,EAAK+F,GACtBzX,KAAK4U,MAAM,WACP,IAAK,GAAIovB,GAAKtyB,EAAI2C,QAAQC,IAAK0vB,GAAMtyB,EAAI6kB,YAAYjiB,IAAK0vB,IAClDhkC,KAAKm9B,MAAM2d,OAAO9W,IAClBhkC,KAAKm9B,MAAM0d,OAAO7W,EAG1BvsB,GAAQ7F,QAAQ,SAAU8I,GAAV,GAWHupB,GACDlvB,EACArR,EAZJg5C,EAAYhrC,EAAIiL,QAASO,IAAK,IAAK4Y,SAASpb,EAAOjQ,OACnDqM,IACJ,IAAI4lC,IAAcl9C,EAAM6Q,YAAY2qB,QAQpC,IALAh7B,KAAK4R,QAAQ8qC,EAAW,SAAUpoC,EAAKQ,EAAKC,GACxCA,EAAKT,IAAMA,EACXwC,EAAM3W,KAAK4U,KAEf2F,EAAOH,OAAOumC,QAAQhqC,GACbmtB,EAAK,EAAGA,EAAKntB,EAAMjW,OAAQojC,IAC5BlvB,EAAO+B,EAAMmtB,GACbvgC,EAAQgX,EAAOH,OAAO7W,MAAMqR,GAC5B2F,EAAOH,OAAOwmC,QAAQr9C,MAAW,GACjC1D,KAAKuiC,QAAQxtB,EAAKT,MAG3BtU,MACHA,KAAKgqC,SACDt4B,IAAKA,EACL+F,QAASA,KAGbkB,QAAQ,EACR8D,QAAQ,EACRlC,QAAQ,KAGhBymC,aAAc,SAAUtvC,GACpB,GAAIuvC,GAAYjhD,KAAKua,SAAS7I,GAC9B,OAAOA,GAAII,aAAauC,QAAQS,IAAMmsC,EAAU5sC,QAAQS,KAE5DyF,OAAQ,WACJ,MAAOva,MAAKgqC,SAEhBjvB,YAAa,SAAUyY,GACnBxzB,KAAKkhD,aAAa1tB,YAAgB2E,OAAQ3E,GAAQA,KAEtD0tB,aAAc,SAAUhwB,GAChBlxB,KAAKgqC,SACLhqC,KAAK4U,MAAM,WACP5U,KAAKgqC,QAAQvyB,QAAUzX,KAAKgqC,QAAQvyB,QAAQ8C,OAAO,SAAUG,GACzD,MAAOwW,GAAQ7D,QAAQ3S,EAAOjQ,OAAS,IAE3CzK,KAAKqgD,mBAEL1nC,QAAQ,EACR8D,QAAQ,EACRlC,QAAQ,KAIpBqB,aAAc,WACV,OACIpE,KAAMxX,KAAKm9B,MAAMnsB,WACjByG,QAASzX,KAAK88B,SAAS9rB,aAG/B2K,aAAc,SAAU1K,GACpBjR,KAAKm9B,MAAMpsB,SAASE,EAAMuG,MAC1BxX,KAAK88B,SAAS/rB,SAASE,EAAMwG,SAC7BzX,KAAK0Y,eAAgB+D,QAAQ,KAEjCzL,SAAU,WACN,OACIwG,KAAMxX,KAAKm9B,MAAMnsB,WACjByG,QAASzX,KAAK88B,SAAS9rB,WACvB6xB,YAAa7iC,KAAK09B,aAAa/5B,IAAI,SAAUoR,GACzC,MAAOA,GAAK6V,UAEhB0I,WAAYtzB,KAAK0oC,YAAY13B,aAGrCD,SAAU,SAAUE,GAChBjR,KAAKm9B,MAAMpsB,SAASE,EAAMuG,MAC1BxX,KAAK88B,SAAS/rB,SAASE,EAAMwG,SAC7BzX,KAAK09B,aAAezsB,EAAM4xB,YAC1B7iC,KAAK0oC,YAAY33B,SAASE,EAAMqiB,YAChCtzB,KAAK0Y,cAAclZ,EAAM6Q,YAAY8wC,cAEzC5Y,OAAQ,SAAU72B,GAAV,GAGA82B,GAFA3F,EAAc7iC,KAAK09B,aACnB7rB,EAAQ7R,IAoCZ,OAlCAA,MAAK4U,MAAM,WACP4zB,EAAY92B,EAAI/N,IAAI,SAAU+N,GAAV,GAIZ0vC,GAGAzwC,EACA+iB,EACAhwB,EACAsR,EACAyuB,EAIApvB,CAdJ,OAAI3C,aAAelS,GAAM6Q,YAAY8kB,QAC1BzjB,GAEP0vC,EAAa1vC,EAAII,aAAakoB,MAAM6I,EAAa,SAAUnxB,GAC3DmxB,EAAY9H,OAAO8H,EAAYxV,QAAQ3b,GAAM,KAE7Cf,EAAQ,GAAIwJ,GAAMinC,EAAYvvC,GAC9B6hB,EAAU/iB,EAAMu2B,KAAK,WACrBxjC,EAAQiN,EAAMjN,QACdsR,EAASrE,EAAMqE,SACfyuB,EAAa9yB,EAAM8yB,aACvB9yB,EAAMjN,MAAM,MACZiN,EAAMqE,OAAO,MACbrE,EAAM8yB,WAAW,MACbpvB,EAAU,GAAI8F,GAAMinC,EAAW1nB,WAAY7nB,GAC3C6hB,EACArf,EAAQ2yB,KAAK,UAAWtT,GAExBrf,EAAQ3Q,MAAMA,GAElB2Q,EAAQW,OAAOA,GACfX,EAAQovB,WAAWA,GACnBZ,EAAY1iC,KAAKihD,GACVA,IAEX,IAAIzB,GAAgB9tC,EAAMioC,cAC1B6F,GAAclnC,UAAY5G,EAAMyrB,gBAAgBqiB,EAAc9gB,mBAC9D8gB,EAAc/G,YAAc/mC,EAAMyrB,gBAAgBqiB,EAActgB,sBAEhEzoB,YAAY,EACZ6B,WAAW,IAER+vB,GAEXX,oBAAqB,WACjB,MAAO7nC,MAAKsQ,WAAatQ,KAAKsQ,UAAUzQ,QAAQwhD,oBAEpD1tC,oBAAqB,SAAUrU,GAC3B,GAAIgiD,GAAM,GAIV,OAHIthD,MAAK6nC,wBACLyZ,EAAM9hD,EAAMizB,UAAUqV,aAAa,MAEhCtoC,EAAM6Q,YAAY4D,KAAKstC,qBAAqBD,EAAKhiD,MAGhEE,EAAM6Q,YAAYsoC,MAAQA,IAC5Bn5C,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,yBACH,aACA,kBACDD,IACL,YACG,SAAUE,GAAV,GAIO4B,GACAogD,EACAC,EACAC,EACAC,EA6BAC,CApCApiD,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVg8C,EAAahiD,EAAMqiD,YACnBJ,EAAM,IACNC,EAAY,IACZC,GACAG,iBAAkB,oBAClBC,uBAAwB,2CACxBC,gBAAiB,kCACjBC,kBAAmB,oCACnBC,aAAc,+BACdC,gBAAiB,8BACjBC,eAAgB,6BAChBC,gBAAiB,8BACjBC,oBAAqB,wBACrBC,cAAe,kBACfC,cAAe,kBACfC,eAAgB,yBAChBC,iBAAkB,oCAClBC,kBAAmB,YACnBC,eAAgB,SAChBC,eAAgB,SAChBC,mBAAoB,SACpBC,iBAAkB,yBAClBC,qBAAsB,SACtBC,iBAAkB,oBAClBC,iBAAkB,qBAClBC,gBAAiB,2BACjBC,gBAAiB,YACjBC,iBAAkB,WAClBC,mBAAoB,WACpBC,qBAAsB,wEACtBC,qBAAsB,4BAEtB5B,EAAYpiD,EAAMqgB,GAAGC,OAAOngB,QAC5BC,KAAM,SAAU2b,EAAS1b,GACrB,GAAI6f,GAAakiC,EAAUliC,UAC3BlgB,GAAMqgB,GAAGC,OAAO/f,KAAKC,KAAMub,EAAS1b,GACpC0b,EAAUvb,KAAKub,QACfA,EAAQpM,SAASuQ,EAAWoiC,kBAC5B9hD,KAAKyjD,YAAc5jD,EAAQgf,WAC3B7e,KAAK0jD,MAAQ,GAAIlkD,GAAMmkD,IAAIC,KAAKroC,EAAQ,IACxCvb,KAAK0jD,MAAMG,QACP7jD,KAAK8jD,aACL9jD,KAAK+jD,2BAET/jD,KAAKgkD,qBAAoB,GACzBhkD,KAAKikD,kBACLjkD,KAAKkkD,UAAUnyC,KAAK,QAAS/R,KAAKmkD,qBAAqBpyC,KAAK/R,OAC5DA,KAAKkkD,UAAUnyC,KAAK,MAAO/R,KAAKokD,mBAAmBryC,KAAK/R,OACxDub,EAAQwG,GAAG,QAAS0/B,EAAM/hC,EAAWyiC,gBAAiBniD,KAAKqkD,eAAetyC,KAAK/R,OAC/Eub,EAAQwG,GAAG,QAAS,KAAM/hB,KAAKskD,eAAevyC,KAAK/R,OACnDub,EAAQwG,GAAG,WAAY,KAAO0/B,EAAM/hC,EAAWsiC,gBAAiBhiD,KAAKukD,cAAcxyC,KAAK/R,OACxFub,EAAQwG,GAAG,QAAS0/B,EAAM/hC,EAAWwiC,aAAcliD,KAAKwkD,aAAazyC,KAAK/R,QAE9EH,SACIiM,KAAM,YACN24C,YAAcp2B,SAAU,MAE5BnuB,QACI,SACA,UACA,UAEJqkD,cAAe,WACPvkD,KAAK0kD,UAGT1kD,KAAK2kD,cAAc3kD,KAAK27C,QAAS37C,KAAK4kD,gBAAgB,GACtD5kD,KAAK0kD,QAAU1kD,KAAKub,QAAQ0qB,KAAKzmC,EAAMwV,OAAO,cAAeysC,EAAKG,EAAUliC,WAAW2iC,kBAAkB/yC,QAAQyS,GAAG,UAAW/hB,KAAK6kD,iBAAiB9yC,KAAK/R,OAAO+hB,GAAG,OAAQ/hB,KAAK8kD,cAAc/yC,KAAK/R,SAExM+kD,eAAgB,SAAUC,GACtB,GAAI5tB,GAAe4tB,EAAW,KAAOhlD,KAAK0kD,QAAQt1C,KAClDpP,MAAK0kD,QAAQp5B,MACbtrB,KAAK0kD,QAAU,KACf1kD,KAAK2kD,cAAc3kD,KAAK27C,QAAS37C,KAAK4kD,gBAAgB,GACtD5kD,KAAKilD,eAAe7tB,IAExB8tB,aAAc,SAAUC,EAAQC,IACvBD,GAAUC,EAAgB,GAG/BplD,KAAK2kD,cAAcQ,EAAQC,GAAe,IAE9CT,cAAe,SAAUQ,EAAQC,EAAezd,GAAjC,GAEP0d,GACAC,EASAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAOIC,EAzBJ3tB,EAAOp4B,KAGP0f,EAAakiC,EAAUliC,UAC3B0Y,GAAK4tB,OAASxmD,EAAMyQ,QAAQg2C,MAAM7tB,EAAK7c,SACvC6c,EAAKujB,QAAUwJ,EACf/sB,EAAKwsB,eAAiBQ,EACtBhtB,EAAK8tB,YAAYve,GAAc,GAC1BvP,EAAK+tB,uBAGNZ,EAAgBntB,EAAKguB,iBACrBZ,EAAmBD,EAAcc,SAAS5E,EAAM/hC,EAAW8iC,eAC3DiD,EAAmBF,EAAcc,SAAS5E,EAAM/hC,EAAW6iC,eAC3DmD,EAAW,EACXC,EAAYvtB,EAAK7c,QAAQ0qB,KAAKwb,EAAM/hC,EAAWwiC,cAC/C0D,EAAiBpE,EAAWmE,GAAaA,EAAUv8B,WAAWxM,KAAO8oC,EACrEG,EAAwBrE,EAAWgE,GAAoBE,EACvDI,EAAc1tB,EAAKkuB,eACvBd,EAAiB3jC,KAAMjF,KAAMgpC,IAC7BL,EAAcp2C,SAASuQ,EAAW4iC,oBAAsBZ,EAAYhiC,EAAWqiC,wBAC/E+D,EAAYjkC,KAAM0kC,WAAYX,IAC9BP,EAAqBE,EAAc,GAAGrgD,YACtCogD,EAAyBQ,EAAY,GAAGU,YACpClB,EAAyBM,EAAiBP,GACtCU,EAAwBp3B,KAAK83B,KAAKjnD,EAAMknD,WAAWjB,EAAiB5jC,IAAI,WACvEuW,EAAKuuB,wBACNvuB,EAAKwuB,qBAAsB,EAC3BxuB,EAAKuuB,uBAAwB,GAEjCb,EAAYjkC,KACR0kC,WAAYV,EAAwBD,EACpCiB,YAAarF,EAAWiE,GAAoBM,EAAwBL,KAGpEttB,EAAKuuB,uBAAyBrB,GAA0BD,GACxDjtB,EAAKuuB,uBAAwB,EAC7Bb,EAAYjkC,KACR0kC,WAAYX,EACZiB,YAAa,MAGjBf,EAAYjkC,KAAM0kC,WAAYX,IAGtCxtB,EAAK0uB,yBAETA,qBAAsB,SAAUl9B,GAAV,GACdwO,GAAOp4B,KACP+mD,EAAK3uB,EAAKkuB,eACV1mC,EAAUwY,EAAKguB,iBACfY,EAAaD,EAAGC,aAChB3+C,EAAOuX,EAAQqmB,KAAKwb,EAAMG,EAAUliC,WAAW8iC,eAC/CxO,EAAOp0B,EAAQqmB,KAAKwb,EAAMG,EAAUliC,WAAW6iC,cAC/C34B,MAAW,GACXvhB,EAAKuhB,QAAO,GACZoqB,EAAKpqB,QAAO,KAEZvhB,EAAKuhB,OAAOwO,EAAK4tB,OAASgB,EAAaD,EAAG,GAAGP,YAAcO,EAAG,GAAG7hD,YAAc,EAAmB,IAAf8hD,GACnFhT,EAAKpqB,OAAOwO,EAAK4tB,OAAwB,IAAfgB,EAAmBA,EAAaD,EAAG,GAAGP,YAAcO,EAAG,GAAG7hD,YAAc,KAG1G8+C,oBAAqB,SAAUp6B,GAAV,GACbwO,GAAOp4B,KACP0f,EAAakiC,EAAUliC,WACvB7f,EAAUu4B,EAAKv4B,QAGf0lD,EAAgBntB,EAAKguB,iBAFrBZ,EAGeD,EAAcc,SAAS5E,EAAM/hC,EAAW8iC,eAFvDiD,EAGeF,EAAcc,SAAS5E,EAAM/hC,EAAW6iC,cACvD34B,IACA47B,EAAiBzjC,GAAG,YAAa,WAC7BqW,EAAKwuB,qBAAsB,EAC3BxuB,EAAK6uB,qBAAqBpnD,EAAQ4kD,WAAWp2B,UAAY+J,EAAK4tB,OAAS,SAE3EP,EAAiB1jC,GAAG,YAAa,WAC7BqW,EAAKwuB,qBAAsB,EAC3BxuB,EAAK6uB,qBAAqBpnD,EAAQ4kD,WAAWp2B,UAAY+J,EAAK4tB,UAAc,MAEhFR,EAAiB9T,IAAI+T,GAAkB1jC,GAAG,UAAW,WACjDqW,EAAKwuB,qBAAsB,MAG/BpB,EAAiBl6B,MACjBm6B,EAAiBn6B,QAGzB46B,YAAa,SAAUve,EAAcuf,GAAxB,GACL98B,GAQIvY,EACAs1C,EACAvlC,EACAwlC,EAmBQC,EA7BZC,KACA3D,EAAMnkD,EAAMmkD,IACZpoC,EAAUooC,EAAIpoC,QACd4pC,EAASnlD,KAAK27C,QACdyJ,EAAgBplD,KAAK4kD,eACrBllC,EAAakiC,EAAUliC,UAC3B,KAAK0K,EAAM,EAAGA,EAAM+6B,EAAOtkD,OAAQupB,IAC3BvY,EAAQszC,EAAO/6B,GACf+8B,EAAkB/8B,IAAQg7B,EAC1BxjC,GAASmjB,UAAWrlB,EAAW+iC,eAAiBf,GAChD0F,KAEAxlC,EAAKmjB,WADLoiB,EACkBznC,EAAWgjC,iBAAmBhB,EAAYhiC,EAAWsiC,gBAErDtiC,EAAWuiC,kBAE7BkF,GAAmBxf,EACnByf,EAAejnD,KAAKob,EAAQ,SACxBhK,KAAM,OACN7N,MAAOmO,EAAM/F,OACbi5B,UAAWrlB,EAAWijC,kBAAoBjB,EAAYhiC,EAAW2iC,gBACjEkF,UAAW,UAGfH,EAAejnD,KAAKob,EAAQ,QACxBwpB,UAAWrlB,EAAWkjC,eACtBxxC,MAAOS,EAAM/F,SACb63C,EAAIriD,KAAKuQ,EAAM/F,WACfq5C,EAAOtkD,OAAS,IACZwmD,EAAa9rC,EAAQ,QAAUwpB,UAAWrlB,EAAWmjC,eAAiBnB,EAAYhiC,EAAWojC,mBAAqBpB,EAAYhiC,EAAW0jC,qBAC7IgE,EAAejnD,KAAKob,EAAQ,QAAUwpB,UAAWrlB,EAAWkjC,eAAiBlB,EAAYhiC,EAAWyiC,kBAAoBkF,OAGhIC,EAAcnnD,KAAKob,EAAQ,KAAMqG,EAAMwlC,GAE3CpnD,MAAK0jD,MAAMG,QACP7jD,KAAK8jD,aACL9jD,KAAK+jD,qBAAqBuD,EAAeJ,MAGjDnD,qBAAsB,SAAUuD,EAAeJ,GAAzB,GAMVM,GALJjsC,EAAU/b,EAAMmkD,IAAIpoC,QACpBmE,EAAakiC,EAAUliC,WACvB+nC,GAAoBlsC,EAAQ,MAAQwpB,UAAWrlB,EAAWyjC,iBAAmBmE,GAOjF,OANAJ,IAAsB,EAClBA,IACIM,EAAkB9nC,EAAWqjC,iBAAmBrB,EAAYhiC,EAAWsjC,qBAAuBtB,EAClG+F,EAAiBtnD,KAAKob,EAAQ,QAAUwpB,UAAWyiB,EAAkB9nC,EAAW8iC,gBAAkBjnC,EAAQ,QAAUwpB,UAAWrlB,EAAWmjC,eAAiBnB,EAAYhiC,EAAWujC,yBAClLwE,EAAiBtnD,KAAKob,EAAQ,QAAUwpB,UAAWyiB,EAAkB9nC,EAAW6iC,gBAAkBhnC,EAAQ,QAAUwpB,UAAWrlB,EAAWmjC,eAAiBnB,EAAYhiC,EAAWwjC,0BAE/K3nC,EAAQ,OAASwpB,UAAWrlB,EAAW0iC,gBAAkBqF,IAEpExD,gBAAiB,WACb,GAAIvkC,GAAakiC,EAAUliC,UAC3B1f,MAAKkkD,UAAY,GAAI1kD,GAAMqgB,GAAG6nC,SAAS1nD,KAAKub,SACxChB,OAAQ/a,EAAMwV,OAAO,sBAAuB0K,EAAWsiC,gBAAiBtiC,EAAWuiC,mBACnF0F,UAAWlG,EAAM/hC,EAAW0iC,eAC5B1mC,KAAM,IACNksC,WAAW,EACXC,OAAQ,QACRpnC,IAAK,WACGzgB,KAAK8nD,UAAUvnB,MACfvgC,KAAK8nD,UAAUvnB,KAAK9wB,UAG5B8wB,KAAM,SAAUhlB,GACZ,GAAIglB,GAAOn/B,EAAEma,GAASqP,OACtB,OAAO2V,GAAKxsB,KAAK,eAAkB2L,EAAW6jC,qBAAuB,gBAAoB7jC,EAAW8jC,qBAAuB,iBAAkBuE,QAAQ,WAIjKlD,iBAAkB,SAAU3+B,GACpBlmB,KAAK0kD,UACW,KAAZx+B,EAAEoI,OACFtuB,KAAK+kD,iBAEO,KAAZ7+B,EAAEoI,OACFtuB,KAAK+kD,gBAAe,KAIhCD,cAAe,WACP9kD,KAAK0kD,SACL1kD,KAAK+kD,kBAGbX,mBAAoB,SAAUl+B,GAC1BA,EAAE5N,iBACFtY,KAAKU,QAAQ,WACTsnD,SAAU9hC,EAAE8hC,SACZC,SAAU/hC,EAAE+hC,YAGpB9D,qBAAsB,SAAUj+B,GACxBlmB,KAAK0kD,SACLx+B,EAAE5N,kBAGV+rC,eAAgB,SAAUn+B,GAAV,GAKRgiC,GAJAC,EAAmB/mD,EAAE8kB,EAAEjU,QAAQ81C,QAAQ,MAAMzmD,MAC7CtB,MAAK0kD,SACL1kD,KAAK+kD,iBAELmD,EAAgB,SAAUhiC,GAC1B,GAAIkiC,GAAMliC,EAAEmiC,MACRD,GAAIE,eACJtoD,KAAKU,QAAQ,UACToL,KAAMq8C,EACNI,cAAc,KAGxBx2C,KAAK/R,MACPA,KAAKyjD,YAAY,gBAAkBpjC,MAAO6nC,KAE9C5D,eAAgB,SAAUp+B,GACtB,GAAIsiC,GAAoBpnD,EAAE8kB,EAAEjU,QAAQ3Q,MACpC,OAAIF,GAAE8kB,EAAEjU,QAAQ/D,GAAGuzC,EAAMG,EAAUliC,WAAW2iC,mBAAqBmG,MAC/DtiC,GAAE5N,kBAGFtY,KAAK0kD,SACL1kD,KAAK+kD,iBAET/kD,KAAKyoD,oBAAoBrnD,EAAE8kB,EAAEjU,QAAQ81C,QAAQ,WAC7C/nD,MAAKU,QAAQ,UACToL,KAAM08C,EACNE,aAAa,MAGrBzD,eAAgB,SAAU7tB,GAClBp3B,KAAK27C,QAAQ37C,KAAK4kD,gBAAgB94C,SAAWsrB,GAAiC,OAAjBA,GAGjEp3B,KAAKU,QAAQ,UACToL,KAAMsrB,EACNuxB,WAAY3oD,KAAK4kD,kBAGzBJ,aAAc,WACVxkD,KAAKU,QAAQ,UAAYgoD,aAAa,KAE1C5E,WAAY,WAAA,GACJvoC,GAAU/b,EAAMmkD,IAAIpoC,QACpBmE,EAAakiC,EAAUliC,UAC3B,OAAOnE,GAAQ,KAAOwpB,UAAWrlB,EAAWwiC,aAAeR,EAAYhiC,EAAWqjC,mBAAqBxnC,EAAQ,QAAUwpB,UAAWrlB,EAAWmjC,eAAiBnB,EAAYhiC,EAAWojC,mBAAqBpB,EAAYhiC,EAAW4jC,2BAEvOrjC,QAAS,WACLjgB,KAAKkkD,UAAUjkC,WAEnBkmC,mBAAoB,WAChB,GAAItmD,GAAUG,KAAKH,OACnB,OAAOA,GAAQ4kD,aAAel3C,MAAM1N,EAAQ4kD,WAAWp2B,WAE3Do6B,oBAAqB,SAAUG,GAAV,GAKb9C,GACA+C,EACAC,EACAC,EACAC,EACAC,EACAC,EAVA9wB,EAAOp4B,IACNo4B,GAAKuuB,wBAGNb,EAAc1tB,EAAKkuB,eACnBuC,EAAsB/C,EAAYkB,aAClC8B,EAAYtH,EAAWoH,GACvBG,EAAa3wB,EAAK4tB,OAAS4C,EAAKx/B,WAAWxM,KAAOgsC,EAAKx/B,WAAWxM,KAAOkpC,EAAYO,WAAW91B,QAAQnH,WAAWxM,KACnHosC,EAAmBlD,EAAY,GAAG5gD,YAClC+jD,EAAqBt6B,KAAK83B,KAAKC,WAAWZ,EAAYjkC,IAAI,kBAE1DuW,EAAK4tB,OACD+C,EAAa,EACbG,EAAeL,EAAsBE,GAAcC,EAAmBH,GAAuBI,EACtFF,EAAaD,EAAYE,IAChCE,EAAeL,EAAsBE,EAAaD,EAAiC,EAArBG,GAG9DJ,EAAsBG,EAAmBD,EAAaD,EACtDI,EAAeH,EAAaD,EAAYE,EAAwC,EAArBC,EACpDJ,EAAsBE,IAC7BG,EAAeH,EAAaE,GAGpCnD,EAAYqD,SAASC,SAAUpC,WAAckC,GAAgB,OAAQ,SAAU,WAC3E9wB,EAAK0uB,2BAGbR,aAAc,WACV,MAAOtmD,MAAKomD,iBAAiBC,SAAS,OAE1CD,eAAgB,WACZ,MAAOpmD,MAAKub,QAAQ0qB,KAAKwb,EAAMG,EAAUliC,WAAW0iC,iBAExD6E,qBAAsB,SAAUvyC,GAAV,GACd0jB,GAAOp4B,KACP8lD,EAAc1tB,EAAKkuB,eACnB+C,EAAUvD,EAAYkB,YAC1BlB,GAAYqD,SAASC,SAAUpC,WAAcqC,EAAU30C,GAAS,OAAQ,SAAU,WAC1E0jB,EAAKwuB,oBACLxuB,EAAK6uB,qBAAqBvyC,GAE1B0jB,EAAK0uB,4BAKrBtnD,EAAM6Q,YAAYuxC,UAAYA,EAC9BxgD,EAAEzB,QAAO,EAAMiiD,GAAaliC,WAAYiiC,MAC1Cx+C,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,oBAAqB,uBAAwBD,IACtD,WACE,YAmDA,SAASgqD,GAAoBC,GACzBC,EAAWC,IAAMF,EACjBC,EAAWE,IAAa,KAAPH,EAAa,IAAM,IACpCC,EAAWG,IAAa,KAAPJ,EAAa,KAAO,IACrCK,EAAmB,KAAPL,EAAaM,EAAkBC,EAgC/C,QAASC,GAAO7nD,GACZA,EAAMA,EAAImjB,aACV,KAAK,GAAIvQ,GAAM,EAAG3S,EAAI,EAAGA,EAAID,EAAIrB,SAAUsB,EACvC2S,EAAY,GAANA,EAAW5S,EAAIG,WAAWF,GAAK,EAEzC,OAAO2S,GAAM,EAEjB,QAASk1C,GAAO9nD,GACZ,MAAOoL,UAASpL,EAAK,IAAM,EAE/B,QAASq6C,GAAezwC,EAAMm+C,GAA9B,GAKYrhD,GAEI0L,EAAoBQ,EAMxBo1C,EACAn/C,EAEI2G,CAfZ,IAA0B,UAAtB5F,EAAKvD,cACL,MAAO8H,GAAY4qB,QAEvBkvB,GAAK,CAED,KAAIvhD,EAAI,6BAA6BkI,KAAKhF,IAA1C,CASA,IAFIo+C,EAASE,EAAYt+C,MACrBf,OACS,CAET,GADI2G,EAAMw4C,EAAOlW,OACbtiC,YAAeyjB,GACfzjB,EAAImjB,IAAM,MACP,CAAA,KAAInjB,YAAe0jB,IAItB,KAAM+0B,EAHNz4C,GAAI2C,QAAQwgB,IAAM,EAClBnjB,EAAI6kB,YAAY1B,IAAM,EAK1B,GADA9pB,EAAE5K,KAAKuR,GACHw4C,EAAO19B,MACP,KAEJ,KAAK09B,EAAOh8C,GAAG,KAAMs7C,EAAWE,KAC5B,KAAMS,EAEVD,GAAOlW,OAEX,MAAmB,IAAZjpC,EAAElK,OAAckK,EAAE,GAAK,GAAIsF,GAAYglB,SAAStqB,GA1BnD,GADIuJ,EAAM01C,EAAOphD,EAAE,IAAKkM,EAAMi1C,EAAOnhD,EAAE,IACnC0L,EAAM,SAAWQ,EAAM,MACvB,MAAO,IAAIqgB,GAAQ60B,EAAOphD,EAAE,IAAKmhD,EAAOnhD,EAAE,KA2BtD,IAAKqhD,EACD,KAAUr/C,OAAM,2BAA6BkB,GAGrD,QAASmqC,GAAapkC,EAAOyC,EAAKQ,EAAKhB,GAenC,QAASu2C,GAAa34C,GAGlB,MAFAA,GAAIjH,MAAQgsB,EAAK51B,OACjB41B,EAAKt2B,KAAKuR,GACHA,EAEX,QAASpG,GAAKiG,EAAM7N,EAAO4mD,GACvB,GAAIp8C,EAAGqD,EAAM7N,GACT,MAAOoQ,GAAMkgC,MAEb,IAAIprB,GAAM9U,EAAMy2C,MACZ3hC,GACA9U,EAAMpJ,MAAM,YAAc6G,EAAO,KAAU7N,EAAQ,eAAoBklB,EAAIrX,KAAO,KAAUqX,EAAIllB,MAAQ,KAChG4mD,GACRx2C,EAAMpJ,MAAM,YAAc6G,EAAO,KAAU7N,EAAQ,KAI/D,QAAS8mD,GAAgBC,GACrB,MAAOC,GAAYC,EAAeC,KAAc,EAAGH,GAEvD,QAASI,GAAYjiC,GACjB,MAAiB,QAAbA,EAAIkiC,OAAgC,SAAbliC,EAAIkiC,MACP,QAAbliC,EAAIkiC,MAAkBC,EAAOC,EAEjCX,EAAa,GAAIn1B,GAAQtM,EAAIllB,QAExC,QAASunD,KAAT,GAIQ5f,GAHA4G,EAAQn+B,EAAMkgC,MAIlB,KAHA/B,EAAQA,EAAMvuC,MACd4H,EAAK,OAAQ,KACT+/B,OACM,CACN,GAAIn9B,EAAG,OAAQ,KACX;AAEJ,GAAIA,EAAG,KAAMs7C,EAAWE,KACpBre,EAAKlrC,MAAOoR,KAAM,SAClBuC,EAAMkgC,WAFV,CAMA,GADA3I,EAAKlrC,KAAKqqD,GAAgB,IACtB12C,EAAM0Y,OAASte,EAAG,OAAQ,KAC1B,KAEJ5C,GAAK,KAAMk+C,EAAWE,MAG1B,MADAp+C,GAAK,OAAQ,KAAK,IAEdiG,KAAM,OACN67B,KAAM6E,EACN5G,KAAMA,GAGd,QAAS6f,GAAax5C,GAIlB,MAHKA,GAAI4jB,YACL5jB,EAAIoZ,SAASjZ,GAEVw4C,EAAa34C,GAExB,QAASk5C,KACL,GAAIO,EA8BJ,OA7BIj9C,GAAG,OACHi9C,EAAMD,EAAap3C,EAAMkgC,QAClB9lC,EAAG,QACVi9C,EAAMF,IACC/8C,EAAG,OAAQ,MAClB4F,EAAMkgC,OACNmX,EAAMX,GAAgB,GACtBl/C,EAAK,OAAQ,KAAK,IACX4C,EAAG,OAAQ,MAClB4F,EAAMkgC,OACNmX,EAAMC,IACN9/C,EAAK,OAAQ,KAAK,IACX4C,EAAG,QAAUA,EAAG,QAAUA,EAAG,SACpCi9C,EAAMr3C,EAAMkgC,OACL9lC,EAAG,OACVi9C,EAAMN,EAAY/2C,EAAMkgC,QACjB9lC,EAAG,KAAM,MAAQA,EAAG,KAAM,KACjCi9C,GACI55C,KAAM,SACN85C,GAAIv3C,EAAMkgC,OAAOtwC,MACjBynD,IAAKP,KAKT92C,EAAMpJ,MAHEoJ,EAAMy2C,OAEPr8C,EAAG,OAAQ,KACN,mCAEA,cAJA,yBAMTo9C,EAAaH,GAExB,QAASC,KAEL,IADA,GAAI92C,MAAU5Q,GAAS4Q,GAAMic,GAAQ,GAC7Bzc,EAAM0Y,QAAUte,EAAG,OAAQ,MAC3BqiB,EACAA,GAAQ,EACDriB,EAAG,KAAM,MAChBxK,EAAMvD,KAAKmU,MACXR,EAAMkgC,QAEN1oC,EAAK,KAAMk+C,EAAWG,KAE1Br1C,EAAInU,KAAKqqD,GAAgB,GAE7B,QACIj5C,KAAM,SACN7N,MAAOA,GAGf,QAASinD,GAAeQ,GACpB,MAAIj9C,GAAG,OAAQ,MAAQA,EAAG,QAAUA,EAAG,QAAUA,EAAG,SAE5CqD,KAAM,SACN85C,GAAI,IACJzuC,KAAMuuC,EACNruC,MAAO0tC,GAAgB,IAGpBW,EAGf,QAASG,GAAaH,GAClB,MAAIj9C,GAAG,KAAM,MACT4F,EAAMkgC,OACCsX,GACH/5C,KAAM,UACN85C,GAAI,IACJF,IAAKA,KAGFA,EAGf,QAAST,GAAY9tC,EAAM2uC,EAASd,GAApC,GAGYe,GAGI1uC,EALR8L,EAAM1a,EAAG,KACb,OAAI0a,KAAQ6hC,GAAU7hC,EAAIllB,OAAS8lD,EAAWE,OACtC8B,EAAW5B,EAAUhhC,EAAIllB,OACzB8nD,EAAWD,IACXz3C,EAAMkgC,OACFl3B,EAAQ4tC,EAAYE,IAAaY,EAAUf,GACxCC,GACHn5C,KAAM,SACN85C,GAAiB,KAAbziC,EAAIllB,MAAe,IAAMklB,EAAIllB,MACjCkZ,KAAMA,EACNE,MAAOA,GACRyuC,EAASd,IAGb7tC,EApKf,GAMQ1O,GALAuoB,IAMJ,OALA3iB,GAAQs2C,EAAYt2C,GAChBQ,IAAKA,EACLQ,IAAKA,IAEL5G,EAAK4F,EAAM5F,IAEXqD,KAAM,MACNk6C,IAAKjB,GAAgB,GACrB/zB,KAAMA,EACN5kB,MAAOA,EACPyC,IAAKA,EACLQ,IAAKA,GA0Jb,QAAS42C,GAAoB5/C,EAAM6/C,GAAnC,GAOYC,GANJC,EAAU5V,EAAa,KAAM,EAAG,EAAGnqC,EACvC,MAAM+/C,EAAQJ,cAAev2B,IACzB,KAAM,IAAIhhB,GAAW,iBAAmBpI,EAa5C,OAXA+/C,GAAUA,EAAQJ,IACZE,YAAe32B,KACb42B,EAAS3V,EAAa4V,EAAQh6C,MAAO,EAAG,EAAG85C,GAE3CA,EADAC,EAAOH,cAAez2B,GAChB42B,EAAOH,IACN,2BAA2BjiD,KAAKoiD,EAAOH,IAAIl6C,MAC5Cq6C,EAAOH,IAAI/nD,MAEXooD,EAAYF,KAItB9/C,KAAM+/C,EACNnoD,MAAOioD,GAYf,QAASI,GAAYZ,GAEjB,QAASpgC,GAAMzH,EAAM0tB,EAAQgb,GA4CzB,QAASC,GAAW3sD,GAApB,GACQ+rD,GAAK/nC,EAAK+nC,GACVa,EAAatC,EAAUyB,GAAMW,IAASA,GAAc,KAANX,GAA4B,UAAfra,EAAOz/B,MAAoBy6C,GAAQpC,EAAUyB,IAAoB,KAAbra,EAAOqa,IAA4B,UAAfra,EAAOz/B,MAAoBy6C,GAAQpC,EAAUyB,IAAO/nC,IAAS0tB,EAAOl0B,KAC3M,OAAOqvC,GAAa7sD,IAAK4sD,GA9C7B,OAAQ5oC,EAAK/R,MACb,IAAK,MACD,MAAO,oDAAwD8gB,KAAKC,UAAUD,KAAKC,UAAUhP,EAAK5f,QAAU,MAAQ2uB,KAAKC,UAAUD,KAAKC,UAAUhP,EAAK5f,QAAU,yDACrK,KAAK,OACD,MAAO2uB,MAAKC,UAAUhP,EAAK5f,MAC/B,KAAK,QACD,MAAO2uB,MAAKC,UAAU,IAAMhP,EAAK5f,MACrC,KAAK,MACD,MAAO2uB,MAAKC,UAAUD,KAAKC,UAAUhP,EAAK5f,OAC9C,KAAK,MACD,MAAO,aAAe4f,EAAK7Y,MAAQ,wBACvC,KAAK,SACD,MAAOwhD,GAAW,WACd,MAAO55B,MAAKC,UAAUhP,EAAK+nC,IAAM,MAAQtgC,EAAMzH,EAAK6nC,IAAK7nC,EAAMsmC,EAAUtmC,EAAK+nC,MAEtF,KAAK,UACD,MAAOY,GAAW,WACd,MAAOlhC,GAAMzH,EAAK6nC,IAAK7nC,EAAMsmC,EAAUtmC,EAAK+nC,KAAO,MAAQh5B,KAAKC,UAAUhP,EAAK+nC,KAEvF,KAAK,SACD,MAAOY,GAAW,WAAA,GACVrvC,GAAOuvC,EAAaphC,EAAMzH,EAAK1G,KAAM0G,EAAMsmC,EAAUtmC,EAAK+nC,KAAM/nC,EAAK1G,eAAgBsY,IAAsB,KAAX5R,EAAK+nC,IACrGvuC,EAAQqvC,EAAaphC,EAAMzH,EAAKxG,MAAOwG,EAAMsmC,EAAUtmC,EAAK+nC,KAAM/nC,EAAKxG,gBAAiBoY,IAAsB,KAAX5R,EAAK+nC,GAC5G,OAAI,QAAQ7hD,KAAK8Z,EAAK+nC,IACXzuC,EAAO,+CAAiDE,EAExDF,EAAO,MAAQyV,KAAKC,UAAUhP,EAAK+nC,IAAM,MAAQvuC,GAGpE,KAAK,OACD,MAAOuV,MAAKC,UAAUhP,EAAK8pB,KAAO,KAAO,OAAS9pB,EAAK+nB,KAAKxqC,OAAS,EAAIyiB,EAAK+nB,KAAK1nC,IAAI,SAAUyoD,GAC7F,MAAOrhC,GAAMqhC,EAAK9oC,EAAM,KACzBthB,KAAK,sDAA0D,MAAU,QAChF,KAAK,SACD,MAAO,UAAcshB,EAAK5f,MAAMC,IAAI,SAAUghB,GAC1C,MAAOA,GAAGhhB,IAAI,SAAUghB,GACpB,MAAOoG,GAAMpG,EAAIrB,EAAM,KACxBthB,KAAK,wDACTA,KAAK,cAAkB,QAC9B,KAAK,OACD,MAAO,KAEX,KAAU4I,OAAM,gCAAkC0Y,EAAK/R,MAO3D,QAAS46C,GAAa/hD,EAAMwhC,GACxB,MAAOA,GAAO,SAAaxhC,EAAO,SAAaA,EApDnD,MAAOiiD,GAAY,kCAAoCthC,EAAMogC,EAAIM,IAAKN,EAAK,GAAK,MAuDpF,QAASmB,GAAMb,EAAKnY,GAGhB,QAASiZ,GAAIjpC,EAAMgwB,GACf,OAAQhwB,EAAK/R,MACb,IAAK,MACD,MAAOi7C,GAAOlpC,EAAMgwB,EACxB,KAAK,MACL,IAAK,MACL,IAAK,OACL,IAAK,QACL,IAAK,OACD,MAAOmZ,GAAQnpC,EAAMgwB,EACzB,KAAK,SACL,IAAK,UACD,MAAOoZ,GAASppC,EAAMgwB,EAC1B,KAAK,SACD,MAAOqZ,GAAUrpC,EAAMgwB,EAC3B,KAAK,OACD,MAAOsZ,GAAQtpC,EAAMgwB,EACzB,KAAK,SACD,MAAOuZ,GAAUvpC,EAAMgwB,EAC3B,KAAK,SACD,MAAOwZ,GAAUxpC,EAAK5f,MAAO4vC,GAAG,GAEpC,KAAU1oC,OAAM,cAAgB0Y,EAAK/R,MAEzC,QAASi7C,GAAOlpC,EAAMgwB,GAClB,MAAmB,QAAZhwB,EAAK5R,IAAgBq7C,EAAWzpC,EAAMgwB,GAAKmZ,EAAQnpC,EAAMgwB,GAEpE,QAASmZ,GAAQnpC,EAAMgwB,GACnB,MAAOA,GAAEhwB,GAEb,QAASypC,GAAWzpC,EAAMgwB,GACtB,OACI/hC,KAAM,OACN67B,KAAM,WACN/B,MACI2hB,EAAiB1Z,GACjBhwB,IAIZ,QAASopC,GAASppC,EAAMgwB,GACpB,MAAOiZ,IACHh7C,KAAM,OACN67B,KAAM,QAAU9pB,EAAK+nC,GACrBhgB,MAAO/nB,EAAK6nC,MACb7X,GAEP,QAASqZ,GAAUrpC,EAAMgwB,GACrB,MAAOiZ,IACHh7C,KAAM,OACN67B,KAAM,SAAW9pB,EAAK+nC,GACtBhgB,MACI/nB,EAAK1G,KACL0G,EAAKxG,QAEVw2B,GAEP,QAAS2Z,GAAMpY,EAAIC,EAAInwB,EAAI2uB,GACvB,MAAOiZ,GAAI1X,EAAI,SAAUA,GAAV,GACP5pB,GAAO+hC,EAAiB1Z,GACxB4Z,EAAQC,EAAO,KACfC,EAAQD,EAAO,IACnB,QACI57C,KAAM,OACN67B,KAAM,KACN/B,MACIpgB,EACA4pB,GAEItjC,KAAM,SACN87C,MAAOH,GACPjoD,KAAMsnD,EAAIzX,GAAMiW,EAAM,SAAUjW,GAC5B,OACIvjC,KAAM,OACN67B,MACI77B,KAAM,MACNzF,KAAMohD,GAEV7hB,MAAOyJ,QAKfvjC,KAAM,SACN87C,MAAOD,GACPnoD,KAAMsnD,EAAI5nC,GAAMqmC,EAAO,SAAUrmC,GAC7B,OACIpT,KAAM,OACN67B,MACI77B,KAAM,MACNzF,KAAMshD,GAEV/hB,MAAO1mB,WAQnC,QAAS2oC,GAAOjiB,EAAMiI,GAClB,MAAoB,KAAhBjI,EAAKxqC,OACE4rD,EAAQ1B,EAAMzX,GAElBiZ,GACHh7C,KAAM,OACN67B,KAAM,KACN/B,MACIA,EAAK,IAED95B,KAAM,OACN67B,KAAM,MACN/B,KAAMA,EAAK/qC,MAAM,IAErB0qD,IAEL1X,GAEP,QAASia,GAAMliB,EAAMiI,GACjB,MAAoB,KAAhBjI,EAAKxqC,OACE4rD,EAAQzB,EAAO1X,GAEnBiZ,GACHh7C,KAAM,OACN67B,KAAM,KACN/B,MACIA,EAAK,GACL0f,GAEIx5C,KAAM,OACN67B,KAAM,KACN/B,KAAMA,EAAK/qC,MAAM,MAG1BgzC,GAEP,QAASsZ,GAAQtpC,EAAMgwB,GACnB,OAAQhwB,EAAK8pB,KAAK7kC,eAClB,IAAK,KACD,MAAO0kD,GAAM3pC,EAAK+nB,KAAK,GAAI/nB,EAAK+nB,KAAK,GAAI/nB,EAAK+nB,KAAK,GAAIiI,EAC3D,KAAK,MACD,MAAOga,GAAOhqC,EAAK+nB,KAAMiI,EAC7B,KAAK,KACD,MAAOia,GAAMjqC,EAAK+nB,KAAMiI,EAC5B,KAAK,OACD,MAAOA,GAAEyX,EACb,KAAK,QACD,MAAOzX,GAAE0X,GAEb,MAAO,SAAS3nC,GAAKgoB,EAAMlpC,GACvB,MAAIA,IAAKmhB,EAAK+nB,KAAKxqC,QAEX0Q,KAAM,OACN67B,KAAM9pB,EAAK8pB,KACX/B,KAAMA,GAGHkhB,EAAIjpC,EAAK+nB,KAAKlpC,GAAI,SAAUuB,GAC/B,MAAO2f,GAAKgoB,EAAK3U,QAAQhzB,IAASvB,EAAI,OAG/C6qD,EAAiB1Z,IAAK,GAE7B,QAASuZ,GAAUvpC,EAAMgwB,GAAzB,GACQka,GAAOL,EAAO,KACdloD,EAAOsnD,EAAIjpC,EAAKre,KAAM,SAAUA,GAChC,OACIsM,KAAM,OACN67B,MACI77B,KAAM,MACN7N,MAAO8pD,GAEXniB,MAAOpmC,KAGf,OAAOquC,IACH/hC,KAAM,SACN87C,MAAOG,GAAM92B,OAAOpT,EAAK+pC,MACzBpoD,KAAMA,IAGd,QAAS6nD,GAAUW,EAAUna,EAAGoa,GAC5B,GAAI3iD,KACJ,OAAO,SAASsY,GAAKlhB,GACjB,MAAIA,IAAKsrD,EAAS5sD,OACPyyC,GACH/hC,KAAM,SACN7N,MAAOqH,KAGH2iD,EAAWZ,EAAYP,GAAKkB,EAAStrD,GAAI,SAAUiN,GAEvD,MADArE,GAAE5I,GAAKiN,EACAiU,EAAKlhB,EAAI,MAG1B,GAEN,QAAS6qD,GAAiB1Z,GACtB,GAAIka,GAAOL,EAAO,IAClB,QACI57C,KAAM,SACN87C,MAAOG,GACPvoD,KAAMquC,GACF/hC,KAAM,MACNzF,KAAM0hD,KAIlB,QAASL,GAAOrhD,GAKZ,MAJKA,KACDA,EAAO,IAEXA,EAAO,IAAMA,EACNA,KAAS6hD,EAvNpB,GAAIA,GAAS,CACb,OAAOpB,GAAId,EAAKnY,GA0NpB,QAASwY,GAAYX,GAsBjB,QAASyC,GAAGtqC,GACR,GAAI/R,GAAO+R,EAAK/R,IAChB,IAAY,OAARA,EACA,MAAO+R,GAAK5f,MAAQ,EACjB,IAAY,OAAR6N,EACP,MAAO8gB,MAAKC,UAAUhP,EAAK5f,MACxB,IAAY,SAAR6N,EACP,MAAO,iBAAmB8gB,KAAKC,UAAUhP,EAAK5f,OAAS,GACpD,IAAY,UAAR6N,EACP,MAAO,mBAAqBq8C,EAAGtqC,EAAK5f,OAAS,GAC1C,IAAY,QAAR6N,EACP,MAAO,gBAAkB8gB,KAAKC,UAAUhP,EAAK8pB,MAAQ,KAAOwgB,EAAGtqC,EAAK+nB,KAAK,IAAM,KAAOwiB,EAAQvqC,EAAK+nB,KAAK/qC,MAAM,IAAM,GACjH,IAAY,QAARiR,EACP,MAAOq8C,GAAGtqC,EAAK8pB,MAAQ,IAAM9pB,EAAK+nB,KAAK1nC,IAAIiqD,GAAI5rD,KAAK,MAAQ,GACzD,IAAY,OAARuP,EACP,MAAO,QAAU+R,EAAK7Y,MAAQ,GAC3B,IAAY,QAAR8G,EACP,MAAO,GAAK+R,EAAK5f,KACd,IAAY,MAAR6N,EACP,MAAO,iBAAmBq8C,EAAGtqC,EAAKuxB,IAAM,OAAS+Y,EAAGtqC,EAAKwxB,IAAM,MAAQ8Y,EAAGtqC,EAAKqB,IAAM,GAClF,IAAY,UAARpT,EACP,MAAO,aAAe+R,EAAK+pC,KAAKrrD,KAAK,MAAQ,aAAe4rD,EAAGtqC,EAAKre,MAAQ,MACzE,IAAY,OAARsM,EACP,MAAO+R,GAAKxX,IACT,IAAY,UAARyF,EACP,MAAOs8C,GAAQvqC,EAAK5f,MACjB,IAAY,QAAR6N,EACP,MAAO,MAEP,MAAU3G,OAAM,6BAA+B2G,GAGvD,QAASs8C,GAAQ9iD,GACb,MAAO,KAAOA,EAAEpH,IAAIiqD,GAAI5rD,KAAK,MAAQ,KAvD7C,GAOQoI,GANAspC,EAAUqY,EAAYZ,GACtB/oD,EAAOsxC,EAAQ3zC,KAAKorD,GACpBz3B,EAAUo6B,EAAc1rD,EAC5B,OAAIsxB,GACOA,EAAQ9I,MAAMugC,EAAIt5C,MAAOs5C,EAAI72C,IAAK62C,EAAIr2C,MAE7C1K,EAAOwjD,EAAGtB,EAAMnB,EAAIM,IAAK,SAAUz3B,GACnC,OACIziB,KAAM,SACN7N,MAAOswB,MAGf5pB,GACI,cACA,qDACAA,EACA,KACFpI,KAAK,OACP0xB,EAAU,GAAI/S,GAAQwpB,QAAQghB,EAAI10B,KAAM41B,EAAYjiD,GAAOspC,EAASyX,EAAIt5C,MAAOs5C,EAAI72C,IAAK62C,EAAIr2C,KAC5Fg5C,EAAc1rD,GAAQsxB,EAAQ9I,MAAMugC,EAAIt5C,MAAOs5C,EAAI72C,IAAK62C,EAAIr2C,KACrD4e,GAqCX,QAASq6B,GAASvlD,GACd,MAAOA,GAEX,QAAS4hD,GAAYt2C,EAAOjU,GA0BxB,QAASqO,GAAGqD,EAAM7N,GACd,GAAIklB,GAAM2hC,GACV,OAAc,OAAP3hC,GAAwB,MAARrX,GAAgBqX,EAAIrX,OAASA,GAAmB,MAAT7N,GAAiBklB,EAAIllB,QAAUA,EAAe,KAANklB,EAE1G,QAAS2hC,KAIL,MAHa,OAAT9jC,IACAA,EAAQunC,KAELvnC,EAEX,QAASutB,KACL,GAAa,MAATvtB,EAAe,CACf,GAAIlY,GAAMkY,CAEV,OADAA,GAAQ,KACDlY,EAEX,MAAOy/C,KAEX,QAASA,KAAT,GACQh6B,GACAyb,EAAI37B,EAAMy2C,MASd,OARI9a,KACc,OAAVA,EAAEl+B,MAA2B,MAAVk+B,EAAEl+B,MAA0B,OAAVk+B,EAAEl+B,OACvCyiB,EAAMi6B,EAAM,EAAGC,IAAeD,EAAM,EAAGE,IAAcF,EAAM,EAAGG,IAAkBH,EAAM,EAAGI,IAAiBJ,EAAM,EAAGK,IAAaL,EAAM,EAAGM,IAAYN,EAAM,EAAGO,IAE7Jx6B,IACDA,EAAMlgB,EAAMkgC,SAGbhgB,EAEX,QAAS2F,GAAO/Q,EAAK6lC,GAArB,GAcQ3iD,GACAlD,EAcI0L,EAKAQ,EAVJ0iB,CAvBJ,IAAgB,MAAZ5O,EAAIrX,KAIJ,OAHIqX,EAAIiM,KAAQh1B,EAAQ6uD,WAA6B,MAAf7uD,EAAQyU,KAA8B,MAAfzU,EAAQiV,KACjEhB,EAAMpJ,MAAM,4CAET,GAAIyqB,GAAQvM,EAAItU,IAAKsU,EAAI9T,IAAK8T,EAAIiM,IAE7C,IAAgB,OAAZjM,EAAIrX,KACJ,MAAIqX,GAAIllB,OAAS,QACNirD,EAAQ,GAAIx5B,GAAQ60B,EAAOphC,EAAIllB,OAAQ+qD,IAAW5xC,EAAAA,KAAYA,EAAAA,GAAU,IAExE,IAKf,IAFI/Q,EAAO8c,EAAIllB,MACXkF,EAAI,6BAA6BkI,KAAKhF,GAGtC,MADIwI,GAAM01C,EAAOphD,EAAE,IAAKkM,EAAMi1C,EAAOnhD,EAAE,IACnC0L,GAAO,SAAWQ,GAAO,MAClB65C,EAAQ,GAAIx5B,GAAQ60B,EAAOphD,EAAE,IAAKmhD,EAAOnhD,EAAE,KAAMA,EAAE,GAAK,EAAI,IAAMA,EAAE,GAAK,EAAI,KAE7E,IAOf,IAJI4uB,EAAwB,KAAlB1rB,EAAKjD,OAAO,GAClB2uB,IACA1rB,EAAOA,EAAKmc,OAAO,IAEnB,QAAQze,KAAKsC,IAEb,GADIwI,EAAM01C,EAAOl+C,GACbwI,GAAO,QACP,MAAOq6C,GAAQ,GAAIx5B,GAAQ60B,EAAOl+C,GAAO2iD,IAAW5xC,EAAAA,KAAYA,EAAAA,GAAU2a,EAAM,EAAI,QAIxF,IADI1iB,EAAMi1C,EAAOj+C,GACbgJ,GAAO,MACP,MAAO65C,GAAQ,GAAIx5B,GAAQs5B,IAAW5xC,EAAAA,KAAYA,EAAAA,GAAUktC,EAAOj+C,GAAO0rB,EAAM,EAAI,IAIhG,QAAS02B,GAAWnjD,EAAGiZ,EAAGtb,EAAGC,EAAGud,EAAG5mB,EAAGsvD,EAAGzc,GACrC,GAAc,OAAVpnC,EAAEwG,MAA2B,MAAVyS,EAAEzS,MAA2B,KAAXyS,EAAEtgB,OAA0B,OAAVgF,EAAE6I,MAA2B,QAAV5I,EAAE4I,MAA6B,KAAX5I,EAAEjF,QAA2B,OAAVwiB,EAAE3U,MAA2B,MAAV2U,EAAE3U,MAA0B,OAAV2U,EAAE3U,MAAiB2U,EAAExiB,OAASwiB,EAAExiB,MAAQ,IAAgB,MAAVpE,EAAEiS,MAA2B,KAAXjS,EAAEoE,QAA2B,OAAVkrD,EAAEr9C,MAA2B,MAAVq9C,EAAEr9C,MAA0B,OAAVq9C,EAAEr9C,MAAiBq9C,EAAElrD,OAASkrD,EAAElrD,MAAQ,IAAMkrD,EAAEr9C,MAAQ2U,EAAE3U,OAAoB,QAAV4gC,EAAE5gC,MAA6B,KAAX4gC,EAAEzuC,OAAiBkrD,EAAEC,OAAQ,CACnY,GAAIj3B,GAAK+B,EAAOzT,GAAG,GAAO2R,EAAK8B,EAAOi1B,GAAG,EACzC,IAAIh3B,GAAMC,EAEN,MADAvsB,GAAK,GACEwjD,EAAO,GAAI15B,GAASwC,EAAG9M,SAAS/f,EAAErH,OAAO,GAAOm0B,EAAG/M,SAASpiB,EAAEhF,OAAO,IAAOonB,SAAS/f,EAAErH,OAAO,GAAOqH,EAAG6jD,IAI3H,QAAST,GAAUpjD,EAAGiZ,EAAGtb,EAAGC,EAAGud,EAAG5mB,GAAlC,GAEYs4B,GAGIC,CAJZ,IAAc,OAAV9sB,EAAEwG,MAA2B,MAAVyS,EAAEzS,MAA2B,KAAXyS,EAAEtgB,OAA0B,OAAVgF,EAAE6I,MAA2B,QAAV5I,EAAE4I,MAA6B,KAAX5I,EAAEjF,QAA2B,OAAVwiB,EAAE3U,MAA2B,MAAV2U,EAAE3U,MAA0B,OAAV2U,EAAE3U,MAAiB2U,EAAExiB,OAASwiB,EAAExiB,MAAQ,KAAkB,QAAVpE,EAAEiS,MAA6B,KAAXjS,EAAEoE,OAAiBwiB,EAAE2oC,SAC3Oj3B,EAAK+B,EAAOzT,IAIZ,MAFA5a,GAAK,GACDusB,EAAKD,EAAGhN,QACLkkC,EAAO,GAAI15B,GAASwC,EAAG9M,SAAS/f,EAAErH,OAAO,GAAOm0B,EAAG/M,SAASpiB,EAAEhF,OAAO,IAAOonB,SAAS/f,EAAErH,OAAO,GAAOqH,EAAGmb,GAI3H,QAASkoC,GAAcrjD,EAAGiZ,EAAGtb,EAAGC,EAAGud,EAAG5mB,GAClC,GAAc,OAAVyL,EAAEwG,MAA2B,QAAVyS,EAAEzS,MAA6B,KAAXyS,EAAEtgB,QAA2B,OAAVgF,EAAE6I,MAA2B,MAAV7I,EAAE6I,MAA0B,OAAV7I,EAAE6I,MAAiB7I,EAAEhF,OAASgF,EAAEhF,MAAQ,IAAgB,MAAViF,EAAE4I,MAA2B,KAAX5I,EAAEjF,QAA2B,OAAVwiB,EAAE3U,MAA2B,MAAV2U,EAAE3U,MAA0B,OAAV2U,EAAE3U,MAAiB2U,EAAExiB,OAASwiB,EAAExiB,MAAQ,KAAkB,QAAVpE,EAAEiS,MAA6B,KAAXjS,EAAEoE,OAAiBwiB,EAAE2oC,OAAQ,CACxT,GAAIj3B,GAAK+B,EAAOjxB,GAAG,GAAOmvB,EAAK8B,EAAOzT,GAAG,EACzC,IAAI0R,GAAMC,EAEN,MADAvsB,GAAK,GACEwjD,EAAO,GAAI15B,GAASwC,EAAIC,GAAI/M,SAAS/f,EAAErH,OAAO,GAAOqH,EAAGmb,IAI3E,QAASmoC,GAAatjD,EAAGiZ,EAAGtb,EAAGC,GAC3B,GAAc,OAAVoC,EAAEwG,MAA2B,QAAVyS,EAAEzS,MAA6B,KAAXyS,EAAEtgB,QAA2B,OAAVgF,EAAE6I,MAA2B,MAAV7I,EAAE6I,MAA0B,OAAV7I,EAAE6I,MAAiB7I,EAAEhF,OAASgF,EAAEhF,MAAQ,KAAkB,QAAViF,EAAE4I,MAA6B,KAAX5I,EAAEjF,OAAiBgF,EAAEmmD,OAAQ,CAChMvjD,EAAK,EACL,IAAI9C,GAAImxB,EAAOjxB,EAIf,OAHKF,IAAMusB,SAASvsB,EAAE8L,OAClB9L,EAAI,GAAI0sB,GAAQxsB,EAAEhF,QAEforD,EAAOtmD,EAAEsiB,SAAS/f,EAAErH,OAAO,GAAOqH,EAAGrC,IAGpD,QAAS4lD,GAASvjD,EAAGiZ,EAAGtb,EAAGC,GACvB,IAAe,OAAVoC,EAAEwG,MAA2B,MAAVxG,EAAEwG,MAA0B,OAAVxG,EAAEwG,MAAiBxG,EAAErH,OAASqH,EAAErH,MAAQ,IAAiB,MAAVsgB,EAAEzS,MAA2B,KAAXyS,EAAEtgB,QAA4B,OAAVgF,EAAE6I,MAA2B,MAAV7I,EAAE6I,MAA0B,OAAV7I,EAAE6I,MAAiB7I,EAAEhF,OAASgF,EAAEhF,MAAQ,KAAkB,QAAViF,EAAE4I,MAA6B,KAAX5I,EAAEjF,OAAiBgF,EAAEmmD,OAAQ,CACjQ,GAAIj3B,GAAK+B,EAAO5uB,GAAG,GAAO8sB,EAAK8B,EAAOjxB,GAAG,EACzC,IAAIkvB,GAAMC,EAEN,MADAvsB,GAAK,GACEwjD,EAAO,GAAI15B,GAASwC,EAAIC,GAAK9sB,EAAGrC,IAInD,QAAS6lD,GAAQxjD,EAAGiZ,GAChB,IAAe,OAAVjZ,EAAEwG,MAA2B,MAAVxG,EAAEwG,QAA6B,QAAVyS,EAAEzS,MAA6B,KAAXyS,EAAEtgB,OAAiBqH,EAAE8jD,OAAQ,CAC1F,GAAIrmD,GAAImxB,EAAO5uB,EACf,IAAIvC,GAAKusB,SAASvsB,EAAE8L,MAAQygB,SAASvsB,EAAEsM,KAEnC,MADAxJ,GAAK,GACEwjD,EAAOtmD,EAAGuC,EAAGA,IAIhC,QAASyjD,GAAQzjD,EAAGiZ,GAChB,GAAc,OAAVjZ,EAAEwG,MAA2B,QAAVyS,EAAEzS,MAA6B,KAAXyS,EAAEtgB,QAAiBqH,EAAE8jD,MAG5D,MAFA9jD,GAAEwG,KAAO,OACTjG,EAAK,GACEP,EA7JnB,GAEQkjD,GACA3iD,EACAmb,EACAkoC,EASAG,CAKJ,OAlBAh7C,GAAQi7C,EAAeC,EAAYl7C,GAAQjU,GACvCouD,EAAQn6C,EAAMm6C,MACd3iD,EAAOwI,EAAMxI,KACbmb,EAAQ,KACRkoC,EAAyB,MAAf9uD,EAAQyU,KAA8B,MAAfzU,EAAQiV,IAAc,SAAUC,GAOjE,MANe,GAAXA,EAAK8f,MACL9f,EAAKD,KAAOjV,EAAQiV,KAET,EAAXC,EAAK8f,MACL9f,EAAKT,KAAOzU,EAAQyU,KAEjBS,GACPg5C,EACAe,EAASjvD,EAAQ6uD,UAAY,SAAU3gD,EAAOkhD,EAAYC,GAG1D,MAFAnhD,GAAMyS,MAAQyuC,EAAWzuC,MACzBzS,EAAM0S,IAAMyuC,EAASzuC,IACd1S,GACPggD,GAEAxD,KAAMA,EACNvW,KAAMA,EACNtpC,MAAOoJ,EAAMpJ,MACb8hB,IAAK1Y,EAAM0Y,IACXte,GAAIA,GAyIZ,QAAS/C,GAAa7B,GAClB,MAAO,YAAoB+jB,QAAQ/jB,IAAO,EAG9C,QAASylD,GAAej7C,EAAOjU,GAW3B,QAAS0L,GAAQjC,GACb,MAAO,SAASE,KAAKF,GAEzB,QAAS6lD,GAAU7lD,GACf,MAAO,WAAWE,KAAKF,IAAOvI,EAAKsI,gBAAgBC,GAEvD,QAAS8lD,GAAK9lD,GACV,MAAO6lD,GAAU7lD,IAAOiC,EAAQjC,IAAa,KAANA,EAE3C,QAAS+lD,GAAS/lD,GACd,MAAOA,KAAMsgD,GAEjB,QAAS0F,GAAOhmD,GACZ,MAAO,aAAa+jB,QAAQ/jB,IAAO,EAEvC,QAASimD,KAAT,GACQC,IAAU,EACVC,EAAS5kD,EAAU,SAAUvB,GAC7B,MAAIA,IAAMkgD,EAAWC,KACb+F,IAGJA,GAAU,GACH,GAEJjkD,EAAQjC,IAEnB,OAAImmD,IAAUjG,EAAWC,KAEjBl4C,KAAM,OACN7N,MAAO8lD,EAAWC,MAIlBl4C,KAAM,MACN7N,MAAOgjD,WAAW+I,EAAOjuD,QAAQgoD,EAAWC,IAAK,OAI7D,QAASiG,GAAOxmD,EAAI8D,GAChB,OACIuE,KAAM,MACN7N,MAAOwF,EACP4hD,MAAO5hD,EAAGmc,cACVwpC,MAAO1jD,EAAa2I,EAAMy2C,QAC1Bv9C,MAAOA,GAGf,QAAS2iD,GAAM5kD,EAAGiZ,EAAGtb,GACjB,IAAKqC,IAAMiZ,IAAMtb,EACb,MAAO,KAEX,KAAKqC,IAAMrC,GAAKqC,GAAKrC,EAAG,CACpB,GAAI4xB,GAAMtW,EAAI1W,SAAS0W,EAAG,IAAM,CAChC,OAAOjZ,GAAIuvB,EAAMA,EAAM,GAG/B,QAASs1B,KAAT,GAGYt7C,GACAQ,EAHJlM,EAAIkL,EAAM+7C,UAAU,iDACxB,OAAIjnD,KACI0L,EAAMq7C,EAAM/mD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAC1BkM,EAAM66C,EAAM/mD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IACnB,MAAP0L,GAAsB,MAAPQ,IACfhB,EAAMxI,KAAK1C,IAEP2I,KAAM,KACN+C,IAAKA,EACLQ,IAAKA,EACL+f,KAAMjsB,EAAE,MAAQA,EAAE,IAAMA,EAAE,IAAMA,EAAE,IAAM,EAAI,IAAMA,EAAE,MAAQA,EAAE,IAAMA,EAAE,IAAMA,EAAE,IAAM,EAAI,KAI7F8mD,EAAO7kD,EAAUukD,IAE5B,QAASU,KAEL,MADAh8C,GAAMkgC,QAEFziC,KAAM,MACN7N,MAAOoQ,EAAMi8C,YAAY,MAGjC,QAASC,KAEL,MADAl8C,GAAMkgC,OACC0b,EAAO57C,EAAMi8C,YAAY,MAAO,GAE3C,QAASE,KACL,OACI1+C,KAAM,KACN7N,MAAOmH,EAAU,SAAUvB,EAAI+hD,GAC3B,MAAOA,GAAK/hD,IAAMsgD,MAI9B,QAASsG,KACL,OACI3+C,KAAM,OACN7N,MAAOoQ,EAAMkgC,QAGrB,QAASga,KACL,GAAIl6C,EAAM0Y,MACN,MAAO,KAEX,IAAuB5jB,GAAnBU,EAAKwK,EAAMy2C,MACf,OAAU,KAANjhD,EACOwmD,IAED,KAANxmD,EACO0mD,IAEPzkD,EAAQjC,IAAOA,GAAMkgD,EAAWC,IACzB8F,IAEPJ,EAAU7lD,GACHsmD,IAEPP,EAAS/lD,GACF2mD,IAEPX,EAAOhmD,GACA4mD,KAEPtnD,EAAIkL,EAAM+7C,UAAU,wBACpB/7C,EAAMxI,KAAK1C,IAEP2I,KAAM,QACN7N,MAAOkF,EAAE,MAGZ/I,EAAQ6uD,WACT56C,EAAMpJ,MAAM,qCAAwCpB,EAAGjH,WAAW,KAGlEkP,KAAM,QACN7N,MAAOoQ,EAAMkgC,SAGrB,QAASuW,KACL,IADJ,GAGY/pC,GACAoI,EAHDD,EAAO9nB,QAAU4J,GACpBI,EAAUM,GACNqV,EAAQ1M,EAAMlO,MACdgjB,EAAMolC,IACNnuD,EAAQ6uD,WAAa9lC,IACrBA,EAAIpI,MAAQA,EACZoI,EAAInI,IAAM3M,EAAMlO,OAEpB+iB,EAAOxoB,KAAKyoB,EAEhB,OAAOD,GAAOle,GAElB,QAASupC,KACL,GAAIprB,GAAM2hC,GAIV,OAHI3hC,IACAne,IAEGme,EAEX,QAASqlC,GAAMhoD,EAAG3G,GAEd,IADA,GAAIsG,GAAM6E,EAAOM,KACV9E,KAAM,GACT8E,EAAE5K,KAAK6zC,KAAUmc,EAGrB,OADA1lD,GAAQ7E,EACDtG,EAAE8J,MAAM2B,EAAGA,GAEtB,QAASO,GAAKrF,GACVwE,GAASxE,EAEb,QAASumB,KACL,MAAiB,OAAV+9B,IApLf,GACQ5hC,MAAale,EAAQ,EACrBI,EAAYiJ,EAAMjJ,SACtB,QACImpC,KAAMA,EACNuW,KAAMA,EACN/9B,IAAKA,EACL9hB,MAAOoJ,EAAMpJ,MACbujD,MAAOA,EACP3iD,KAAMA,GA8Kd,QAAS0jD,GAAYl7C,GAcjB,QAASoqC,KACL,MAAOt4C,GAEX,QAASouC,KACL,GAAI1qC,GAAKwK,EAAMjL,OAAOjD,IAOtB,OANU,MAAN0D,GACAu/B,IACA/zB,EAAM,GAENA,IAEGxL,EAEX,QAASihD,KACL,MAAOz2C,GAAMjL,OAAOjD,GAExB,QAAS4mB,KACL,MAAkB,KAAX+9B,IAEX,QAAS7/C,GAAMC,GACX,KAAM,IAAIuJ,GAAWvJ,EAAM,YAAcmJ,EAAQ,IAAKlO,GAE1D,QAAS0F,GAAKhC,GACV,GAAiB,gBAANA,GACHwK,EAAMmU,OAAOriB,EAAK0D,EAAGzI,SAAWyI,GAChCoB,EAAM,YAAcpB,GAExB8mD,EAAQ9mD,EAAGzI,YACR,IAAIyI,YAAcU,QAAQ,CAC7B,GAAIpB,GAAIU,EAAGwH,KAAKgD,EAAMmU,OAAOriB,GAC7B,IAAIgD,EAEA,MADAwnD,GAAQxnD,EAAE,GAAG/H,QACN+H,MAGXwnD,GAAQ9mD,EAAG,GAAGzI,QAGtB,QAASuvD,GAAQnqD,GACb,KAAOA,KAAM,GACT+tC,IAGR,QAAS+b,GAAYtvC,GAEjB,IAFJ,GAGYnX,GAFJ+mD,GAAU,EAAOnuD,EAAM,IACnBsqB,KAEJ,GADIljB,EAAK0qC,IACLqc,EACAnuD,GAAOoH,EACP+mD,GAAU,MACP,IAAU,MAAN/mD,EACP+mD,GAAU,MACP,CAAA,GAAI/mD,GAAMmX,EACb,KAEAve,IAAOoH,EAGf,MAAOpH,GAEX,QAAS2I,GAAUs7B,GAEf,IADA,GAAIjkC,GAAM,IACFsqB,KAAS2Z,EAAUokB,IAAQroD,IAC/BA,GAAO8xC,GAEX,OAAO9xC,GAEX,QAAS2tD,GAAUS,GACf,MAAOA,GAAGx/C,KAAKgD,EAAMmU,OAAOriB,IAjFhC,GAAIA,GAAM,EAAGijC,EAAO,EAAG/zB,EAAM,CAC7B,QACIk/B,KAAMA,EACNuW,KAAMA,EACN/9B,IAAKA,EACL9hB,MAAOA,EACPG,UAAWA,EACXklD,YAAaA,EACbF,UAAWA,EACXvkD,KAAMA,EACN8kD,QAASA,EACTxqD,IAAKs4C,GAsKb,QAASp1B,GAAShV,EAAOQ,EAAKQ,GAe1B,QAASk/B,KACL,GAAIprB,GAAM9U,EAAMkgC,MAiBhB,OAhBgB,OAAZprB,EAAIrX,KACa,QAAbqX,EAAIkiC,OACJliC,EAAIrX,KAAO,OACXqX,EAAIllB,OAAQ,GACQ,SAAbklB,EAAIkiC,QACXliC,EAAIrX,KAAO,OACXqX,EAAIllB,OAAQ,GAEG,OAAZklB,EAAIrX,OACXqX,GACIrX,KAAM,MACNG,IAAY,MAAP4C,GAAsB,MAAPQ,EAAc8T,EAAI4M,SAASlhB,EAAKQ,GAAO8T,EAC3DpI,MAAOoI,EAAIpI,MACXC,IAAKmI,EAAInI,MAGVmI,EAjCf,GAUQA,GATAD,IAMJ,KALA7U,EAAQs2C,EAAYt2C,GAChB46C,WAAW,EACXp6C,IAAKA,EACLQ,IAAKA,KAEDhB,EAAM0Y,OACV7D,EAAOxoB,KAAK6zC,IAMhB,OAJIprB,GAAMD,EAAO,GACD,MAAZC,EAAIrX,MAA6B,KAAbqX,EAAIllB,QACxBklB,EAAIrX,KAAO,YAERoX,EAsBX,QAAS4nC,GAAWz8C,EAAOQ,EAAKQ,GAAhC,GAOQ2hB,GAEI/kB,CADR,KAPA4C,EAAMA,GAAO,EACbQ,EAAMA,GAAO,EACbhB,EAAQs2C,EAAYt2C,GAChBQ,IAAKA,EACLQ,IAAKA,IAEL2hB,MACI3iB,EAAM0Y,OAAO,CAEjB,GADI9a,EAAMoC,EAAMkgC,OACA,OAAZtiC,EAAIH,KACJ,KAAM,IAAI2C,GAAW,kCAAoCme,KAAKC,UAAU5gB,GAE5E+kB,GAAKt2B,KAAKuR,EAAI8jB,SAASlhB,EAAKQ,IAEhC,MAAO2hB,GA2KX,QAAS+5B,GAAgBC,EAAOnP,GAAhC,GACQp4C,GAAKunD,EAAQnP,EACbgP,EAAKI,EAAiBxnD,EAO1B,OANKonD,KACDA,EAAK,gCACLA,EAAKA,EAAG9uD,QAAQ,OAAQ,KAAO8/C,GAAK9/C,QAAQ,OAAQ,KAAOivD,GAC3DH,EAAStmD,OAAOsmD,GAChBI,EAAiBxnD,GAAMonD,GAEpBA,EAEX,QAASK,GAAOzuD,EAAKwiB,GAEjB,IADA,GAAIxa,GAAM,GACHwa,KAAQ,GACXxa,GAAOhI,CAEX,OAAOgI,GA55Cb,GAKMnJ,GACAsP,EACA2kB,EACAI,EACAD,EACAD,EACAyb,EACAhwB,EACAmpC,EACAD,EAgCAD,EACAJ,EAwBAt1C,EASA62C,EAIAC,EAkPAqB,EA4RAyB,EAkOAqC,EA6QAS,EACAC,EAyTAH,CAz4CAlxD,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DrP,EAAOvB,MAAMuB,KACbsP,EAAc7Q,MAAM6Q,YACpB2kB,EAAM3kB,EAAY2kB,IAClBI,EAAW/kB,EAAY+kB,SACvBD,EAAU9kB,EAAY8kB,QACtBD,EAAU7kB,EAAY6kB,QACtByb,EAAUtgC,EAAY4D,KACtB0M,EAAUgwB,EAAQhwB,QAClBmpC,EAAqB9gD,OAAOC,OAAO,MACnC4gD,EAAkB7gD,OAAOC,OAAO,MACnC,SAAU6nD,GACPA,EAAIl/C,QAAQ,SAAUoa,EAAK7pB,GACvB6pB,EAAIpa,QAAQ,SAAUy5C,GAClBvB,EAAmBuB,GAAMyF,EAAIjwD,OAASsB,EACtC0nD,EAAsB,KAANwB,EAAY,IAAMA,GAAMyF,EAAIjwD,OAASsB,SAI5D,MACA,MACA,MACA,MACA,MAEG,IACA,MAGA,IACA,MAEH,MAEG,IACA,IACA,IACA,KACA,KACA,QAGJynD,EAAYE,EACZN,GACAC,IAAK,IACLC,IAAK,IACLC,IAAK,KAQThZ,EAAQ4Q,qBAAuB,SAAUgI,EAAKjqD,GAC1C,GAAIkqD,EAAWC,KAAOF,EAClB,MAAOjqD,IAEX,IAAI+L,GAAOm+C,EAAWC,GACtBH,GAAoBC,EACpB,KACI,MAAOjqD,KACT,QACEgqD,EAAoBj+C,KAG5BslC,EAAQogB,YAAcvH,EAClBt1C,EAAa1U,MAAM4D,MAAMzD,QACzBC,KAAM,SAAoByR,EAASzL,GAC/B5F,KAAKqR,QAAUA,EACfrR,KAAK4F,IAAMA,GAEf8vB,SAAU,WACN,MAAO11B,MAAKqR,WAGhB05C,GACAx5C,KAAM,OACN7N,OAAO,GAEPsnD,GACAz5C,KAAM,OACN7N,OAAO,GAgPP2oD,EAAc,SAAUtjD,GACxB,MAAO,UAAUqB,GACb,GAAI9K,GAAIyJ,EAAMqB,EAId,OAHK9K,KACDA,EAAIyJ,EAAMqB,GAAYmiC,SAAS,uBAA2BniC,EAAO,QAE9D9K,IAEb0J,OAAOC,OAAO,OAoRZ6kD,EAAgB9kD,OAAOC,OAAO,MAkO9BknD,GAAQ5+C,KAAM,OA6Qdq/C,KACAC,EAAuBlgB,EAAQkgB,qBAAuB,SAAUG,GAChEJ,EAAezwD,KAAK6wD,IAExBrgB,EAAQtmC,MAAQ,SAAUwH,EAAOyC,EAAKQ,EAAKhB,EAAOkB,GAAlC,GA2BJ9S,GA6CJo4B,EAzBKn4B,EACD0D,EAiBJioC,CAhEJ,IAAIh6B,YAAiBhK,MACjB,OACIyH,KAAM,OACN7N,MAAOid,EAAQmvB,aAAah8B,GAGpC,IAAoB,gBAATA,GACP,OACIvC,KAAM,SACN7N,MAAOoQ,EAGf,IAAoB,iBAATA,GACP,OACIvC,KAAM,UACN7N,MAAOoQ,EAIf,IADAA,GAAS,GACL,KAAKtK,KAAKsK,GACV,OACIvC,KAAM,SACN7N,MAAOoQ,EAAMmU,OAAO,GAG5B,IAAI,cAAcze,KAAKsK,KACf5R,EAAM4R,EAAMmU,OAAO,EAAGnU,EAAMjT,OAAS,GACrCy5B,EAAMosB,WAAWxkD,IAChBqL,MAAM+sB,IAAQA,GAAOp4B,GACtB,OACIqP,KAAM,UACN7N,MAAO42B,EAAM,IAIzB,IAAI,KAAK9wB,KAAKsK,GAEV,MADAA,GAAQA,EAAMmU,OAAO,GACjB,KAAKze,KAAKsK,GACHmiC,EAAapkC,EAAOyC,EAAKQ,EAAKhB,IAGjCvC,KAAM,SACN7N,MAAO,IAAMoQ,EAIzB,KAAS3R,EAAI,EAAGA,EAAIyuD,EAAe/vD,SAAUsB,EAEzC,GADI0D,EAAS+qD,EAAezuD,GAAG2R,GAE3B,MAAOjO,EAGf,OAA2B,QAAvBiO,EAAMvL,eAEFgJ,KAAM,UACN7N,OAAO,GAGY,SAAvBoQ,EAAMvL,eAEFgJ,KAAM,UACN7N,OAAO,IAGXoqC,EAAOntB,EAAQ4vB,UAAUz8B,EAAOkB,KAG5BzD,KAAM,OACN7N,MAAOid,EAAQmvB,aAAahC,KAGhCxT,EAAMosB,WAAW5yC,IAChBvG,MAAM+sB,IAAQxmB,EAAMjT,OAAS,GAAKy5B,GAAOxmB,GAC1CkB,EAAS,KACLslB,GAAO3L,KAAK+F,MAAM4F,KAClBtlB,EAAS,MAAcslB,EAAP/4B,IAAYwE,MAAM,KAAK,GAAGvE,QAAQ,MAAO,OAGzD+P,KAAM,SACN7N,MAAO42B,EACPtlB,OAAQA,KAIZzD,KAAM,SACN7N,MAAOoQ,KAwDf68B,EAAQ+a,oBAAsBA,EAC9B/a,EAAQsF,aAAeA,EACvBtF,EAAQ4L,eAAiBA,EACzB5L,EAAQnJ,QAAUskB,EAClBnb,EAAQ4f,WAAaA,EACrB5f,EAAQqe,YAAcA,EACtBre,EAAQz8B,WAAaA,EACrBy8B,EAAQ7nB,SAAWA,EACnB+nC,EAAqB,SAAU/8C,GAAV,GACblL,GAEI0lC,EACAib,EACA9a,EACAN,EAMA8iB,EAEI1iD,EA0DJohC,EACAC,EACAC,EACAd,EA1EDjB,EAAO,EAAG94B,EAAS,EAC1B,IAAIpM,EAAI,8CAA8CkI,KAAKgD,GAAQ,CAiB/D,GAhBIw6B,EAAKhhC,SAAS1E,EAAE,GAAI,IACpB2gD,EAAM3gD,EAAE,GACR6lC,EAAKnhC,SAAS1E,EAAE,GAAI,IACpBulC,EAAK7gC,SAAS1E,EAAE,GAAI,IACpBulC,EAAK,GACLA,GAAM,IACCA,EAAK,MACZA,GAAM,MAEN8iB,GAAa,EACb3iB,EAAK,KACD//B,EAAM+/B,EACVA,EAAKG,EACLA,EAAKlgC,EACL0iD,GAAa,IAEZtwC,EAAQ6tB,UAAUL,EAAIG,EAAIG,GAC3B,MAAO,KAEXX,GAAOntB,EAAQkuB,SAASV,EAAIG,EAAK,EAAGG,GAChCX,EAAO,GACPA,IAGA94B,EADAi8C,GAEI,KACA,KACA,QACFjvD,KAAKunD,IAGH,KACA,KACA,QACFvnD,KAAKunD,GAEXv0C,GAAUpM,EAAE,GACZkL,EAAQA,EAAMmU,OAAOrf,EAAE,GAAG/H,QAE9B,OAAI+H,EAAI,gBAAgBkI,KAAKgD,KACrB67B,EAAKriC,SAAS1E,EAAE,GAAI,IACpBgnC,EAAKtiC,SAAS1E,EAAE,GAAI,KAEpB2I,KAAM,OACNyD,OAAQA,EAAS,QACjBtR,MAAOoqC,EAAOntB,EAAQ+uB,SAASC,EAAIC,EAAI,EAAG,MAG9ChnC,EAAI,uBAAuBkI,KAAKgD,KAC5B87B,EAAKtiC,SAAS1E,EAAE,GAAI,IACpBinC,EAAKviC,SAAS1E,EAAE,GAAI,IACpBmmC,EAAwB,IAAnB2X,WAAW99C,EAAE,KAElB2I,KAAM,OACNyD,OAAQA,EAAS,WACjBtR,MAAOoqC,EAAOntB,EAAQ+uB,SAAS,EAAGE,EAAIC,EAAId,MAG9CnmC,EAAI,sBAAsBkI,KAAKgD,KAC3B67B,EAAKriC,SAAS1E,EAAE,GAAI,IACpBgnC,EAAKtiC,SAAS1E,EAAE,GAAI,IACpBinC,EAAKviC,SAAS1E,EAAE,GAAI,KAEpB2I,KAAM,OACNyD,OAAQA,EAAS,WACjBtR,MAAOoqC,EAAOntB,EAAQ+uB,SAASC,EAAIC,EAAIC,EAAI,MAG/CjnC,EAAI,6BAA6BkI,KAAKgD,KAClC67B,EAAKriC,SAAS1E,EAAE,GAAI,IACpBgnC,EAAKtiC,SAAS1E,EAAE,GAAI,IACpBinC,EAAKviC,SAAS1E,EAAE,GAAI,IACpBmmC,EAAwB,IAAnB2X,WAAW99C,EAAE,KAElB2I,KAAM,OACNyD,OAAQA,EAAS,cACjBtR,MAAOoqC,EAAOntB,EAAQ+uB,SAASC,EAAIC,EAAIC,EAAId,KARnD,SAYJ8hB,EAAqB,SAAU/8C,GAAV,GACblL,GAAG3C,EAkDHvC,EAjDA+uB,EAAUjzB,MAAMizB,UAChBg+B,EAAQh+B,EAAQqV,aAAa,KAC7BwZ,EAAM7uB,EAAQqV,aAAa,KAC3BL,EAAWhV,EAAQqV,aAAaL,SAASioB,OACzCwB,EAAQV,EAAgBC,EAAOnP,GAC/B6P,EAAYnnD,OAAO,UAAYy9B,EAAW,QAC1CyL,EAAO,EACPl+B,EAAS,GACTo8C,EAAS,GACTC,GAAe,EACfC,GAAc,CASlB,IARAx9C,EAAQk7C,EAAYl7C,EAAMtS,QAAQ,aAAc,KAC5CsS,EAAMxI,KAAK,WACX4nC,OAEAtqC,EAAIkL,EAAMxI,KAAK6lD,MACfE,GAAe,EACfr8C,GAAU,IAAMpM,EAAE,GAAK,KAEvBkL,EAAMxI,KAAK,SAAU,CACrB,GAAI4nC,EAAO,EACP,MAAO,KAEXA,MAEJ,KAAMjtC,EAAI6N,EAAMxI,KAAK4lD,IACjB,MAAO,KAGX,IADAl8C,GAAU,IACNpM,EAAIkL,EAAMxI,KAAK6lD,GAAQ,CACvB,GAAIE,EACA,MAAO,KAEXA,IAAe,EACfD,EAAS,IAAMxoD,EAAE,GAAK,IAM1B,OAJKyoD,IAAiBzoD,EAAIkL,EAAMxI,KAAK,eACjCgmD,GAAc,EACdF,EAASxoD,EAAE,IAEVkL,EAAM0Y,QAGPvmB,EAAE,IAAMorD,KACRr8C,GAAU,MAEV/O,EAAE,KACF+O,GAAU,IAAM27C,EAAO,IAAK1qD,EAAE,GAAGpF,OAAS,IAE1C6C,EAAQuC,EAAE,GAAGzE,QAAYwI,OAAO,KAAOymD,EAAO,KAAM,IAAIjvD,QAAYwI,OAAO,KAAOs3C,EAAK,KAAM,KACjG59C,EAAQgjD,WAAWhjD,GACf4tD,IACA5tD,GAAS,KAEbsR,GAAUo8C,EACNC,IACAr8C,GAAU,KAAOA,IAGjBzD,KAAM,SACNk2B,SAAU4pB,EACVr8C,OAAQA,EACRtR,MAAOwvC,EAAOxvC,IArBP,OAwBfmtD,EAAqB,SAAU/8C,GAC3B,GAAIlL,EACJ,IAAIA,EAAI,6BAA6BkI,KAAKgD,GACtC,OACIvC,KAAM,SACN7N,MAAOgjD,WAAW5yC,GAAS,IAC3BkB,OAAQ,KAAO27C,EAAO,IAAK/nD,EAAE,GAAG/H,QAAU+H,EAAE,MAIpD8nD,OAmBY,kBAAVnxD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,4BACH,aACA,cACA,iBACA,oBACDD,IACL,WACE,YAYA,SAASiyD,GAAUhzC,EAAMhO,EAAUihD,GAC/B,GAAIC,GAAS,GAAIC,WACjBD,GAAOE,OAAS,SAAUzrC,GACtB,GAAI0rC,GAAM,GAAIC,OAAM3rC,EAAEjU,OAAOpM,OAC7BisD,GAAaF,EAAKrhD,EAAUihD,IAEhCC,EAAOM,kBAAkBxzC,GAwG7B,QAASyzC,GAAGzzC,GAMR,MAFIA,GAHC,MAAM/U,KAAK+U,GAGLA,EAAK0J,OAAO,GAFZ,MAAQ1J,EAMvB,QAASuzC,GAAaF,EAAKrhD,EAAU0hD,GAArC,GAEQC,GACAC,EACAC,EACAlxC,EACAmxC,EACAh6C,EAkDAi6C,CAxDJC,GAAYhiD,EAASqO,qBACjBszC,EAAUM,EAAYZ,GACtBO,EAAgBM,EAAkBb,EAAK,sBACvCQ,EAAQM,EAAUd,EAAKO,EAAcQ,OAAOP,MAAM,IAClDlxC,EAAS0xC,EAAWhB,EAAKQ,GACzBC,KACAh6C,EAAc,EAClBhO,EAAMunD,EAAK,mBACPiB,MAAO,SAAUC,EAAK/mD,GAAf,GAEKgnD,GACAx0C,EACAzS,EACAknD,CAJJhzD,MAAKkO,GAAG+kD,IACJF,EAAQhnD,EAAM,QACdwS,EAAO4zC,EAAce,KAAKH,GAC1BjnD,EAAOC,EAAMD,KACbknD,EAAMG,EAAgBvB,EAAKrzC,GAC/BhO,EAAS1Q,QAAQuS,YAAc4gD,EAAI5gD,aAAe7B,EAAS1Q,QAAQuS,YACnE7B,EAAS1Q,QAAQyS,UAAY0gD,EAAI1gD,WAAa/B,EAAS1Q,QAAQyS,UAC/D+/C,EAAMlyD,MACFoQ,SAAUA,EACVqhD,IAAKA,EACLM,QAASA,EACThxC,OAAQA,EACR3C,KAAMA,EACN1e,SACIiM,KAAMA,EACN0L,KAAMmX,KAAKoK,IAAIxoB,EAAS1Q,QAAQ2X,MAAQ,EAAGw7C,EAAIx7C,MAC/CC,QAASkX,KAAKoK,IAAIxoB,EAAS1Q,QAAQ4X,SAAW,EAAGu7C,EAAIv4B,MACrDroB,YAAa4gD,EAAI5gD,YACjBE,UAAW0gD,EAAI1gD,cAGhBtS,KAAKkO,GAAGklD,IACXrnD,EAAMsnD,YACNh7C,EAAci7C,EAAQvnD,EAAMsnD,aAIxC/xD,KAAM,SAAUA,GAAV,GAGMiyD,GACA1hD,EAIA/F,EAPJC,EAAQ/L,KAAKkO,GAAGslD,IAChBznD,GAAWmmC,EAAKnmC,EAAM,cAAgBmmC,EAAKnmC,EAAM0nD,eAC7CF,EAAexnD,EAAMwnD,aACrB1hD,EAAQ,KACQ,MAAhB0hD,IACA1hD,EAAQwgD,EAAMkB,GAAc1zD,QAAQiM,MAEpCA,EAAOC,EAAMD,KACL,yBAARA,IACI+F,IACA/F,EAAO,IAAO+F,EAAMrQ,QAAQ,MAAO,OAAU,KAAQsK,GAEzD4nD,EAAa7hD,EAAO,KAAM,WACtBtB,EAASgP,WAAWzT,EAAMxK,EAAM4wC,EAAKnmC,EAAM+uC,UAC5C,8BAAgChvC,QAK/CwmD,EAAU,GAAIlxD,GAAEuyD,SACpBrB,EAAQL,SAAS,SAAU5mB,GACnB4mB,GACAA,EAAS2B,OAAOvoB,KAErB3sB,KAAK,WACJ,GAAIymC,GAAS50C,EAAS40C,QACtB0O,GAAa1O,GACb50C,EAAS8H,YAAY8sC,EAAO9sC,IACxB45C,GACAA,EAAStmB,YAGjBmoB,EAAWzB,EAAO9hD,EAAU+hD,GAEhC,QAASwB,GAAWzB,EAAO9hD,EAAU0hD,GAArC,GAEa9vD,GADL4xD,GAAQ,GAAI3yD,GAAEuyD,UAAWhoB,SAC7B,KAASxpC,EAAI,EAAGA,EAAIkwD,EAAMxxD,OAAQsB,KAC7B,SAAUyB,EAAOzB,GACd4xD,EAAQA,EAAMr1C,KAAK,WAAA,GAGXs1C,GACA3oB,EAHAx5B,EAAQtB,EAAS0jD,YAAYrwD,EAAM/D,QAUvC,OATAgS,GAAM2oC,gBAAe,GACjBwZ,EAAUE,EAAWriD,EAAOjO,GAC5BynC,GACAx5B,MAAOA,EACPogD,SAAU9vD,GAAKkwD,EAAMxxD,OAAS,IAElCmzD,EAAQt1C,KAAK,WACTuzC,EAAS2B,OAAOvoB,KAEb2oB,KAEb3B,EAAMlwD,GAAIA,EAEhB4xD,GAAMr1C,KAAK,WACPuzC,EAAStmB,YAGjB,QAASuoB,GAAWriD,EAAOwU,GACvB,GAAImrC,GAAW,GAAIpwD,GAAEuyD,QAKrB,OAJArsC,YAAW,WACP6sC,EAAU9tC,EAAIurC,IAAKvrC,EAAI9H,KAAM1M,EAAOwU,EAAI6rC,QAAS7rC,EAAInF,QACrDswC,EAAS7lB,WACV,GACI6lB,EAEX,QAASqC,GAAa1O,GAClB,IAAK,GAAIhjD,GAAI,EAAGA,EAAIgjD,EAAOtkD,OAAQsB,IAC/BgjD,EAAOhjD,GAAGq4C,gBAAe,GAAO9hC,eAAgBC,QAAQ,IAGhE,QAASw6C,GAAgBvB,EAAKrzC,GAC1B,GAAIy0C,IACAx7C,KAAM,EACNijB,KAAM,EAsBV,OApBApwB,GAAMunD,EAAKI,EAAGzzC,IACVs0C,MAAO,SAAUC,EAAK/mD,GAClB,GAAW,aAAP+mD,EAAoB,CACpB,GAAIphD,GAAM6qC,EAAexwC,EAAM2F,IAC3BA,GAAI6kB,cACJy8B,EAAIv4B,KAAO/oB,EAAI6kB,YAAYzhB,IAAM,EACjCk+C,EAAIx7C,KAAO9F,EAAI6kB,YAAYjiB,IAAM,OAEtB,kBAARw+C,GACH/mD,EAAMqoD,kBACNpB,EAAI5gD,YAAciiD,EAAW3N,WAAW36C,EAAMqoD,mBAE9CroD,EAAMuoD,mBACNtB,EAAI1gD,UAAYiiD,EAAY7N,WAAW36C,EAAMuoD,qBAE1Ct0D,KAAKkO,GAAGsmD,IACfx0D,KAAKqO,UAIV2kD,EAEX,QAASqB,GAAWhxD,GAApB,GACQoxD,GAAoB,EACpBC,GAAY,IAAMrxD,EAAOsrB,KAAK+F,MAAM,IAAM+/B,IAAsB,GACpE,OAAOC,GAAWD,EAEtB,QAASF,GAAYI,GACjB,MAAOA,IAAO,EAAI,GAEtB,QAASR,GAAUvC,EAAKrzC,EAAM1M,EAAOqgD,EAAShxC,GAmP1C,QAAS0zC,KACL/iD,EAAMlB,MAAMswC,GAAW1mC,OAAOs6C,IAC9B5T,EAAY,KArPpB,GAEQvvC,GAAKH,EAAM7N,EAAOgwB,EAASohC,EAAcC,EAKzCC,EAAUC,EACVhU,EACAD,EACAkU,EACAC,EACAC,EACAC,EAZAC,KAEAC,GAAQ1jD,EAAMirB,SAASsF,OACvBozB,GAAc,KACdC,GAAWl3C,EAAK/c,QAAQ,eAAgB,qBACxC2wD,GAAgBM,EAAkBb,EAAK6D,IAQvCZ,KACJtC,GAAY1gD,EAAMvB,UAAUsO,kBAC5BvU,EAAMunD,EAAKI,EAAGzzC,IACVs0C,MAAO,SAAUC,EAAK/mD,EAAO2pD,GAAtB,GACCnnD,GAmBIonD,EAOAjmC,EACAkmC,EACArzD,EAQS0hC,EAQT3vB,EACA9R,EAYIqzD,EAeJ9C,EACA9gD,CAxER,IAAIjS,KAAKkO,GAAG4nD,GACJJ,GACe,UAAX3pD,EAAM0jC,GAA6B,MAAZ1jC,EAAM6nB,KAC7BF,EAAU7hB,EAAMlB,MAAM2kD,EAAevpD,EAAM6nB,KAAKsT,KAAK,gBAG1D,IAAIlnC,KAAKkO,GAAG6nD,GACfryD,EAAQ,KACRgwB,EAAU,KACVhiB,EAAM3F,EAAM5D,EACZ2sD,EAAe,KACJ,MAAPpjD,IACAA,EAAM6qC,EAAeiZ,IACrB9jD,EAAIoD,MACJpD,EAAMA,GAAAA,GAEV8jD,GAAc9jD,EACdH,EAAOxF,EAAM0jC,EACTkmB,EAAa5pD,EAAM+mC,EACL,MAAd6iB,GACAK,EAAWnkD,EAAOH,EAAKwP,EAAQy0C,OAEhC,IAAI31D,KAAKkO,GAAG+nD,GACfpkD,EAAMlB,MAAM5E,EAAM2F,KAAKqF,YACpB,IAAI/W,KAAKkO,GAAGgoD,GAAU,CAUzB,GATIxmC,EAAQ4jC,EAAQvnD,EAAMitB,KAAO,EAC7B48B,EAAOjnC,KAAKqK,IAAIu8B,GAAOjC,EAAQvnD,EAAMgtB,MAAQ,EAE7ChtB,EAAMxJ,QACNA,EAAQ8xD,EAAW3N,WAAW36C,EAAMxJ,QACtB,IAAVA,GACAsP,EAAMirB,SAAS/0B,OAAOrE,MAAMgsB,EAAOkmC,EAAMrzD,IAG5B,MAAjBwJ,EAAM+uC,QAA4B,IAAVv4C,EACxB,IAAS0hC,EAAKvU,EAAOuU,GAAM2xB,EAAM3xB,IAC7BpyB,EAAMswB,WAAW8B,EAGN,OAAfl4B,EAAMpJ,OACNqzD,EAAWnkD,EAAO,GAAIrS,OAAM6Q,YAAY+kB,SAAS,GAAI51B,OAAM6Q,YAAY8kB,WAAStY,EAAAA,IAAU6S,GAAQ,GAAIlwB,OAAM6Q,YAAY8kB,WAAStY,EAAAA,IAAU+4C,IAAQ10C,EAAQnV,EAAMpJ,WAE9J3C,MAAKkO,GAAGsmD,IACXlgD,EAAMg/C,EAAQvnD,EAAM5D,GAAK,EAEzB4D,EAAMoqD,KACN3zD,EAAS+xD,EAAY7N,WAAW36C,EAAMoqD,KACvB,IAAX3zD,GACAqP,EAAMsrB,MAAMp1B,OAAOrE,MAAM4Q,EAAKA,EAAK9R,IAGtB,MAAjBuJ,EAAM+uC,QAA6B,IAAXt4C,GACxBqP,EAAM0wB,QAAQjuB,IAEXtU,KAAKkO,GAAGkoD,GACXrqD,EAAM6K,aACFi/C,EAAQtZ,EAAexwC,EAAM6K,YACjC/E,EAAMtC,OAAOsmD,GAAO,IAEjB71D,KAAKkO,GAAGmoD,GACI,UAAftqD,EAAMkF,QACFlF,EAAMuqD,QACNzkD,EAAMyF,cAAcg8C,EAAQvnD,EAAMuqD,SAElCvqD,EAAMwqD,QACN1kD,EAAM0F,WAAW+7C,EAAQvnD,EAAMwqD,UAGhCv2D,KAAKkO,GAAGsoD,GACf3kD,EAAMkB,cAAcm/B,EAAKnmC,EAAMgH,eAAe,IACvC/S,KAAKkO,GAAGuoD,IACX1D,EAAQhnD,EAAM,QACdkG,EAASkgD,GAAce,KAAKH,GAC5B9gD,GACAJ,EAAMlB,MAAM5E,EAAM2F,KAAKe,KAAKR,IAEzBjS,KAAKkO,IAAI,gBAChB+yC,EAAYl1C,EAAM2F,IACdgkD,GACAd,KAEG3T,IACHjhD,KAAKkO,IAAI,iBACT8yC,EAAe1zC,SAASvB,EAAM2qD,MAAO,IAC9B12D,KAAKkO,IAAI,mBAChBgnD,EAAoBhjB,EAAKnmC,EAAM4qD,KAAO,MAAQ,KAC9CxB,MACOn1D,KAAKkO,IAAI,kBAChBK,EAAMqoD,EAAgB7qD,EAAMge,SAAUhe,EAAMqD,KACxCb,GACA4mD,EAAqBh1D,MACjB4pB,SAAUxb,EAAIwb,SACdrmB,MAAO6K,EAAI7K,SAGZ1D,KAAKkO,IAAI,kBAChB2mD,GAAQ10D,MACJua,OAAQsmC,EACRzmC,OAAQ,GAAI/a,OAAM6Q,YAAYwmD,eAAgBtlD,KAAMulD,EAAkB/qD,EAAMwF,UAEzEvR,KAAKkO,IAAI,UAChB2mD,GAAQ10D,MACJua,OAAQsmC,EACRzmC,OAAQ,GAAI/a,OAAM6Q,YAAY0mD,WAC1BrzD,MAAOszD,EAAajrD,EAAMqD,KAC1BmC,KAAM,SAAU0lD,EAAS/5C,GACrB,MAAO+5C,IAAW/5C,EAAM,aAAeA,EAAM,YAAc+5C,EAAU,gBAAkB,gBACzF/kB,EAAKnmC,EAAMkrD,SAAU/kB,EAAKnmC,EAAMmR,UAGnCld,KAAKkO,IAAI,aAChBknD,EAAoBljB,EAAKnmC,EAAMmrD,OAC/B7B,MACOr1D,KAAKkO,IAAI,YAChBmnD,EAAkBl1D,KAAK62D,EAAajrD,EAAMqD,QAItD+nD,MAAO,SAAUrE,EAAK/mD,GAAf,GAOSqrD,GAOAzmD,CAbR3Q,MAAKkO,GAAG4nD,GACHpiC,GAAsB,UAAX3nB,EAAM0jC,GAA6B,MAAZ1jC,EAAM6nB,KACzCF,EAAU7hB,EAAMlB,MAAM2kD,EAAevpD,EAAM6nB,KAAKsT,KAAK,YAElDlnC,KAAKkO,GAAG6nD,GACA,MAAXriC,GACI0jC,EAAS1D,EAAa7hD,EAAOijD,GAAgBpjD,EAAK,WAClDG,EAAMlB,MAAMmkD,GAAgBpjD,GAAKgiB,QAAQA,EAASqhC,IACnD,mBACCqC,GACAvlD,EAAMlB,MAAMmkD,GAAgBpjD,GAAKhO,MAAMgwB,GAAS+P,WAAW,YAE/C,MAAT//B,IACHiN,EAAQkB,EAAMlB,MAAMe,GACnBf,EAAMu2B,KAAK,aACP31B,GAAgB,KAARA,EAEM,KAARA,EACP7N,EAAQwuD,EAAQoB,EAAQ5vD,IACT,KAAR6N,EACP7N,EAAkB,MAAVA,EACO,KAAR6N,IACP7N,EAAQlE,MAAM+wC,UAAU7sC,IANxBA,EAAQgjD,WAAWhjD,GAQV,MAATA,GACAiN,EAAMjN,MAAMA,KAIjB1D,KAAKkO,GAAGmpD,IAAmBr3D,KAAKkO,GAAGopD,IACzC,WAAA,GACO7gC,GAAOj3B,MAAM6Q,YAAY4D,KAAKs8C,WAAWxkD,EAAMwrD,OAC/ChmD,EAAOxF,EAAMwF,KAAKhJ,cAClBwhB,EAAWhe,EAAMge,QACjB,uBAAsBvgB,KAAK+H,GAC3BA,EAAO,SACQ,QAARA,IACPwY,EAAW,SAEVA,GAAY,oBAAoBvgB,KAAK+H,KACtCwY,EAAW,WAEf0M,EAAK7kB,QAAQ,SAAUF,GACnBgiD,EAAa7hD,EAAOH,EAAK,WACrBG,EAAMlB,MAAMe,GAAK0M,YACb7M,KAAM2gC,EAAKnmC,EAAMyrD,kBAAkB,GAAQ,SAAW,UACtD7hB,KAAMqf,EACN9e,GAAI+e,EACJrf,SAAUrkC,EACV+kC,aAAcmhB,EAAmB1tC,IAAaA,EAC9C2sB,WAAYxE,EAAKnmC,EAAM2rD,YACvB7gB,WAAY3E,EAAKnmC,EAAM4rD,eAAyB,QAARpmD,GAA0B,QAARA,EAC1DylC,gBAAiBjrC,EAAMolC,MACvB8F,cAAelrC,EAAM6rD,cAE1B,2BAGG,QAAP9E,EACPjhD,EAAMirB,SAASyjB,WACD,aAAPuS,EACPjhD,EAAMsrB,MAAMojB,WACE,cAAPuS,EACP8B,IACO3T,IACI,iBAAP6R,EACA+B,GAAQ10D,MACJua,OAAQsmC,EACRzmC,OAAQ,GAAI/a,OAAM6Q,YAAYgL,cAC1Bw8C,MAAO3C,EACP4C,SAAU3C,MAGJ,WAAPrC,GACP+B,GAAQ10D,MACJua,OAAQsmC,EACRzmC,OAAQ,GAAI/a,OAAM6Q,YAAY8K,aAC1BpT,OAAQstD,EACR0C,OAAQ3C,QAM5B9zD,KAAM,SAAUA,GACZ,GAAIyK,EACA/L,MAAKkO,GAAG8pD,IAAch4D,KAAKkO,GAAG+pD,GAC9Bv0D,EAAQpC,GACDyK,EAAQ/L,KAAKkO,GAAG4nD,KACvBpiC,EAAUpyB,EACVyzD,EAA4B,SAAXhpD,EAAM0jC,EACnBslB,EACAD,EAAe/oD,EAAM2F,IACH,UAAX3F,EAAM0jC,IACb6lB,EAAevpD,EAAM6nB,IAAMliB,IAExB1R,KAAKkO,GAAGgqD,IAA4Bl4D,KAAKkO,GAAGiqD,GACnDnD,EAAW1zD,EACJtB,KAAKkO,GAAGkqD,IAA4Bp4D,KAAKkO,GAAGmqD,GACnDpD,EAAW3zD,EACJtB,KAAKkO,GAAGoqD,KACft4D,KAAKK,MAAML,KAAKK,MAAMQ,OAAS,GAAG02D,MAAQj2D,MAS1D,QAASs1D,GAAgBvL,EAAI3nD,GACzB,GAAI60D,IACAC,MAAO,KACPC,SAAU,KACVxgB,YAAa,KACbygB,mBAAoB,MACpBxgB,SAAU,KACVygB,gBAAiB,OACnBtN,EAEF,OADA3nD,GAAQszD,EAAatzD,GACjB60D,GAAyB,gBAAT70D,IAEZqmB,SAAUwuC,EACV70D,MAAOA,GAGJ,YAAN2nD,GAAqBA,GAAuB,gBAAT3nD,GAAxC,QAEQqmB,SAAUshC,EAAK,eAAiB,UAChC3nD,MAAOA,GAInB,QAASozD,GAAkBvlD,GACvB,OACIqnD,GAAI,WACJC,GAAI,WACJC,GAAI,WACJC,GAAI,WACJC,GAAI,UACJC,GAAI,WACJC,GAAI,QACJC,GAAI,QACJC,GAAI,MACJC,GAAI,OACJC,GAAI,OACJC,GAAI,SACJC,GAAI,YACJC,IAAK,UACLC,IAAK,WACLC,IAAK,YACPpoD,EAAK8T,gBAAkB9T,EAE7B,QAASylD,GAAa5nD,GAClB,GAAIb,GAAMm4C,WAAWt3C,EACrB,OAAK7B,OAAMgB,IAAQA,GAAOa,EAGnBA,EAFIb,EAIf,QAASmlD,GAAa7hD,EAAOH,EAAK07B,EAAMoE,GACpC,IAEI,MADApE,MACO,EACT,MAAOxjC,GACL,GAAIyiC,IACAmF,QAASA,EACTL,MAAcvnC,EAAPrI,GASX,OAPIsQ,KACAw6B,EAAIx6B,MAAQA,EAAM/F,QAElB4F,IACA26B,EAAI6R,SAAkBxsC,EAAPnQ,IAEnBgxD,EAAUpyD,KAAKksC,IACR,GAiDf,QAAS2pB,GAAWnkD,EAAOH,EAAKwP,EAAQy0C,GA8BpC,QAASiE,GAAUt6D,GACf,GAAI0V,GAAqB,gBAAL1V,GAAgBA,EAAIA,EAAEu6D,UAC5B,OAAV7kD,GAAmB,aAAaxL,KAAKwL,KACrCA,EAASA,EAAOxT,QAAQ,iBAAkB,IAC1CmP,EAAMqE,OAAOA,IAGrB,QAAS8kD,GAAQx6D,GACC,SAAVA,EAAEiS,MACFZ,EAAM8yB,WAAWnkC,EAAE6jC,OAG3B,QAAS42B,GAAQz6D,GACbqR,EAAM21B,WAAWhnC,EAAEwM,MACfxM,EAAE+D,MACFsN,EAAMH,UAAU,WAAqB,EAATlR,EAAE+D,KAAW,GAEzC/D,EAAEqkC,MACFhzB,EAAMgzB,MAAK,GAEXrkC,EAAEokC,QACF/yB,EAAM+yB,QAAO,GAEbpkC,EAAEsT,WACFjC,EAAMiC,WAAU,GAEhBtT,EAAE6jC,OACFxyB,EAAMwyB,MAAM7jC,EAAE6jC,OAGtB,QAAS62B,GAAUh2C,GACf,QAASmO,GAAI8nC,EAAMxmC,GAAnB,GAKQlxB,GAIA4gC,EARA/tB,EAAS4O,EAAEi2C,EACV7kD,KAGD7S,EAAQ23D,EAAc9kD,EAAOzS,OACnB,IAAVJ,IAGA4gC,EAAQ/tB,EAAO+tB,MACN,MAATA,IACAA,EAAQ,QAEZxyB,EAAMH,UAAUijB,GACZpwB,KAAMd,EACN4gC,MAAOA,MAGfhR,EAAI,OAAQ,cACZA,EAAI,MAAO,aACXA,EAAI,QAAS,eACbA,EAAI,SAAU,gBAElB,QAASgoC,GAAUC,EAAWtxB,GAC1B,GAAI2G,GAAI4qB,EAAGD,EACX,IAAS,MAAL3qB,IAAcA,EACd,OAAO,CAGX,IADA/rC,EAAQ22D,EAAGvxB,GACPtrB,GAAiB,MAAT9Z,EAAe,CAEvB,GADA+rC,EAAIjyB,EAAK48C,GACA,MAAL3qB,IAAcA,EACd,OAAO,CAEX/rC,GAAQ8Z,EAAKsrB,GAEjB,MAAgB,OAATplC,EAjGf,GAE8C8Z,GAAM9Z,EAD5CiN,EAAQkB,EAAMlB,MAAMe,GACpB2oD,EAAKn5C,EAAOo5C,aAAa3E,EACzB0E,GAAGE,OACH/8C,EAAO0D,EAAOs5C,YAAYH,EAAGE,OAE7BJ,EAAU,cAAe,aACzBH,EAAU94C,EAAOqiB,QAAQ7/B,IAEzBy2D,EAAU,YAAa,WACvBJ,EAAQ74C,EAAOu5C,MAAM/2D,IAErBy2D,EAAU,iBAAkB,cAC5BxpD,EAAMizB,UAAUlgC,GAEhBy2D,EAAU,iBAAkB,kBAC5BxpD,EAAMkzB,cAAcngC,GAEpBy2D,EAAU,iBAAkB,WAC5BxpD,EAAM+pD,OAAOh3D,GAEby2D,EAAU,iBAAkB,aAC5BxpD,EAAMH,UAAU,OAAQ9M,GAExBy2D,EAAU,YAAa,WACvBL,EAAQ54C,EAAOy5C,MAAMj3D,IAErBy2D,EAAU,oBAAqB,aAC/BP,EAAU14C,EAAO05C,QAAQl3D,IAAUm3D,EAAgBn3D,IAwE3D,QAAS2G,GAAMunD,EAAKrzC,EAAMhU,GACtB,GAAIuwD,GAAOlJ,EAAImJ,MAAMx8C,EACjBu8C,IACA/rD,EAAS+rD,EAAKE,eAAgBzwD,GAGtC,QAASioD,GAAYZ,GAArB,GACQM,MACApvD,EAAU,IAiBd,OAhBAuH,GAAMunD,EAAK,wBACPuF,MAAO,WACCn3D,KAAKkO,GAAG+sD,KACR/I,EAAQ/xD,KAAK2C,GACbA,EAAU,OAGlBxB,KAAM,SAAUA,GACRtB,KAAKkO,GAAGgtD,KACO,MAAXp4D,IACAA,EAAU,IAEdA,GAAWxB,MAIhB4wD,EAEX,QAASO,GAAkBb,EAAKrzC,GAC5B,GAAI5a,IACAuvD,QACAP,QAAUP,UAad,OAXA/nD,GAAMunD,EAAKI,EAAGzzC,GAAQ,SAClBs0C,MAAO,SAAUC,EAAK/mD,GAAf,GAGKwF,GACA4pD,CAHG,iBAAPrI,IACAnvD,EAAIuvD,KAAKnnD,EAAMqvD,IAAMrvD,EAAMsvD,OACvB9pD,EAAOxF,EAAMuvD,KAAK98C,MAAM,QAAQ,GAChC28C,EAAUx3D,EAAIgvD,OAAOphD,OACzB4pD,EAAQh7D,KAAK4L,EAAMsvD,QACnB13D,EAAIgvD,OAAOphD,GAAQ4pD,MAIxBx3D,EA8FX,QAASivD,GAAWhB,EAAKQ,GA8FrB,QAASmJ,GAAMxvD,GAgBX,QAASyvD,GAAQ1vD,GACM,MAAfC,EAAMD,KACNuuD,EAAGvuD,GAAQomC,EAAKnmC,EAAMD,KAjB9B,GAAIuuD,IACAoB,SAAUnI,EAAQvnD,EAAM0vD,UACxBC,OAAQpI,EAAQvnD,EAAM2vD,QACtBC,OAAQrI,EAAQvnD,EAAM4vD,QACtBC,SAAUtI,EAAQvnD,EAAM6vD,UACxBC,YAAa3pB,EAAKnmC,EAAM8vD,aACxBC,YAAa5pB,EAAKnmC,EAAM+vD,aACxBvB,KAAMjH,EAAQvnD,EAAMwuD,MAaxB,OAXAiB,GAAQ,kBACRA,EAAQ,eACRA,EAAQ,aACRA,EAAQ,aACRA,EAAQ,qBACRA,EAAQ,mBAMDnB,EAEX,QAAS0B,GAAShwD,GAAlB,GAMYiwD,GAIA74B,EAGI84B,CAZZ,OAAIlwD,GAAMmwD,IACCC,EAAWpwD,EAAMmwD,KACjBnwD,EAAMqwD,QACNC,GAAe/I,EAAQvnD,EAAMqwD,UAC7BrwD,EAAMqmD,OACT4J,EAAa5J,EAAMkK,YAAYhJ,EAAQvnD,EAAMqmD,UAI7CjvB,EAAQ3jC,MAAMsgD,WAAWkc,GACzBjwD,EAAMkwD,OACN94B,EAAQA,EAAMo5B,QACVN,EAAOvV,WAAW36C,EAAMkwD,MAExB94B,EAAM16B,EADNwzD,EAAO,EACG94B,EAAM16B,GAAK,EAAIwzD,GAEf94B,EAAM16B,GAAK,EAAIwzD,IAAS,IAAM,KAAO,EAAIA,KAGpD94B,EAAMq5B,aAZFH,GAAe,GAHvB,OA1Hf,GACQn7C,IACAu5C,SACAG,WACAD,SACAp3B,WACAi3B,eACAF,iBAEAmC,EAAO,KACPC,EAAO,KACPtnD,EAAS,KACTilD,EAAK,IAgIT,OA/HAhwD,GAAMunD,EAAK,iBACPiB,MAAO,SAAUC,EAAK/mD,EAAO2pD,GACzB,GAAI11D,KAAKkO,GAAGyuD,IACRz7C,EAAO05C,QAAQ7uD,EAAM6vD,UAAY7vD,MAC9B,IAAI/L,KAAKkO,GAAG0uD,IACf17C,EAAOu5C,MAAMt6D,KAAKs8D,UACf,IAAIA,EACI,MAAP3J,EACA2J,EAAKp5D,KAAOqjD,WAAW36C,EAAMqD,KACf,QAAP0jD,EACP2J,EAAK3wD,KAAOC,EAAMqD,IACJ,KAAP0jD,EACP2J,EAAK94B,KAAOuO,EAAKnmC,EAAMqD,KAAK,GACd,KAAP0jD,EACP2J,EAAK/4B,OAASwO,EAAKnmC,EAAMqD,KAAK,GAChB,KAAP0jD,EACP2J,EAAK7pD,UAAyB,MAAb7G,EAAMqD,KAA4B,UAAbrD,EAAMqD,IAC9B,SAAP0jD,IACP2J,EAAKt5B,MAAQ44B,EAAShwD,QAEvB,IAAI/L,KAAKkO,GAAG2uD,IACf37C,EAAOy5C,MAAMx6D,KAAKu8D,UACf,IAAIA,EACI,eAAP5J,EACA4J,EAAKnrD,KAAOxF,EAAM+wD,YACJ,WAAPhK,GAAkC,UAAd4J,EAAKnrD,KAChCmrD,EAAKv5B,MAAQ44B,EAAShwD,GACR,WAAP+mD,GAAkC,UAAd4J,EAAKnrD,OAChCmrD,EAAKv5B,MAAQ44B,EAAShwD,QAEvB,IAAI/L,KAAKkO,GAAG6uD,GACf77C,EAAOqiB,QAAQpjC,KAAKiV,UACjB,IAAIA,GAIP,GAHI,8BAA8B5L,KAAKspD,KACnC19C,EAAO09C,IAASnwD,MAAOoJ,EAAMpJ,OAAS,SAE/B,SAAPmwD,EAAgB,CAChB,GAAImH,GAAOj6D,KAAKK,MAAML,KAAKK,MAAMQ,OAAS,GAAG+M,IAC7CwH,GAAO6kD,GAAM92B,MAAQ44B,EAAShwD,QAE3B/L,MAAKkO,GAAG8uD,KACf3C,EAAKkB,EAAMxvD,GACXmV,EAAOs5C,YAAYr6D,KAAKk6D,GACpB3E,IACA2E,EAAK,OAEFr6D,KAAKkO,GAAG+uD,KACf5C,EAAKkB,EAAMxvD,GACXmV,EAAOo5C,aAAan6D,KAAKk6D,GACrB3E,IACA2E,EAAK,OAEFA,GACI,aAAPvH,IACI,kCAAkCtpD,KAAKuC,EAAMmxD,cAC7C7C,EAAGz2B,UAAY73B,EAAMmxD,YAErB,0BAA0B1zD,KAAKuC,EAAMoxD,YACrC9C,EAAGx2B,cAAgB93B,EAAMoxD,UAEP,MAAlBpxD,EAAMqxD,WACN/C,EAAG+C,SAAWlrB,EAAKnmC,EAAMqxD,WAET,MAAhBrxD,EAAM2uD,SACNL,EAAGK,OAASpH,EAAQvnD,EAAM2uD,WAK1CvD,MAAO,SAAUrE,GACT9yD,KAAKkO,GAAG0uD,IACRH,EAAO,KACAz8D,KAAKkO,GAAG2uD,IACfH,EAAO,KACA18D,KAAKkO,GAAG6uD,GACf3nD,EAAS,KACK,MAAP09C,IACPuH,EAAK,SAkDVn5C,EAYX,QAASwxC,GAAUd,EAAK/8B,GAmBpB,QAASwoC,GAAKC,EAAKvyD,EAAGiZ,GAClB,GAAIzV,GAAM+uD,EAAIvyD,EACduyD,GAAIvyD,GAAKuyD,EAAIt5C,GACbs5C,EAAIt5C,GAAKzV,EAtBjB,GACQgvD,MACAnL,GAAUkK,YAAaiB,GACvBh/C,EAAOyzC,EAAGn9B,EAqBd,OApBI+8B,GAAImJ,MAAMx8C,KACVlU,EAAMunD,EAAKrzC,GACPs0C,MAAO,SAAUC,EAAK/mD,GACd/L,KAAKkO,GAAGsvD,IACRD,EAAOp9D,KAAKg8D,EAAwB,UAAbpwD,EAAMqD,IAAkB,WAAa,aACrDpP,KAAKkO,GAAGuvD,KACfF,EAAOp9D,KAAKg8D,EAAW,KAAOpwD,EAAMqD,SAI5CmuD,EAAO18D,OAAS,IAChBw8D,EAAKE,EAAQ,EAAG,GAChBF,EAAKE,EAAQ,EAAG,KAQjBnL,EAEX,QAASkB,GAAQlkD,GACb,MAAc,OAAPA,EAAc,KAAO9B,SAAS8B,EAAK,IAE9C,QAAS8iC,GAAK9iC,EAAKu8C,GACf,MAAW,OAAPv8C,EACOu8C,EAEG,QAAPv8C,GAAiBA,KAAQ,GAAe,GAAPA,EAE5C,QAAS+sD,GAAWD,GAChB,GAAItzD,GAAI,0DAA0DkI,KAAKorD,EACvE,OAAO,QAAU5uD,SAAS1E,EAAE,GAAI,IAAM,KAAO0E,SAAS1E,EAAE,GAAI,IAAM,KAAO0E,SAAS1E,EAAE,GAAI,IAAM,KAAO0E,SAAS1E,EAAE,GAAI,IAAM,IAAM,IAviCtI,GAKMxH,GACA2N,EACAwtC,EACAkb,EAIAlF,EASAwD,EAKAG,EAIA1C,EAIAsC,EAMAG,EAIAI,EAKA7B,EAIA4B,EAKAnD,EAIAgF,EAMAiD,EACAD,EACAjD,EAMA5E,EAIAoD,EAIAC,EAIAY,EAIAa,EAKAE,EAKAd,EAIAgB,EAKAH,EAMAE,EA0dA6B,EAgBAW,EA+KAkC,EAIAF,GAIAD,GAIAK,GAIAD,GAIAL,GAIAN,GAkNAoB,GAKAD,EA3/BAh+D,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,MAAMgG,OACVuJ,EAAWvP,MAAMuB,KAAKgO,SACtBwtC,EAAiB/8C,MAAM6Q,YAAY4D,KAAKsoC,eACxCkb,GACAiB,mBAAoB,uBACpBC,gBAAiB,qBAEjBpG,EAAY,KASZwD,GACA,YACA,MACA,KAEAG,GACA,OACA,OAEA1C,GACA,eACA,eAEAsC,GACA,YACA,MACA,IACA,KAEAG,GACA,aACA,aAEAI,GACA,aACA,YACA,QAEA7B,GACA,YACA,OAEA4B,GACA,aACA,YACA,aAEAnD,GACA,SACA,SAEAgF,GACA,YACA,MACA,IACA,MAEAiD,GAAY,KACZD,GAAqB,MACrBjD,GACA,YACA,MACA,IACA,KAEA5E,GACA,YACA,gBAEAoD,GACA,aACA,aAEAC,GACA,aACA,aAEAY,GACA,kBACA,kBAEAa,GACA,kBACA,iBACA,YAEAE,GACA,kBACA,iBACA,YAEAd,GACA,sBACA,sBAEAgB,GACA,sBACA,qBACA,YAEAH,GACA,sBACA,qBACA,eACA,QAEAE,GACA,sBACA,qBACA,eACA,QAsdA6B,GACAwD,KAAQ,EACRC,KAAQ,EACRC,OAAU,EACVC,OAAU,EACVC,OAAU,EACVC,MAAS,EACTC,SAAU,EACVC,KAAQ,EACRC,aAAgB,EAChBC,QAAW,EACXC,cAAiB,EACjBC,WAAc,EACdC,iBAAoB,EACpBC,aAAgB,GAEhB1D,GACA2D,EAAG,UACHr4D,EAAG,IACHG,EAAG,OACHG,EAAG,QACHG,EAAG,WACHe,EAAG,KACHvB,GAAI,QACJq4D,GAAI,WACJC,GAAI,QACJ7xC,GAAI,UACJ8xC,GAAI,WACJC,GAAI,WACJC,GAAI,QACJC,GAAI,SACJC,GAAI,aACJC,GAAI,gBACJz4D,GAAI,OACJ04D,GAAI,UACJC,GAAI,cACJ39C,GAAI,iBACJuL,GAAI,sBACJtL,GAAI,sBACJ3a,GAAI,2BACJs4D,GAAI,QACJlyC,GAAI,YACJmyC,GAAI,SACJC,GAAI,WACJC,GAAI,KAmJJvC,GACA,UACA,UAEAF,IACA,QACA,QAEAD,IACA,QACA,QAEAK,IACA,UACA,MAEAD,IACA,eACA,MAEAL,IACA,UACA,UAEAN,IACAF,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,aAgJXsB,IACA,cACA,IACA,aAEAD,IACA,cACA,IACA,YAyCJh+D,MAAM6Q,YAAYkhD,UAAYA,EAC9B/xD,MAAM6Q,YAAYkvD,WAAapL,EAC/B30D,MAAM6Q,YAAYmvD,aAAehN,EACjChzD,MAAM6Q,YAAYovD,YAAc7M,EAChCpzD,MAAM6Q,YAAYqvD,WAAahN,EAC/BlzD,MAAM6Q,YAAYsvD,cAAgB7N,IAClB,kBAAVvyD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,wBACH,aACA,sBACA,yBACA,4BACDD,IACL,YACG,SAAUE,GAohBP,QAASogE,GAAoBt1D,EAAMzK,GAC/B,QAASggE,GAAG90D,EAAGiZ,EAAGtb,GACd,MAAa+E,UAAN1C,EAAkBA,EAAU0C,SAANuW,EAAkBA,EAAItb,EAF3D,GAMiBvG,GACDmS,EACA0vB,EAKS51B,EACD2G,EACAkvB,EAXhB/Q,EAAW2sC,EAAGv1D,EAAK4oB,SAAUrzB,EAAQ2X,KAAM,KAAM2b,EAAc0sC,EAAGv1D,EAAK6oB,YAAatzB,EAAQ4X,QAAS,IAAKnF,EAAYutD,EAAGv1D,EAAKgI,UAAWzS,EAAQyS,UAAW,IAAKF,EAAcytD,EAAGv1D,EAAK8H,YAAavS,EAAQuS,YAAa,IAAK8mC,EAAe2mB,EAAGv1D,EAAK4uC,aAAcr5C,EAAQq5C,aAAc,IAAKC,EAAc0mB,EAAGv1D,EAAK6uC,YAAat5C,EAAQs5C,YAAa,GAC1V,IAAkB1rC,SAAdnD,EAAKkN,KACL,IAASrV,EAAI,EAAGA,EAAImI,EAAKkN,KAAK3W,SAAUsB,EAMpC,GALImS,EAAMhK,EAAKkN,KAAKrV,GAChB6hC,EAAK67B,EAAGvrD,EAAI7J,MAAOtI,GACnB6hC,GAAM9Q,IACNA,EAAW8Q,EAAK,GAEhB1vB,EAAIwC,MACJ,IAAS1I,EAAI,EAAGA,EAAIkG,EAAIwC,MAAMjW,SAAUuN,EAChC2G,EAAOT,EAAIwC,MAAM1I,GACjB61B,EAAK47B,EAAG9qD,EAAKtK,MAAO2D,GACpB61B,GAAM9Q,IACNA,EAAc8Q,EAAK,EAMvC,QACI/Q,SAAUA,EACVC,YAAaA,EACb7gB,UAAWA,EACXF,YAAaA,EACb8mC,aAAcA,EACdC,YAAaA,GAjjBxB,GAIO/3C,GACA+oC,EACAnV,EACA+V,EACA+0B,CAPAtgE,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACV2kC,EAAU3qC,EAAM6Q,YAAY4D,KAAK0M,QAAQwpB,QACzCnV,EAAMx1B,EAAM6Q,YAAY2kB,IACxB+V,EAAYvrC,EAAM6Q,YAAY06B,UAC9B+0B,EAAWtgE,EAAME,WAAWC,QAC5BC,KAAM,SAAUC,EAAS2nB,GACrBhoB,EAAME,WAAWI,GAAGF,KAAKG,KAAKC,MAC9BA,KAAKH,QAAUA,EACfG,KAAKoZ,MAAQoO,EACbxnB,KAAK27C,WACL37C,KAAK+/D,sBACL//D,KAAKoY,OAASpY,KAAKi0D,aACfz8C,KAAMxX,KAAKH,QAAQ2X,KACnBC,QAASzX,KAAKH,QAAQ4X,QACtBnF,UAAWtS,KAAKH,QAAQyS,UACxBF,YAAapS,KAAKH,QAAQuS,YAC1B8mC,aAAcl5C,KAAKH,QAAQq5C,aAC3BC,YAAan5C,KAAKH,QAAQs5C,YAC1BpzB,WAAY/lB,KAAKH,QAAQkmB,aAE7B/lB,KAAKggE,cAAgB,GAAIxgE,GAAMuB,KAAKtB,cACpCO,KAAKggE,cAAcjuD,MACf,OACA,QACD/R,KAAKigE,YAAYluD,KAAK/R,OACzBA,KAAKkgE,SAAW,GAAI1gE,GAAM6Q,YAAY8vD,eAAengE,MACrDA,KAAKogE,mBAAqB,GAAI5gE,GAAM6Q,YAAY2hC,yBAAyBhyC,MACzEA,KAAKqgE,OAASr3D,OAAOC,OAAO;AAC5BjJ,KAAK2zB,SAAS3zB,KAAKH,UAEvBgY,UAAW,WAIP,MAHK7X,MAAK4X,aACN5X,KAAK4X,WAAa,GAAIpY,GAAM6Q,YAAYs0B,UAAU3kC,OAE/CA,KAAK4X,YAEhBqI,QAAS,WACLjgB,KAAKsgE,SACDtgE,KAAK4X,YACL5X,KAAK4X,WAAWqI,WAGxB/f,QACI,MACA,OACA,QACA,SACA,cACA,cACA,cACA,cACA,cACA,cACA,YACA,eACA,YACA,eACA,UACA,aACA,YACA,eACA,SACA,gBAEJqgE,aAAc,SAAUr6C,GACpBlmB,KAAKU,QAAQ,SAAUwlB,IAE3Bs6C,gBAAiB,SAAUt6C,GACnBlmB,KAAKU,QAAQ,aACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVmoD,mBAAoB,SAAUv6C,GACtBlmB,KAAKU,QAAQ,gBACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVooD,gBAAiB,SAAUx6C,GACnBlmB,KAAKU,QAAQ,aACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVqoD,mBAAoB,SAAUz6C,GACtBlmB,KAAKU,QAAQ,gBACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVsoD,cAAe,SAAU16C,GACjBlmB,KAAKU,QAAQ,WACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVuoD,iBAAkB,SAAU36C,GACpBlmB,KAAKU,QAAQ,cACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVwoD,gBAAiB,SAAU56C,GACnBlmB,KAAKU,QAAQ,aACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGVyoD,mBAAoB,SAAU76C,GACtBlmB,KAAKU,QAAQ,gBACTmR,MAAOqU,EAAEmiC,OACT59C,MAAOyb,EAAEzb,SAEbyb,EAAE5N,kBAGV0oD,aAAc,SAAU96C,GACpBlmB,KAAKU,QAAQ,SAAUwlB,IAE3B+6C,qBAAsB,SAAU/6C,GAC5BlmB,KAAKU,QAAQ,iBAAkBwlB,IAEnCg7C,aAAc,SAAUxvD,GACpB,GAAI6D,GAAOvV,IACX,OAAOuV,GAAK6C,OAAOzE,oBAAoB,WACnC,MAAO,IAAInU,GAAM6Q,YAAY8J,MAAMzI,EAAK6D,EAAK6C,QAAQtE,WAG7DmsD,YAAa,SAAU/5C,GACnBA,EAAE9lB,QAAQuQ,QAAQpB,UAEtB4xD,QAAS,SAAUthE,GAAV,GAYDgG,GAXAu7D,EAAiBhgE,EAAEzB,QAAS4Q,SAAUvQ,MAAQH,EAAQA,SACtDO,EAAU,GAAIZ,GAAM6Q,YAAYxQ,EAAQO,SAASghE,GACjDvvD,EAAQ7R,KAAKqY,aAiBjB,OAhBI+oD,GAAernD,QACf3Z,EAAQ2Z,OAAOqnD,EAAernD,QAG9B3Z,EAAQuQ,MADRywD,EAAe7iB,eACD6iB,EAAe7iB,eAEf1sC,EAAM4G,aAEpB5S,EAASzF,EAAQ0Q,OAChBjL,GAA4B,UAAlBA,EAAOyL,SACdlR,EAAQke,WACRte,KAAKggE,cAAc//D,QAEnBD,KAAKggE,cAAc7/D,KAAKC,IAGzByF,GAEX26C,cAAe,WACXxgD,KAAK27C,QAAQ/pC,QAAQ,SAAUC,GAC3BA,EAAM2uC,mBAGdC,iBAAkB,WACdzgD,KAAK27C,QAAQ/pC,QAAQ,SAAUC,GAC3BA,EAAM4uC,sBAGd4gB,QAAS,SAAU/vD,GACXA,EAAOqH,SACP3Y,KAAKwgD,gBACLxgD,KAAKygD,mBACLzgD,KAAKoY,OAAOO,OAAO3Y,KAAKkgE,UACxBlgE,KAAKoY,OAAOsoC,WAAW1gD,KAAKogE,sBAGpC/nD,YAAa,SAAUxG,GACnB,MAAcpE,UAAVoE,EACO7R,KAAKoY,YAEXpY,KAAKw7C,YAAY3pC,EAAM/F,UAG5B9L,KAAKoY,OAASvG,EACdA,EAAM6G,cAAclZ,EAAM6Q,YAAY8wC,gBAE1CmgB,iBAAkB,SAAUzvD,EAAO0vD,GAAjB,GACVC,GAAYxhE,KAAK2oD,WAAW92C,GAC5BszC,EAASnlD,KAAK27C,OACd6lB,UAGJxhE,KAAK+/D,sBACL5a,EAAOpqB,OAAOwmC,EAAS,EAAGpc,EAAOpqB,OAAOymC,EAAW,GAAG,IACtDxhE,KAAKU,QAAQ,UAAY+gE,gBAAgB,MAE7CxN,YAAa,SAAUp0D,GAAV,GAELu4B,GACAspC,EACAC,EACAxc,EACAyc,EAaA/vD,CALJ,IAbAhS,EAAUA,MACNu4B,EAAOp4B,KACP0hE,EAAuC,gBAAlB7hE,GAAQ4K,MAAqB5K,EAAQ4K,MAAQ2tB,EAAKujB,QAAQ96C,OAE/EskD,EAAS/sB,EAAKujB,QACdimB,EAAqB,SAAUC,GAC/BA,EAAkBA,EAAkBA,EAAkB,CACtD,IAAI/1D,GAAO,QAAU+1D,CACrB,OAAKzpC,GAAKojB,YAAY1vC,GAGf81D,EAAmBC,EAAkB,GAFjC/1D,IAIXjM,EAAQiM,OAAQssB,EAAKojB,YAAY37C,EAAQiM,MAiB7C,MAdA9L,MAAK+/D,sBACL4B,EAAY9hE,EAAQiM,MAAQ81D,IACxB/vD,EAAQ,GAAIrS,GAAM6Q,YAAYsoC,MAAM94C,EAAQ2X,MAAQxX,KAAKH,QAAQ2X,KAAM3X,EAAQ4X,SAAWzX,KAAKH,QAAQ4X,QAAS5X,EAAQyS,WAAatS,KAAKH,QAAQyS,UAAWzS,EAAQuS,aAAepS,KAAKH,QAAQuS,YAAavS,EAAQq5C,cAAgBl5C,KAAKH,QAAQq5C,aAAcr5C,EAAQs5C,aAAen5C,KAAKH,QAAQs5C,YAAat5C,EAAQu5C,kBAAoBp5C,KAAKH,QAAQu5C,kBAC/VvnC,EAAMvB,UAAYtQ,KAClB6R,EAAMuN,MAAMuiD,GACZ3hE,KAAK8hE,iBAAiBjwD,GACtBszC,EAAOpqB,OAAO2mC,EAAa,EAAG7vD,GAC1BhS,EAAQyK,MACRuH,EAAM8hB,SAAS9zB,EAAQyK,MAEvBzK,EAAQkmB,YACRlU,EAAM4oC,cAAc56C,EAAQkmB,YAEhC/lB,KAAKU,QAAQ,UAAY+gE,gBAAgB,IAClC5vD,GAEXiwD,iBAAkB,SAAUjwD,GACxBA,EAAME,KAAK,SAAU/R,KAAKugE,aAAaxuD,KAAK/R,OAC5C6R,EAAME,KAAK,YAAa/R,KAAKwgE,gBAAgBzuD,KAAK/R,OAClD6R,EAAME,KAAK,eAAgB/R,KAAKygE,mBAAmB1uD,KAAK/R,OACxD6R,EAAME,KAAK,YAAa/R,KAAK0gE,gBAAgB3uD,KAAK/R,OAClD6R,EAAME,KAAK,eAAgB/R,KAAK2gE,mBAAmB5uD,KAAK/R,OACxD6R,EAAME,KAAK,UAAW/R,KAAK4gE,cAAc7uD,KAAK/R,OAC9C6R,EAAME,KAAK,aAAc/R,KAAK6gE,iBAAiB9uD,KAAK/R,OACpD6R,EAAME,KAAK,YAAa/R,KAAK8gE,gBAAgB/uD,KAAK/R,OAClD6R,EAAME,KAAK,eAAgB/R,KAAK+gE,mBAAmBhvD,KAAK/R,OACxD6R,EAAME,KAAK,SAAU/R,KAAKghE,aAAajvD,KAAK/R,OAC5C6R,EAAME,KAAK,iBAAkB/R,KAAKihE,qBAAqBlvD,KAAK/R,QAEhEmlD,OAAQ,WACJ,MAAOnlD,MAAK27C,QAAQr7C,SAExBk7C,YAAa,SAAUmmB,GACnB,MAAO3hE,MAAK27C,QAAQ37C,KAAK2oD,WAAWgZ,KAExCI,aAAc,SAAUt3D,GACpB,MAAOzK,MAAK27C,QAAQlxC,IAExBk+C,WAAY,SAAU92C,GAAV,GAQA/F,GAPJq5C,EAASnlD,KAAK27C,QACdgmB,GAA6B,gBAAT9vD,GAAoBA,EAAQA,EAAM/F,QAAQvD,cAC9D6hB,EAAMpqB,KAAK+/D,mBAAmB4B,EAClC,IAAIv3C,GAAO,EACP,MAAOA,EAEX,KAAKA,EAAM,EAAGA,EAAM+6B,EAAOtkD,OAAQupB,IAG/B,GAFIte,EAAOq5C,EAAO/6B,GAAKte,OAAOvD,cAC9BvI,KAAK+/D,mBAAmBj0D,GAAQse,EAC5Bte,IAAS61D,EACT,MAAOv3C,EAGf,WAEJ8M,YAAa,SAAUrlB,EAAOulB,GAC1B,GAAID,GAAetlB,EAAM/F,OAAOvD,aAChC,IAAK6uB,GAAgBD,IAAiBC,EAAa7uB,gBAAiBvI,KAAKw7C,YAAYpkB,KAGrFvlB,EAAQ7R,KAAKw7C,YAAYrkB,GACpBtlB,IAGL7R,KAAK+/D,uBACD//D,KAAKU,QAAQ,eACTmR,MAAOA,EACPulB,aAAcA,MAqBtB,MAjBAp3B,MAAK27C,QAAQ/pC,QAAQ,SAAUC,GAC3BA,EAAMq2B,aAAa,SAAUxU,GACzBA,EAAQwD,YAAYC,EAAcC,OAG1Cp3B,KAAKgiE,YAAY,SAAUrW,EAAK7/C,GACxB6/C,EAAIsW,QAAQ/qC,YAAYC,EAAcC,KACtCp3B,KAAKyf,aAAa3T,GAClB6/C,EAAI7/C,KAAO6/C,EAAIsW,QAAQl3C,QACvB/qB,KAAKqf,eAAessC,EAAI7/C,KAAM6/C,KAE9BA,EAAIjoD,gBAAiBsxB,IAAO22B,EAAIjoD,gBAAiBymC,KACjDwhB,EAAIjoD,MAAMwzB,YAAYC,EAAcC,IAE1CrlB,KAAK/R,OACP6R,EAAMuN,MAAMgY,GACZp3B,KAAKU,QAAQ,UAAY+gE,gBAAgB,IAClC5vD,GAEXqwD,YAAa,SAAUrwD,GAAV,GAgBGswD,GAfR/pC,EAAOp4B,KACPmlD,EAAS/sB,EAAKujB,QACd7vC,EAAO+F,EAAM/F,OACbrB,EAAQ2tB,EAAKuwB,WAAW92C,EACN,KAAlBszC,EAAOtkD,SAGPb,KAAKU,QAAQ,eAAiBmR,MAAOA,MAGzC7R,KAAK+/D,sBACDt1D,OACAoH,EAAMyuD,SACNnb,EAAOpqB,OAAOtwB,EAAO,GACjB2tB,EAAK/f,cAAcvM,SAAWA,GAC1Bq2D,EAAWhd,EAAO16C,IAAU06C,EAAOtkD,OAAS4J,EAAQ,EAAIA,GAC5D2tB,EAAK/f,YAAY8pD,IAEjBniE,KAAKU,QAAQ,UACTiY,QAAQ,EACR8oD,gBAAgB,QAKhCW,aAAc,WACV,IAAK,GAAIjgE,GAAI,EAAGA,EAAInC,KAAK27C,QAAQ96C,OAAQsB,IACrCnC,KAAK27C,QAAQx5C,GAAGm+D,QAEpBtgE,MAAK27C,WACL37C,KAAK+/D,sBACL//D,KAAKqgE,WAET1sC,SAAU,SAAU8rB,GAAV,GAGOr1B,GACD9f,EACA+gC,EACAx5B,CALZ,IAAI4tC,EAAK0F,OAEL,IADAnlD,KAAKoiE,eACIh4C,EAAM,EAAGA,EAAMq1B,EAAK0F,OAAOtkD,OAAQupB,IACpC9f,EAAOm1C,EAAK0F,OAAO/6B,GACnBihB,EAAOu0B,EAAoBt1D,EAAMtK,KAAKH,SACtCgS,EAAQ7R,KAAKi0D,aACbz8C,KAAM6zB,EAAKnY,SACXzb,QAAS4zB,EAAKlY,YACd7gB,UAAW+4B,EAAK/4B,UAChBF,YAAai5B,EAAKj5B,YAClB8mC,aAAc7N,EAAK6N,aACnBC,YAAa9N,EAAK8N,YAClB7uC,KAAMA,IAENA,EAAKyb,YACLlU,EAAM4oC,cAAcnwC,EAAKyb,WAKjC/lB,MAAKqY,YADLonC,EAAKpnC,YACYrY,KAAKw7C,YAAYiE,EAAKpnC,aAEtBrY,KAAK27C,QAAQ,IAE9B8D,EAAK4iB,OACL5iB,EAAK4iB,MAAMzwD,QAAQ,SAAU+5C,GACzB3rD,KAAKuf,WAAWosC,EAAI7/C,KAAM6/C,EAAIjoD,MAAOioD,EAAI7Q,SAC1C96C,OAGXqoC,OAAQ,WACJroC,KAAKwgD,gBACLxgD,KAAKygD,kBACL,IAAI4hB,GAAQr5D,OAAOiY,KAAKjhB,KAAKqgE,QAAQ18D,IAAI,SAAUmI,GAAV,GACjC6/C,GAAM3rD,KAAKqgE,OAAOv0D,GAClBsD,EAAMu8C,EAAIjoD,KAQd,OAPI0L,aAAe4lB,IAAO5lB,YAAe+6B,GACrC/6B,EAAMA,EAAI2b,MAAM,EAAG,GAAG,GACf3b,YAAe27B,GACtB37B,GAAY,GAEZA,EAAMijB,KAAKC,UAAUljB,IAGrB1L,MAAO0L,EACP0rC,OAAQ6Q,EAAI7Q,OACZhvC,KAAM6/C,EAAI7/C,KACV+F,MAAO85C,EAAIsW,QAAQpwD,MACnBywD,UAAW3W,EAAIsW,QAAQn2D,OAE5B9L,KACH,QACIqY,YAAarY,KAAKqY,cAAcvM,OAChCq5C,OAAQnlD,KAAK27C,QAAQh4C,IAAI,SAAUkO,GAG/B,MAFAA,GAAM8G,OAAO3Y,KAAKkgE,UAClBruD,EAAM6uC,WAAW1gD,KAAKogE,oBACfvuD,EAAMw2B,UACdroC,MACHqiE,MAAOA,EACPjwD,YAAapS,KAAKH,QAAQuS,YAC1BE,UAAWtS,KAAKH,QAAQyS,YAGhCmM,SAAU,SAAUF,GAAV,GACFizC,GAAW,GAAIpwD,GAAEuyD,SACjBK,EAAUxC,EAASwC,UACnB3oB,GACA9sB,KAAMA,EACNy1C,QAASA,EAQb,OANIz1C,KAASve,KAAKU,QAAQ,cAAe2qC,IACrCrrC,KAAKoiE,eACL5iE,EAAM6Q,YAAYkhD,UAAUhzC,EAAMve,KAAMwxD,IAExCA,EAAS+Q,SAENvO,GAEX/0C,YAAa,SAAUpf,GAAV,GAELyK,GAEIiG,CAHR1Q,GAAUuB,EAAEzB,UAAWK,KAAKH,QAAQ2iE,MAAO3iE,GACvCyK,EAAOtK,KAAKqoC,SACXroC,KAAKU,QAAQ,eAAiB6P,SAAUjG,MACrCiG,EAAW,GAAI/Q,GAAMijE,MAAM3C,SAASx1D,GACxC9K,EAAMkjE,QACFC,QAASpyD,EAASqyD,YAClB7jD,SAAUzU,EAAKyU,UAAYlf,EAAQkf,SACnC8jD,SAAUhjE,EAAQgjE,SAClBC,WAAYjjE,EAAQijE,eAIhCj4B,KAAM,SAAUhrC,EAAS4R,GACC,kBAAX5R,IAA0B4R,IACjCA,EAAW5R,EACXA,KAEJ,IAAIiC,MAAYqjD,EAASnlD,KAAK27C,SAC7B,QAASt4B,GAAKlhB,GACX,GAAIA,EAAIgjD,EAAOtkD,OACXskD,EAAOhjD,GAAG0oC,KAAKrrC,EAAM6Q,YAAY4qB,SAAUp7B,EAAS,SAAUkjE,GAC1DjhE,EAAM3B,KAAK4iE,GACX1/C,EAAKlhB,EAAI,SAEV,CACH,GAAI4gE,GAAQjhE,EAAM,EAClB,KAAKK,EAAI,EAAGA,EAAIL,EAAMjB,SAAUsB,EAC5B4gE,EAAM1c,SAAW0c,EAAM1c,SAAS3vB,OAAO50B,EAAMK,GAAGkkD,SAEpD50C,GAASsxD,KAEf,IAENC,WAAY,SAAUtxD,EAAKG,GAAf,GAKJ3P,GACK4J,EACD6/C,EACAv8C,CAPM3B,UAAVoE,IACAA,EAAQH,EAAIG,OAEhBA,EAAQA,EAAMtJ,cACVrG,EAAMwP,EAAM,EAChB,KAAS5F,IAAQ9L,MAAKqgE,OAGlB,GAFI1U,EAAM3rD,KAAKqgE,OAAOv0D,GAClBsD,EAAMu8C,EAAIjoD,MACV0L,YAAe4lB,MACV5lB,EAAIyC,OAASzC,EAAIyC,OAASA,GAASzC,EAAIyC,MAAMtJ,gBAC1C6G,EAAM,IAAMlN,EACZ,MAAOypD,EAKvB,QAAS7/C,KAAM5J,IAEnBqd,WAAY,SAAUzT,EAAMpI,EAAOo3C,GAC/B,GAAItyC,GAAIhJ,EAAM6Q,YAAY4D,KAAKy3C,oBAAoB5/C,EAAMpI,EACzDoI,GAAOtD,EAAEsD,KAAKif,QACd/qB,KAAKqgE,OAAOv0D,EAAKvD,gBACb7E,MAAO8E,EAAE9E,MACTo3C,OAAQA,EACRhvC,KAAMA,EACNm2D,QAASz5D,EAAEsD,OAGnB2T,aAAc,SAAU3T,SACb9L,MAAKqgE,OAAOv0D,EAAKvD,gBAE5BwpC,UAAW,SAAUjmC,GAEjB,MADAA,GAAOA,EAAKvD,cACRuD,IAAQ9L,MAAKqgE,OACNrgE,KAAKqgE,OAAOv0D,GAAMpI,MAEtB,MAEX2b,eAAgB,SAAUvT,EAAM6/C,GAS5B,MARA7/C,GAAOA,EAAKvD,cACRY,UAAUtI,OAAS,IACP4M,SAARk+C,QACO3rD,MAAKqgE,OAAOv0D,GAEnB9L,KAAKqgE,OAAOv0D,GAAQ6/C,GAGrB3rD,KAAKqgE,OAAOv0D,IAEvBk2D,YAAa,SAAU50B,GACnBpkC,OAAOiY,KAAKjhB,KAAKqgE,QAAQzuD,QAAQ,SAAU9F,GACvCshC,EAAKptC,KAAKqgE,OAAOv0D,GAAOA,IACzB9L,OAEP67C,YAAa,SAAU3H,EAAevc,EAAQjI,EAAOhb,GACjDw/B,EAAgBA,EAAc3rC,cAC9BS,OAAOiY,KAAKjhB,KAAKqgE,QAAQzuD,QAAQ,SAAU9F,GAAV,GACzB6/C,GAAM3rD,KAAKqgE,OAAOv0D,GAClBtD,EAAImjD,EAAIjoD,KACR8E,aAAawsB,IAAOxsB,EAAEqJ,MAAMtJ,eAAiB2rC,EAC7CyX,EAAIjoD,MAAQ8E,EAAEitB,OAAO,KAAM,KAAM,KAAM,KAAMkC,EAAQjI,EAAOhb,GACrDlM,YAAa2hC,IACpB3hC,EAAEitB,OAAOye,EAAevc,EAAS,MAAQ,MAAOjI,EAAOhb,IAE5D1U,OAEPH,aAkCJL,EAAM6Q,YAAYyvD,SAAWA,EACzBtgE,EAAMyjE,WACNzjE,EAAMyjE,SAAStjE,OAAOmgE,EAAS9sD,WAC/B8sD,EAAS9sD,UAAUkM,UAAY,SAAUrf,GAAV,GACvBoyD,GAAW,GAAI7wD,GAAEuyD,SACjBK,EAAU/B,EAAS+B,UACnB3oB,GAAS2oB,QAASA,EACtB,KAAIh0D,KAAKU,QAAQ,YAAa2qC,GAiB9B,MAdArrC,MAAKkjE,SAASrjE,EAASoyD,GAAUvzC,KAAK,SAAUuR,GAC5C,MAAOzwB,GAAM2jE,QAAQC,UAAUnzC,KAChCyP,KAAK,SAAUijC,GACdnjE,EAAMkjE,QACFC,QAASA,EACT5jD,SAAUlf,EAAQkf,SAClB8jD,SAAUhjE,EAAQgjE,SAClBC,WAAYjjE,EAAQijE,WACpBO,YAAaxjE,EAAQwjE,cAEzBpR,EAAStmB,YACV23B,KAAK,SAAUj3B,GACd4lB,EAASsQ,OAAOl2B,KAEb2nB,GAEX8L,EAAS9sD,UAAUkwD,SAAW,SAAUrjE,GAAV,GACtBgG,GAAS,GAAIzE,GAAEuyD,SACfliD,EAAW,SAAUsxD,GACrBl9D,EAAO8lC,QAAQo3B,GAEnB,QAAQljE,EAAQ0jE,MAChB,IAAK,WACD1jE,EAAQ0Q,SAASs6B,KAAKhrC,EAAS4R,EAC/B,MACJ,KAAK,QACD5R,EAAQ0Q,SAAS8H,cAAcwyB,KAAKhrC,EAAS4R,EAC7C,MACJ,KAAK,YACD5R,EAAQ0Q,SAAS8H,cAAcI,YAAYoyB,KAAKhrC,EAAS4R,GAG7D,MAAO5L,GAAOmuD,cAGxBx0D,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,8BAA+B,cAAeD,IACvD,WAAA,GAIM+Q,GACA8kB,EACAC,EACAC,EACAH,EACAF,EACAmrC,EAsKAnuB,CA/KAxyC,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DC,EAAc7Q,MAAM6Q,YACpB8kB,EAAU9kB,EAAY8kB,QACtBC,EAAW/kB,EAAY+kB,SACvBC,EAAWhlB,EAAYglB,SACvBH,EAAU7kB,EAAY6kB,QACtBF,EAAM3kB,EAAY2kB,IAClBmrC,EAAiB3gE,MAAM4D,MAAMzD,QAC7BC,KAAM,SAAU2Q,GACZvQ,KAAKuQ,SAAWA,GAEpBohC,YAAa,SAAUjgC,EAAK2gC,EAAYmxB,EAAQC,EAAMC,EAAMn4B,GAA/C,GACL15B,GAAO6hB,EAAShwB,EAAOvB,EAuBnBwhE,EAAa19D,EAILsI,EAUJqpB,EACAC,EACAglB,EACAC,EACA/0C,EACK+M,EACIR,EACD7J,EAmBZM,EAOAqE,CArER,IAAIsC,YAAeyjB,GAEf,MADAtjB,GAAQ7R,KAAKuQ,SAASirC,YAAY9pC,EAAIG,OACjCA,GAAUH,EAAIulB,SAGnBvD,EAAU7hB,EAAM6hB,QAAQhiB,GACxBhO,EAAQmO,EAAMlB,MAAMe,EAAI4C,IAAK5C,EAAIoD,KAAKpR,QAClC6nC,GAAwB,MAAX7X,GAA4B,MAAThwB,IAExBgwB,QAASA,EACThwB,MAAOA,EACP4Q,IAAK5C,EAAI4C,IACTQ,IAAKpD,EAAIoD,IACTjD,MAAOH,EAAIG,MACXipC,SAAQzI,IAA4C,IAA/BxgC,EAAMO,YAAYV,EAAIoD,MAA2C,IAA7BjD,EAAMS,UAAUZ,EAAI4C,cAX3E5Q,MAAO,GAAIlE,OAAM6Q,YAAY4D,KAAK0M,QAAQoqB,UAAU,QAiBtE,IAAIr5B,YAAe0jB,GAAU,CAWzB,GAVAjzB,EAAInC,KAAKuQ,SAASo4C,WAAWj3C,EAAIG,OAC7B8xD,KAAa19D,EAAI9D,EACjBuP,EAAIomB,WACJ7xB,EAAIjG,KAAKuQ,SAASo4C,WAAWj3C,EAAIomB,UAC7B31B,EAAI8D,IACAsI,EAAMpM,EACVA,EAAI8D,EACJA,EAAIsI,IAGRpM,EAAI,GAAK8D,EAAI,IAAMyL,EAAIulB,QACvB,QAAUvzB,MAAO,GAAIlE,OAAM6Q,YAAY4D,KAAK0M,QAAQoqB,UAAU,QAElE,MAAO5oC,GAAK8D,GAOR,IANA4L,EAAQ7R,KAAKuQ,SAASwxD,aAAa5/D,KAC/By1B,EAAK/lB,EAAMwpB,MAAMtD,UAAUrmB,EAAI2C,SAC/BwjB,EAAKhmB,EAAMwpB,MAAMtD,UAAUrmB,EAAI6kB,aAC/BsmB,EAAiBhrC,EAAMwpB,MAAMogB,aAAa7jB,GAC1CklB,EAAejrC,EAAMwpB,MAAMogB,aAAa5jB,GACxC9vB,EAAS8J,EAAM62B,YAAYnX,SAAS,QAASsrB,EAAgBC,GACxDhoC,EAAM8iB,EAAG9iB,IAAKA,GAAO+iB,EAAG/iB,MAAOA,EACpC,IAASR,EAAMsjB,EAAGtjB,IAAKA,GAAOujB,EAAGvjB,MAAOA,EAChC7J,EAAQoH,EAAMwpB,MAAM5wB,MAAM6J,EAAKQ,GACnC4e,EAAU7hB,EAAM62B,YAAYzkC,IAAI,UAAWwG,GAC3C/G,EAAQqE,EAAO0pB,GAAGhnB,IACd8gC,GAAwB,MAAX7X,GAA4B,MAAThwB,IAChCigE,EAAOxjE,MACHuzB,QAASA,EACThwB,MAAOA,EACP4Q,IAAKA,EACLQ,IAAKA,EACLjD,MAAOA,EAAM/F,OACbgvC,SAAQzI,IAAwC,IAA3BxgC,EAAMO,YAAY0C,IAAuC,IAAzBjD,EAAMS,UAAUgC,KAMzF,OAAOqvD,GAEX,GAAIjyD,YAAe2jB,GAAU,CAEzB,IADItqB,KACC5I,EAAI,EAAGA,EAAIuP,EAAI+kB,KAAK51B,SAAUsB,EAC/B4I,EAAIA,EAAE2rB,OAAO12B,KAAK2xC,YAAYjgC,EAAI+kB,KAAKt0B,GAAIkwC,EAAYmxB,EAAQC,EAAMC,GAEzE,OAAO34D,GAEX,MAAI2G,aAAewjB,IACX9lB,EAAMpP,KAAK+xC,UAAUrgC,EAAK8xD,EAAQC,EAAMC,GACxCt0D,YAAe4lB,GACRh1B,KAAK2xC,YAAYviC,EAAKijC,EAAYmxB,EAAQC,EAAMC,KAEjDhgE,MAAc,MAAP0L,EAAc,GAAI5P,OAAM6Q,YAAY4D,KAAK0M,QAAQoqB,UAAU,QAAU37B,SAI9F2iC,UAAW,SAAUrgC,EAAK8xD,EAAQC,EAAMC,GACpC,GAAIt0D,EAaJ,OAZIsC,GAAI4jB,WACJlmB,EAAMpP,KAAKuQ,SAASwhC,UAAUrgC,EAAIqZ,UAElCrZ,EAAMA,EAAIkZ,QAAQE,SAAS04C,GAAQ,GACnCp0D,EAAMpP,KAAKuQ,SAASwhC,UAAUrgC,EAAIqZ,SACvB,MAAP3b,IACAA,EAAMpP,KAAKuQ,SAASwhC,UAAUrgC,EAAI5F,QAGtCsD,YAAe4lB,KACf5lB,EAAMA,EAAIomB,SAASiuC,EAAMC,IAEtBt0D,GAEX2Y,QAAS,SAAUrW,EAAK8xD,EAAQC,EAAMC,EAAMn4B,GAAnC,GAKDjhC,GAJAksB,EAAS9kB,YAAeyjB,EAW5B,OAVIzjB,aAAewjB,KACfsB,EAASx2B,KAAKuQ,SAASwhC,UAAUrgC,EAAI5F,eAAiBqpB,IAEtD7qB,EAAOtK,KAAK2xC,YAAYjgC,GAAK,EAAO8xD,EAAQC,EAAMC,EAAMn4B,GAAW5nC,IAAI,SAAUoR,GACjF,GAAI3F,GAAM2F,EAAKrR,KAIf,OAHI0L,aAAe5P,OAAM6Q,YAAY4D,KAAK0M,QAAQwpB,UAC9C/6B,EAAMA,EAAI1L,OAEP0L,IAEJonB,EAASlsB,EAAK,GAAKA,GAE9BgnC,UAAW,SAAUhyC,GAAV,GAUHskE,GAEIC,EAAOC,EACPvhE,EACAC,EAbJqP,EAAQ7R,KAAKuQ,SAASirC,YAAYl8C,EAAEuS,OACpCyC,EAAMhV,EAAEgV,IAAKQ,EAAMxV,EAAEwV,IAAKpR,EAAQpE,EAAEoE,MACpCqgE,EAAiBlyD,EAAM6hB,SACvBpf,IAAKA,EACLQ,IAAKA,GAET,OAAIivD,KAAmBzkE,IAGnBskE,EAAatkE,EAAE6oC,kBACfy7B,GAEIrhE,EAAQmB,EAAMnB,MACdC,EAASkB,EAAMlB,OACnBqP,EAAMD,QAAQgyD,EAAY,SAAUtvD,EAAKQ,GAAf,GAKlBkvD,GACAC,EACA70D,CANU3B,UAAVo2D,IACAA,EAAQvvD,EACRwvD,EAAQhvD,GAERkvD,EAAO1vD,EAAMuvD,EACbI,EAAOnvD,EAAMgvD,EAGb10D,EADA40D,EAAOxhE,GAAUyhE,EAAO1hE,EAClBmB,EAAMO,IAAI+/D,EAAMC,GAEhB,GAAIzkE,OAAM6Q,YAAY4D,KAAK0M,QAAQoqB,UAAU,OAEvDl5B,EAAMK,OAAOoC,EAAKQ,EAAK1F,OAGvB1L,YAAiBsxB,KACjBtxB,EAAQ1D,KAAK+nB,QAAQrkB,EAAOpE,EAAEuS,MAAOyC,EAAKQ,GACtCqjB,MAAMsT,QAAQ/nC,KACdA,EAAQA,EAAM,IAEJ+J,SAAV/J,IACAA,EAAQ,OAGZA,YAAiBlE,OAAM6Q,YAAY4D,KAAK0M,QAAQ6jB,SAChD9gC,EAAQA,EAAMO,IAAI,EAAG,IAEzB4N,EAAMK,OAAOoC,EAAKQ,EAAKpR,IAE3BqjB,aAAalV,EAAMqyD,wBACnBryD,EAAMqyD,uBAAyB58C,WAAW,WACtCzV,EAAM+C,MAAM,cACP6H,QAAQ,KACd,KACI,MAGXu1B,EAA2BmuB,EAAexgE,QAC1C2xC,UAAW,WACP,OAAO,KAGfjhC,EAAY8vD,eAAiBA,EAC7B9vD,EAAY2hC,yBAA2BA,IACvB,kBAAVzyC,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,0BAA2B,cAAeD,IACnD,YACG,SAAUE,GACP,YAuEA,SAAS2kE,GAAiBC,GACtB,MAAOA,GAAUzgE,IAAI,SAAU46B,GAC3B,MAAO,iBAAmBA,EAAS,OACpCv8B,KAAK,KA3Ef,GAKOZ,GACAijE,EACAC,EAgBAC,EAcAC,EASAC,EAQAC,EASAC,EACAC,EACAC,EAYAC,EASAC,EAIAC,EACAC,EACAC,EACKrjE,EAYLsjE,CAvGJ,MAAI3lE,EAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,GAAlE,CAGIhP,EAAI5B,EAAMgG,OACV6+D,EAAiB,aACjBC,GACAc,GAAM,KACNC,KAAQ,OACRzoD,KAAQ,OACRE,MAAS,QACTsI,KAAQ,YACRkgD,YAAa,YACb7kD,IAAO,WACP8kD,aAAc,WACdC,UAAW,YACXC,YAAa,WACbC,YAAa,QACbC,WAAY,OACZC,OAAU,YACVC,SAAY,aAEZtB,GACAuB,IAAO,OACPC,YAAa,WACblT,MAAS,QACTmT,cAAe,QACfC,SAAU,gBACVC,UAAa,gBACbC,kBAAmB,OACnBC,gBAAiB,OACjBC,YAAa,OACbC,iBAAkB,OAClBC,qBAAsB,OACtBC,QAAS,QAEThC,GACAiC,MAAS,UACTC,cAAe,cACfC,YAAe,gBACfC,cAAe,cACfC,YAAa,YACbC,aAAc,aACdC,UAAa,eAEbtC,GACAmB,OAAU,WACVC,SAAY,aACZmB,QAAW,YACXC,QAAS,QACTC,UAAW,UACXC,SAAU,UAEVzC,GACA0C,IAAO,cACPvU,MAAS,eACTwU,YAAa,gBACbrB,cAAe,eACfF,IAAO,eACPC,YAAa,eACbuB,mBAAoB,wBAEpB3C,EAAoBvjE,EAAEzB,QAAS2P,MAAO,oBAAsBo1D,GAC5DE,EAAsBxjE,EAAEzB,QAAS2P,MAAO,qBAAuBo1D,GAC/DG,GACA9vD,KAAM,QACNwyD,UAAW,MACXC,aAAc,SACdC,UAAW,QACXC,SAAU,YAOV5C,EAAyCX,GACzC,MACA,OACA,QACA,cACA,eACA,eACA,iBAEAY,EAA0BZ,GAC1B,aACA,kBAEAa,KACAC,KACAC,IACJ,KAASrjE,IAAOyiE,GACZU,EAAY7kE,KAAK0B,GACjBojE,EAAkB9kE,KAAK,SAAW0B,EAEtC,KAAKA,IAAO0iE,GACRW,EAAkB/kE,KAAK0B,EAE3B4iE,GAAiBO,GAAe,WAChCP,EAAiBQ,GAAqB,gBACtCR,EAAiBS,GAAqB,gBACtCN,EAAoBI,GAAe,iBACnCJ,EAAoBK,GAAqB,sBACrCE,EAAa3lE,EAAM4D,MAAMzD,QACzBC,KAAM,SAAU4nB,EAAMjX,GAClBvQ,KAAKwnB,KAAOA,EACZxnB,KAAKuQ,SAASA,GACdvQ,KAAK2nD,UAAYvmD,EAAEomB,EAAKmgC,WACxB3nD,KAAK2nE,iBAAmBvmE,EAAEomB,EAAK3P,WAC/B7X,KAAK4nE,gBAAkBpgD,EAAKogD,gBAC5B5nE,KAAK6nE,qBAAuBrgD,EAAKqgD,qBACjC7nE,KAAK8nE,qBAAuBtgD,EAAKsgD,qBACjC9nE,KAAK+nE,SAAWvgD,EAAKugD,SACrB/nE,KAAKgoE,SAAWxgD,EAAKwgD,SACrBhoE,KAAKioE,UAAYzgD,EAAKygD,UACtBzgD,EAAK0gD,WAAWn2D,KAAK,QAAS/R,KAAKmoE,kBAAkBp2D,KAAK/R,OAC1DwnB,EAAK0gD,WAAWn2D,KAAK,SAAU/R,KAAKooE,mBAAmBr2D,KAAK/R,OAC5DwnB,EAAK0gD,WAAWn2D,KAAK,SAAU/R,KAAKqoE,mBAAmBt2D,KAAK/R,OAC5DwnB,EAAK0gD,WAAWn2D,KAAK,SAAU/R,KAAKsoE,mBAAmBv2D,KAAK/R,OAC5DA,KAAKuoE,OAAS/gD,EAAK+gD,OACnBvoE,KAAKuoE,OAAOx2D,KAAK,SAAU/R,KAAKwoE,eAAez2D,KAAK/R,OACpDA,KAAKuoE,OAAOx2D,KAAK,WAAY/R,KAAKyoE,iBAAiB12D,KAAK/R,OACxDA,KAAKuoE,OAAOx2D,KAAK,aAAc/R,KAAK0oE,mBAAmB32D,KAAK/R,OAC5DA,KAAKuoE,OAAOx2D,KAAK,SAAU/R,KAAK2oE,eAAe52D,KAAK/R,OACpDoB,EAAEomB,EAAKugD,UAAUhmD,GAAG,SAAU/hB,KAAK4oE,SAAS72D,KAAK/R,OACjDA,KAAK6oE,SAAW,GAAIrpE,GAAM6Q,YAAYuc,cAAc5sB,KAAK2nD,UAAW3nD,KAAMwkE,GAC1ExkE,KAAK8oE,sBACD9oE,KAAKioE,YACLjoE,KAAKioE,UAAUl2D,KAAK,SAAU/R,KAAK+oE,iBAAiBh3D,KAAK/R,OACzDA,KAAKioE,UAAUl2D,KAAK,UAAW/R,KAAKgpE,kBAAkBj3D,KAAK/R,OAC3DA,KAAKioE,UAAUl2D,KAAK,SAAU/R,KAAKipE,iBAAiBl3D,KAAK/R,OACzDA,KAAKioE,UAAUl2D,KAAK,SAAU/R,KAAKkpE,iBAAiBn3D,KAAK/R,QAE7DA,KAAK4nE,gBAAgB71D,KAAK,SAAU/R,KAAKmpE,oBAAoBp3D,KAAK/R,OAClEA,KAAK6nE,qBAAqB91D,KAAK,SAAU/R,KAAKmpE,oBAAoBp3D,KAAK/R,OACvEA,KAAK8nE,qBAAqB/1D,KAAK,SAAU/R,KAAKmpE,oBAAoBp3D,KAAK/R,OACvEA,KAAK4nE,gBAAgBrsD,QAAQm2B,IAAI1xC,KAAK6nE,qBAAqBtsD,SAASm2B,IAAI1xC,KAAK8nE,qBAAqBvsD,SAASwG,GAAG,eAAe,GACzH/hB,KAAKgoE,WACLhoE,KAAKgoE,SAASj2D,KAAK,SAAU/R,KAAKopE,iBAAiBr3D,KAAK/R,OACxDA,KAAKgoE,SAASj2D,KAAK,SAAU/R,KAAKqpE,gBAAgBt3D,KAAK/R,SAG/D8oE,oBAAqB,SAAU51D,GACZzF,SAAXyF,GAAwBA,GACxBlT,KAAKspE,YAAc,GAAI9pE,GAAM6Q,YAAYuc,cAAc5sB,KAAK2nE,iBAAkB3nE,KAAMykE,GACpFzkE,KAAKupE,eAAiB,GAAI/pE,GAAM6Q,YAAYuc,cAAc5sB,KAAKuoE,OAAOiB,aAAcxpE,KAAM2kE,GAC1F3kE,KAAKypE,iBAAmB,GAAIjqE,GAAM6Q,YAAYuc,cAAc5sB,KAAKuoE,OAAOmB,cAAe1pE,KAAM4kE,KAE7F5kE,KAAKspE,YAAYrpD,UACjBjgB,KAAKupE,eAAetpD,UACpBjgB,KAAKypE,iBAAiBxpD,YAG9B0pD,SAAU,SAAU9pE,GAChB,GAAIgG,GAAS7F,KAAKsQ,UAAU6wD,QAAQthE,EAkBpC,OAjBwB,gBAApBA,EAAQO,SAA8ByF,GACtC7F,KAAKsQ,UAAU5P,QAAQ,UAAYkpE,aAAa,IAEhD/jE,IACA7F,KAAK6pE,oBAAqB,EACJ,UAAlBhkE,EAAOyL,QACPtR,KAAKuoE,OAAOuB,YAAW,GACvB9pE,KAAKwnB,KAAKuiD,UAAUlkE,EAAQ,WACxB7F,KAAKgqE,gBAAe,GACpBhqE,KAAKuoE,OAAO7kE,MAAM1D,KAAKiqE,kBACvBjqE,KAAKuoE,OAAOr2D,OAASlS,KAAKsQ,UAAU4wD,aAAalhE,KAAKsQ,UAAU+H,cAAcknC,mBAC9Ev/C,KAAKuoE,OAAOh5D,UACdwC,KAAK/R,QAEPA,KAAKwnB,KAAK3I,WAAWhZ,EAAOyL,SAG7BzL,GAEXqkE,eAAgB,WACZ,MAAOlqE,GAAAA,KAAKsQ,UAAU+H,cAAczB,aAAa+T,YAErDw+C,oBAAqB,SAAUjjD,GAAV,GAEb9lB,GADAm+B,EAASn9B,EAAE8kB,EAAE0iC,MAAMt+C,KAAK,SAE5B,QAAQi0B,GACR,IAAK,MACDn+B,GACIA,QAAS,oBACTP,SAAW0Q,SAAUvQ,KAAKsQ,WAE9B,MACJ,KAAK,OACDlQ,GACIA,QAAS,qBACTP,SAAW0Q,SAAUvQ,KAAKsQ,WAE9B,MACJ,KAAK,QACDlQ,GACIA,QAAS,sBACTP,SAAW0Q,SAAUvQ,KAAKsQ,WAE9B,MACJ,KAAK,UACDlQ,GACIA,QAAS,mBACTP,SAAW6D,MAAO,WAEtB,MACJ,KAAK,QACD1D,KAAKwnB,KAAK3I,WAAW,QACrB,MACJ,KAAK,WACDze,GACIA,QAAS,kBACTP,SAAW6b,KAAM,OAErB,MACJ,KAAK,cACDtb,GACIA,QAAS,kBACTP,SAAW6b,KAAM,UAErB,MACJ,KAAK,aACDtb,GACIA,QAAS,oBACTP,SAAW6b,KAAM,OAErB,MACJ,KAAK,gBACDtb,GACIA,QAAS,oBACTP,SAAW6b,KAAM,UAErB,MACJ,KAAK,aACDtb,GAAYA,QAAS,mBACrB,MACJ,KAAK,gBACDA,GAAYA,QAAS,uBAGrBA,GACAJ,KAAK2pE,SAASvpE,IAGtB8oE,iBAAkB,SAAUhjD,GACxB,GAAIrU,GAAQ7R,KAAKsQ,UAAUkrC,YAAYt1B,EAAEpa,KACpC+F,IAGL7R,KAAKsQ,UAAU4xD,YAAYrwD,IAE/BoO,QAAS,WACLjgB,KAAK6oE,SAAS5oD,UACdjgB,KAAK8oE,qBAAoB,GACzB9oE,KAAKspE,YAAYrpD,UACjBjgB,KAAKypE,iBAAiBxpD,WAE1B8oD,iBAAkB,SAAU7iD,GAAV,GACVrU,GACAtB,EAAWvQ,KAAKsQ,SACpB,IAAI4V,EAAEwiC,YAAa,CACf,GAAI1oD,KAAKsQ,UAAU5P,QAAQ,eACvB,MAEJmR,GAAQtB,EAAS0jD,kBAEjBpiD,GAAQtB,EAASirC,YAAYt1B,EAAEpa,KAEnC,IAAIyE,EAAS8H,cAAcvM,SAAW+F,EAAM/F,OAAQ,CAChD,GAAI9L,KAAKsQ,UAAU5P,QAAQ,eAAiBmR,MAAOA,IAC/C,MAEC7R,MAAKuoE,OAAOr+C,cAAa,IAC1BlqB,KAAKuoE,OAAOuB,aAEhBv5D,EAAS8H,YAAYxG,KAG7Bm3D,kBAAmB,SAAU9iD,GACzB,GAAIrU,GAAQ7R,KAAKsQ,UAAUyxD,aAAa77C,EAAE8hC,SAC1ChoD,MAAKsQ,UAAUgxD,iBAAiBzvD,EAAOqU,EAAE+hC,UACzCjoD,KAAKsQ,UAAU+H,YAAYxG,IAE/Bo3D,iBAAkB,SAAU/iD,GACxB,GAAIrU,GAAQ7R,KAAKsQ,UAAUyxD,aAAa77C,EAAEyiC,WAC1C,OAAI3oD,MAAKsQ,UAAUkrC,YAAYt1B,EAAEpa,UAC7B9L,MAAKwnB,KAAKuiD,WACNz4D,OAAQ,QACRC,KAAM,wBAIdvR,KAAKsQ,UAAU4mB,YAAYrlB,EAAOqU,EAAEpa,UACpC9L,MAAK2nE,iBAAiBr4D,UAE1BuC,MAAO,SAAUA,GACb7R,KAAKmtB,UAAYtb,EAAMsb,YACvBntB,KAAK6b,YAAchK,EAAMgK,eAE7BtL,SAAU,SAAUA,GAChBvQ,KAAKsQ,UAAYC,EACjBvQ,KAAK6X,UAAYtH,EAASsH,YAC1BtH,EAASwB,KAAK,iBAAkB/R,KAAKopE,iBAAiBr3D,KAAK/R,QAE/DqhE,QAAS,WAAA,GAUD3vD,GACAi6C,EAVA4c,EAASvoE,KAAKuoE,OACdh4D,EAAWvQ,KAAKsQ,UAChBuB,EAAQtB,EAAS8H,aACrBrY,MAAKq9B,gBAAkBr9B,KAAKwnB,KAAKugD,SAASoC,aAC1CnqE,KAAKmtB,UAAU3qB,OAAOxC,KAAKq9B,iBACtBkrC,EAAOv/C,YAAehpB,KAAKoqE,mBAC5B7B,EAAOr1D,OAAOrB,EAAM4G,YAAYvF,YAAa,GAC7ClT,KAAKqqE,oBAEL34D,EAAMG,EAAM4G,YAAY9G,KAAKgZ,WAC7BghC,EAAM3rD,KAAKsQ,UAAU0yD,WAAWtxD,EAAKG,EAAM/F,QAC/C9L,KAAKwnB,KAAK0gD,WAAWxkE,MAAMioD,EAAI7/C,OAEnC88D,SAAU,WACN5oE,KAAKwnB,KAAKq8B,QAASymB,QAAQ,KAE/BC,QAAS,SAAUxyD,GAAV,GACDyyD,GAASzyD,EAAMiQ,cAAcwiD,OAC7BC,EAAS1yD,EAAMiQ,cAAcyiD,MACK,KAAlC1yD,EAAMiQ,cAAc0iD,YACpBF,GAAU,GACVC,GAAU,IAEdzqE,KAAK2qE,WAAWH,EAAQC,GACxB1yD,EAAMO,kBAEVsyD,SAAU,SAAU7yD,EAAOwmB,GACvBv+B,KAAKmtB,UAAUiS,eAAeklC,EAAQ/lC,IACtCxmB,EAAMO,kBAEVuyD,SAAU,WACN7qE,KAAK8qE,YAAY9qE,KAAKq9B,kBAE1B0tC,WAAY,WACR/qE,KAAK8qE,WAAW9qE,KAAKq9B,kBAEzB2tC,cAAe,SAAUjzD,EAAOwmB,GAAjB,GAEH0sC,GACAppE,EAmBAqpE,EACAC,CAtBR,IAAIpzD,EAAMgX,IAAK,CAGX,OAFIk8C,GAAgB,EAChBppE,EAAMN,OAAOiN,aAAauJ,EAAMmP,UAEpC,IAAK,IACDlnB,KAAKmtB,UAAUyQ,WACf,MACJ,KAAK,IACD59B,KAAKsQ,UAAU0vD,cAAcr/D,MAC7B,MACJ,KAAK,IACDX,KAAKsQ,UAAU0vD,cAAcx/D,MAC7B,MACJ,SACIyqE,GAAgB,EAGhBA,GACAlzD,EAAMO,qBAKV,IAFI4yD,EAAWlrE,KAAKsQ,UAAU+H,cAAcI,YAAYvF,YAAa,EACjEi4D,EAAoB,UAAX5sC,EACC,UAAVA,GAAgC,aAAVA,EACjB2sC,GACDlrE,KAAK2pE,UAAWvpE,QAAS,wBAE7B2X,EAAMO,qBACH,IAAI+rD,EAAe76D,KAAK+0B,KAAY4sC,EAAQ,CAC/C,GAAID,EAEA,WADAnzD,GAAMO,gBAGN6yD,IACAnrE,KAAKuoE,OAAO7kE,MAAM,IAEtB1D,KAAKgqE,eAAemB,OAEpBnrE,MAAKmtB,UAAUmS,oBAAoBilC,EAAchmC,IACjDxmB,EAAMO,kBAIlB8yD,cAAe,SAAUrzD,EAAOwmB,GAC5Bv+B,KAAKmtB,UAAUmR,gBAAgBgmC,EAAQ/lC,EAAO/8B,QAAQ,SAAU,KAAMxB,KAAKqrE,iBAC3EtzD,EAAMO,kBAEVgzD,YAAa,SAAUvzD,GAAV,GAKLnW,GAJAiQ,EAAQ7R,KAAKsQ,UAAU+H,aACvBxG,GAAM8rC,sBAAwB9rC,EAAM2sC,wBAGpC58C,EAAS5B,KAAKurE,SAASxzD,GACP,uBAAhBnW,EAAO2P,MAAiD,oBAAhB3P,EAAO2P,KAC/CM,EAAMwsC,qBAAqBz8C,EAAO8P,KAElCG,EAAMusC,uBAGdotB,YAAa,SAAUzzD,GAAV,GAuBLlG,GAtBAjQ,EAAS5B,KAAKurE,SAASxzD,EAI3B,IAHInW,EAAO6pE,OACPzrE,KAAK0rE,YAAc9pE,EAAO6pE,MAEV,WAAhB7pE,EAAO2P,KAIP,MAHAvR,MAAK2rE,cACL3rE,KAAK4rE,uBACL7zD,GAAMO,gBAGV,IAAItY,KAAKuoE,OAAOr+C,cAAa,IAAUtoB,EAAO8P,IAI1C,MAHA1R,MAAKsQ,UAAU+H,cAAcinC,sBAAsBt/C,KAAKuoE,OAAO98C,mBAC/DzrB,KAAKmtB,UAAU+Q,eAAet8B,EAAO8P,IAAK1R,KAAK6rE,eAAgB7rE,KAAKqrE,gBAAiBtzD,EAAMoX,cAC3FpX,GAAMO,gBAKN,IAFAtY,KAAK6pE,oBAAqB,EAC1B7pE,KAAKuoE,OAAOuB,cACR9pE,KAAK6pE,mBAAT,CAKJ,GADIh4D,EAAQ7R,KAAKsQ,UAAU+H,cACP,uBAAhBzW,EAAO2P,MAAiD,oBAAhB3P,EAAO2P,KAM/C,MALAM,GAAMkrC,eACFv0C,EAAG5G,EAAO4G,EACVimB,EAAG7sB,EAAO6sB,QAEd1W,GAAMO,gBAGV,IAAoB,eAAhB1W,EAAO2P,KAGP,MAFAvR,MAAK8rE,eAAe/zD,OACpBA,GAAMO,gBAGVtY,MAAK6rE,eAAiBhH,EAAgBjjE,EAAO2P,MAC7CvR,KAAKqrE,gBAAkBtzD,EAAMgX,IAC7B/uB,KAAKmtB,UAAU+Q,eAAet8B,EAAO8P,IAAK1R,KAAK6rE,eAAgB7rE,KAAKqrE,gBAAiBtzD,EAAMoX,YAE/F48C,cAAe,SAAUh0D,GAAV,GASPi0D,GACApqE,EAKAqqE,EACAC,EACAC,EAhBAt6D,EAAQ7R,KAAKsQ,UAAU+H,aACvBxG,GAAM8rC,uBAGV5lC,EAAMO,iBACNtY,KAAK4nE,gBAAgBvnD,QACrBrgB,KAAK8nE,qBAAqBznD,QAC1BrgB,KAAK6nE,qBAAqBxnD,QAEtBze,EAAS5B,KAAKurE,SAASxzD,GACP,uBAAhBnW,EAAO2P,MAAiD,oBAAhB3P,EAAO2P,OAGnDvR,KAAKmtB,UAAUkR,qBAAqBz8B,EAAO8P,IAAKmzD,EAAgBjjE,EAAO2P,OACnE06D,EAAcjsE,KAAKmtB,UAAU/U,OAAO7I,kBAAoB/P,GAAM6Q,YAAYglB,SAC1E62C,GAAa,EACbC,GAAc,EACC,gBAAfvqE,EAAO2P,MACPy6D,EAAOhsE,KAAK8nE,qBACZoE,GAAcD,GAAejsE,KAAK6b,YAAYgmB,kCACxB,aAAfjgC,EAAO2P,MACdy6D,EAAOhsE,KAAK6nE,qBACZqE,GAAcD,GAAejsE,KAAK6b,YAAYimB,gCAE9CkqC,EAAOhsE,KAAK4nE,gBACZuE,EAAcnsE,KAAKmtB,UAAUsQ,gCAEjCuuC,EAAKzwD,QAAQ0qB,KAAK6+B,GAAwCl7C,QAAQqiD,GAClED,EAAKzwD,QAAQ0qB,KAAK8+B,GAAyBn7C,OAAOsiD,GAClDF,EAAKzwD,QAAQ0qB,KAAK,yBAAyBrc,OAAOuiD,GAClD7kD,WAAW,WACP0kD,EAAK1rD,KAAKvI,EAAMyW,MAAOzW,EAAM2W,YAGrC09C,QAAS,SAAUr0D,GACfA,EAAMO,kBAEV+zD,gBAAiB,SAAU96D,EAAMG,GAAhB,GACTG,GAAQ7R,KAAKsQ,UAAU+H,cACvBi0D,EAAez6D,EAAMmsC,sBACzB,QAAQsuB,GAAyB,YAAT/6D,GAA+B,cAATA,GAAwBG,EAAIoD,IAAMw3D,EAAax3D,KAAOpD,EAAI4C,IAAMg4D,EAAah4D,KAE/Hi4D,YAAa,SAAUx0D,GAAV,GAILmmC,GAIAt8C,EACAiQ,EAiBI26D,CAzBR,IAA4B,UAAxBxsE,KAAK6rE,eAAT,CASA,GANI3tB,GACAuuB,QAAS10D,EAAM00D,QACfC,QAAS30D,EAAM20D,SAEf9qE,EAAS5B,KAAKurE,SAASrtB,GACvBrsC,EAAQ7R,KAAKsQ,UAAU+H,cACvBxG,EAAM8rC,qBAON,YANK39C,KAAKqsE,gBAAgBzqE,EAAO2P,KAAM3P,EAAO8P,MAC1CG,EAAMksC,oBACFv1C,EAAG5G,EAAO4G,EACVimB,EAAG7sB,EAAO6sB,IAKtB,IAAoB,YAAhB7sB,EAAO2P,KAEP,WADAvR,MAAK2sE,gBAAgB/qE,EAGrB5B,MAAK0rE,cAAgB9pE,EAAO6pE,KAC5BzrE,KAAK4sE,iBAAiB1uB,IAElBsuB,EAAQxsE,KAAK0rE,YAAYrwC,MACzBz5B,EAAO4G,EAAIgkE,EAAM1vD,OACjB9c,KAAKgnD,aAELplD,EAAO6sB,EAAI+9C,EAAMrvD,QACjBnd,KAAK6sE,YAELjrE,EAAO6sB,EAAI+9C,EAAMtvD,KAAOtb,EAAO4G,EAAIgkE,EAAM5vD,KACzC5c,KAAK2sE,gBAAgB/qE,EAAQs8C,GAE7Bl+C,KAAK4sE,iBAAiB1uB,IAG9BnmC,EAAMO,mBAEVw0D,UAAW,SAAU/0D,GAAV,GAKHwwD,GAIA5jD,EAOA/iB,EAfAiQ,EAAQ7R,KAAKsQ,UAAU+H,aAK3B,IAJAxG,EAAM+rC,mBACN59C,KAAKmtB,UAAUiR,oBACfp+B,KAAK+sE,iBACDxE,EAASvoE,KAAKuoE,OAAOyE,eACzB,CAIA,IADIroD,EAAK5M,EAAM9F,OACR0S,GAAI,CACP,GAAIA,IAAO4jD,EAAOhtD,QAAQ,GACtB,MAEJoJ,GAAKA,EAAGtf,WAERzD,EAAS5B,KAAKurE,SAASxzD,GACvBnW,GAAUA,EAAO8P,KAAO62D,EAAOr+C,cAAa,KAC5Cq+C,EAAO79C,WAAW7Y,GAClBA,EAAMytC,sBAAsBipB,EAAO98C,sBAG3CwhD,WAAY,SAAUl1D,GAAV,GAMJ6L,GALAhiB,EAAS5B,KAAKurE,SAASxzD,GACvBmzD,EAAWlrE,KAAKsQ,UAAU+H,cAAcI,YAAYvF,YAAa,CACjD,UAAhBtR,EAAO2P,MAAmB25D,IAG1BtnD,EAAM5jB,KAAKsQ,UAAU+H,cAAcI,YACvCzY,KAAKgqE,gBAAgBpmD,EAAIlgB,UAAYkgB,EAAI8P,WACzC1zB,KAAK2oE,mBAETuE,MAAO,SAAUhnD,GACb,GAAIA,EAAG,CACH,GAAI6d,GAAQ/jC,KAAK2nE,iBAAiB1hC,KAAK,yBAA2BjmC,KAAK6X,UAAUmtB,MAAMmoC,QACvFntE,MAAK2nE,iBAAiByF,OAAOrpC,EAAMnZ,OAAM,IACzCtD,WAAW,WACPtnB,KAAK2nE,iBAAiB/sC,QAAQwyC,OAAOrpC,IACvChyB,KAAK/R,OAEXA,KAAK2pE,UACDvpE,QAAS,aACTP,SACI0Q,SAAUvQ,KAAKwnB,KAAKlX,UACpByH,MAAOmO,EAAE8B,eAAiB9B,MAItCmnD,eAAgB,WACZ,MAAOrtE,MAAK2nE,iBAAiB14D,QAEjCq+D,QAAS,SAAUpnD,GAAV,GAOOqnD,GACAC,EAeAzpC,EAtBR90B,EAAO,GACPk2B,EAAQ,EAEZ,IADAnlC,KAAK6X,UAAUe,YAAoBnL,SAANyY,EACzBA,EAAG,CACH,IAAIA,EAAE8B,cAAcF,gBAAiB5B,EAAE8B,cAAcF,cAAcC,QAwC/D,MAtBIgc,GAAQ/jC,KAAK2nE,iBAAiB1hC,KAAK,yBAA2BjmC,KAAK6X,UAAUmtB,MAAMmoC,SACvFntE,KAAK2nE,iBAAiB/sC,YACtBtT,YAAW,WAAA,GACHrY,GAAOjP,KAAK2nE,iBAAiB14D,OAC7Bk2B,EAAQhiC,OAAO2kB,cAAcC,QAAQ,QAAQ62B,QAC5C3vC,GAASk2B,KAGdnlC,KAAK6X,UAAU2tB,UACXv2B,KAAMA,EACNk2B,MAAOA,IAEXnlC,KAAK2nE,iBAAiB/sC,QAAQwyC,OAAOrpC,GACrC/jC,KAAK2pE,UACDvpE,QAAS,eACTP,SACI0Q,SAAUvQ,KAAKwnB,KAAKlX,UACpByH,MAAOmO,EAAE8B,eAAiB9B,KAGlClmB,KAAK6X,UAAUe,aAAc,IAC/B7G,KAAK/R,MAtCPkmB,GAAE5N,iBACEi1D,GAAU,EACVC,GAAe,EACfrqE,OAAOsqE,eAAiBvnD,EAAE8B,cAAcF,cAAc4lD,gBAAiBvqE,QAAOsqE,eAC9EF,EAAUrnD,EAAE8B,cAAcF,cAAc4lD,MAAMx1C,SAAS,aACvDs1C,EAAetnD,EAAE8B,cAAcF,cAAc4lD,MAAMx1C,SAAS,gBAE5Dq1C,EAAU,aAAa/jE,KAAK0c,EAAE8B,cAAcF,cAAc4lD,OAC1DF,EAAe,cAAchkE,KAAK0c,EAAE8B,cAAcF,cAAc4lD,QAEhEH,IACAt+D,EAAOiX,EAAE8B,cAAcF,cAAcC,QAAQ,cAE7CylD,IACAroC,EAAQjf,EAAE8B,cAAcF,cAAcC,QAAQ,cAAc62B,YA2BjE,CACH,GAAIp/C,EAAMyQ,QAAQC,QAAQC,KAGtB,MAFAnQ,MAAK2nE,iBAAiBr4D,QAAQC,aAC9BpL,UAASqL,YAAY,QAGrBxP,MAAK6X,UAAUe,aAAc,GAGhC3J,GAASk2B,KAGdnlC,KAAK6X,UAAU2tB,UACXv2B,KAAMA,EACNk2B,MAAOA,IAEXnlC,KAAK2pE,UACDvpE,QAAS,eACTP,SACI0Q,SAAUvQ,KAAKwnB,KAAKlX,UACpByH,MAAOmO,EAAE8B,eAAiB9B,OAItCynD,OAAQ,SAAUznD,GACdlmB,KAAK6X,UAAUe,YAAoBnL,SAANyY,EAC7BlmB,KAAK2pE,UACDvpE,QAAS,cACTP,SACI0Q,SAAUvQ,KAAKwnB,KAAKlX,UACpByH,MAAOmO,EAAE8B,eAAiB9B,MAItC2mD,UAAW,WACP7sE,KAAK+nE,SAAS8E,UAAY,GAE9B7lB,WAAY,WACRhnD,KAAK+nE,SAAS/gB,WAAa,GAE/B8jB,WAAY,SAAUpnE,GAClB1D,KAAK+nE,SAAS8E,WAAanpE,GAE/BkqE,YAAa,SAAUlqE,GACnB1D,KAAK+nE,SAAS/gB,YAActjD,GAEhCinE,WAAY,SAAU7tD,EAAOuoD,GACzBrlE,KAAK+nE,SAAS8E,WAAaxH,EAC3BrlE,KAAK+nE,SAAS/gB,YAAclqC,GAEhCyuD,SAAU,SAAUrtB,GAChB,GAAKA,EAAL,CAGA,GAAIt5C,GAAM5E,KAAK2nD,UAAU,GAAGkmB,uBAC5B,OAAO7tE,MAAKwnB,KAAK+jD,SAASrtB,EAASuuB,QAAU7nE,EAAIgY,KAAMshC,EAASwuB,QAAU9nE,EAAIsY,OAElF0vD,iBAAkB,SAAUkB,GACxB,GAAIlsE,GAAS5B,KAAKurE,SAASuC,EACvBlsE,GAAO6pE,OACPzrE,KAAKggC,gBAAgBp+B,GACrB5B,KAAK+tE,sBAAwBD,EAC7B9tE,KAAK0rE,YAAc9pE,EAAO6pE,MAE9BzrE,KAAK+sE,kBAET/sC,gBAAiB,SAAUp+B,GACvB5B,KAAKmtB,UAAU6S,gBAAgBp+B,EAAO8P,IAAK1R,KAAK6rE,eAAgB7rE,KAAKqrE,kBAEzE2C,WAAY,WAAA,GACJxlE,GAAIxI,KAAKiuE,kBAAkBzlE,EAC3BimB,EAAIzuB,KAAKiuE,kBAAkBx/C,EAC3By/C,EAAaluE,KAAK0rE,YAAYrwC,MAC9B0sC,EAAW/nE,KAAKwnB,KAAKugD,SACrBoG,EAAa,EACbnnB,EAAa+gB,EAAS/gB,WACtB6lB,EAAY9E,EAAS8E,SACrBrkE,GAAI0lE,EAAWtxD,MACf5c,KAAK4tE,aAAaO,GAElB3lE,EAAI0lE,EAAWpxD,OACf9c,KAAK4tE,YAAYO,GAEjB1/C,EAAIy/C,EAAWhxD,KACfld,KAAK8qE,YAAYqD,GAEjB1/C,EAAIy/C,EAAW/wD,QACfnd,KAAK8qE,WAAWqD,GAEhBtB,IAAc9E,EAAS8E,WAAa7lB,IAAe+gB,EAAS/gB,WAC5DhnD,KAAK4sE,iBAAiB5sE,KAAKouE,eAE3BpuE,KAAKggC,gBAAgBhgC,KAAKurE,SAASvrE,KAAK+tE,yBAGhDpB,gBAAiB,SAAU0B,EAAYnwB,GAC9Bl+C,KAAKsuE,kBACNtuE,KAAKsuE,gBAAkBC,YAAYvuE,KAAKguE,WAAWj8D,KAAK/R,MAAO,KAEnEA,KAAKouE,cAAgBlwB,GAAYl+C,KAAK+tE,sBACtC/tE,KAAKiuE,kBAAoBI,GAE7BtB,eAAgB,WACZyB,cAAcxuE,KAAKsuE,iBACnBtuE,KAAKsuE,gBAAkB,MAE3B1C,iBAAkB,WACd5rE,KAAKwnB,KAAKokD,oBAEdE,eAAgB,SAAU/zD,GAAV,GACRnW,GAAS5B,KAAKurE,SAASxzD,GACvBlG,EAAQ7R,KAAKsQ,UAAU+H,cACvBqC,EAAS7I,EAAMmvC,aAAap/C,EAAO8P,KACnC+8D,EAAazuE,KAAKwnB,KAAKknD,iBAAiBh0D,EAC5C+zD,GAAW18D,KAAK,SAAU/R,KAAKopE,iBAAiBr3D,KAAK/R,OACrDyuE,EAAW18D,KAAK,SAAU08D,EAAWpuD,MAAMtO,KAAK08D,IAChDA,EAAWE,QAAQ52D,EAAM9F,SAE7B28D,iBAAkB,SAAUn7D,GAAV,GACV5B,GAAQ7R,KAAKuoE,OAAO13D,OAAOgB,QAC3BnO,EAAQ1D,KAAKuoE,OAAO7kE,OACpB1D,MAAKsQ,UAAU+H,gBAAkBxG,IACjC7R,KAAKsQ,UAAU+H,cAAcinC,wBAC7Bt/C,KAAKsQ,UAAU+H,YAAYxG,IAE/BA,EAAM81B,cAAa,GACnB3nC,KAAKiqE,iBAAmBvmE,EACxB1D,KAAK2pE,UACDvpE,QAAS,cACTP,SACI6D,MAAOA,EACP+P,aAAcA,MAI1B+0D,eAAgB,WACZxoE,KAAK4uE,kBAAiB,IAE1BC,qBAAsB,WAClB7uE,KAAK4uE,kBAAiB,GACtB5uE,KAAKuoE,OAAOuB,YAAW,IAE3BrB,iBAAkB,WAAA,GACVl4D,GAAWvQ,KAAKsQ,UAChBuB,EAAQtB,EAAS8H,aACrBxG,GAAMytC,sBAAsBt/C,KAAKuoE,OAAO98C,mBACxC5Z,EAAM81B,cAAa,IAEvB+gC,mBAAoB,WAChB,GAAI72D,GAAQ7R,KAAKsQ,UAAU+H,aAC3BxG,GAAM81B,cAAa,GACnB91B,EAAMytC,2BAEVqpB,eAAgB,WACZ3oE,KAAKsQ,UAAU+H,cAAcinC,sBAAsBt/C,KAAKuoE,OAAO98C,oBAEnEqjD,iBAAkB,WACd,GAAI5D,GAAWlrE,KAAKsQ,UAAU+H,cAAcI,YAAYvF,YAAa,CACjEg4D,IAGJlrE,KAAKuoE,OAAO5xD,UACRhG,MAAO3Q,KAAKsQ,UAAU+H,cAAcI,YACpCs2D,KAAM/uE,KAAKwnB,KAAKwnD,sBAChBvlD,QAASzpB,KAAKkqE,oBAGtB+E,kBAAmB,WACfjvE,KAAKuoE,OAAOvmD,SAEhB2pD,YAAa,WACT3rE,KAAKqqE,mBACLrqE,KAAKuoE,OAAOuB,aACZ9pE,KAAK2nE,iBAAiBr4D,SAE1Bid,cAAe,SAAUrG,GACrBA,EAAE5N,iBACFtY,KAAKuoE,OAAOh8C,iBAEhB2iD,aAAc,SAAUnnC,EAAGxJ,GACnBv+B,KAAKuoE,OAAO4G,eAGhBnvE,KAAK6pE,oBAAqB,EAC1B7pE,KAAKuoE,OAAOuB,aACP9pE,KAAK6pE,qBACN7pE,KAAK2nE,iBAAiBr4D,QACtBtP,KAAKmtB,UAAUmS,oBAAoBilC,EAAchmC,OAGzD6wC,eAAgB,SAAUr3D,EAAOwmB,GAAjB,GACRgqC,GAASvoE,KAAKuoE,OACd12D,EAAQ7R,KAAKsQ,UAAU+H,aACvBrY,MAAKqvE,gBAAkB,2BAA2B7lE,KAAK+0B,IACvDv+B,KAAKsvE,mBACLtvE,KAAKmtB,UAAUiS,eAAeklC,EAAQ/lC,IACtCxmB,EAAMO,kBACCiwD,EAAOr+C,cAAa,KAC3BlqB,KAAKmtB,UAAUiS,eAAeklC,EAAQ/lC,IACtCgqC,EAAOyE,eAAetiD,WAAW7Y,GACjCA,EAAMytC,sBAAsBipB,EAAO98C,mBACnC1T,EAAMO,mBAGdi3D,oBAAqB,SAAUx3D,EAAOwmB,GAAjB,GACbgqC,GAASvoE,KAAKuoE,OACd12D,EAAQ7R,KAAKsQ,UAAU+H,aACvBkwD,GAAOr+C,cAAa,KACpBlqB,KAAKmtB,UAAUmR,gBAAgBgmC,EAAQ/lC,EAAO/8B,QAAQ,SAAU,KAAMxB,KAAKqrE,iBAC3E9C,EAAOyE,eAAetiD,WAAW7Y,GACjCA,EAAMytC,sBAAsBipB,EAAO98C,mBACnC1T,EAAMO,mBAGd+xD,iBAAkB,WAAA,GACVx4D,GAAQ7R,KAAKsQ,UAAU+H,cACvB3G,EAAMG,EAAM+E,aACZ9C,EAAQ9T,KAAKsQ,UAAU4wD,aAAaxvD,GACpClJ,EAAIqJ,EAAMlB,MAAMe,GAAKuI,0BACrBzR,KACAsL,EAAQ,IAAMtL,EAAEkrB,SAEpB1zB,KAAKuoE,OAAO7kE,MAAMoQ,IAAStL,IAE/BwhE,eAAgB,SAAUmB,GACtBnrE,KAAKqvE,eAAiBlE,EACtBnrE,KAAKuoE,OAAO5xD,UACRhG,MAAO3Q,KAAKsQ,UAAU+H,cAAcI,YACpCs2D,KAAM/uE,KAAKwnB,KAAKwnD,sBAChBvlD,QAASzpB,KAAKkqE,mBACf56D,SAEPggE,iBAAkB,WACdtvE,KAAKwnB,KAAK+gD,OAAOuB,cAErBV,iBAAkB,SAAUljD,GACpBA,EAAE9lB,QACFJ,KAAK2pE,SAASzjD,GAEdlmB,KAAKsQ,UAAU0vD,cAAc95C,EAAEqY,WAGvC8qC,gBAAiB,SAAUnjD,GACvB,GAAIspD,IACAC,UAAWzvE,KAAKsQ,UAAUzQ,QAAQsf,IAClCuwD,YAAa1vE,KAAKsQ,UAAUzQ,QAAQ2iE,MAEpCt8C,GAAErmB,QACFuB,EAAEzB,QAAO,EAAMumB,EAAErmB,QAAS2vE,GAE1BtpD,EAAErmB,QAAU2vE,EAEhBxvE,KAAKwnB,KAAK3I,WAAWqH,EAAEpa,KAAMoa,EAAErmB,UAEnCsoE,kBAAmB,WAAA,GAQH55D,GANRgC,EAAWvQ,KAAKsQ,UAChBuB,EAAQtB,EAAS8H,cACjBvM,EAAO9L,KAAKwnB,KAAK0gD,WAAWxkE,QAH5BgO,EAIElS,EAAM6Q,YAAY4D,KAAKsoC,eAAezwC,GAAM,IAASyE,EAASwhC,UAAUjmC,EAC9E,OAAI4F,aAAelS,GAAM6Q,YAAY2kB,KAC7BtjB,EAAIG,OAASH,EAAIG,MAAMtJ,eAAiBsJ,EAAM/F,OAAOvD,gBACjDgG,EAAMgC,EAASirC,YAAY9pC,EAAIG,OAC/BtD,IACAgC,EAAS8H,YAAY9J,GACrBsD,EAAQtD,QAGhBsD,GAAMlB,MAAMe,GAAKnC,WAGrBmC,EAAMG,EAAM4G,YAAY9G,KAAKiZ,QAAQD,WAAWG,SAASjZ,EAAM/F,QAAQ,GACvE9L,KAAK2pE,UACDvpE,QAAS,oBACTP,SACIiM,KAAMA,EACNpI,MAAOgO,SAGf1R,MAAK2nE,iBAAiBr4D,UAE1B84D,mBAAoB,WAChBpoE,KAAK2nE,iBAAiBr4D,SAE1B+4D,mBAAoB,SAAUxgD,GAAV,GAOJtZ,GANRzC,EAAO+b,EAAG/b,KACVyE,EAAWvQ,KAAKsQ,UAChBuB,EAAQtB,EAAS8H,cACjB3G,EAAMnB,EAASwhC,UAAUjmC,EAC7B,OAAI4F,aAAelS,GAAM6Q,YAAY2kB,KAC7BtjB,EAAIG,OAASH,EAAIG,MAAMtJ,eAAiBsJ,EAAM/F,OAAOvD,gBACjDgG,EAAMgC,EAASirC,YAAY9pC,EAAIG,OAC/BtD,IACAgC,EAAS8H,YAAY9J,GACrBsD,EAAQtD,QAGhBsD,GAAMlB,MAAMe,GAAKnC,cAGrBvP,MAAK2nE,iBAAiBr4D,SAE1Bg5D,mBAAoB,SAAUzgD,GAC1B7nB,KAAK2pE,UACDvpE,QAAS,oBACTP,SAAWiM,KAAM+b,EAAG/b,QAExB9L,KAAK2nE,iBAAiBr4D,WAG9B9P,EAAM6Q,YAAY80D,WAAaA,IACjChiE,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,oBACH,aACA,aACA,wBACA,aACDD,IACL,YACG,SAAUE,GAsDP,QAASmwE,GAAsBhrD,GAA/B,GAGQhU,GAFAiT,EAAMzgB,OAAO0gB,cACjBD,GAAIsB,kBACAvU,EAAQxM,SAAS2gB,cACrBnU,EAAMi/D,mBAAmBjrD,GACzBf,EAAIuB,SAASxU,GAEjB,QAASk/D,GAAW9rC,EAAOzvB,GACvB,GAAIwC,GAAQitB,EAAM+rC,IAAIx7D,GAAK+xC,QAC3B,OAAOvvC,GAAMA,EAAMjW,OAAS,GAEhC,QAASkvE,GAAUhsC,EAAOzvB,GAA1B,GACQ07D,GAAUjsC,EAAM+rC,IAAIx7D,EAAM,GAC1B7J,EAAQs5B,EAAM+rC,IAAIx7D,GAAK+xC,SAASxlD,OAAS,CAC7C,IAAImvE,GAAWvlE,GAAS,EACpB,MAAOulE,GAAQ3pB,SAAS57C,GAGhC,QAASwlE,GAAWvsE,GAChB,OAAQA,EAAML,MAAQ,GAAK,aAAeK,EAAMy/B,OAAS,QAE7D,QAAS+sC,GAAMz9D,GAIX,MAHK,QAAQjJ,KAAKiJ,KACdA,EAAO,UAAYA,GAEhBA,EAEX,QAAS09D,GAASC,EAAYr7D,EAAMiX,EAAKqkD,GACrC,QAASC,GAAU3rD,GAAnB,GAQYhiB,GAPJ8P,EAAOsC,EAAKtC,IAMhB,OALKA,IACwB,gBAAdsC,GAAKrR,QACZ+O,EAAOsC,EAAKrR,MAAM+O,MAGtBA,GACI9P,GAAU4tE,eAAgB,QAC1Bx7D,EAAKouB,QACLxgC,EAAMwgC,MAAQpuB,EAAKouB;AAEnBpuB,EAAKnC,YACLjQ,EAAM4tE,eAAiB,aAEpB/wE,EAAMmkD,IAAIpoC,QAAQ,KACrBi1D,KAAMN,EAAMz9D,GACZ9P,MAAOA,EACPsP,OAAQ,UACT0S,GAAMA,QAENA,EAtBf,GA4BQhiB,GACA8gC,EAEIgtC,EA8CJnmE,EAAmBiH,EAAoByD,EA0BvC0K,EAUAmkB,EAMAwiB,EACA/yB,EACAlV,EAOAuF,EAxGA+sD,EAA2B,MAAd37D,EAAKrR,OAAoC,MAAnBqR,EAAKqJ,aAAuBrJ,EAAKqJ,WAAW1a,OAASqR,EAAK0uB,YAAc1uB,EAAKurB,MACpH,IAAKtU,GAAQ0kD,EAAb,CAgEA,GA7DI/tE,KACA8gC,EAAa1uB,EAAK0uB,WAClBA,IACIgtC,EAAgBhtC,EAChB4sC,IACAI,EAAgBjxE,EAAMsgD,WAAW2wB,GAAeE,QAChDF,EAAcnoE,GAAK,GACnBmoE,EAAgBA,EAAcjU,aAElCiU,EAAgBR,GAAa9sC,MAAOstC,IACpC9tE,EAAMiuE,QAAUH,GAEhBhtC,IACA9gC,EAAMkuE,gBAAkBptC,GAExB1uB,EAAKouB,QACLxgC,EAAMwgC,MAAQpuB,EAAKouB,OAEnBpuB,EAAKuxB,aACL3jC,EAAM2jC,WAAavxB,EAAKuxB,YAExBvxB,EAAKnC,YACLjQ,EAAM4tE,eAAiB,aAEvBx7D,EAAK2uB,SACL/gC,EAAMmuE,UAAY,UAElB/7D,EAAK6uB,YACLjhC,EAAMihC,UAAY7uB,EAAK6uB,WAEvB7uB,EAAK4uB,OACLhhC,EAAMouE,WAAa,QAEnBh8D,EAAKyuB,WACL7gC,EAAM6gC,SAAWzuB,EAAKyuB,SAAW,MAEjCzuB,EAAKhB,QAAS,GACdpR,EAAM2mB,WAAa,WACnB3mB,EAAMquE,aAAe,aACrBruE,EAAMsuE,SAAW,eAEjBtuE,EAAM2mB,WAAa,MACnB3mB,EAAMquE,aAAe,SACrBruE,EAAMsuE,SAAW,UAErBtuE,EAAMia,KAAO7H,EAAK6H,KAAO,EAAI,KAC7Bja,EAAMua,IAAMnI,EAAKmI,IAAM,EAAI,KAC3Bva,EAAMJ,MAAQwS,EAAKxS,MAAQ,EAAI,KAC/BI,EAAMH,OAASuS,EAAKvS,OAAS,EAAI,KAC7B8H,EAAOyK,EAAKrR,MAAO6N,QAAcjH,GAAM0K,EAASD,EAAKC,OACpDA,GAAkB,UAARzD,GAAoBjH,GAAQqkB,KAAK+F,MAAMpqB,KAClD0K,EAAS,oBAETA,GAAkB,MAAR1K,GACVA,EAAO9K,EAAM6Q,YAAYsE,WAAWK,OAAO1K,EAAM0K,GAC7C1K,EAAK4mE,aACL3/D,EAAOjH,EAAK4mE,aAEA,OAAT5mE,GAA0BmD,SAATnD,IACxBA,EAAO9K,EAAMmkD,IAAIriD,KAAKgJ,KAErB3H,EAAMihC,UACP,OAAQryB,GACR,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,WACD5O,EAAMihC,UAAY,OAClB,MACJ,KAAK,UACDjhC,EAAMihC,UAAY,SAgC1B,MA5BApkC,GAAM6Q,YAAYw6B,KAAKsmC,YAAYp8D,EAAMpS,GACrC+c,GAAc0xD,EAAer8D,MAC7BiX,GACAtM,EAAWvf,KAAK6rB,GAEhBjX,EAAK7B,UAAW,GAChBwM,EAAWvf,KAAK,oBAEhB4U,EAAKurB,QACL5gB,EAAWvf,KAAK,6BAEhB0jC,EAAgB9uB,EAAK8uB,eAAiB,SAEtCv5B,EADAu5B,GAAiBv5B,EACV9K,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAW,oBAAsBlB,IAAkBysC,EAAUhmE,KAExFgmE,EAAUhmE,GAEjB+7C,EAAW/7C,GAAQA,MACnBgpB,GAAe3wB,MAAOA,GACtByb,EAAarJ,EAAKqJ,WAClBA,IAAeA,EAAW1a,QAC1B2iD,EAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,QAAUwpB,UAAW,aACrDrlB,EAAWvf,KAAK,gBAChBmzB,EAAWliB,MAAQgN,EAAW/M,SAElCiiB,EAAWyR,UAAYrlB,EAAW1d,KAAK,KACnC2hB,EAAMnkB,EAAMmkD,IAAIpoC,QAAQ,MAAO+X,EAAY+yB,GAC/C+pB,EAAWjwE,KAAKwjB,GACTA,GAEX,QAAS0tD,GAAQttC,EAAOzvB,EAAKS,GAA7B,GA0CQzK,GAAmBiH,EAAoByD,EAuBvC+vB,EAIAb,EACA9uB,EAAQk8D,EArER3uE,IAmDJ,IAlDIoS,EAAK0uB,aACL9gC,EAAMkuE,gBAAkB97D,EAAK0uB,YAE7B1uB,EAAKouB,QACLxgC,EAAMwgC,MAAQpuB,EAAKouB,OAEnBpuB,EAAKuxB,aACL3jC,EAAM2jC,WAAavxB,EAAKuxB,YAExBvxB,EAAKnC,YACLjQ,EAAM4tE,eAAiB,aAEvBx7D,EAAK2uB,SACL/gC,EAAMmuE,UAAY,UAElB/7D,EAAK6uB,YACLjhC,EAAMihC,UAAY7uB,EAAK6uB,WAEvB7uB,EAAK8uB,gBACLlhC,EAAMkhC,cAAuC,WAAvB9uB,EAAK8uB,cAA6B,SAAW9uB,EAAK8uB,eAExE9uB,EAAK4uB,OACLhhC,EAAMouE,WAAa,QAEnBh8D,EAAKyuB,WACL7gC,EAAM6gC,SAAWzuB,EAAKyuB,SAAW,MAEjCzuB,EAAKhB,QAAS,IACdpR,EAAM2mB,WAAa,YAEnBvU,EAAKkB,YACLtT,EAAMsT,YAAcg6D,EAAWl7D,EAAKkB,aAC7BlB,EAAK0uB,aACZ9gC,EAAM4uE,iBAAmBx8D,EAAK0uB,YAE9B1uB,EAAKwB,aACL5T,EAAM4T,aAAe05D,EAAWl7D,EAAKwB,cAC9BxB,EAAK0uB,aACZ9gC,EAAM6uE,kBAAoBz8D,EAAK0uB,YAE/Bn5B,EAAOyK,EAAKrR,MAAO6N,QAAcjH,GAAM0K,EAASD,EAAKC,OACpDA,GAAkB,UAARzD,GAAoBjH,GAAQqkB,KAAK+F,MAAMpqB,KAClD0K,EAAS,oBAETA,GAAkB,MAAR1K,IACVA,EAAO9K,EAAM6Q,YAAYsE,WAAWK,OAAO1K,EAAM0K,GAC7C1K,EAAK4mE,aACL3/D,EAAOjH,EAAK4mE,cAGfvuE,EAAMihC,UACP,OAAQryB,GACR,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,WACD5O,EAAMihC,UAAY,OAClB,MACJ,KAAK,UACDjhC,EAAMihC,UAAY,SA4B1B,MAxBImB,GAAY,KACZhwB,EAAK7B,UAAW,IAChB6xB,EAAY,oBAEZb,EAAKH,EAAMstC,QAAQ/8D,EAAKhK,EAAM3H,EAAOoiC,EAAWhwB,EAAKqJ,YAErDrJ,EAAKe,YACLw7D,EAAUzB,EAAW9rC,EAAOzvB,GAC5Bc,EAAS66D,EAAWl7D,EAAKe,YACrBw7D,GAAWl8D,IACXk8D,EAAQ1vD,KAAKjf,MAAMsT,YAAcb,IAE9BL,EAAK0uB,aACZ9gC,EAAM8uE,gBAAkB18D,EAAK0uB,YAE7B1uB,EAAKqB,WACLk7D,EAAUvB,EAAUhsC,EAAOzvB,GAC3Bc,EAAS66D,EAAWl7D,EAAKqB,WACrBk7D,GAAWl8D,IACXk8D,EAAQ1vD,KAAKjf,MAAM4T,aAAenB,IAE/BL,EAAK0uB,aACZ9gC,EAAM+uE,eAAiB38D,EAAK0uB,YAEzBS,EA6EX,QAASytC,GAAOjuE,EAAOs1B,EAAKD,GACxB,MAAOr1B,IAASs1B,GAAOt1B,GAASq1B,EA5XvC,GAIO33B,GACA+zB,EACAssB,EACAmwB,EACAC,EAwSAC,EAsEAC,EACAC,EACAC,EAEAC,EAIAC,EAgiBAf,EAsCAzlD,CAn8BAnsB,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACV2vB,EAAU31B,EAAM6Q,YAAY8kB,QAC5BssB,EAAM,IACNmwB,EAAsB,EACtBC,GACArqD,KAAM,qBACN4qD,eAAgB,gCAChBC,cAAe,+BACftK,SAAU,yBACVuK,SAAU,0BACVz6D,UAAW,0BACX06D,WAAY,4BACZC,UAAW,uBACXC,UAAW,2BACXC,qBAAsB,mBACtBC,YAAa,iBACbC,aAAc,uBACdC,mBAAoB,iBACpBC,iBAAkB,sBAClBC,eAAgB,oBAChBC,KAAM,SACNC,kBAAmB,oBACnBC,UAAW,2BACXlxB,gBAAiB,kCACjBC,kBAAmB,oCACnB2lB,gBAAiB,kCACjBC,qBAAsB,wCACtBC,qBAAsB,yCAE1BtoE,EAAM6Q,YAAY8iE,SAAS3rD,MACvB4rD,QAAS,WACTz0D,QACI00D,gBAAiB,mDACjBC,sBAAuB,sIACvBC,8BAA+B,sDAC/BC,8BAA+B,gDAC/BC,4BAA6B,0DAC7BC,0BAA2B,wCAC3BC,0BAA2B,iCAC3BC,gBAAiB,8BACjBC,mBAAoB,qDACpBC,gBAAiB,4EACjBC,qBAAsB,iCAE1BC,MACI5uD,KAAM,OACNmK,OAAQ,SACRjlB,KAAM,SA6PVwnE,EAAYtyE,EAAM4D,MAAMzD,QACxBC,KAAM,WACFI,KAAKy6B,QACLz6B,KAAK8vE,OACL9vE,KAAKi0E,QAAU,EACfj0E,KAAKk0E,OAAS,GAElBC,UAAW,SAAU5xE,GACjBvC,KAAKk0E,QAAU3xE,CACf,IAAIuS,GAAMtV,EAAMmkD,IAAIpoC,QAAQ,OAAS5Y,OAASJ,MAAOA,EAAQ,OAC7DuS,GAAI2S,QAAUllB,EAAQ,EACtBvC,KAAKy6B,KAAKt6B,KAAK2U,IAEnBs/D,OAAQ,SAAU5xE,GAAV,GAIAk4B,GAHA9Y,EAAO,IACXA,IAASjf,OAASH,OAAQA,EAAS,OACnCxC,KAAKi0E,SAAWzxE,EACZk4B,EAAKl7B,EAAMmkD,IAAIpoC,QAAQ,KAAMqG,GACjC8Y,EAAGjT,QAAUjlB,EAAS,EACtBxC,KAAK8vE,IAAI3vE,KAAKu6B,IAElB22C,QAAS,SAAUp4D,EAAU3X,EAAMqB,EAAOoiC,EAAW3mB,GAA5C,GAODioC,GACA/yB,EASA4Q,CAEJ,OAlBa,QAAT5iC,GAA0BmM,SAATnM,IACjBA,EAAO,IAELA,YAAgB9B,GAAMmkD,IAAI0wB,OAC5B/yE,EAAO9B,EAAMmkD,IAAIriD,KAAKA,IAEtB+kD,GAAY/kD,GACZgyB,GAAe3wB,MAAOA,GACtByb,IAAeA,EAAW1a,QAC1B2iD,EAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,QAAUwpB,UAAW,aACrDA,GAAaA,GAAa,KAAOA,EAAY,IAAM,IAAM,eACzDzR,EAAWliB,MAAQgN,EAAW/M,SAE9B0zB,IACAzR,EAAWyR,UAAYA,GAEvBb,EAAK1kC,EAAMmkD,IAAIpoC,QAAQ,KAAM+X,EAAY+yB,GAC7CrmD,KAAK8vE,IAAI72D,GAAUotC,SAASlmD,KAAK+jC,GAC1BA,GAEXowC,UAAW,SAAU9rE,EAAGimB,EAAGsW,GACvB/kC,KAAK8vE,IAAM9vE,KAAK8vE,IAAIv1D,OAAO,SAAUmgB,GACjC,MAAOA,GAAGjT,SAEd,IAAI8sD,GAAS,CAUb,OATAv0E,MAAKy6B,KAAOz6B,KAAKy6B,KAAKlgB,OAAO,SAAUzF,EAAKmvB,GAOxC,MANKnvB,GAAI2S,UACLznB,KAAK8vE,IAAIl+D,QAAQ,SAAU8oB,GACvBA,EAAG2rB,SAAStrB,OAAOkJ,EAAKswC,EAAQ,KAEpCA,KAEGz/D,EAAI2S,SACZznB,MACIR,EAAMmkD,IAAIpoC,QAAQ,SACrB5Y,OACIia,KAAMpU,EAAI,KACV0U,IAAKuR,EAAI,KACTjsB,OAAQxC,KAAKi0E,QAAU,KACvB1xE,MAAOvC,KAAKk0E,OAAS,MAEzBnvC,UAAWA,IAEXvlC,EAAMmkD,IAAIpoC,QAAQ,WAAY,KAAMvb,KAAKy6B,MACzCj7B,EAAMmkD,IAAIpoC,QAAQ,QAAS,KAAMvb,KAAK8vE,UAI9CiC,EAAoB,6OACpBC,EAA0B,kSAC1BC,EAA0B,2SAC9BzyE,EAAM6Q,YAAYmkE,YAAch1E,EAAMqgB,GAAG20D,YACrCtC,EAAgB1yE,EAAMymB,SAAS,iVAAwV8rD,EAAoBC,EAA0BC,GAIraE,EAAO3yE,EAAM4D,MAAMzD,QACnBC,KAAM,SAAU2b,EAAS1b,GAAnB,GAiBE40E,GAhBA/0D,EAAayyD,EAAKzyD,UACtB1f,MAAKub,QAAUA,EACfvb,KAAKH,QAAUuB,EAAEzB,QAAO,GAAQwzE,SAAU3zE,EAAM6Q,YAAY8iE,SAAS3rD,MAAQxnB,KAAKH,QAASA,GAC3FG,KAAK00E,UACL10E,KAAK20E,YACLp5D,EAAQ6xD,OAAO8E,GAAgBxyD,WAAYA,KAC3C1f,KAAK40E,gBACL50E,KAAK4f,QAAUrE,EAAQ0qB,KAAKwb,EAAM/hC,EAAW8H,MAC7CxnB,KAAK2nD,UAAYpsC,EAAQ0qB,KAAKwb,EAAM/hC,EAAW0yD,gBAAgB,GAC/DpyE,KAAK+nE,SAAWxsD,EAAQ0qB,KAAKwb,EAAM/hC,EAAWqoD,UAAU,GACxD/nE,KAAK6X,UAAY0D,EAAQ0qB,KAAKwb,EAAM/hC,EAAW7H,WAC/C7X,KAAKsyE,SAAWlxE,EAAEpB,KAAK+nE,SAASvkD,YAChCxjB,KAAKgwB,KAAO,GAAIxwB,GAAMmkD,IAAIC,KAAK5jD,KAAK2nD,WACpC3nD,KAAK60E,kBAAoB,GAAIr1E,GAAMmkD,IAAIC,KAAK5jD,KAAK6X,UAAU,IAC3D7X,KAAKuoE,OAAS,GAAI/oE,GAAM6Q,YAAYykE,YAAY90E,MAChDA,KAAK+0E,aACDN,GACAxiE,OAAQsJ,EACRqsC,WAAW,EACXotB,OAAQ,SAEZh1E,KAAK4nE,gBAAkB,GAAIpoE,GAAM6Q,YAAYmkE,YAAYj5D,EAAQ0qB,KAAKwb,EAAM/hC,EAAWkoD,iBAAkB6M,GACzGz0E,KAAK8nE,qBAAuB,GAAItoE,GAAM6Q,YAAYmkE,YAAYj5D,EAAQ0qB,KAAKwb,EAAM/hC,EAAWooD,sBAAuB2M,GACnHz0E,KAAK6nE,qBAAuB,GAAIroE,GAAM6Q,YAAYmkE,YAAYj5D,EAAQ0qB,KAAKwb,EAAM/hC,EAAWmoD,sBAAuB4M,IAEvHQ,gBAAiB,SAAU/hE,GACvBlT,KAAKk1E,wBAA0BhiE,EAC3BA,EACAlT,KAAK6X,UAAU+J,KAAK,kBAAmB1O,GAEvClT,KAAK6X,UAAUmL,WAAW,oBAGlCmyD,QAAS,WAAA,GACDC,GAAYh0E,EAAEpB,KAAKq1E,WAAW95D,SAAS+5D,QAAQ,6BAC/CC,EAAc/1E,EAAMg2E,aACpBC,EAAiBz1E,KAAKgoE,SAAWuN,EAAYv1E,KAAKgoE,SAASzsD,SAAW,EACtEm6D,EAAmBN,EAAYG,EAAYH,GAAa,EACxDO,EAAkB31E,KAAKioE,UAAYsN,EAAYv1E,KAAKioE,UAAU1sD,SAAW,CAC7Evb,MAAK4f,QAAQpd,OAAOxC,KAAKub,QAAQ/Y,UAAYizE,EAAiBC,EAAmBC,IAC7E31E,KAAKgoE,UACLhoE,KAAKgoE,SAAS4N,qBAGtBlB,QAAS,WAAA,GAIDW,GAHAz1D,EAAUxe,EAAE,4CAA8Cy0E,UAAU71E,KAAKub,SACzE2sD,EAAa9mE,EAAE,6CAA+CiO,SAASuQ,EAC3E5f,MAAKkoE,WAAa,GAAI1oE,GAAM6Q,YAAYylE,WAAW5N,EAAYloE,KAAKH,SAChEw1E,EAAaj0E,EAAE,WAAWiO,SAASuQ,GACvC5f,KAAKq1E,WAAa,GAAI71E,GAAM6Q,YAAYsP,WAAW01D,GAC/Cr1E,KAAKH,QAAQk2E,SACb/1E,KAAKg2E,aAGbpB,cAAe,WACX,GAAIrM,GAASvoE,KAAKub,QAAQ0qB,KAAKwb,EAAM0wB,EAAKzyD,WAAW6yD,WACrDvyE,MAAK+f,aAAe,GAAIvgB,GAAM6Q,YAAY2P,aAAauoD,GAAUzmD,WAAW,KAEhFizD,WAAY,WACR,GAAI/0E,KAAKH,QAAQooE,UAAW,CACxB,GAAIpoE,GAAUuB,EAAEzB,QAAO,GAAQkf,WAAY7e,KAAK6e,WAAW9M,KAAK/R,OAASA,KAAKH,QAAQooE,UACtFjoE,MAAKioE,UAAY,GAAIzoE,GAAM6Q,YAAYuxC,UAAU5hD,KAAKub,QAAQ0qB,KAAKwb,EAAM0wB,EAAKzyD,WAAWwzD,WAAYrzE,KAG7Gm2E,UAAW,WAAA,GAYElqE,GAXLqnE,EAAWnzE,KAAKH,QAAQszE,SAASa,KACjCn0E,EAAUuB,EAAEzB,QAAO,GACnBylB,MAAM,EACNmK,QAAQ,EACRjlB,MAAM,GACPtK,KAAKH,QAAQk2E,SACZ/B,IACAh0E,MAAKgoE,WACLhoE,KAAKgoE,SAAS/nD,UACdjgB,KAAKub,QAAQ8qC,SAAS,eAAe52C,SAEzC,KAAS3D,IAAQjM,IACTA,EAAQiM,MAAU,GAAQjM,EAAQiM,YAAiBqsB,SACnD67C,EAAK7zE,MACD+I,GAAI4C,EACJxK,KAAM6xE,EAASrnE,GACfmqE,QAAS,IAIrBj2E,MAAKgoE,SAAW,GAAIxoE,GAAM6Q,YAAY6lE,SAAS90E,EAAE,WAAWy0E,UAAU71E,KAAKub,UACvEqsC,WAAW,EACXuuB,cAAe,OACfC,iBAAkB,UAClBrwD,WAAYiuD,EACZqC,eAAgBx2E,EAChB2nB,KAAMxnB,OAEVA,KAAKgoE,SAASz4D,OAAO,IAEzB+mE,gBAAiB,SAAUpwD,GACvBlmB,KAAKoY,OAAO1X,QAAQ,iBAAkBwlB,IAE1C3V,SAAU,SAAUA,GAChBvQ,KAAKsQ,UAAYC,EACjBA,EAAS6I,MAAQpZ,KACjBA,KAAKkoE,WAAW53D,UAAYC,GAEhCsB,MAAO,SAAUA,GACb7R,KAAKoY,OAASvG,GAElBm9D,oBAAqB,WACjB,MAAOhvE,MAAKu2E,cAAcv2E,KAAKoY,OAAOmnC,oBAE1Ci3B,WAAY,SAAU/K,EAAM/5D,GACxB,MAAO+5D,GAAKpwC,MAAMo7C,kBAAkB/kE,EAAII,eAE5C4kE,gBAAiB,SAAUluE,EAAGijE,EAAM32D,GAQhC,MAPAtM,IAAKxI,KAAKoY,OAAOijB,MAAMs7C,aAClBlL,EAAKpwC,MAAM5jB,QAAQm/D,SACpBpuE,GAAKxI,KAAK+nE,SAAS/gB,YAEvBlyC,EAAM9U,KAAKoY,OAAOijB,MAAMyB,SAAS+5C,OAAO,EAAG/hE,EAAK,SAAUgiE,GACtD,MAAOnoD,MAAK6I,IAAIhvB,EAAIsuE,IAAMlF,EAAsB,IAErC,OAAR98D,GAAiB9U,KAAKoY,OAAOgoB,eAAetrB,GAAa,KAANA,GAE9DiiE,aAAc,SAAUtoD,EAAGg9C,EAAMn3D,GAQ7B,MAPAma,IAAKzuB,KAAKoY,OAAOijB,MAAM27C,cAClBvL,EAAKpwC,MAAM7jB,KAAKo/D,SACjBnoD,GAAKzuB,KAAK+nE,SAAS8E,WAEvBv4D,EAAMtU,KAAKoY,OAAOijB,MAAM8B,MAAM05C,OAAO,EAAGviE,EAAK,SAAU69B,GACnD,MAAOxjB,MAAK6I,IAAI/I,EAAI0jB,IAAMy/B,EAAsB,IAErC,OAARt9D,GAAiBtU,KAAKoY,OAAO+nB,YAAY7rB,GAAa,KAANA,GAE3D2iE,aAAc,SAAUzuE,EAAGimB,EAAGg9C,EAAM/5D,GAAtB,GACN6D,GAAOvV,KACPk3E,EAAUzL,EAAKpwC,MACfwxC,EAAYqK,EAAQ1/D,KAAKo/D,OAAS,EAAIrhE,EAAKwyD,SAAS8E,UACpD7lB,EAAakwB,EAAQz/D,QAAQm/D,OAAS,EAAIrhE,EAAKwyD,SAAS/gB,UAG5D,OAFAx+C,IAAK+M,EAAK6C,OAAOijB,MAAMs7C,aAAe3vB,EACtCv4B,GAAKlZ,EAAK6C,OAAOijB,MAAM27C,cAAgBnK,EAChCrtE,EAAMuB,KAAK0I,SAAS,SAAU4E,GACjCkH,EAAK6C,OAAOqkC,oBAAoB/qC,EAAK,SAAUA,GAC3C,GAAIq9D,GAAOx5D,EAAKihE,WAAW/K,EAAM/5D,EAC7B+5D,GAAK0L,eAAepI,GAAMh/C,WAAWvnB,EAAGimB,IACxCpgB,GAAK,QAKrB+oE,WAAY,SAAU5uE,EAAGimB,EAAGg9C,GAAhB,GAaJxhD,GAZAxR,EAAYzY,KAAKoY,OAAO7I,QAC5B,SAAIkJ,EAAUpV,KAAO,KAGrBmF,GAAKxI,KAAKoY,OAAOijB,MAAMs7C,aACvBloD,GAAKzuB,KAAKoY,OAAOijB,MAAM27C,cAClBvL,EAAKpwC,MAAM5jB,QAAQm/D,SACpBpuE,GAAKxI,KAAK+nE,SAAS/gB,YAElBykB,EAAKpwC,MAAM7jB,KAAKo/D,SACjBnoD,GAAKzuB,KAAK+nE,SAAS8E,WAEnB5iD,EAAYjqB,KAAKw2E,WAAW/K,EAAMhzD,GAC/BkW,KAAK6I,IAAIvN,EAAUnN,MAAQtU,GAAK,GAAKmmB,KAAK6I,IAAIvN,EAAU9M,OAASsR,GAAK,IAEjF4oD,aAAc,SAAU7uE,EAAGimB,EAAGg9C,GAAhB,GAGFtjE,GAFJmvE,EAAKt3E,KAAKoY,OAAOm/D,wBACrB,IAAID,IACInvE,EAAInI,KAAKgvE,sBACTvgD,GAAKtmB,EAAE+U,KAAOuR,GAAKtmB,EAAEgV,QACrB,MAAOsuD,GAAK+L,oBAAsBhvE,EAAIL,EAAEyU,MAAQpU,GAAKL,EAAEyU,KAAO,GAAKpU,EAAIL,EAAE2U,OAAStU,GAAKL,EAAE2U,MAAQ,IAI7GyuD,SAAU,SAAU/iE,EAAGimB,GAAb,GAEF7sB,GAAQ6pE,EAUAn3D,EACAoG,EACAnJ,EACAG,EACA+lE,EAfRr8C,EAAOp7B,KAAKoY,OAAOijB,KAiDvB,OA/CI7yB,GAAI,GAAKimB,EAAI,GAAKjmB,EAAIxI,KAAK+nE,SAAS2P,aAAejpD,EAAIzuB,KAAK+nE,SAASoC,aACrEvoE,GAAW2P,KAAM,WACV/I,EAAI4yB,EAAKu7C,cAAgBloD,EAAI2M,EAAK47C,cACzCp1E,GAAW2P,KAAM,cAEjBk6D,EAAOzrE,KAAK23E,OAAOnvE,EAAGimB,GACjBg9C,GAGGn3D,EAAMm3D,EAAKpwC,MAAM7jB,KAAKogE,aAAanpD,EAAGzuB,KAAK+nE,SAAS8E,WACpDnyD,EAAS+wD,EAAKpwC,MAAM5jB,QAAQmgE,aAAapvE,EAAGxI,KAAK+nE,SAAS/gB,YAC1Dz1C,EAAO,OACPG,EAAM,GAAIyjB,GAAQ7gB,EAAKoG,GACvB+8D,EAAYz3E,KAAKoY,OAAOomC,sBACxBx+C,KAAKo3E,WAAW5uE,EAAGimB,EAAGg9C,GACtBl6D,EAAO,WACAvR,KAAKi3E,aAAazuE,EAAGimB,EAAGg9C,EAAM/5D,GACrCH,EAAO,cACCkmE,GAAajvE,EAAI4yB,EAAKu7C,cAC9BplE,EAAO,YACyC,QAA3C+C,EAAMtU,KAAK+2E,aAAatoD,EAAGg9C,EAAMn3D,MAClC5C,EAAM,GAAIyjB,GAAQ7gB,KAAMuI,EAAAA,KACxBtL,EAAO,qBAEHkmE,GAAahpD,EAAI2M,EAAK47C,eAC9BzlE,EAAO,eACkD,QAApDmJ,EAAS1a,KAAK02E,gBAAgBluE,EAAGijE,EAAM/wD,MACxChJ,EAAM,GAAIyjB,MAAStY,EAAAA,IAAUnC,GAC7BnJ,EAAO,uBAEJvR,KAAKq3E,aAAa7uE,EAAGimB,EAAGg9C,KAC/Bl6D,EAAO,UAEC,QAARA,GACAvR,KAAKoY,OAAOioB,kBAAkB3uB,EAAK,SAAU4uB,GACzC5uB,EAAM4uB,EAAOjsB,UAGrBzS,GACI2P,KAAMA,EACNG,IAAKA,IAjCT9P,GAAW2P,KAAM,YAqCzB3P,EAAO6pE,KAAOA,EACd7pE,EAAO4G,EAAIA,EACX5G,EAAO6sB,EAAIA,EACJ7sB,GAEX+1E,OAAQ,SAAUnvE,EAAGimB,GACjB,MAAOzuB,MAAKqX,MAAMkD,OAAO,SAA4BkxD,GACjD,GAAIrwC,GAAOqwC,EAAKpwC,KAChB,OAAOs2C,GAAOljD,EAAG2M,EAAKle,IAAKke,EAAKje,SAAWw0D,EAAOnpE,EAAG4yB,EAAKxe,KAAMwe,EAAKte,SACtE,IAEP+6D,eAAgB,SAAU9iE,GACtB,MAAO/U,MAAKqX,MAAMkD,OAAO,SAAUkxD,GAC/B,QAAIA,EAAKpwC,MAAMnD,SAASnjB,KAIzB,IAEPwhE,cAAe,SAAUxhE,GAAV,GACPmiE,GAAUl3E,KAAK63E,eAAe9iE,GAAMsmB,MACpCpR,EAAYjqB,KAAKoY,OAAOijB,MAAMpR,UAAUlV,EAC5C,OAAOkV,GAAUsqD,OAAO2C,EAAQ/9B,aAAe+9B,EAAQz/D,QAAQm/D,OAAS,EAAI52E,KAAK+nE,SAAS/gB,YAAakwB,EAAQh+B,cAAgBg+B,EAAQ1/D,KAAKo/D,OAAS,EAAI52E,KAAK+nE,SAAS8E,aAE3KxL,QAAS,SAAU/vD,GAAV,GAYGgG,GACAC,EAZJ1F,EAAQ7R,KAAKoY,MACbpY,MAAKgoE,UACLhoE,KAAKgoE,SAAS8P,aAAajmE,EAAMlB,MAAMkB,EAAM+E,eAE7CtF,EAAOmwD,gBAAkBzhE,KAAKioE,WAC9BjoE,KAAKioE,UAAU/iB,aAAallD,KAAKsQ,UAAU60C,SAAUnlD,KAAKsQ,UAAUq4C,WAAW3oD,KAAKoY,SAExFpY,KAAKm1E,UACLn1E,KAAKsyE,SAAS,GAAG3vE,MAAMH,OAASqP,EAAMwpB,MAAM08C,cAAgB,KAC5D/3E,KAAKsyE,SAAS,GAAG3vE,MAAMJ,MAAQsP,EAAMwpB,MAAM28C,aAAe,KACtD1mE,EAAOmL,SACHnF,EAAgBzF,EAAMyF,gBACtBC,EAAa1F,EAAM0F,aACvBvX,KAAKqX,OAASrX,KAAKi4E,MAAM1gE,EAAYD,IACjCA,EAAgB,GAChBtX,KAAKqX,MAAMlX,KAAKH,KAAKi4E,MAAM1gE,EAAY,EAAG,KAAMD,IAEhDC,EAAa,GACbvX,KAAKqX,MAAMlX,KAAKH,KAAKi4E,MAAM,EAAG3gE,EAAeC,EAAY,OAEzDA,EAAa,GAAKD,EAAgB,GAClCtX,KAAKqX,MAAMlX,KAAKH,KAAKi4E,MAAM,EAAG,EAAG1gE,EAAYD,KAGjDhG,EAAOiJ,QACPva,KAAKk4E,qBAEL5mE,EAAOsF,aACP5W,KAAK2iB,OAAS9Q,EAAM+E,aAAa9E,eAGzC48D,iBAAkB,SAAUh0D,GAAV,GAKV7I,GACAH,EACAf,EACA4K,EACA1b,EAIA4uE,CAZJ,OAAIzuE,MAAKm4E,aAAen4E,KAAKm4E,YAAYt4E,QAAQ6a,QAAUA,EAChD1a,KAAKm4E,aAEhBn4E,KAAKk4E,qBACDrmE,EAAQ7R,KAAKoY,OACb1G,EAAMG,EAAM0I,SAAS7I,IACrBf,EAAQ,GAAInR,GAAM6Q,YAAY8J,MAAMzI,EAAKG,GACzC0J,EAAUna,EAAE,WAAWiO,SAASrP,KAAKub,SACrC1b,GACA6a,OAAQA,EACR/J,MAAOA,GAEP89D,EAAa,GAAIjvE,GAAM6Q,YAAY+nE,WAAW78D,EAAS1b,GAC3DG,KAAKm4E,YAAc1J,EACZA,IAEX4J,wBAAyB,WAChBr4E,KAAKk1E,yBACNl1E,KAAK6X,UAAUvI,QACfqgE,EAAsB3vE,KAAK6X,UAAU,MAG7CygE,eAAgB,SAAUvjE,GAAV,GACRwjE,IAAa,EACbrB,EAAUl3E,KAAK63E,eAAe9iE,GAAMsmB,MACpC6yC,EAAagJ,EAAQsB,iBAAiBzjE,GACtCgzD,EAAW/nE,KAAK+nE,SAChB8E,EAAYqK,EAAQ1/D,KAAKo/D,OAAS,EAAI7O,EAAS8E,UAC/C7lB,EAAakwB,EAAQz/D,QAAQm/D,OAAS,EAAI7O,EAAS/gB,UAiBvD,OAhBIknB,GAAWhxD,IAAM2vD,IACjB0L,GAAa,EACbxQ,EAAS8E,UAAYqB,EAAWrB,WAEhCqB,EAAW/wD,OAAS0vD,IACpB0L,GAAa,EACbxQ,EAAS8E,UAAYqB,EAAWuK,cAEhCvK,EAAWtxD,KAAOoqC,IAClBuxB,GAAa,EACbxQ,EAAS/gB,WAAaknB,EAAWlnB,YAEjCknB,EAAWpxD,MAAQkqC,IACnBuxB,GAAa,EACbxQ,EAAS/gB,WAAaknB,EAAWN,aAE9B2K,GAEXG,eAAgB,WACZ14E,KAAK20E,SAASnoE,OAElBo/D,iBAAkB,WAAA,GACVr2D,GAAOvV,KACP+U,EAAOQ,EAAK6C,OAAOxB,aAAa2Z,QAChCg4C,EAAShzD,EAAK6C,OAAOm/D,yBACrB5mE,EAAQ4E,EAAK6C,OAAOzH,MAAMoE,EAC9BwzD,GAAOoQ,MACHhoE,MAAOA,EACPo+D,KAAMx5D,EAAKy5D,sBACXxnD,KAAMxnB,KACNoe,WAAYpe,KAAKoY,OAAOgG,WAAWrJ,GACnCtD,SAAU,SAAU/N,EAAO2G,GACvBkL,EAAK+gE,iBACDl2E,QAAS,cACTP,SACI0+C,eAAgB5tC,EAChBF,SAAUpG,EAAQ,QAAU,QAC5B3G,MAAOA,SAM3Bmb,WAAY,SAAU/S,EAAMjM,GACxB,GAAIgS,GAAQ7R,KAAKoY,MACjB,OAAOvG,GAAM8B,oBAAoB,WAAA,GAMrBjC,GACAf,EANJioE,EAASp5E,EAAM6Q,YAAYwoE,QAAQ5vE,OAAO6C,EAAMjM,EACpD,IAAI+4E,EAOA,MANAA,GAAO7mE,KAAK,SAAU/R,KAAKs2E,gBAAgBvkE,KAAK/R,OAChD44E,EAAO7mE,KAAK,aAAc/R,KAAK04E,eAAe3mE,KAAK/R,OACnDA,KAAK20E,SAASx0E,KAAKy4E,GACflnE,EAAMG,EAAM+E,aACZjG,EAAQ,GAAInR,GAAM6Q,YAAY8J,MAAMzI,EAAKG,GAC7C+mE,EAAOt4D,KAAK3P,GACLioE,GAEb7mE,KAAK/R,QAEX+pE,UAAW,SAAUlqE,EAASi5E,GAAnB,GAmBCC,GAlBJC,EAAgBh5E,KAAKH,QAAQszE,SAASx0D,OACtCs6D,EAAc,SAAU/yD,GACxB,GAAIsnC,GAAOtnC,EAAEmiC,OAAOuwB,SAASr9D,OAC7BiyC,GAAKvnB,KAAK,mBAAmB32B,QAC7Bk+C,EAAKvnB,KAAK,oBAAoBlkB,GAAG,UAAW,SAAU8F,GAC9CA,EAAGX,SAAW1nB,EAAMyhB,KAAKi4D,KACzBhzD,EAAEmiC,OAAOhoC,WAIjB84D,EAAU,SAAUjzD,GACpB,GAAIkiC,GAAMliC,EAAEmiC,MACZroD,MAAKq4E,0BACDjwB,EAAIgxB,QAAUN,GACdA,KAEN/mE,KAAK/R,KACHR,GAAM6Q,YAAYwoE,QAAQQ,WAAWx5E,EAAQ0R,OACzCwnE,GAAkB14D,MAAO84D,GACR,oBAAjBt5E,EAAQ0R,OACRwnE,EAAgB33E,EAAEzB,OAAOo5E,GACrB3nE,MAAOvR,EAAQuR,OAAS,QACxB9P,KAAMzB,EAAQoF,KAAOpF,EAAQoF,KAAO+zE,EAAcn5E,EAAQ0R,MAC1DoF,SAAUsiE,KAGlBj5E,KAAK6e,WAAWhf,EAAQ0R,KAAMwnE,IAE9B/4E,KAAK6e,WAAW,WACZzN,MAAOvR,EAAQuR,OAAS,QACxB9P,KAAMzB,EAAQoF,KAAOpF,EAAQoF,KAAO+zE,EAAcn5E,EAAQ0R,MAC1DoF,SAAUsiE,EACV54D,MAAO84D,KAInBl5D,QAAS,WACLjgB,KAAK20E,SAAS/iE,QAAQ,SAAUgnE,GAC5BA,EAAO34D,YAEXjgB,KAAK4nE,gBAAgB3nD,UACrBjgB,KAAK6nE,qBAAqB5nD,UAC1BjgB,KAAK8nE,qBAAqB7nD,UACtBjgB,KAAKgoE,UACLhoE,KAAKgoE,SAAS/nD,UAElBjgB,KAAKk4E,sBAETA,mBAAoB,WACZl4E,KAAKm4E,cACLn4E,KAAKm4E,YAAYl4D,UACjBjgB,KAAKm4E,YAAc1qE,OACnBzN,KAAKs5E,kBAAoB7rE,SAGjCo2C,OAAQ,SAAUvyC,GAAV,GAIAO,GACAvC,EAIAiqE,EAEAn+C,EACAyxC,EACA7lB,EAOAnhD,EAGA4sE,EAYA+G,CAlCCx5E,MAAKub,QAAQrN,GAAG,cAGjB2D,EAAQ7R,KAAKoY,OACb9I,EAAQuC,EAAMvC,QACdA,GAAStP,KAAKs4E,eAAehpE,KAG7BiqE,EAAmB1nE,EAAM8rC,qBAAgC9rC,EAAMmsC,uBAAuBlpC,QAAS+H,EAAAA,GAAW,SAAW,MAArE,OACpD7c,KAAK4f,QAAQqD,YAAY4uD,EAAeQ,cAAeryE,KAAKuoE,OAAOv/C,YAAY/F,YAAY4uD,EAAeiB,iBAAqC,OAAnByG,GAA0Bt2D,YAAY4uD,EAAekB,eAAmC,UAAnBwG,GAC7Ln+C,EAAOvpB,EAAMwpB,MACbwxC,EAAY7sE,KAAK+nE,SAAS8E,UAC1B7lB,EAAahnD,KAAK+nE,SAAS/gB,WAC3B6lB,EAAY,IACZA,EAAY,GAEZ7lB,EAAa,IACbA,EAAa,GAEbnhD,EAAS7F,KAAKqX,MAAM1T,IAAI,SAAU8nE,GAClC,MAAOA,GAAK5nB,OAAOmD,EAAY6lB,KAE/B4F,EAAYjzE,EAAMmkD,IAAIpoC,QAAQ,OAC9B5Y,OACIJ,MAAO64B,EAAKu7C,aAAe,KAC3Bn0E,OAAQ44B,EAAK47C,cAAgB,MAEjCjyC,UAAWotC,EAAKzyD,WAAW+yD,YAE/B5sE,EAAO1F,KAAKsyE,GACR5gE,EAAMmsC,wBAA0BnsC,EAAMksC,sBACtCl4C,EAAO1F,KAAKH,KAAKy5E,oBAErBz5E,KAAKgwB,KAAK6zB,OAAOh+C,GACb2zE,EAAYh6E,EAAMyQ,QAAQupE,YAC9Bp4E,EAAEpB,KAAK2nD,WAAW9lC,KACdtf,MAAOvC,KAAK4f,QAAQ,GAAG83D,YAAc8B,EACrCh3E,OAAQxC,KAAK4f,QAAQ,GAAGuqD,aAAeqP,IAEvCx5E,KAAKuoE,OAAOv/C,WACZhpB,KAAKuoE,OAAO7+C,cAAc1pB,KAAKgvE,uBACtB19D,EAAOqL,QAAUrL,EAAOg5D,QAAUz4D,EAAM2sC,uBAAyB3sC,EAAM8rC,sBAAwB9rC,EAAM81B,gBAC9G3nC,KAAK05E,6BAGbD,iBAAkB,WAAA,GAIV92E,GAgBA+c,EAnBA7N,EAAQ7R,KAAKoY,OACb1G,EAAMG,EAAMmsC,uBACZkf,EAAaxrD,EAAIoD,QAAS+H,EAAAA,EAkB9B,OAfIla,GADAu6D,GAEI16D,OAAQxC,KAAK+nE,SAASoC,aAAe,KACrC5nE,MAAOqvE,EAAsB,KAC7Bh1D,KAAM/K,EAAMksC,qBAAqBv1C,EAAI,KACrC0U,IAAK,QAIL1a,OAAQovE,EAAsB,KAC9BrvE,MAAOvC,KAAK+nE,SAAS2P,YAAc,KACnCx6D,IAAKrL,EAAMksC,qBAAqBtvB,EAAI,KACpC7R,KAAM,OAGV8C,EAAaiM,EAAKjM,WACflgB,EAAMmkD,IAAIpoC,QAAQ,OACrBwpB,UAAWrlB,EAAWi6D,YAAezc,EAAmD,GAAtC,IAAMx9C,EAAWk6D,oBACnEj3E,MAAOA,IAEPnD,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAWrlB,EAAWm6D,mBACjDr6E,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAWrlB,EAAWo6D,sBAGzDJ,wBAAyB,WAAA,GAWjB31C,GACAg2C,EAOAxrE,EACAyrE,EACAC,EApBApoE,EAAQ7R,KAAKoY,OACbgjB,EAAOvpB,EAAMwpB,MACb5iB,EAAY2iB,EAAKrD,UAAUlmB,EAAMtC,SAASuC,cAC1CyG,EAASvY,KAAKsQ,UAAUuH,YAAY0B,SACxC,OAAIhB,GAAOgB,WAAY,GAAShB,EAAOmB,gBACnC1Z,KAAK60E,kBAAkBhxB,eACvB7jD,MAAKq4E,4BAGT5/D,EAAY5G,EAAM+sC,KAAKnmC,GACnBsrB,EAAQ,GAAI+tC,GACZiI,EAAgB3+C,EAAK8+C,gBAAgBzhE,GACzCshE,EAAcviE,KAAK5F,QAAQ,SAAUpP,GACjCuhC,EAAMqwC,OAAO5xE,KAEjBu3E,EAActiE,QAAQ7F,QAAQ,SAAUrP,GACpCwhC,EAAMowC,UAAU5xE,KAEhBgM,EAAMsD,EAAM63B,gBAAgBjxB,GAC5BuhE,EAAqBzrE,EAAIg7B,QACzB0wC,EAAuB1rE,EAAIi7B,UAC/B33B,EAAMD,QAAQ6G,EAAW,SAAUnE,EAAKQ,EAAKC,GAApB,GAGbmvB,GACAi2C,EAHJj8B,EAAW,GAAI/oB,GAAQ7gB,EAAKQ,GAAKiW,OAChCkvD,GAAqB/7B,KAClBha,EAAKmtC,EAAQttC,EAAOzvB,EAAMmE,EAAUpE,QAAQC,IAAKS,GACjDolE,EAAaH,EAAmB97B,GAChCi8B,IACAj2C,EAAGtiB,KAAKw4D,QAAUD,EAAW53E,QAC7B2hC,EAAGtiB,KAAKy4D,QAAUF,EAAW33E,aAIzCxC,KAAK60E,kBAAkBhxB,QAAQ9f,EAAMuwC,UAAU,EAAG,EAAG,mBAAqBt0E,KAAKsQ,UAAUuH,YAAYmtB,YACrGhlC,MAAKq4E,4BAETJ,MAAO,SAAU3jE,EAAKoG,EAAQwY,EAAUC,GACpC,GAAIs4C,GAAO,GAAI9/C,GAAK3rB,KAAKoY,OAAQpY,KAAKoY,OAAOijB,MAAMowC,MAC/Cn3D,IAAKA,EACLoG,OAAQA,EACRwY,SAAUA,EACVC,YAAaA,IAGjB,OADAs4C,GAAKpK,QAAQrhE,KAAK+nE,SAAS2P,YAAa13E,KAAK+nE,SAASoC,cAC/CsB,KAGX2F,GACAr8D,KAAM,qBACNulE,MAAO,sBACPC,MAAO,sBACPC,QAAS,wBACTC,QAAS,wBACTC,UAAW,2BACXC,aAAc,8BACdlP,KAAM,qBACNnhE,KAAM,qBACN6vE,WAAY,4BACZS,mBAAoB,yBACpBhkE,WAAY,4BACZ6B,UAAW,0BACXoiE,iBAAkB,sBAClBC,gBAAiB,sBACjBtkD,OAAQ,WACRtZ,IAAK,QACLJ,MAAO,UACPK,OAAQ,WACRP,KAAM,SACN0vD,aAAc,kBACdyO,mBAAoB,yBACpBC,gBAAiB,sBACjBrB,WAAY,gBACZE,iBAAkB,uBAClBC,iBAAkB,uBAClBF,mBAAoB,yBACpBqB,mBAAoB,oCACpBrvD,QACI,aACA,aACA,aACA,aACA,aACA,eAGJD,EAAOnsB,EAAM4D,MAAMzD,QACnBC,KAAM,SAAUiS,EAAOupB,GACnBp7B,KAAKoY,OAASvG,EACd7R,KAAKq7B,MAAQD,GAEjBimC,QAAS,SAAU9+D,EAAOC,GACtBxC,KAAKq7B,MAAMgmC,QAAQ9+D,EAAOC,IAE9B04E,UAAW,SAAUl0B,EAAY6lB,EAAWn7D,GACxC,MAAO1R,MAAKq7B,MAAM7T,KAAKw/B,EAAY6lB,GAAWn7D,IAAIqe,WAAWre,IAEjEmyC,OAAQ,SAAUmD,EAAY6lB,GAAtB,GAQAxmB,GAOIq0B,EAsBAC,EAUA/9D,EAsBJu+D,EApEAz7D,EAAaiM,EAAKjM,WAClB7N,EAAQ7R,KAAKoY,OACbgjB,EAAOp7B,KAAKq7B,MACZ7T,EAAO4T,EAAK5T,KAAKw/B,EAAY6lB,EAwEjC,OAvEA7sE,MAAKo7E,aAAe5zD,EACpBxnB,KAAKq7E,aAAer7E,KAAKw2E,WAAWhvD,EAAK9V,KACzC1R,KAAKs7E,iBAAmBzpE,EAAMiqC,kBAC1BuK,KACJA,EAASlmD,KAAKH,KAAKu7E,cACnBl1B,EAASlmD,KAAKH,KAAKw7E,mBACnBn1B,EAASlmD,KAAKH,KAAKy7E,kBACnBp1B,EAASlmD,KAAKH,KAAK07E,yBACnBr1B,EAASlmD,KAAKH,KAAK27E,uBACfvgD,EAAKwgD,eACDlB,EAAYl7E,EAAMmkD,IAAIpoC,QAAQ,OAC9BwpB,UAAWrlB,EAAWg7D,UACtB/3E,OACIJ,MAAO64B,EAAK+d,YAAc,KAC1Bj8B,IAAKsK,EAAKq0D,UAAY,QAG9Bx1B,EAASlmD,KAAKu6E,GACd7oE,EAAMD,QAAQ4V,EAAK9V,IAAImE,aAAc,SAAUvB,GAC3C,IAAKzC,EAAMsuB,YAAY7rB,GAAM,CACzB,GAAIhT,GAAOgT,EAAM,EAAG9R,EAASqP,EAAMS,UAAUgC,EAC7ComE,GAAUr0B,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OACtCwpB,UAAW/kC,KAAK87E,gBAAgBxnE,EAAK,OACrC3R,OACIJ,MAAO64B,EAAK+d,YAAc,KAC1B32C,OAAQA,EAAS,QAErBhD,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAW,4BAA8BvlC,EAAMmkD,IAAIriD,KAAKA,EAAO,WAEpGyQ,KAAK/R,QAEPo7B,EAAK2gD,kBACDpB,EAAen7E,EAAMmkD,IAAIpoC,QAAQ,OACjCwpB,UAAWrlB,EAAWi7D,aACtBh4E,OACIua,IAAK,MACLN,KAAM4K,EAAKw0D,aAAe,KAC1Bz5E,MAAOvC,KAAKq7E,aAAa94E,MAAQ,KACjCC,OAAQ44B,EAAK8d,aAAe,QAGpCmN,EAASlmD,KAAKw6E,GACV/9D,EAAO,EACX/K,EAAMD,QAAQ4V,EAAK9V,IAAIyE,SAAU,SAAU7B,EAAKQ,GAC5C,IAAKjD,EAAMuuB,eAAetrB,GAAM,CAC5B,GAAIxT,GAAO9B,EAAM6Q,YAAY2kB,IAAIqC,QAAQ,KAAMxa,EAAAA,EAAU/H,GAAMvS,EAAQsP,EAAMO,YAAY0C,EACzF6lE,GAAat0B,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OACzCwpB,UAAW/kC,KAAK87E,gBAAgBhnE,EAAK,OACrCnS,OACIymB,SAAU,WACVxM,KAAMA,EAAO,KACbra,MAAOA,EAAQ,KACfC,OAAQ44B,EAAK8d,aAAe,QAEhC15C,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAW,4BAA8BvlC,EAAMmkD,IAAIriD,KAAKA,EAAO,SAC9Fsb,GAAQra,IAEdwP,KAAK/R,QAEP6R,EAAMmsC,yBAA2B5iB,EAAK2gD,iBAAmB3gD,EAAKwgD,gBACzD/pE,EAAMksC,sBACP/9C,KAAKi8E,mBAAmB51B,IAG5B80B,GAAez7D,EAAW+rD,MAC1BrwC,EAAK2gD,iBACLZ,EAAYh7E,KAAKuf,EAAWxC,KAE5Bke,EAAKwgD,cACLT,EAAYh7E,KAAKuf,EAAW9C,MAEzBpd,EAAMmkD,IAAIpoC,QAAQ,OACrB5Y,MAAOy4B,EAAKz4B,MACZoiC,UAAWo2C,EAAYn5E,KAAK,MAC7BqkD,IAEPy1B,gBAAiB,SAAUrxE,EAAO8G,GAAjB,GAET2qE,GACAC,EAQAp3C,EAVA+W,EAAkB97C,KAAKs7E,gBAc3B,OAXa,QAAT/pE,GACA2qE,EAAgBpgC,EAAgBtkC,KAAK/M,GACrC0xE,EAAargC,EAAgBC,UAE7BmgC,EAAgBpgC,EAAgBrhB,KAAKhwB,GACrC0xE,EAAargC,EAAgBE,SAE7BjX,EAAYm3C,IAAkBpgC,EAAgBsD,IAAM,OAAS+8B,EAAa,UAAY,QACtFp3C,IACAA,EAAY,eAAiBA,GAE1BA,GAEXw2C,WAAY,WAAA,GAY4ElzE,GAgChFk7B,EACA64C,EACAxlE,EA7CA/E,EAAQ7R,KAAKoY,OACboP,EAAOxnB,KAAKo7E,aACZ5tB,EAAOhuD,EAAMmkD,IAAIpoC,QAAQ,OACzBwpB,UAAWpZ,EAAKjM,WAAWpV,KAC3B3H,OACIymB,SAAU,WACVxM,KAAM4K,EAAKw0D,aAAe,KAC1B9+D,IAAKsK,EAAKq0D,UAAY,QAG1B9M,EAAO/uE,KAAKq7E,aACZ5+D,EAASjd,EAAM6Q,YAAYw6B,KAAKwxC,SAASxqE,EAAO2V,EAAK9V,KAAO4qE,WAAW,IACvEvpE,EAAgBlB,EAAM4nC,cAwF1B,OAvFI1mC,KACA1K,EAAO,KACPoU,EAAO8/D,QAAQ3qE,QAAQ,SAAUpJ,GACzBA,IAAMH,IACNA,EAAOG,EACPglD,EAAKnH,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OACjCwpB,UAAWqsC,EAAekJ,MAC1B33E,OACIia,KAAMpU,EAAI,KACVhG,OAAQusE,EAAKvsE,OAAS,KACtBg6E,YAAa3qE,EAAMuqC,wBAKnC/zC,EAAO,KACPoU,EAAOggE,QAAQ7qE,QAAQ,SAAU6c,GACzBA,IAAMpmB,IACNA,EAAOomB,EACP++B,EAAKnH,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OACjCwpB,UAAWqsC,EAAemJ,MAC1B53E,OACIua,IAAKuR,EAAI,KACTlsB,MAAOwsE,EAAKxsE,MAAQ,KACpBi6E,YAAa3qE,EAAMuqC,yBAMnC7Y,EAAU/jC,EAAM6Q,YAAYw6B,KAAK6xC,UACjCN,EAAkBvqE,EAAM+E,aAAa9E,aACrC8E,EAAawlE,EAAgB/nE,QACjCoI,EAAO3F,MAAMlF,QAAQ,SAAUmD,GAC3B,GAAIiX,GAAM,IACNjX,GAAKT,IAAMkT,EAAK9V,IAAI2C,QAAQC,KAAOsC,EAAWtC,KAAOS,EAAKD,IAAM0S,EAAK9V,IAAI2C,QAAQS,KAAO8B,EAAW9B,MACnGkX,GAAOL,EAAKjM,WAAW9I,YAAY8f,OAAO12B,KAAK28E,sBAAuB38E,KAAK48E,kBAAkBR,IACzFvqE,EAAMkuB,uBACN/T,EAAI7rB,KAAKwrB,EAAKjM,WAAW8W,QAE7BxK,EAAMA,EAAIhqB,KAAK,MAEnBuhC,EAAQmO,IAAI38B,GACZo7D,EAAS3iB,EAAKnH,SAAUtxC,EAAMiX,EAAKjZ,IACpC/S,MACHujC,EAAQs5C,KAAKjrE,QAAQ,SAAU7G,GAC3BA,EAAE6G,QAAQ,SAAUoS,GAChB,IAAKA,EAAE84D,SAAU,CACb94D,EAAE84D,UAAW,CACb,IAAIn6E,IACAia,KAAMoH,EAAExb,EAAI,KACZ0U,IAAK8G,EAAE9G,IAAM,KACb1a,OAAQwhB,EAAE7G,OAAS6G,EAAE9G,IAAM,EAAI,KAC/B6/D,YAAa/4D,EAAE3gB,KAAO,KACtBm5E,YAAax4D,EAAEmf,MAEL,IAAVnf,EAAE3gB,OACFV,EAAMq6E,UAAY,gBAAkBh5D,EAAE3gB,KAAO,GAAK,EAAI,OAE1DmqD,EAAKnH,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OACjCwpB,UAAWqsC,EAAeoJ,QAC1B73E,MAAOA,UAKvB4gC,EAAQ05C,MAAMrrE,QAAQ,SAAU7G,GAC5BA,EAAE6G,QAAQ,SAAUoS,GAChB,IAAKA,EAAE84D,SAAU,CACb94D,EAAE84D,UAAW,CACb,IAAIn6E,IACAua,IAAK8G,EAAEyK,EAAI,KACX7R,KAAMoH,EAAEpH,KAAO,KACfra,MAAOyhB,EAAElH,MAAQkH,EAAEpH,KAAO,KAC1BmgE,YAAa/4D,EAAE3gB,KAAO,KACtBm5E,YAAax4D,EAAEmf,MAEL,IAAVnf,EAAE3gB,OACFV,EAAMq6E,UAAY,gBAAkBh5D,EAAE3gB,KAAO,GAAK,EAAI,OAE1DmqD,EAAKnH,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OACjCwpB,UAAWqsC,EAAeqJ,QAC1B93E,MAAOA,UAKhB6qD,GAEXyuB,mBAAoB,SAAUt0B,GAAV,GAKZhlD,GAJAkP,EAAQ7R,KAAKoY,OACb1G,EAAMG,EAAMmsC,uBACZ/zB,EAAYjqB,KAAKw2E,WAAW9kE,GAC5BgO,GAAciM,EAAKjM,WAAW4sD,aAElC,IAAI56D,EAAIoD,QAAS+H,EAAAA,GAAU,CACvB,GAAI7c,KAAKq7B,MAAM7jB,KAAK0lE,OAAS,EACzB,MAEJv6E,IACIH,OAAQxC,KAAKq7B,MAAM6d,aAAe,KAClC32C,MAAOqvE,EAAsB,KAC7Bh1D,KAAMqN,EAAUnN,MAAQ80D,EAAsB,EAAI,KAClD10D,IAAK,OAETwC,EAAWvf,KAAK0xE,EAAeiB,sBAC5B,CACH,GAAI9yE,KAAKq7B,MAAM5jB,QAAQylE,OAAS,EAC5B,MAEJv6E,IACIH,OAAQovE,EAAsB,KAC9BrvE,MAAOvC,KAAKq7B,MAAM8d,YAAc,KAChCj8B,IAAK+M,EAAU9M,OAASy0D,EAAsB,EAAI,KAClDh1D,KAAM,OAEV8C,EAAWvf,KAAK0xE,EAAekB,gBAEnCprB,EAAUxnD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,OAC7BwpB,UAAWrlB,EAAW1d,KAAK,KAC3BW,MAAOA,MAGfw0E,eAAgB,SAAUpI,GAAV,GACRoO,GAAc,GACdC,EAAgB,CACpB,OAAO,IAAI59E,GAAM6Q,YAAYgtE,UAAUtO,EAAKjyD,MAAQqgE,EAAcC,EAAerO,EAAK7xD,IAAMkgE,EAAeD,EAAaA,IAE5HxB,oBAAqB,WAKjB,QAAS3I,GAAKjuC,GACV,MAAOvlC,GAAMmkD,IAAIpoC,QAAQ,QAAUwpB,UAAWrlB,EAAWszD,KAAO,IAAMjuC,IAE1E,QAAS6tC,GAAalzD,EAAY0J,EAAU3e,GAA5C,GAYQ8jB,GAXA5rB,GACAia,KAAMwM,EAASxM,KAAO,KACtBM,IAAKkM,EAASlM,IAAM,MAEpBogE,EAAW/iE,GAAUA,EAAO9C,QAAQ4gB,KAAK,SAAU3vB,GACnD,MAAOA,GAAE+B,QAAUA,IAEnB8yE,EAAU79D,EAAWkzD,YAQzB,OAPI0K,KACAC,GAAW,IAAM79D,EAAWmzD,oBAE5BtkD,EAAS/uB,EAAMmkD,IAAIpoC,QAAQ,QAC3BwpB,UAAWw4C,EACX56E,MAAOA,IACPqwE,EAAKtzD,EAAWuzD,qBAvBP,GACbphE,GAAQ7R,KAAKoY,OACbiuC,KACA3mC,EAAayyD,EAAKzyD,WAClBnF,EAAS1I,EAAM0I,QAgCnB,OAVIA,IACAva,KAAKw9E,QAAQn3B,EAAU9rC,EAAO7I,IAAKgO,EAAWizD,aAElD9gE,EAAM4qC,oBAAoBz8C,KAAKo7E,aAAa1pE,IAAK,SAAUA,GAAV,GACzCq9D,GAAO/uE,KAAKw2E,WAAW9kE,GACvB0X,EAAWppB,KAAKm3E,eAAepI,GAC/Br0D,EAAS1a,KAAKoY,OAAO4oC,aAAatvC,GAClC6c,EAASqkD,EAAalzD,EAAY0J,EAAU1O,EAChD2rC,GAASlmD,KAAKouB,IAChBxc,KAAK/R,OACAR,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAWrlB,EAAWgzD,sBAAwBrsB,IAEpFq1B,sBAAuB,WAAA,GACfh8D,GAAaiM,EAAKjM,WAClB7N,EAAQ7R,KAAKoY,OACbqlE,IAQJ,OAPA5rE,GAAMmoC,mBAAmBpoC,QAAQ,SAAUjB,GACvC,GAAIe,GAAMf,EAAMe,GACZA,KAAQlS,EAAM6Q,YAAY2qB,SAG9Bh7B,KAAKw9E,QAAQC,EAAY/rE,EAAKgO,EAAWu7D,mBAAqB,IAAMtqE,EAAMsb,aAC5Ela,KAAK/R,OACAR,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAWrlB,EAAWm7D,kBAAoB4C,IAEhFjC,gBAAiB,WAAA,GACT97D,GAAaiM,EAAKjM,WAClB+9D,KACAC,GAAoBh+D,EAAWjH,WAC/B5G,EAAQ7R,KAAKoY,OACbxB,EAAa/E,EAAM+E,aAAa9E,aAChC2G,EAAY5G,EAAMtC,QActB,OAbAmuE,GAAmBA,EAAiBhnD,OAAO12B,KAAK28E,uBACvB,IAArBlkE,EAAUpV,QACVq6E,EAAiBv9E,KAAK,sBAEtBH,KAAKoY,OAAOqlC,iBACZigC,EAAiBv9E,KAAK,0BAE1BsY,EAAU7G,QAAQ,SAAUF,GACpBA,IAAQlS,EAAM6Q,YAAY2qB,SAC1Bh7B,KAAKw9E,QAAQC,EAAY/rE,EAAKgsE,EAAiB17E,KAAK,OAE1D+P,KAAK/R,OACPA,KAAK29E,0BAA0BF,EAAY7mE,GACpCpX,EAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAWrlB,EAAWm7D,kBAAoB4C,IAEhFhC,eAAgB,WAAA,GAGJj+B,GACA7c,EACAjC,EAKIhtB,EAAKksE,EAmBLr9C,EACAtW,EA7BR4zD,IACJ,IAAI79E,KAAKoY,OAAOslC,qBAKZ,GAJIF,EAAcx9C,KAAKoY,OAAOolC,cAC1B7c,EAAQ3gC,KAAKoY,OAAOqlC,gBACpB/e,EAAY1+B,KAAKoY,OAAOmlC,mBAC5Bv9C,KAAKw9E,QAAQK,EAAmBrgC,EAAa,eACzC7c,EACA3gC,KAAKw9E,QAAQK,EAAmBl9C,EAAO,yBACpC,IAAkBlzB,SAAdixB,EAAyB,CAEhC,OAAQA,GACR,IAAK,GACDhtB,EAAM8rC,EAAYjnB,YAClBqnD,EAAW,qBACX,MACJ,KAAK,GACDlsE,EAAM8rC,EAAYjnB,YAClBqnD,EAAW,qBACX,MACJ,KAAK,GACDlsE,EAAM,GAAIyjB,GAAQqoB,EAAYnpC,QAAQC,IAAKkpC,EAAYjnB,YAAYzhB,KACnE8oE,EAAW,qBACX,MACJ,KAAK,GACDlsE,EAAM,GAAIyjB,GAAQqoB,EAAYjnB,YAAYjiB,IAAKkpC,EAAYnpC,QAAQS,KACnE8oE,EAAW,sBAGXr9C,EAAO/gC,EAAMmkD,IAAIpoC,QAAQ,QAAUwpB,UAAW,cAAgBvlC,EAAMmkD,IAAIriD,KAAKtB,KAAKoY,OAAOklC,iBACzFrzB,EAAYjqB,KAAKw9E,QAAQK,EAAmBnsE,EAAKksE,GACjD3zD,GACAA,EAAUo8B,SAASlmD,KAAKogC,GAIpC,MAAO/gC,GAAMmkD,IAAIpoC,QAAQ,OAASwpB,UAAWpZ,EAAKjM,WAAWo7D,iBAAmB+C,IAEpFL,QAAS,SAAUpN,EAAY1+D,EAAKqzB,GAChC,GAA8BphB,GAA1B6D,EAAOxnB,KAAKo7E,YAKhB,OAJI5zD,GAAK9V,IAAIqe,WAAWre,KACpBiS,EAAM3jB,KAAKw2E,WAAW9kE,GAAKiL,OAAO,EAAG,GAAGmhE,MAAM/4C,GAC9CqrC,EAAWjwE,KAAKwjB,IAEbA,GAEXg6D,0BAA2B,SAAUvN,EAAY1+D,GAAtB,GAOfuY,GANJ1U,EAAOvV,KACP6R,EAAQ0D,EAAK6C,OACboP,EAAOjS,EAAK6lE,aACZjoD,EAAc5d,EAAK8lB,MAAM5jB,QAAQsmE,MAAM37C,OACvCk1C,EAAKzlE,EAAM0lE,wBACXD,IAAM9vD,EAAK9V,IAAIqe,WAAWre,KACtBuY,EAAY1U,EAAKihE,WAAW9kE,GAChCG,EAAMD,QAAQF,EAAIgoB,WAAY,SAAUplB,EAAKQ,EAAKC,GAApB,GAKtBipE,GACAC,EAKAC,CAVJnpE,GAAK6H,KAAOqN,EAAUrN,KACtB7H,EAAKmI,IAAM+M,EAAU/M,IACrBnI,EAAKxS,MAAQ0nB,EAAU1nB,MACvBwS,EAAKvS,OAASynB,EAAUznB,OACpBw7E,EAAW,uCACXC,EAAenpE,GAAOqe,EAAc,EACpC8qD,IACAD,GAAY,8BAEhBzoE,EAAKiiE,oBAAsByG,EACvBC,EAAM1+E,EAAMmkD,IAAIpoC,QAAQ,OACxBwpB,UAAWi5C,EACXr7E,OACIia,KAAM7H,EAAK6H,MAAQqhE,EAAe,EAAIlpE,EAAKxS,OAAS,KACpD2a,IAAKnI,EAAKmI,IAAM,KAChB1a,OAAQuS,EAAKvS,OAAS,QAG1B80E,EAAGtE,MACHkL,EAAI73B,SAASlmD,KAAKX,EAAMmkD,IAAIpoC,QAAQ,QAAUwpB,UAAW,UAAYuyC,EAAGtE,QAE5E5C,EAAWjwE,KAAK+9E,OAI5BvB,oBAAqB,WAAA,GACbwB,GACAC,IASJ,OARIp+E,MAAKoY,OAAOuvB,iBACZw2C,EAAyBn+E,KAAKoY,OAAO4hC,mBAAmBz/B,OAAO,SAAUqJ,GACrE,MAAOA,GAAImI,QAAsB,OAAZnI,EAAIrS,OAC1B,GACC4sE,GACAC,EAAaj+E,KAAKg+E,EAAuBlyD,aAG1CmyD,GAEXxB,kBAAmB,SAAU7nE,GAAV,GACXspE,MACA3+D,EAAaiM,EAAKjM,WAClB8H,EAAOxnB,KAAKo7E,aAAa1pE,GAa7B,OAZKqD,GAAKylB,KAAK,MAAOzK,WAAWvI,IAC7B62D,EAAYl+E,KAAKuf,EAAW9C,MAE3B7H,EAAKylB,QAAS,GAAGzK,WAAWvI,IAC7B62D,EAAYl+E,KAAKuf,EAAWxC,KAE3BnI,EAAKylB,KAAK,EAAG,GAAGzK,WAAWvI,IAC5B62D,EAAYl+E,KAAKuf,EAAW5C,OAE3B/H,EAAKylB,KAAK,EAAG,GAAGzK,WAAWvI,IAC5B62D,EAAYl+E,KAAKuf,EAAWvC,QAEzBkhE,GAEX7H,WAAY,SAAU9kE,GAClB,MAAO1R,MAAKq7B,MAAMo7C,kBAAkB/kE,EAAII,cAAcyiE,QAAQv0E,KAAKo7E,aAAakD,gBAAiBt+E,KAAKo7E,aAAamD,kBAG3H/+E,EAAM6Q,YAAY8hE,KAAOA,EACzB3yE,EAAM6Q,YAAYsb,KAAOA,EACzBnsB,EAAM6Q,YAAY8/D,SAAWA,EAC7B/uE,EAAEzB,QAAO,EAAMwyE,GAAQzyD,WAAYmyD,IACnCzwE,EAAEzB,QAAO,EAAMgsB,GAAQjM,WAAY0xD,MACrCjuE,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,6BACH,aACA,cACA,iBACA,iBACA,qBACDD,IACL,YACG,SAAUE,GACP,YADH,IAKO4B,GACAo9E,EACAC,CALAj/E,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVg5E,KACAC,EAAiBj/E,EAAM6Q,YAAYouE,eAAiB,SAAU3yE,EAAMy8D,GACpEiW,EAAQ1yE,GAAQy8D,GAEpB/oE,EAAM6Q,YAAYsoC,MAAM3lC,UAAUukE,uBAAyB,WAAA,GAG/CnoE,GACAvN,EACA0mE,EAJJxzD,EAAO/U,KAAK4W,aAAa2Z,OAC7B,IAAIvwB,KAAK2Q,MAAMoE,GAAM7B,SAajB,MAZI9D,GAAMpP,KAAKoe,WAAWrJ,GACtBlT,EAAM7B,KAAK0oC,YAAYzkC,IAAI,SAAUjE,KAAKq7B,MAAMogB,aAAa1mC,IAEtD,MAAPlT,EACA0mE,EAASiW,EAAQ38E,GACVuN,GAAOA,EAAIynC,aAClBh1C,EAAM,eAAiBuN,EAAIwmC,SAC3B2yB,EAASiW,EAAQ38E,IAEA,kBAAV0mE,KACPA,EAASiW,EAAQ38E,GAAO0mE,KAErBA,GAGfkW,EAAe,mBAAoB,WAE/B,QAASx1E,KACAypB,IACDA,EAAWtxB,EAAE,SAASs9E,gBACtB93D,EAAQxlB,EAAE,SAASu9E,aACnBjsD,EAASrjB,SAASuX,GAClB8L,EAAWA,EAASksD,mBACpBh4D,EAAQA,EAAMi4D,gBACdnsD,EAAS3gB,KAAK,SAAU,WACpB6U,EAAMvG,OACN,IAAIytB,GAAOpb,EAAShvB,OACf8tC,GAAQ7gC,MAAMqE,UACfw8B,EAAQ7gC,MAAMqE,OAAO,cAEzBw8B,EAAQ//B,SAASjS,EAAM6Q,YAAYmiB,aAAasb,OAGxDlnB,EAAMk4D,YAAah4D,OAAQ0qB,EAAQhqB,KAAKjM,QAAQ0qB,KAAK,kCAEzD,QAAS3lB,KAAT,GAEQwtB,GAMA1+B,EAEI4pB,EACAD,CAVR9vB,KACI6kC,EAAO0D,EAAQ7gC,MAAMjN,QAErBgvB,EAAShvB,MADD,MAARoqC,EACetuC,EAAM6Q,YAAYu3B,aAAakG,GAE/B,MAEf1+B,EAAMoiC,EAAQpzB,WACdhP,GACI4pB,EAAMx5B,EAAMqgB,GAAGk/D,SAASj/E,GAAGD,QAAQm5B,IACnCD,EAAMv5B,EAAMqgB,GAAGk/D,SAASj/E,GAAGD,QAAQk5B,IACnC,2BAA2BvvB,KAAK4F,EAAIknC,gBACpCtd,EAAMx5B,EAAM6Q,YAAYu3B,aAAax4B,EAAIumC,KAAKjyC,QAE1B,WAApB0L,EAAIknC,eACJvd,EAAMv5B,EAAM6Q,YAAYu3B,aAAax4B,EAAI8mC,GAAGxyC,QAExB,YAApB0L,EAAIknC,eACJvd,EAAMv5B,EAAM6Q,YAAYu3B,aAAax4B,EAAIumC,KAAKjyC,QAElDgvB,EAASosD,YACLE,aAAc,SAAUlxC,GAAV,GACN6H,GAAOvmC,EAAIumC,KAAwB,EAAjBvmC,EAAIumC,KAAKjyC,MAAY,EACvCwyC,EAAK9mC,EAAI8mC,GAAoB,EAAf9mC,EAAI8mC,GAAGxyC,MAAY,CAErC,OADAoqC,GAA8C,EAAvCtuC,EAAM6Q,YAAYmiB,aAAasb,IAC9BtuC,EAAM6Q,YAAY+N,WAAWg4B,oBAAoBhnC,EAAIknC,cAAcxI,EAAM6H,EAAMO,IAE3Fld,IAAKA,EACLD,IAAKA,KAGTrG,EAASosD,YACLE,aAAc,KACdhmD,IAAK,KACLD,IAAK,OAGbnS,EAAMtG,OAzDV,GAAIkxB,GAAS9e,EAAU9L,CA2DvB,QACI+xD,KAAM,SAAU94E,GACZ2xC,EAAU3xC,EACVygB,KAEJ0yD,KAAM,kBAGdyL,EAAe,mBAAoB,WAE/B,QAASx1E,KACAuc,IACDA,EAAOpkB,EAAE,gCAAkC69E,iBACvCh5D,SAAU,WACVL,YAAY,EACZD,UAAU,IAEdiB,EAAQxlB,EAAE,SAASu9E,aACnBn5D,EAAKnW,SAASuX,GACdA,EAAQA,EAAMi4D,gBACdr5D,EAAOA,EAAK05D,qBACZ15D,EAAKzT,KAAK,SAAU,WAChB6U,EAAMvG,OACN,IAAIuoC,GAAOpjC,EAAK9hB,QAAQ,EACpBklD,IACApX,EAAQ//B,SAASm3C,EAAKllD,UAIlCkjB,EAAMk4D,YAAah4D,OAAQ0qB,EAAQhqB,KAAKjM,QAAQ0qB,KAAK,kCAEzD,QAAS3lB,KAAT,GAEQ+xC,GACA/nD,EAAWonC,EAQX3rB,CAVJ9c,KACIopD,EAAQ7gB,EAAQpzB,WAAWu3B,KAAKjyC,MAChC4G,KAAWonC,EAAM,SAAU/sB,GACvBra,EAAKnK,MAAOuD,MAAOihB,KAEvB0tC,YAAiB7yD,GAAM6Q,YAAY4D,KAAK0M,QAAQ6jB,OAChD6tB,EAAMvnB,KAAK4G,IAEV2gB,EAAQ,IAAItsD,MAAM,WAAW6L,QAAQ8/B,GAEtC3rB,EAAa,GAAIvmB,GAAM8K,KAAKib,YAAajb,KAAMA,IACnDkb,EAAKi1B,cAAc10B,GACnBA,EAAWo5D,OACXv4D,EAAMtG,OApCV,GAAIkxB,GAAShsB,EAAMoB,CAsCnB,QACI+xD,KAAM,SAAU94E,GACZ2xC,EAAU3xC,EACVygB,KAEJ0yD,KAAM,yBAGhB7vE,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,oBACH,aACA,0BACDD,IACL,YACG,SAAUE,GAAV,GAIO21B,GACAC,EACAC,EACAgoD,EA8BA1jC,EAmGAylC,CAvIA5/E,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9D+kB,EAAU31B,EAAM6Q,YAAY8kB,QAC5BC,EAAW51B,EAAM6Q,YAAY+kB,SAC7BC,EAAW71B,EAAM6Q,YAAYglB,SAC7BgoD,EAAY79E,EAAM4D,MAAMzD,QACxBC,KAAM,SAAUgd,EAAMM,EAAK3a,EAAOC,GAC9BxC,KAAK4c,KAAOA,EACZ5c,KAAKuC,MAAQA,EACbvC,KAAK8c,MAAQF,EAAOra,EACpBvC,KAAKkd,IAAMA,EACXld,KAAKwC,OAASA,EACdxC,KAAKmd,OAASD,EAAM1a,GAExB+xE,OAAQ,SAAU33D,EAAMM,GACpB,MAAO,IAAImgE,GAAUr9E,KAAK4c,KAAOA,EAAM5c,KAAKkd,IAAMA,EAAKld,KAAKuC,MAAOvC,KAAKwC,SAE5Ema,OAAQ,SAAUpa,EAAOC,GACrB,MAAO,IAAI66E,GAAUr9E,KAAK4c,KAAM5c,KAAKkd,IAAKld,KAAKuC,MAAQA,EAAOvC,KAAKwC,OAASA,IAEhFutB,WAAY,SAAUvnB,EAAGimB,GACrB,MAAOzuB,MAAK4c,KAAOpU,GAAKA,EAAIxI,KAAK4c,KAAO5c,KAAKuC,OAASvC,KAAKkd,IAAMuR,GAAKA,EAAIzuB,KAAKkd,IAAMld,KAAKwC,QAE9Fs7E,MAAO,SAAU/4C,GACb,MAAOvlC,GAAMmkD,IAAIpoC,QAAQ,OACrBwpB,UAAWA,EACXpiC,OACIJ,MAAOvC,KAAKuC,MAAQ,KACpBC,OAAQxC,KAAKwC,OAAS,KACtB0a,IAAKld,KAAKkd,IAAM,KAChBN,KAAM5c,KAAK4c,KAAO,WAK9B+8B,EAAOn6C,EAAM4D,MAAMzD,QACnBC,KAAM,SAAU4X,EAAMC,EAASyb,EAAUC,EAAa+lB,EAAcC,GAChEn5C,KAAKkzB,SAAWA,EAChBlzB,KAAKmzB,YAAcA,EACnBnzB,KAAK88B,SAAWrlB,EAChBzX,KAAKm9B,MAAQ3lB,EACbxX,KAAKg3E,cAAgB99B,EACrBl5C,KAAK22E,aAAex9B,GAExBwF,OAAQ,SAAUjtC,GAAV,GAEA2C,GACAkiB,CACJ,OAHA7kB,GAAMA,EAAII,aACNuC,EAAU3C,EAAI2C,QACdkiB,EAAc7kB,EAAI6kB,YACC,IAAhBliB,EAAQC,KAAaiiB,EAAYjiB,MAAQtU,KAAKkzB,SAAW,GAAqB,IAAhB7e,EAAQS,KAAayhB,EAAYzhB,MAAQ9U,KAAKmzB,YAAc,GAErI5wB,MAAO,SAAUmtB,EAAOjP,GACpB,MAAOzgB,MAAK88B,SAAS0N,IAAI9a,EAAOjP,IAEpCje,OAAQ,SAAUktB,EAAOjP,GACrB,MAAOzgB,MAAKm9B,MAAMqN,IAAI9a,EAAOjP,IAEjCs3D,YAAa,WACT,MAAO/3E,MAAKm9B,MAAMkiD,MAAQr/E,KAAKg3E,eAEnCgB,WAAY,WACR,MAAOh4E,MAAK88B,SAASuiD,MAAQr/E,KAAK22E,cAEtClsE,MAAO,SAAU6J,EAAKoG,GAClB,MAAOA,GAAS1a,KAAKkzB,SAAW5e,GAEpCkoC,QAAS,SAAU/xC,GACf,MAAO,IAAI0qB,GAAQ1qB,EAAQzK,KAAKkzB,SAAUzoB,EAAQzK,KAAKkzB,UAAY,IAEvE8K,OAAQ,SAAU1pB,GACd,MAAO,IAAI8gB,GAAS,GAAID,GAAQ7gB,EAAK,GAAI,GAAI6gB,GAAQ7gB,EAAKtU,KAAKmzB,YAAc,KAEjF8K,OAAQ,SAAUnpB,GACd,MAAO,IAAIsgB,GAAS,GAAID,GAAQ,EAAGrgB,GAAM,GAAIqgB,GAAQn1B,KAAKkzB,SAAW,EAAGpe,KAE5E2mC,aAAc,SAAU/pC,GACpB,MAAO1R,MAAKyK,MAAMiH,EAAI4C,IAAK5C,EAAIoD,MAEnCijB,UAAW,SAAUrmB,GACjB,MAAIA,aAAe0jB,GACR,GAAIA,GAASp1B,KAAK+3B,UAAUrmB,EAAI2C,SAAUrU,KAAK+3B,UAAUrmB,EAAI6kB,cAAczL,SAASpZ,EAAIG,MAAOH,EAAI4jB,YAE1G5jB,YAAe2jB,GACR3jB,EAAI/N,IAAI,SAAU+N;AACrB,MAAO1R,MAAK+3B,UAAUrmB,IACvB1R,OAEH0R,YAAeyjB,KACfzjB,EAAMA,EAAIkZ,QACVlZ,EAAIoD,IAAM6Z,KAAKoK,IAAI,EAAGpK,KAAKqK,IAAIh5B,KAAKmzB,YAAc,EAAGzhB,EAAIoD,MACzDpD,EAAI4C,IAAMqa,KAAKoK,IAAI,EAAGpK,KAAKqK,IAAIh5B,KAAKkzB,SAAW,EAAGxhB,EAAI4C,OAEnD5C,IAEXuY,UAAW,SAAUvY,GAAV,GACH2C,GAAUrU,KAAK+3B,UAAUrmB,EAAI2C,SAC7BkiB,EAAcv2B,KAAK+3B,UAAUrmB,EAAI6kB,YACrC,OAAO,IAAI8mD,GAAUr9E,KAAKuC,MAAM,EAAG8R,EAAQS,IAAM,GAAI9U,KAAKwC,OAAO,EAAG6R,EAAQC,IAAM,GAAItU,KAAKuC,MAAM8R,EAAQS,IAAKyhB,EAAYzhB,KAAM9U,KAAKwC,OAAO6R,EAAQC,IAAKiiB,EAAYjiB,OAEzKm3D,KAAM,SAAU5rE,GACZ,MAAO,IAAIu/E,GAAS,GAAI5/E,GAAM6Q,YAAYivE,SAASt/E,KAAKm9B,MAAOt9B,EAAQyU,IAAKzU,EAAQqzB,SAAUlzB,KAAKg3E,eAAgB,GAAIx3E,GAAM6Q,YAAYivE,SAASt/E,KAAK88B,SAAUj9B,EAAQ6a,OAAQ7a,EAAQszB,YAAanzB,KAAK22E,cAAe32E,OAE9Nk6E,gBAAiB,SAAUqF,GACvB,OACI/nE,KAAMxX,KAAKm9B,MAAMp1B,OAAOwpB,SAASguD,EAASlrE,QAAQC,IAAKirE,EAAShpD,YAAYjiB,KAC5EmD,QAASzX,KAAK88B,SAAS/0B,OAAOwpB,SAASguD,EAASlrE,QAAQS,IAAKyqE,EAAShpD,YAAYzhB,OAG1FlD,QAAS,SAAUF,EAAKD,GAAf,GAGIwyB,GACID,EAHT3vB,EAAUrU,KAAK+3B,UAAUrmB,EAAI2C,SAC7BkiB,EAAcv2B,KAAK+3B,UAAUrmB,EAAI6kB,YACrC,KAAS0N,EAAK5vB,EAAQS,IAAKmvB,GAAM1N,EAAYzhB,IAAKmvB,IAC9C,IAASD,EAAK3vB,EAAQC,IAAK0vB,GAAMzN,EAAYjiB,IAAK0vB,IAC9CvyB,EAAS,GAAI0jB,GAAQ6O,EAAIC,KAIrC2a,KAAM,SAAUltC,EAAKjB,GAAf,GAKOwzB,GACDvU,EACAjP,EACA1Y,EAEIgN,EATRV,EAAUrU,KAAK+3B,UAAUrmB,EAAI2C,SAC7BkiB,EAAcv2B,KAAK+3B,UAAUrmB,EAAI6kB,aACjC4D,EAAiB9lB,EAAQC,IACzB8lB,EAAiB/lB,EAAQS,GAC7B,KAASmvB,EAAK5vB,EAAQS,IAAKmvB,GAAM1N,EAAYzhB,IAAKmvB,IAC1CvU,EAAQ1vB,KAAKyK,MAAM4J,EAAQC,IAAK2vB,GAChCxjB,EAAMzgB,KAAKyK,MAAM8rB,EAAYjiB,IAAK2vB,GAClCl8B,EAAS0I,EAASuf,KAAKH,aAAaH,EAAOjP,GAC3C1Y,EAAOlH,SACHkU,EAAO/U,KAAKw8C,QAAQz0C,EAAOA,EAAOlH,OAAS,GAAG4f,KAClD0Z,EAAiBxL,KAAKoK,IAAIoB,EAAgBplB,EAAKT,KAC/C8lB,EAAiB6J,EAGzB,OAAO,IAAI7O,GAAS1jB,EAAI2C,QAAS,GAAI8gB,GAAQxG,KAAKqK,IAAImB,EAAgBzoB,EAAI6kB,YAAYjiB,KAAM8lB,OAGhGglD,EAAW5/E,EAAM4D,MAAMzD,QACvBC,KAAM,SAAU4X,EAAMC,EAAS2jB,GAC3Bp7B,KAAKwX,KAAOA,EACZxX,KAAKyX,QAAUA,EACfzX,KAAKq7B,MAAQD,EACbp7B,KAAKk5C,aAAe1hC,EAAKgoE,WACzBx/E,KAAKm5C,YAAc1hC,EAAQ+nE,WAC3Bx/E,KAAK47E,aAAenkE,EAAQgoE,UAC5Bz/E,KAAK+7E,gBAAkBvkE,EAAKioE,WAEhCpe,QAAS,SAAU9+D,EAAOC,GAAjB,GAGDgG,GACAimB,CAHJzuB,MAAKyX,QAAQ66D,SAAS/vE,GACtBvC,KAAKwX,KAAK86D,SAAS9vE,GACfgG,EAAIxI,KAAKyX,QAAQioE,cACjBjxD,EAAIzuB,KAAKwX,KAAKkoE,cAClB1/E,KAAK4c,KAAOpU,EAAE+rE,OACdv0E,KAAKkd,IAAMuR,EAAE8lD,OACbv0E,KAAK8c,MAAQtU,EAAE+rE,OAAS/rE,EAAE3H,OAC1Bb,KAAKmd,OAASsR,EAAE8lD,OAAS9lD,EAAE5tB,OAC3Bb,KAAK2C,OACDua,IAAKuR,EAAE8lD,OAAS,KAChB33D,KAAMpU,EAAE+rE,OAAS,KACjB/xE,OAAQisB,EAAE5tB,OAAS,KACnB0B,MAAOiG,EAAE3H,OAAS,OAG1B2mB,KAAM,SAAU5K,EAAMM,GAAhB,GACE1F,GAAOxX,KAAKwX,KAAKiQ,QAAQvK,GACzBzF,EAAUzX,KAAKyX,QAAQgQ,QAAQ7K,EACnC,QACIpF,KAAMA,EACNC,QAASA,EACTokE,UAAWrkE,EAAK+8D,OAChByH,aAAcvkE,EAAQ88D,OACtB+J,eAAgB7mE,EAAQiY,MACxB6uD,cAAe/mE,EAAKkY,MACpBhe,IAAK,GAAI0jB,GAAS,GAAID,GAAQ3d,EAAKzP,OAAO2nB,MAAOjY,EAAQ1P,OAAO2nB,OAAQ,GAAIyF,GAAQ3d,EAAKzP,OAAO0Y,IAAKhJ,EAAQ1P,OAAO0Y,QAG5HyX,SAAU,SAAUxmB,GAChB,MAAO1R,MAAKwX,KAAK0gB,SAASxmB,EAAI2C,QAAQC,IAAK5C,EAAI6kB,YAAYjiB,MAAQtU,KAAKyX,QAAQygB,SAASxmB,EAAI2C,QAAQS,IAAKpD,EAAI6kB,YAAYzhB,MAE9HrK,MAAO,SAAU6J,EAAKoG,GAClB,MAAO1a,MAAKq7B,MAAM5wB,MAAM6J,EAAKoG,IAEjC+7D,kBAAmB,SAAU/kE,GACzB,MAAO1R,MAAKq7B,MAAMpR,UAAUvY,IAEhC+pC,aAAc,SAAU/pC,GACpB,MAAO1R,MAAKq7B,MAAMogB,aAAa/pC,IAEnC8mE,iBAAkB,SAAUzjE,GAAV,GACVqU,GAAWppB,KAAKy2E,kBAAkB1hE,GAClCm5D,GACAhxD,IAAKyR,KAAKoK,IAAI,EAAG3P,EAASlM,IAAMld,KAAKkd,KAAOld,KAAK+7E,gBAAkB,EAAI/7E,KAAKk5C,eAC5Et8B,KAAM+R,KAAKoK,IAAI,EAAG3P,EAASxM,KAAO5c,KAAK4c,MAAQ5c,KAAK47E,aAAe,EAAI57E,KAAKm5C,cAC5Er8B,MAAOsM,EAAStM,MAAQ9c,KAAKyX,QAAQkoE,UAAY3/E,KAAKm5C,YACtDh8B,OAAQiM,EAASjM,OAASnd,KAAKwX,KAAKmoE,UAAY3/E,KAAKk5C,cAErD0mC,EAAoB5/E,KAAKyX,QAAQooE,aAAe,EAChDC,EAAqB9/E,KAAKwX,KAAKqoE,aAAe,CAKlD,OAJA3R,GAAWrB,UAAYqB,EAAWhxD,IAAM4iE,EACxC5R,EAAWuK,aAAevK,EAAW/wD,OAAS2iE,EAC9C5R,EAAWlnB,WAAaknB,EAAWtxD,KAAOgjE,EAC1C1R,EAAWN,YAAcM,EAAWpxD,MAAQ8iE,EACrC1R,KAGf1uE,EAAM6Q,YAAYspC,KAAOA,EACzBn6C,EAAM6Q,YAAY+uE,SAAWA,EAC7B5/E,EAAM6Q,YAAYgtE,UAAYA,IAChC79E,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,oBAAqB,cAAeD,IAC7C,YACG,SAAUE,GAAV,GAIO65C,GA6NAimC,CAhOA9/E,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DipC,EAAO75C,EAAM4D,MAAMzD,QACnBC,KAAM,SAAU2d,EAAO7Z,GACnB1D,KAAKkS,OAASxO,EACd1D,KAAKoiC,OAAS7kB,EACdvd,KAAK+H,OAAS,GAAIvI,GAAM6Q,YAAY8f,UAAU,EAAG5S,EAAQ,EAAG7Z,GAC5D1D,KAAK+/E,QAAU,GAAIvgF,GAAM6Q,YAAY8f,UAAU,EAAG5S,EAAQ,EAAG,GAC7Dvd,KAAKggF,cAAgBxgF,EAAMyQ,QAAQupE,YACnCx5E,KAAKugD,YAET9qB,OAAQ,SAAU/F,EAAOhb,GACjBA,EAAQ,GACR1U,KAAK+H,OAAO0R,KAAKiW,EAAQhb,EAAO1U,KAAKoiC,OAAS,EAAG1S,GACjD1vB,KAAK+/E,QAAQtmE,KAAKiW,EAAQhb,EAAO1U,KAAKoiC,OAAS,EAAG1S,KAElD1vB,KAAK+H,OAAO0R,KAAKiW,EAAO1vB,KAAKoiC,OAAQ1S,EAAQhb,GAC7C1U,KAAK+/E,QAAQtmE,KAAKiW,EAAO1vB,KAAKoiC,OAAQ1S,EAAQhb,GAC9C1U,KAAK+H,OAAOrE,MAAMgsB,EAAOA,EAAQhb,EAAQ,EAAG1U,KAAKkS,QACjDlS,KAAK+/E,QAAQr8E,MAAMgsB,EAAOA,EAAQhb,EAAQ,EAAG,IAEjD1U,KAAKugD,YAETlY,OAAQ,SAAUve,EAAO41B,GAAjB,GAGKt1B,GACD1mB,EACAo3C,EAIA1xB,EAGIw/B,EAXR7gD,KACAwpB,EAAWvxB,KAAK+H,OAAOwpB,SAAS,EAAGvxB,KAAKoiC,OAAS,EACrD,KAAShY,EAAM,EAAGA,EAAMpqB,KAAKoiC,OAAQhY,IAC7B1mB,EAAQ6tB,EAASE,GAAGrH,GACpB0wB,EAAS96C,KAAK+/E,QAAQr8E,MAAM0mB,EAAKA,IACjC1mB,IAAU1D,KAAKkS,QAAW4oC,KAG1B1xB,EAAWs2B,EAAUt1B,GACR3c,SAAb2b,IACAA,EAAWrhB,EAAOlH,OACd+nD,GAASn+C,MAAO2f,GACpBw+B,EAAK9+B,GAASpmB,EACVo3C,IACA8N,EAAK9N,OAASA,GAElB/yC,EAAO5H,KAAKyoD,GACZlJ,EAAUt1B,GAAOhB,GAGzB,OAAOrhB,IAEX4rB,SAAU,SAAU7J,EAAO/hB,GAAjB,GACGqiB,GACDzF,EACAla,EAIA/G,CANR,KAAS0mB,EAAM,EAAGA,EAAMriB,EAAOlH,OAAQupB,IAC/BzF,EAAK5c,EAAOqiB,GACZ3f,EAAQka,EAAGla,MACDgD,SAAVhD,IACAA,EAAQ2f,GAER1mB,EAAQihB,EAAGmF,GACD,IAAVpmB,GACIihB,EAAGm2B,QACH96C,KAAK0D,MAAM+G,EAAOA,EAAOka,EAAGm2B,QAEhC96C,KAAKgqB,KAAKvf,IAEVzK,KAAK0D,MAAM+G,EAAOA,EAAO/G,IAIrCsmB,KAAM,SAAUvf,GACZ,IAAKzK,KAAK86C,OAAOrwC,GAAQ,CACrB,GAAI/G,GAAQ1D,KAAK0D,MAAM+G,EAAOA,EAC9BzK,MAAK+/E,QAAQr8E,MAAM+G,EAAOA,EAAO/G,GACjC1D,KAAK0D,MAAM+G,EAAOA,EAAO,KAGjCqwC,OAAQ,SAAUrwC,GACd,MAA4C,KAArCzK,KAAK+/E,QAAQr8E,MAAM+G,EAAOA,IAErCk3B,eAAgB,SAAUjS,EAAOjP,GAC7B,MAAOzgB,MAAK+/E,QAAQlwD,aAAaH,EAAOjP,GAAK5f,OAAS,GAE1D67B,YAAa,SAAUjyB,GAEnB,IADA,GAAIgW,GAAMzgB,KAAKoiC,OAAS,EAAGjgC,EAAIsI,IACtBtI,GAAKse,GACV,IAAKzgB,KAAK86C,OAAO34C,GACb,MAAOA,EAGf,OAAOsI,IAEXu0B,SAAU,SAAUv0B,EAAOw1E,GACvB,MAAOjgF,MAAKyK,MAAMzK,KAAKwqC,IAAI,EAAG//B,EAAQ,GAAKw1E,IAE/ClhD,SAAU,SAAUt0B,EAAOw1E,GACvB,MAAOjgF,MAAKyK,MAAMzK,KAAKwqC,IAAI,EAAG//B,GAASw1E,IAE3ChhD,aAAc,WACV,GAAIihD,GAAclgF,KAAK+/E,QAAQxvD,OAC/B,OAA0B,KAAtB2vD,EAAYx8E,MACL,EAEAw8E,EAAYz/D,IAAM,GAGjCye,YAAa,WACT,GAAIihD,GAAangF,KAAK+/E,QAAQvvD,MAC9B,OAAyB,KAArB2vD,EAAWz8E,MACJ1D,KAAKoiC,OAAS,EAEd+9C,EAAWzwD,MAAQ,GAGlC8M,YAAa,SAAU/xB,GAEnB,IADA,GAAItI,GAAIsI,IACCtI,GAAK,GACV,IAAKnC,KAAK86C,OAAO34C,GACb,MAAOA,EAGf,OAAOsI,IAEXowC,OAAQ,SAAUpwC,GACd,GAAIzK,KAAK86C,OAAOrwC,GAAQ,CACpB,GAAI/G,GAAQ1D,KAAK+/E,QAAQr8E,MAAM+G,EAAOA,EACtCzK,MAAK+/E,QAAQr8E,MAAM+G,EAAOA,EAAO,GACjCzK,KAAK0D,MAAM+G,EAAOA,EAAO/G,KAGjCA,MAAO,SAAUgsB,EAAOjP,EAAK/c,GACzB,MAAc+J,UAAV/J,EAIO1D,KAAK+H,OAAOwpB,SAAS7B,EAAOjP,GAAKgR,GAAG,IAH3CzxB,KAAK+H,OAAOrE,MAAMgsB,EAAOjP,EAAK/c,OAC9B1D,MAAKugD,aAKb/V,IAAK,SAAU9a,EAAOjP,GAAjB,GAGQ2J,GAFLriB,EAAS/H,KAAK+H,OAAOwpB,SAAS7B,EAAOjP,GACrC+pB,EAAM,CACV,KAASpgB,EAAMsF,EAAOtF,GAAO3J,EAAK2J,IAC9BogB,GAAOziC,EAAO0pB,GAAGrH,EAErB,OAAOogB,IAEXqsC,OAAQ,SAAUnnD,EAAOjP,EAAK0lB,GAAtB,GAGK/b,GAEDhb,EAJJrH,EAAS/H,KAAK+H,OAAOwpB,SAAS7B,EAAOjP,GACrC+pB,EAAM,CACV,KAASpgB,EAAMsF,EAAOtF,GAAO3J,EAAK2J,IAG9B,GAFAogB,GAAOziC,EAAO0pB,GAAGrH,GACbhb,EAAM+2B,EAAUqE,GAEhB,MAAOpgB,EAGf,OAAO,OAEX3C,QAAS,SAAUiI,EAAOjP,GAAjB,GAODqP,GASAxL,EACA87D,EACA7L,EACAhwD,EACA87D,EAnBAC,EAAe,KACfC,EAAa,KACbC,GAAW,CAOf,OANI//D,IAAOzgB,KAAKq/E,MAAQr/E,KAAKggF,gBACzBQ,GAAW,GAEX1wD,EAAS9vB,KAAKygF,aAAa5wD,aAAaH,EAAOjP,GACnD6/D,EAAexwD,EAAO,GACtBywD,EAAazwD,EAAOA,EAAOjvB,OAAS,GAC/By/E,GAMDh8D,EAAcoL,EAAQ4wD,EAAa5wD,MACnC0wD,GAAc97D,EAAcg8D,EAAa58E,MAAMA,OAAS,GAAK48E,EAAa58E,MAAMgsB,MAChF6kD,EAASjwD,GAAe87D,EAAaE,EAAa58E,MAAMgsB,OAAS4wD,EAAa58E,MAAMA,MACpF6gB,EAAY9D,EAAM8/D,EAAW7wD,MAC7B2wD,GAAY97D,EAAYg8D,EAAW78E,MAAMA,OAAS,GAAK68E,EAAW78E,MAAMgsB,MACxE2wD,EAAWE,EAAW78E,MAAM+c,MAC5B4/D,EAAWE,EAAW78E,MAAM+c,KAE5B+/D,IACAjM,GAAUgM,EAAW78E,MAAMA,OAAS6gB,GAAa87D,EAAWE,EAAW78E,MAAMgsB,OAAS6wD,EAAW78E,MAAMA,QAE3G6wE,EAAS5lD,KAAKqK,KAAKu7C,EAAQ,IAEvBxsE,OAAQ/H,KAAK+H,OAAOwpB,SAAS6uD,EAAYC,GACzC9L,OAAQA,KAlBJxsE,OAAQ/H,KAAK+H,OAAOwpB,SAAS,EAAG,GAChCgjD,OAAQ,IAoBpB9pE,MAAO,SAAU/G,GAIb,IAJG,GACC+G,GAAQ,EACR8mB,EAAWvxB,KAAK+H,OAAOwpB,SAAS,EAAGvxB,KAAKoiC,OAAS,GACjDt/B,EAAUyuB,EAASE,GAAG,GACnB3uB,EAAUY,GAAS+G,EAAQzK,KAAKoiC,OAAS,GAC5Ct/B,GAAWyuB,EAASE,KAAKhnB,EAE7B,OAAOA,IAEXmtE,aAAc,SAAUl0E,GACpB,GAAI+G,GAAQzK,KAAKyK,MAAM/G,EAIvB,OAHI1D,MAAK86C,OAAOrwC,KACZA,EAAQzK,KAAKw8B,YAAY/xB,IAEtBA,GAEX81C,SAAU,WACN,GAAIz9C,GAAU,CACd9C,MAAKygF,aAAezgF,KAAK+H,OAAOpE,IAAI,SAAUgN,GAAV,GAG5B8P,GAFAiP,EAAQ5sB,CAGZ,OAFAA,KAAY6N,EAAM8P,IAAM9P,EAAM+e,MAAQ,GAAK/e,EAAMjN,MAC7C+c,EAAM3d,EAAU,EACb,GAAItD,GAAM6Q,YAAYshB,WAAWjC,EAAOjP,EAAK9P,KAExD3Q,KAAKq/E,MAAQv8E,GAEjBkO,SAAU,WACN,OACIjJ,OAAQ/H,KAAK+H,OAAOiJ,WACpB8pC,OAAQ96C,KAAK+/E,QAAQ/uE,aAG7BD,SAAU,SAAUE,GAChBjR,KAAK+H,OAAOgJ,SAASE,EAAMlJ,QAC3B/H,KAAK+/E,QAAQhvE,SAASE,EAAM6pC,QAC5B96C,KAAKugD,cAGT++B,EAAW9/E,EAAM4D,MAAMzD,QACvBC,KAAM,SAAU8b,EAAMgU,EAAOnS,EAAOiiE,GAChCx/E,KAAK+9E,MAAQriE,EACb1b,KAAKk9E,OAASxtD,EACd1vB,KAAKoiC,OAAS7kB,EACdvd,KAAKy/E,UAAsB,IAAV/vD,EACjB1vB,KAAKw/E,WAAaA,EAClBx/E,KAAK6/E,aAAenkE,EAAKxJ,OACzBlS,KAAK42E,OAASr5D,EAAQ,GAE1B+0D,SAAU,SAAUA,GAChBtyE,KAAK2/E,UAAYrN,GAErB9nC,IAAK,SAAU9a,EAAOjP,GAClB,MAAOzgB,MAAK+9E,MAAMvzC,IAAI9a,EAAOjP,EAAM,IAEvCiP,MAAO,WACH,MAAO1vB,MAAKwqC,IAAI,EAAGxqC,KAAKk9E,SAE5B75E,KAAM,WACF,MAAOrD,MAAKwqC,IAAIxqC,KAAKk9E,OAAQl9E,KAAKk9E,OAASl9E,KAAKoiC,SAEpD33B,MAAO,SAAU/G,EAAO6wE,GACpB,MAAOv0E,MAAK+9E,MAAMtzE,MAAM/G,GAAS1D,KAAK42E,OAAS,EAAIrC,GAAUv0E,KAAKw/E,aAEtE5H,aAAc,SAAUl0E,EAAO6wE,GAC3B,MAAOv0E,MAAK+9E,MAAMnG,aAAal0E,GAAS1D,KAAK42E,OAAS,EAAIrC,GAAUv0E,KAAKw/E,aAE7EE,YAAa,WAAA,GAEL7+E,GADA0zE,EAASv0E,KAAK0vB,OAelB,OAbK1vB,MAAKy/E,YACNlL,GAAUv0E,KAAKw/E,YAEfx/E,KAAK42E,QACL/1E,EAASb,KAAKqD,OACVrD,KAAKy/E,UACL5+E,GAAUb,KAAKw/E,WAEf3+E,GAAUb,KAAKw/E,YAGnB3+E,EAASb,KAAK2/E,UAAYpL,GAG1BA,OAAQA,EACR1zE,OAAQA,IAGhB4mB,QAAS,SAAU8sD,GAAV,GAEDlxE,GAUAwC,EAXA6pB,EAAQ1vB,KAAK0vB,OAoBjB,OAlBI1vB,MAAK42E,QACLvzE,EAAOrD,KAAKqD,OACPrD,KAAKy/E,YACNp8E,GAAQrD,KAAKw/E,cAGjBn8E,EAAOrD,KAAK2/E,UAAYjwD,EAAQ1vB,KAAKw/E,WACrC9vD,GAAS6kD,GAET1uE,EAAS7F,KAAK+9E,MAAMt2D,QAAQiI,EAAOA,EAAQrsB,EAAO,GAClDrD,KAAK42E,SACL/wE,EAAO0uE,OAAS,GAEpB1uE,EAAO6pB,MAAQA,EACX1vB,KAAKy/E,YACL55E,EAAO0uE,QAAUv0E,KAAKw/E,WACtB35E,EAAO6pB,OAAS1vB,KAAKw/E,YAElB35E,GAEXqyB,SAAU,SAAUxI,EAAOjP,GACvB,MAAIzgB,MAAK42E,SACDlnD,EAAQ1vB,KAAKk9E,OAASl9E,KAAKoiC,WAG3B3hB,EAAMzgB,KAAKk9E,QAKRz8D,GAAOzgB,KAAKk9E,UAI/B19E,EAAM6Q,YAAYgpC,KAAOA,EACzB75C,EAAM6Q,YAAYivE,SAAWA,IAC/B9/E,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,sBACH,aACA,cACDD,IACL,YACG,SAAUE,GA+TP,QAASkhF,GAAQh9E,GACb,GAAImqC,GAAQnqC,EAAM2sC,WAAa,CAC/B,OAAIxC,IAAS,GAAKA,GAAS,EAChB,EACAA,GAAS,GAAKA,GAAS,EACvB,EACAA,GAAS,GAAKA,GAAS,EACvB,EAEA,EAGf,QAAS8yC,GAASj9E,EAAO6wE,GACrB,GAAI7wE,YAAiBoG,MAAM,CACvB,GAAI82E,GAAQphF,EAAMsuC,KAAK8yC,OAEvB,OADAA,GAAMC,YAAYD,EAAMxwC,cAAgBmkC,GACjCqM,EAAMxwC,gBAAkB1sC,EAAM0sC,cAEzC,OAAO,EAEX,QAAS0wC,GAAUp9E,EAAO6wE,GACtB,GAAI7wE,YAAiBoG,MAAM,CACvB,GAAI82E,GAAQphF,EAAMsuC,KAAKizC,gBAAgBvhF,EAAMsuC,KAAK8yC,QAElD,OADAA,GAAMI,SAASJ,EAAMvwC,WAAakkC,EAAQ,GACnCqM,EAAM72E,YAAcvK,EAAMsuC,KAAKizC,gBAAgBr9E,GAAOqG,UAEjE,OAAO,EAEX,QAASk3E,GAASl2E,EAAGiZ,GAArB,GAEYk9D,GACAC,CAFR,OAAIn9D,aAAala,QACTo3E,EAAY1hF,EAAMsuC,KAAKszC,UAAU5hF,EAAMsuC,KAAKwC,QAAQvlC,GAAI,GACxDo2E,EAAa3hF,EAAMsuC,KAAKszC,UAAU5hF,EAAMsuC,KAAKwC,QAAQtsB,GAAI,GACtDk9D,EAAUn3E,YAAco3E,EAAWp3E,WA9VlD,KAAIvK,EAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,GAAlE,CAGA,GAAIgwC,GAAS5gD,EAAM6Q,YAAY+vC,OAAS5gD,EAAM4D,MAAMzD,QAChDmhD,QAAS,aAETp9C,MAAO,SAAUqR,GACb,MAAOA,GAAKrR,OAEhBq9C,QAAS,WACL,KAAUn2C,OAAM,6CAEpBy9B,OAAQ,WACJ,KAAUz9B,OAAM,6CAGxBw1C,GAAOn3C,OAAS,SAAUpJ,GAAV,GAKRqrC,GAJA3wB,EAAS1a,EAAQ0a,MACrB,KAAKA,EACD,KAAU3P,OAAM,6BAGpB,IADIsgC,EAAc1rC,EAAM6Q,YAAYkK,EAAO1R,OAAO,GAAGwc,cAAgB9K,EAAO8R,UAAU,GAAK,WACtF6e,EACD,KAAUtgC,OAAM,8BAEpB,OAAO,IAAIsgC,GAAYrrC,IAE3BL,EAAM6Q,YAAY8K,YAAcilC,EAAOzgD,QACnC0hF,WACAC,UACAC,SAAS,EACT3hF,KAAM,SAAqBC,GACA4N,SAAnB5N,EAAQkI,SACR/H,KAAKqhF,QAAUxhF,EAAQkI,QAEJ0F,SAAnB5N,EAAQk4D,SACR/3D,KAAKuhF,QAAU1hF,EAAQk4D,QAELtqD,SAAlB5N,EAAQ2hF,QACRxhF,KAAKshF,OAASzhF,EAAQ2hF,QAG9B99E,MAAO,SAAUqR,GAAV,GAGKxD,GAFJ7N,EAAQqR,EAAKrR,KAOjB,OANI1D,MAAKshF,OAAOzgF,OAAS,GAAKkU,EAAKC,QAA2B,gBAAVtR,KAC5C6N,EAAO/R,EAAM6Q,YAAYsE,WAAWpD,KAAK7N,EAAOqR,EAAKC,QAC5C,SAATzD,IACA7N,EAAQlE,EAAM6Q,YAAYu3B,aAAalkC,KAGxCA,GAEXq9C,QAAS,SAAUr9C,GACf,MAAc,QAAVA,GAA4B+J,SAAV/J,EACX1D,KAAKuhF,QAEZ79E,YAAiBoG,MACV9J,KAAKshF,OAAOjpD,KAAK,SAAUyV,GAC9B,QAAOA,EAAKF,OAASlqC,EAAM0sC,eAAiC3iC,SAAfqgC,EAAKD,OAAuBC,EAAKD,QAAUnqC,EAAM2sC,YAA6B5iC,SAAbqgC,EAAKC,KAAqBD,EAAKC,MAAQrqC,EAAM4sC,WAA8B7iC,SAAfqgC,EAAKkB,OAAuBlB,EAAKkB,QAAUtrC,EAAMssC,YAAiCviC,SAAjBqgC,EAAKmB,SAAyBnB,EAAKmB,UAAYvrC,EAAMusC,cAAmCxiC,SAAjBqgC,EAAKoB,SAAyBpB,EAAKoB,UAAYxrC,EAAMwsC,gBAGxWlwC,KAAKqhF,QAAQh0D,QAAQ3pB,IAAU,GAE1C2kC,OAAQ,WACJ,OACI9tB,OAAQ,QACRw9C,OAAQ/3D,KAAKuhF,QACbx5E,OAAQ/H,KAAKqhF,QAAQ/gF,MAAM,OAIvCd,EAAM6Q,YAAYgL,aAAe+kC,EAAOzgD,QACpC8hF,OAAQ,MACR7hF,KAAM,SAAsBC,GAIxB,GAHsB4N,SAAlB5N,EAAQg4D,QACR73D,KAAKyhF,OAAS5hF,EAAQg4D,OAEDpqD,SAArB5N,EAAQi4D,SACR,KAAUltD,OAAM,yBAEpB5K,MAAK0hF,UAAY7hF,EAAQi4D,QACzB,IAAI6pB,GAAaniF,EAAM8K,KAAKs3E,MAAMC,YAC9BhqB,MAAO73D,KAAKyhF,OACZ5sB,QAAS70D,KAAK0hF,YACfC,UACH3hF,MAAK8hF,SAAev1C,SAAS,IAAK,UAAYo1C,IAElD5gC,QAAS,SAAUr9C,GACf,MAAc,QAAVA,GAGG1D,KAAK8hF,SAASp+E,IAEzBA,MAAO,SAAUqR,GAAV,GACCrR,GAAQqR,EAAKrR,MACbq+E,EAAiB/hF,KAAK0hF,UAAU,GAAGh+E,MACnCs+E,EAAgBD,YAA0Bj4E,MAAO,aAAgBi4E,GACjEE,QAAmBv+E,EAcvB,OAbIqR,GAAKC,SACLitE,EAAYziF,EAAM6Q,YAAYsE,WAAWpD,KAAK7N,EAAOqR,EAAKC,SAE1DitE,GAAaD,EACQ,UAAjBA,IACIjtE,EAAKC,SACLtR,EAAQlE,EAAM6Q,YAAYsE,WAAWrT,KAAKoC,EAAOqR,EAAKC,SAE1DtR,GAAgB,IAEA,QAAbu+E,IACPv+E,EAAQlE,EAAM6Q,YAAYu3B,aAAalkC,IAEpCA,GAEX2kC,OAAQ,WACJ,OACI9tB,OAAQ,SACRs9C,MAAO73D,KAAKyhF,OACZ3pB,SAAU93D,KAAK0hF,cAI3BliF,EAAM6Q,YAAY0mD,UAAY3W,EAAOzgD,QACjCC,KAAM,SAAmBC,GACrBG,KAAKmV,MAAQtV,EAAQ0R,KACrBvR,KAAKkS,OAASrS,EAAQ6D,MACtB1D,KAAKqhF,YAETvgC,QAAS,SAAUhqC,GAAV,GAaDyG,GAZAxV,EAAS+O,EAAMnT,IAAI3D,KAAK0D,OAAO3B,OAAOwY,OAAO,SAAU7W,EAAO+G,EAAOgtC,GACrE,MAAiB,KAAVhtC,GAAe/G,IAAU+zC,EAAMhtC,EAAQ,IAG9C1C,GAAOhG,KADQ,cAAf/B,KAAKmV,OAAuC,cAAdnV,KAAKmV,MACvB,SAAU3M,EAAGimB,GACrB,MAAOA,GAAIjmB,GAGH,SAAUA,EAAGimB,GACrB,MAAOjmB,GAAIimB,IAGflR,EAAQvd,KAAKkS,OACE,eAAflS,KAAKmV,OAAyC,kBAAfnV,KAAKmV,QACpCoI,EAAQxV,EAAOlH,OAAS0c,EAAQ,KAAO,GAE3Cvd,KAAKqhF,QAAUt5E,EAAOzH,MAAM,EAAGid,IAEnCwjC,QAAS,SAAUr9C,GACf,MAAO1D,MAAKqhF,QAAQh0D,QAAQ3pB,IAAU,GAE1C2kC,OAAQ,WACJ,OACI9tB,OAAQ,MACRhJ,KAAMvR,KAAKmV,MACXzR,MAAO1D,KAAKkS,WAIxB1S,EAAM6Q,YAAYwmD,cAAgBzW,EAAOzgD,QACrCC,KAAM,SAAuBC,GAGzB,GAFAG,KAAKmV,MAAQtV,EAAQ0R,KACrBvR,KAAKkiF,WAAaliF,KAAKH,EAAQ0R,MACA,kBAApBvR,MAAKkiF,WACZ,KAAUt3E,OAAM,uBAA0B/K,EAAQ0R,KAAO,sBAGjE7N,MAAO,SAAUqR,GAAV,GAGKxD,GAFJ7N,EAAQqR,EAAKrR,KAOjB,OANIqR,GAAKC,SACDzD,EAAO/R,EAAM6Q,YAAYsE,WAAWpD,KAAK7N,EAAOqR,EAAKC,QAC5C,SAATzD,IACA7N,EAAQlE,EAAM6Q,YAAYu3B,aAAalkC,KAGxCA,GAEXo9C,QAAS,SAAUhqC,GAAV,GAGImtB,GACDvgC,EAHJ8mC,EAAM,EACNjtB,EAAQ,CACZ,KAAS0mB,EAAK,EAAGA,EAAKntB,EAAMjW,OAAQojC,IAC5BvgC,EAAQ1D,KAAK0D,MAAMoT,EAAMmtB,IACR,gBAAVvgC,KACP8mC,GAAO9mC,EACP6Z,IAIJvd,MAAKmiF,SADL5kE,EAAQ,EACQitB,EAAMjtB,EAEN,GAGxBwjC,QAAS,SAAUr9C,GACf,MAAO1D,MAAKkiF,WAAWx+E,IAE3B0+E,aAAc,SAAU1+E,GAIpB,MAHIA,aAAiBoG,QACjBpG,EAAQlE,EAAM6Q,YAAYmiB,aAAa9uB,IAEtB,gBAAVA,IAGJA,EAAQ1D,KAAKmiF,UAExBE,aAAc,SAAU3+E,GAIpB,MAHIA,aAAiBoG,QACjBpG,EAAQlE,EAAM6Q,YAAYmiB,aAAa9uB,IAEtB,gBAAVA,IAGJA,EAAQ1D,KAAKmiF,UAExBG,SAAU,SAAU5+E,GAChB,GAAIA,YAAiBoG,MAAM,CACvB,GAAIw4E,GAAW9iF,EAAMsuC,KAAKy0C,QAAQ/iF,EAAMsuC,KAAK8yC,QAAS,EACtD,OAAOphF,GAAMsuC,KAAKwC,QAAQ5sC,GAAOqG,YAAcu4E,EAASv4E,UAE5D,OAAO,GAEX62E,MAAO,SAAUl9E,GACb,MAAIA,aAAiBoG,OACVtK,EAAMsuC,KAAK00C,QAAQ9+E,IAIlC++E,UAAW,SAAU/+E,GACjB,GAAIA,YAAiBoG,MAAM,CACvB,GAAI24E,GAAYjjF,EAAMsuC,KAAKy0C,QAAQ/iF,EAAMsuC,KAAK8yC,WAC9C,OAAOphF,GAAMsuC,KAAKwC,QAAQ5sC,GAAOqG,YAAc04E,EAAU14E,UAE7D,OAAO,GAEX24E,SAAU,SAAUh/E,GAChB,MAAOu9E,GAASzhF,EAAMsuC,KAAKy0C,QAAQ/iF,EAAMsuC,KAAK8yC,QAAS,GAAIl9E,IAE/Di/E,SAAU,SAAUj/E,GAChB,MAAOu9E,GAASzhF,EAAMsuC,KAAK8yC,QAASl9E,IAExCk/E,SAAU,SAAUl/E,GAChB,MAAOu9E,GAASzhF,EAAMsuC,KAAKy0C,QAAQ/iF,EAAMsuC,KAAK8yC,YAAcl9E,IAEhEm/E,UAAW,SAAUn/E,GACjB,MAAOo9E,GAAUp9E,EAAO,IAE5Bo/E,UAAW,SAAUp/E,GACjB,MAAOo9E,GAAUp9E,EAAO,IAE5Bq/E,UAAW,SAAUr/E,GACjB,MAAOo9E,GAAUp9E,OAErBs/E,YAAa,SAAUt/E,GAAV,GAEDk9E,GACAjxD,CAFR,OAAIjsB,aAAiBoG,QACb82E,EAAQphF,EAAMsuC,KAAK8yC,QACnBjxD,EAAO+wD,EAAQh9E,GAASg9E,EAAQE,GACpB,IAATjxD,GAAcixD,EAAMxwC,gBAAkB1sC,EAAM0sC,eAAiBzgB,OAAcixD,EAAMxwC,cAAgB,IAAM1sC,EAAM0sC,gBAI5H6yC,YAAa,SAAUv/E,GAAV,GAEDk9E,GACAjxD,CAFR,OAAIjsB,aAAiBoG,QACb82E,EAAQphF,EAAMsuC,KAAK8yC,QACnBjxD,EAAO+wD,EAAQh9E,GAASg9E,EAAQE,GACpB,IAATjxD,GAAcixD,EAAMxwC,gBAAkB1sC,EAAM0sC,gBAI3D8yC,YAAa,SAAUx/E,GAAV,GAEDk9E,GACAjxD,CAFR,OAAIjsB,aAAiBoG,QACb82E,EAAQphF,EAAMsuC,KAAK8yC,QACnBjxD,EAAO+wD,EAAQE,GAASF,EAAQh9E,GACpB,IAATisB,GAAcixD,EAAMxwC,gBAAkB1sC,EAAM0sC,eAAiBzgB,OAAcixD,EAAMxwC,cAAgB,IAAM1sC,EAAM0sC,gBAI5H+yC,SAAU,SAAUz/E,GAChB,MAAOi9E,GAASj9E,EAAO,IAE3B0/E,SAAU,SAAU1/E,GAChB,MAAOi9E,GAASj9E,EAAO,IAE3B2/E,SAAU,SAAU3/E,GAChB,MAAOi9E,GAASj9E,OAEpB4/E,WAAY,SAAU5/E,GAClB,GAAIA,YAAiBoG,MAAM,CACvB,GAAI82E,GAAQphF,EAAMsuC,KAAK8yC,OACvB,OAAOl9E,GAAM0sC,gBAAkBwwC,EAAMxwC,eAAiB1sC,GAASk9E,EAEnE,OAAO,GAEXv4C,OAAQ,WACJ,OACI9tB,OAAQ,UACRhJ,KAAMvR,KAAKmV,WAKnB,EACA,EACA,EACA,GACFvD,QAAQ,SAAUK,GAChBzS,EAAM6Q,YAAYwmD,cAAc7jD,UAAU,UAAYf,GAAU,SAAUvO,GACtE,MAAIA,aAAiBoG,OACV42E,EAAQh9E,KAAWuO,KAKtCzS,EAAM+jF,SAAS,SAAS7wD,SAAS8wD,OAAOnhB,MAAMzwD,QAAQ,SAAUi8B,EAAOpjC,GACnEjL,EAAM6Q,YAAYwmD,cAAc7jD,UAAU66B,EAAMtlC,eAAiB,SAAU7E,GACvE,MAAIA,aAAiBoG,OACVpG,EAAM2sC,aAAe5lC,OAyC1CjL,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,sBAAuB,cAAeD,IAC/C,YACG,SAAUE,GACP,KAAIA,EAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,GAAlE,CAGA,GAAIypC,GAASr6C,EAAM4D,MAAMzD,QACrBC,KAAM,SAAUw7B,EAAM7H,GAClBvzB,KAAKq7B,MAAQD,EACbp7B,KAAKyjF,OAASlwD,GAElBrC,QAAS,SAAUquD,EAAU/5D,EAAM7K,EAAWuW,GAC1C,GAAIC,GAAW0oB,EAAO6pC,iBAItB,OAHI/oE,MAAc,IACdwW,EAAW0oB,EAAO8pC,oBAEfn+D,EAAKwL,cAAchxB,KAAKq7B,MAAMogB,aAAa8jC,EAASlrE,SAAUrU,KAAKq7B,MAAMogB,aAAa8jC,EAAShpD,aAAcpF,EAAUD,IAElI2vB,OAAQ,SAAUnvC,EAAKgJ,EAAQ8K,EAAM7K,EAAWuW,GAAxC,GAEK+S,GACDvU,EACAjP,EACKmjE,EAJT5yD,EAAgBhxB,KAAKkxB,QAAQxf,EAAIokB,SAASpb,GAAS8K,EAAM7K,EAAWuW,EACxE,KAAS+S,EAAKvyB,EAAI2C,QAAQS,IAAKmvB,GAAMvyB,EAAI6kB,YAAYzhB,IAAKmvB,IAGtD,IAFIvU,EAAQ1vB,KAAKq7B,MAAM5wB,MAAMiH,EAAI2C,QAAQC,IAAK2vB,GAC1CxjB,EAAMzgB,KAAKq7B,MAAM5wB,MAAMiH,EAAI6kB,YAAYjiB,IAAK2vB,GACvC2/C,EAAK,EAAGA,EAAK5jF,KAAKyjF,OAAO5iF,OAAQ+iF,IAClCl0D,EAAQ1vB,KAAKyjF,OAAOG,GAAIlyD,kBACxB1xB,KAAKyjF,OAAOG,GAAI7hF,KAAK2tB,EAAOjP,EAAKuQ,EAI7C,OAAOA,KAGf6oB,GAAO6pC,kBAAoB,SAAU34E,EAAGiZ,GAAb,GAUnB6/D,GACAC,CAVJ,IAAU,OAAN/4E,GAAoB,OAANiZ,EACd,MAAO,EAEX,IAAU,OAANjZ,EACA,MAAO,EAEX,IAAU,OAANiZ,EACA,QAIJ,IAFI6/D,QAAe94E,GACf+4E,QAAe9/D,GACL,WAAV6/D,EACA,MAAc,WAAVC,EACO/4E,EAAIiZ,IAKnB,IAAc,WAAV6/D,EACA,OAAQC,GACR,IAAK,SACD,MAAO,EACX,KAAK,SACD,MAAO/4E,GAAEg5E,cAAc//D,EAC3B,SACI,SAGR,GAAc,YAAV6/D,EACA,OAAQC,GACR,IAAK,SACD,MAAO,EACX,KAAK,SACD,MAAO,EACX,KAAK,UACD,MAAO/4E,GAAIiZ,CACf,SACI,SAGR,GAAIjZ,YAAavL,GAAM6Q,YAAY4D,KAAK0M,QAAQoqB,UAC5C,MAAI/mB,aAAaxkB,GAAM6Q,YAAY4D,KAAK0M,QAAQoqB,UACrC,EAEA,CAGf,MAAUngC,OAAM,kBAAoBG,EAAI,QAAUiZ,IAEtD61B,EAAO8pC,mBAAqB,SAAU54E,EAAGiZ,GACrC,MAAU,QAANjZ,GAAoB,OAANiZ,EACP,EAED,OAANjZ,EACO,EAED,OAANiZ,KAGG61B,EAAO6pC,kBAAkB1/D,EAAGjZ,IAEvCvL,EAAM6Q,YAAYwpC,OAASA,IAC7Br6C,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,yBACH,mBACA,YACA,aACDD,IACL,WACE,YASA,SAAS+K,GAAMyJ,GA0CX,QAASkwE,KACL,GAAIp7E,GAAIkL,EAAMxI,KAAK24E,EACnB,IAAIr7E,EACA,MAAOA,GAAE,GAAGL,cAGpB,QAAS27E,KAAT,GAGY90E,GAFJxG,EAAIkL,EAAMxI,KAAK64E,EACnB,IAAIv7E,IACIwG,EAAMs3C,WAAW99C,EAAE,KAClB2E,MAAM6B,IACP,OACIi8C,GAAIziD,EAAE,GACNlF,MAAO0L,EACPinC,QAAQ,GAKxB,QAAS+tC,KAEL,IADA,GAAiBx7D,GAAb5T,KAAkB3M,EAAO,MACrByL,EAAM0Y,QAAU5D,EAAMolC,MACV,QAAZplC,EAAIrX,KACAlJ,GAAQ,cAAcmB,KAAKnB,EAAKkJ,OAAsB,KAAblJ,EAAKyyD,MAA2B,KAAZlyC,EAAIkyC,MAAelyC,EAAI5T,OAAS,IAC7F4T,EAAIrX,KAAO,QAER,cAAc/H,KAAKof,EAAIrX,OAAqB,KAAZqX,EAAIkyC,MACvCzyD,GAAqB,QAAbA,EAAKkJ,MAA+B,KAAblJ,EAAKyyD,MAAezyD,EAAK2M,OAAS,IACjE3M,EAAKkJ,KAAO,QAGf,uBAAuB/H,KAAKof,EAAIrX,QACjClJ,EAAOugB,GAEX5T,EAAO7U,KAAKyoB,EAEhB,OAAO5T,GAEX,QAASqvE,GAAcz7D,GACnB,GAAgB,QAAZA,EAAIrX,MAA8B,KAAZqX,EAAIkyC,MAAelyC,EAAI5T,OAAS,EAAG,CACzD,GAAIpM,GAAIkL,EAAMxI,KAAK,UACf1C,KACAggB,EAAI8rC,SAAW9rD,EAAE,GAAG/H,OACJ,QAAZ+nB,EAAIrX,OACJqX,EAAIrX,KAAO,SAIvB,MAAOqX,GAEX,QAASolC,KACL,GAAI1kD,GAAIV,CACR,IAAIA,EAAIkL,EAAMxI,KAAK,2BACf,OACIiG,KAAM,QACNg4C,KAAK,EACLv0C,OAAQpM,EAAE,GAAKA,EAAE,GACjB07E,QAASC,EAGjB,IAAI37E,EAAIkL,EAAMxI,KAAK,WACf,OACIiG,KAAM,QACNg4C,KAAK,EACLv0C,OAAQpM,EAAE,GACV07E,QAASC,EAGjB,IAAI37E,EAAIkL,EAAMxI,KAAK,eACf,OACIiG,KAAM,MACNjI,GAAIV,EAAE,GACNsqC,KAAMtqC,EAAE,GAGhB,IAAIA,EAAIkL,EAAMxI,KAAK,6BAEf,MADA1C,GAAIA,EAAE,GAAGL,cACF87E,GACH9yE,KAAM,OACNupD,KAAMlyD,EAAEC,OAAO,GACfmM,OAAQpM,EAAE/H,QAGlB,IAAI+H,EAAIkL,EAAMxI,KAAK,eAEf,MADA1C,GAAIA,EAAE,GAAGL,cACF87E,GACH9yE,KAAM,OACNupD,KAAMlyD,EAAEC,OAAO,GACfmM,OAAQpM,EAAE/H,QAGlB,IAAI+H,EAAIkL,EAAMxI,KAAK,uBAEf,MADA1C,GAAIA,EAAE,GAAGL,cACF87E,GACH9yE,KAAM,SACNupD,KAAMlyD,EAAEC,OAAO,GACfmM,OAAQpM,EAAE/H,QAGlB,IAAI+H,EAAIkL,EAAMxI,KAAK,mCAEf,MADA1C,GAAIA,EAAE,GAAG7C,MAAM,MAEXwL,KAAM,OACNizE,GAAI57E,EAAE,GACN67E,GAAI77E,EAAE,GAGd,QAAQU,EAAKwK,EAAMkgC,QACnB,IAAK,IACD,MAAO,KACX,KAAK,KACD,OACIziC,KAAM,MACN7N,MAAOoQ,EAAMkgC,OAErB,KAAK,IACD,OACIziC,KAAM,MACN7N,MAAOoQ,EAAMi8C,YAAYzmD,GAEjC,KAAK,IACD,OAASiI,KAAM,OACnB,KAAK,IACD,OACIA,KAAM,QACN7N,MAAOoQ,EAAMkgC,OAErB,KAAK,IACD,OACIziC,KAAM,OACN7N,MAAOoQ,EAAMkgC,OAErB,KAAK,IACD,MAAIlgC,GAAM+7C,UAAU,cAChB00B,GAAc,GACLhzE,KAAM,SAGfA,KAAM,MACN7N,MAAO,IAEf,KAAK,IACD,OAAS6N,KAAM,UACnB,KAAK,IACD,OAASA,KAAM,SAEnB,OACIA,KAAM,MACN7N,MAAO4F,GAGf,QAASo7E,KACLH,GAAc,CACd,IAAIphD,GAAQ6gD,IAAcp4C,EAAOs4C,GAIjC,QAHK/gD,GAASyI,IACVzI,EAAQ6gD,MAGR7gD,MAAOA,EACPyI,KAAMA,EACN3mC,KAAMm/E,KA1MlB,GAEQO,GAAeC,EAAyBL,EAEpCM,CADR,KAFA/wE,EAAQG,EAAK+6C,YAAYl7C,GACrB6wE,KAAeC,GAAkB,GAC7B9wE,EAAM0Y,OACNq4D,EAAMH,IACVC,EAASxkF,KAAK0kF,GACVA,EAAIj5C,OACJg5C,GAAkB,EAkC1B,OA/BKA,KACsB,GAAnBD,EAAS9jF,OACT8jF,EAAS,GAAG/4C,KAAO,MACO,GAAnB+4C,EAAS9jF,QAChB8jF,EAAS,GAAG/4C,MACRyf,GAAI,KACJ3nD,MAAO,GAEXihF,EAAS,GAAG/4C,MACRyf,GAAI,IACJ3nD,MAAO,IAEJihF,EAAS9jF,QAAU,IAC1B8jF,EAAS,GAAG/4C,MACRyf,GAAI,IACJ3nD,MAAO,GAEXihF,EAAS,GAAG/4C,MACRyf,GAAI,IACJ3nD,MAAO,GAEXihF,EAAS,GAAG/4C,MACRyf,GAAI,IACJ3nD,MAAO,GAEPihF,EAAS9jF,OAAS,IAClB8jF,EAAS,GAAG/4C,KAAO,OACnB+4C,EAAWA,EAASrkF,MAAM,EAAG,MAIlCqkF,EAqKX,QAAS55D,GAAM45D,GAEX,QAASG,GAAaD,GAClB,GAAI36E,GAAM,EAUV,OATI26E,GAAI1hD,QACJj5B,GAAO,IAAM26E,EAAI1hD,MAAQ,KAEzB0hD,EAAIj5C,MACc,QAAZi5C,EAAIj5C,MAA8B,OAAZi5C,EAAIj5C,OAC5B1hC,GAAO,IAAM26E,EAAIj5C,KAAKyf,GAAKw5B,EAAIj5C,KAAKloC,MAAQ,KAGpDwG,GAAO26E,EAAI5/E,KAAKtB,IAAIohF,GAAY/iF,KAAK,IAGzC,QAASqiF,GAAcW,EAAKp8D,GAIxB,MAHIA,GAAI8rC,WACJswB,GAAO,IAAMC,EAAQ,GAAIr8D,EAAI8rC,SAAU,MAEpCswB,EAEX,QAASD,GAAWn8D,GAChB,MAAgB,SAAZA,EAAIrX,KACAqX,EAAI2gC,IACG3gC,EAAI5T,OAAOnM,OAAO,GAAK,IAAM+f,EAAI5T,OAAOiT,OAAO,GAE/CW,EAAI5T,OAEI,OAAZ4T,EAAIrX,KACJqX,EAAItf,GAAKsf,EAAIsqB,KACD,QAAZtqB,EAAIrX,MAA8B,QAAZqX,EAAIrX,KAC1B8yE,EAAcY,EAAQ,GAAIr8D,EAAI5T,OAAQ4T,EAAIkyC,MAAOlyC,GACrC,UAAZA,EAAIrX,KACJ8yE,EAAc,IAAMY,EAAQ,GAAIr8D,EAAI5T,OAAQ4T,EAAIkyC,MAAQ,IAAKlyC,GACjD,QAAZA,EAAIrX,KACJqX,EAAI47D,GAAK,IAAM57D,EAAI67D,GACP,OAAZ77D,EAAIrX,KACJ8gB,KAAKC,UAAU1J,EAAIllB,OACP,QAAZklB,EAAIrX,KACJ,IACY,SAAZqX,EAAIrX,KACJ,IAAMqX,EAAIllB,MACE,QAAZklB,EAAIrX,KACJ,IAAMqX,EAAIllB,MACE,OAAZklB,EAAIrX,KACJ,IACY,WAAZqX,EAAIrX,KACJ,IACY,SAAZqX,EAAIrX,KACJ,IADJ,OA/CX,MAAOozE,GAAShhF,IAAImhF,GAAc9iF,KAAK,KAoD3C,QAASiT,GAAe0vE,EAAUn8E,GAC9Bm8E,EAAS/yE,QAAQ,SAAUizE,GAAV,GAKT5/E,GAAiBigF,EAAkB/iF,EAE/BymB,EAOYra,EAbhBohB,EAAOnnB,CACX,IAAgB,QAAZq8E,EAAIj5C,KAAR,CAIA,IADI3mC,EAAO4/E,EAAI5/E,KAAMigF,GAAW,EAAO/iF,EAAI8C,EAAKpE,OAChC,IAAT8uB,KAAgBxtB,GAAK,GAExB,GADIymB,EAAM3jB,EAAK9C,GACC,SAAZymB,EAAIrX,KAAiB,CACrB,GAAIqX,EAAI07D,UACJY,GAAW,EACPv1D,EAAO,EACP/G,EAAI5T,QAAUiwE,EAAQ,GAAIt1D,EAAM,KACzBA,EAAO,IACVphB,EAAMqa,EAAI5T,OAAOnU,OACrB+nB,EAAI5T,OAAS4T,EAAI5T,OAAOiT,OAAO,EAAG1Z,EAAMohB,GACxCA,GAAQphB,EAAMqa,EAAI5T,OAAOnU,QAEH,IAAtB+nB,EAAI5T,OAAOnU,QAEX,IADAoE,EAAK81B,OAAO54B,EAAG,KACNA,GAAK,GAAG,CAEb,GADAymB,EAAM3jB,EAAK9C,GACK,SAAZymB,EAAIrX,MAAmBqX,EAAI07D,QAAS,GAClCniF,CACF,OAEJ,GAAgB,OAAZymB,EAAIrX,KAAe,CACnBtM,EAAK81B,OAAO54B,EAAG,EACf,QAKhB,GAAIwtB,EAAO,EACP,OAIPu1D,GAAYv1D,EAAO,GACpB1qB,EAAK81B,OAAO54B,EAAI,EAAG,GAAKoP,KAAM,QAC1BA,KAAM,QACNg4C,KAAK,EACL+6B,SAAS,EACTtvE,OAAQiwE,EAAQ,GAAIt1D,EAAM,UAK1C,QAASy6B,GAAYtoD,GACjB,GAAI2I,GAAQ,CACZ,QACIupC,KAAM,WACF,MAAOlyC,GAAM2I,MAEjB+hB,IAAK,WACD,MAAO/hB,IAAS3I,EAAMjB,QAE1BotD,MAAO,SAAUhoD,EAAG3G,GAChB,GAAImL,EAAQxE,GAAKnE,EAAMjB,OAAQ,CAC3B,GAAIuO,GAAM9P,EAAE8J,MAAM,KAAMtH,EAAMxB,MAAMmK,EAAOA,EAAQxE,GAInD,OAHImJ,KACA3E,GAASxE,GAENmJ,IAGf+1E,QAAS,WACL16E,EAAQ,IAIpB,QAAS26E,GAAkBpwE,GA4BvB,QAASqwE,GAAWt6E,EAAGiZ,IACL,SAAVjZ,EAAEwG,MAA6B,SAAVyS,EAAEzS,MAA6B,SAAVxG,EAAEwG,MAAmBxG,EAAE+vC,QAAoB,SAAV92B,EAAEzS,QAC7EyS,EAAE82B,QAAS,EACXwqC,KA/BZ,GAmBYj6B,GAuEAziC,EAzFJ9U,EAAQs2C,EAAYp1C,EAAO/P,MAC3BsgF,GAAU,EACVC,GAAU,EACVC,GAAU,EACVC,EAAe,EACfj+C,EAAW,mIACX69C,EAAa,EACbl7E,EAAO,GACPu7E,GAAkB,EAClBC,EAAS,EACTC,KAAgBC,KAChBC,EAAY/wE,EAAO42B,KACnBo6C,EAAW,EAqBf,KApBiB,QAAbD,EACAC,EAAW,mFACS,OAAbD,EACPC,EAAW,mCACJD,IACH16B,EAAqB,KAAhB06B,EAAU16B,GAAY,KAAO06B,EAAU16B,GAChD26B,EAAW,yCAA6C36B,EAAK,IAAM06B,EAAUriF,MAAQ,OAChFqiF,EAAU1vC,SACXjsC,GAAQ,8BAGZ4K,EAAOmuB,QACP/4B,GAAQ,kBAAoBioB,KAAKC,UAAUtd,EAAOmuB,OAAS,OAQvDrvB,EAAM0Y,OACV1Y,EAAMm6C,MAAM,EAAGo3B,GACXz8D,EAAM9U,EAAMkgC,OACA,WAAZprB,EAAIrX,KACJm0E,IACmB,SAAZ98D,EAAIrX,KACPqX,EAAI07D,SACJsB,GAAUh9D,EAAI5T,OAAOnU,OACrBilF,EAAU3lF,KAAKyoB,EAAI5T,UAEnB6wE,EAAU1lF,KAAKyoB,EAAI5T,QACf4T,EAAI2gC,MACJo8B,GAAkB,IAGP,QAAZ/8D,EAAIrX,KACXi0E,GAAU,EACS,QAAZ58D,EAAIrX,KACXg0E,GAAU,EACS,QAAZ38D,EAAIrX,OACXk0E,EAAUD,GAAU,EAmC5B,KAhCIE,EAAe,IACft7E,GAAQ,YAAcukB,KAAK2mB,IAAI,IAAKowC,GAAgB,MAEpDJ,EAAa,IACbl7E,GAAQ,YAAcukB,KAAK2mB,IAAI,IAAMgwC,GAAc,MAEnDO,EAAUhlF,SACVuJ,GAAQ,mDAAqDioB,KAAKC,UAAUuzD,GAAa,KAAOD,EAAS,KAAOD,EAAkB,MAClIv7E,GAAQ,8CAER07E,EAAUjlF,SACVuJ,GAAQ,0CAA4CioB,KAAKC,UAAUwzD,GAAa,KAAOF,EAAS,QAEhGC,EAAUhlF,QAAUilF,EAAUjlF,UAC9BuJ,GAAQ,qBAERm7E,IACAn7E,GAAQ,0CAERo7E,IACAp7E,GAAQ,2CAERm7E,GAAWC,KACXp7E,GAAQ,oBAERs7E,EAAe,GAAKJ,EAAa,GAAKO,EAAUhlF,QAAUilF,EAAUjlF,QAAU0kF,GAAWC,KACpFQ,IACDA,EAAW,qCAGnBlyE,EAAMqxE,UACN/6E,GAAQ,gCACA0J,EAAM0Y,OACN5D,EAAM9U,EAAMkgC,OACA,OAAZprB,EAAIrX,KACJnH,GAAQ,wCACW,SAAZwe,EAAIrX,MAAoBqX,EAAIkyB,OAEhB,WAAZlyB,EAAIrX,MACXnH,GAAQ,qBACRA,GAAQ,mDACW,OAAZwe,EAAIrX,MACPk2B,EAASj+B,KAAKof,EAAIllB,SAClB0G,GAAQ,sBACRA,GAAQ,8DAEZA,GAAQ,aAAeioB,KAAKC,UAAU1J,EAAIllB,OAAS,MAChC,QAAZklB,EAAIrX,MACXnH,GAAQ,kBACRA,GAAQ,qBACW,SAAZwe,EAAIrX,MACXnH,GAAQ,yCACRA,GAAQ,gBACRA,GAAQ,4CAAgDioB,KAAKC,UAAU1J,EAAIllB,OAAS,SACjE,QAAZklB,EAAIrX,KACXnH,GAAQ,0BAA4BioB,KAAKC,UAAU1J,EAAIllB,OAAS,MAC7C,SAAZklB,EAAIrX,MACXnH,GAAQ,+FACRA,GAAQ,cAAgBwe,EAAI07D,QAAU,UAAY,WAAa,cAC5C,QAAZ17D,EAAIrX,KACXnH,GAAQ,yCAA2CioB,KAAKC,UAAU1J,EAAIkyC,MAAQ,KAAOlyC,EAAI5T,OAAS,MAC/E,QAAZ4T,EAAIrX,KACXnH,GAAQ,gCAAkCioB,KAAKC,UAAU1J,EAAIkyC,MAAQ,KAAOlyC,EAAI5T,OAAS,KAAOywE,EAAU,KAAO78D,EAAI8rC,SAAW,MAC7G,UAAZ9rC,EAAIrX,KACXnH,GAAQ,mCAAqCioB,KAAKC,UAAU1J,EAAIkyC,MAAQ,KAAOlyC,EAAI5T,OAAS,KAAO4T,EAAI8rC,SAAW,MAC/F,QAAZ9rC,EAAIrX,OACXnH,GAAQ,+BAAiCioB,KAAKC,UAAU1J,EAAI47D,IAAM,MAAQnyD,KAAKC,UAAU1J,EAAI67D,IAAM,MA7BnGr6E,GAAQ,iBAsChB,OANAA,IAAQ,yCACRA,GAAQ,uBACRA,GAAQ,kBACJ47E,IACA57E,EAAO47E,EAAW57E,EAAO,KAEtBA,EAgRX,QAAS66E,GAAQ71E,EAAK7M,EAAO+G,GAEzB,IADA8F,GAAO,GACAA,EAAIvO,OAAS0B,GAChB6M,EAAM9F,EAAK8F,CAEf,OAAOA,GAEX,QAAS9N,GAAKhC,GAAd,GAGa6C,GACDwiB,EAHJ5Z,EAAIzL,EAAE2F,KACN3D,EAAO,EACX,KAASa,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EACxBwiB,EAAK5Z,EAAE5I,GACM,gBAANwiB,GACPrjB,GAAQqjB,EACU,SAAXA,EAAGpT,OACVjQ,GAAQ,IAGhB,OAAOA,GA3vBb,GAKMP,GACAkT,EACA0vC,EACAsgC,EACAE,EAkdA8B,EAIAz+C,EAQAgJ,EA+DA7vB,CApiBAnhB,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DrP,EAAOvB,MAAMuB,KACbkT,EAAOzU,MAAM6Q,YAAY4D,KACzB0vC,EAAMnkD,MAAMmkD,IACZsgC,EAAY,yDACZE,EAAe,mCAkdf8B,EAAOb,GACPx5C,KAAM,OACN3mC,OAASsM,KAAM,WAEfi2B,EAAUzmC,EAAK+H,QAAQ,SAAUkM,GAAV,GACnBgb,GAAO3lB,EAAM2K,GACb5K,EAAO4lB,EAAKrsB,IAAIyhF,EAIpB,OAHAh7E,GAAKjK,KAAK8lF,GACV77E,EAAOA,EAAKpI,KAAK,MACjBoI,EAAO,gJAAgKA,EAAO,sBACnKmiC,SAAS,UAAWniC,GAAMuW,KAErC6vB,EAAiBzvC,EAAK+H,QAAQ,SAAUkM,GAqBxC,QAASqvE,GAAcW,EAAKp8D,GAIxB,MAHIA,GAAI8rC,WACJswB,GAAOC,EAAQ,GAAIt2D,KAAKoK,IAAInQ,EAAI8rC,SAAU,GAAI,MAE3CswB,EAEX,QAASD,GAAWn8D,GAChB,GAAgB,SAAZA,EAAIrX,KACJ,MAAIqX,GAAI2gC,IACG3gC,EAAI5T,OAAOnM,OAAO,GAAK,IAAM+f,EAAI5T,OAAOiT,OAAO,GAE/CW,EAAI5T,MAEZ,IAAgB,OAAZ4T,EAAIrX,KACX,MAAOqX,GAAItf,GAAKsf,EAAIsqB,IACjB,IAAgB,QAAZtqB,EAAIrX,MAA8B,QAAZqX,EAAIrX,KAAgB,CACjD,GAAIupD,GAAOlyC,EAAIkyC,IAQf,OAPgB,QAAZlyC,EAAIrX,MAAkB,KAAK/H,KAAKsxD,GAChCA,EAAO,IACY,QAAZlyC,EAAIrX,MAAkB,KAAK/H,KAAKsxD,KAClC2qB,IACD3qB,EAAOA,EAAKz1C,gBAGbg/D,EAAcY,EAAQ,GAAIr8D,EAAI5T,OAAQ8lD,GAAOlyC,GACjD,MAAgB,QAAZA,EAAIrX,KACJ,KACY,OAAZqX,EAAIrX,KACJqX,EAAIllB,MACQ,SAAZklB,EAAIrX,KACJ,IACY,OAAZqX,EAAIrX,KACJ,IACY,WAAZqX,EAAIrX,KACJ,IACY,SAAZqX,EAAIrX,KACJ,IAEA,GA3De,GAE1B20E,GACK/jF,EAEIiM,EAJT4hB,EAAO3lB,EAAM2K,GACJmxE,GAAQ,EAAOV,GAAU,CACtC,KAAStjF,EAAI,EAAGA,EAAI6tB,EAAKnvB,SAAUsB,EAAG,CAElC,IADA+jF,EAAUl2D,EAAK7tB,GACNiM,EAAI,EAAGA,EAAI83E,EAAQjhF,KAAKpE,SAAUuN,EACnC,uBAAuB5E,KAAK08E,EAAQjhF,KAAKmJ,GAAGmD,QAC5C40E,GAAQ,EACoB,QAAxBD,EAAQjhF,KAAKmJ,GAAGmD,OAChBk0E,GAAU,GAItB,IAAIU,EACA,MAGR,MAAKA,GAGED,EAAQjhF,KAAKtB,IAAIohF,GAAY/iF,KAAK,IAF9B,OA6CX2e,GACA+tB,WAAYz6B,EAAK0M,QAAQ+tB,WACzBI,WAAY76B,EAAK0M,QAAQmuB,WACzBhB,KAAM,SAAUrb,EAAS9pB,EAAGmyD,EAAMj6D,GAC9B,OAAQi6D,GACR,IAAK,IACD,OAAQj6D,GACR,IAAK,GACD,MAAO8H,GAAEmlC,IACb,KAAK,GACD,MAAOm3C,GAAQt8E,EAAEmlC,KAAM,EAAG,IAC9B,KAAK,GACD,MAAOrb,GAAQ2zD,UAAUC,SAASC,KAAKC,UAAU59E,EAAEolC,IACvD,KAAK,GACD,MAAOtb,GAAQ2zD,UAAUC,SAASC,KAAKjkB,MAAM15D,EAAEolC,KAEnD,KACJ,KAAK,IACD,OAAQltC,GACR,IAAK,GACD,MAAO8H,GAAEklC,MAAQ,CACrB,KAAK,GACD,MAAOo3C,GAAQt8E,EAAEklC,MAAQ,EAAG,EAAG,IACnC,KAAK,GACD,MAAOpb,GAAQ2zD,UAAUC,SAAS7C,OAAO+C,UAAU59E,EAAEklC,MACzD,KAAK,GACD,MAAOpb,GAAQ2zD,UAAUC,SAAS7C,OAAOnhB,MAAM15D,EAAEklC,MACrD,KAAK,GACD,MAAOpb,GAAQ2zD,UAAUC,SAAS7C,OAAOnhB,MAAM15D,EAAEklC,OAAOhlC,OAAO,GAEnE,KACJ,KAAK,IACD,OAAQhI,GACR,IAAK,GACD,MAAO8H,GAAEilC,KAAO,GACpB,KAAK,GACD,MAAOjlC,GAAEilC,MAIjB,MAAO,MAEXmC,KAAM,SAAUN,EAAGqrB,EAAMj6D,EAAQ2lF,EAAMC,GACnC,GAAIzyD,GAAK0gC,CACT,QAAQoG,GACR,IAAK,IACD9mC,EAAMixD,EAAQuB,EAAO/2C,EAAET,MAAQ,IAAM,GAAKS,EAAET,MAAOnuC,EAAQ,KACvD4lF,IACA/xB,GAAYjlB,EAAER,SAAWQ,EAAEP,QAAUO,EAAEF,aAAe,KAAQ,IAAM,GAExE,MACJ,KAAK,IACDvb,EAAMixD,EAAQx1C,EAAER,QAASpuC,EAAQ,KAC7B4lF,IACA/xB,GAAYjlB,EAAEP,QAAUO,EAAEF,aAAe,KAAQ,GAErD,MACJ,KAAK,IACDvb,EAAMixD,EAAQx1C,EAAEP,QAASruC,EAAQ,KAC7B4lF,IACA/xB,EAAWjlB,EAAEF,aAAe,KAOpC,MAHImlB,KACA1gC,GAAOrT,EAAQ+lE,QAAQhyB,EAAU+xB,GAASjlF,QAAQ,MAAO,KAEtDwyB,GAEX2yD,OAAQ,SAAUjjF,EAAOo3D,EAAMj6D,EAAQ4lF,GACnC,GAAIzyD,GAAK0gC,CACT,QAAQoG,GACR,IAAK,IACD9mC,EAAc,GAARtwB,CACN,MACJ,KAAK,IACDswB,EAAc,GAARtwB,EAAa,EACnB,MACJ,KAAK,IACDswB,EAAc,GAARtwB,EAAa,GAAK,GAU5B,MAPI+iF,KACA/xB,EAAW1gC,GAAa,EAANA,IAEtBA,EAAMixD,EAAc,EAANjxD,EAASnzB,EAAQ,KAC3B6zD,IACA1gC,GAAOrT,EAAQ+lE,QAAQhyB,EAAU+xB,GAASjlF,QAAQ,MAAO,KAEtDwyB,GAEX0oC,KAAM,SAAUpzD,GACZ,MAAOA,IAEXs9E,UAAW,SAAUn0D,EAAS/uB,EAAO5B,EAAO8jF,EAAQr8B,GAYhD,QAAS7X,GAAIpoC,GACLigD,GAAO7kC,GAAOA,EAAM,IAAM,GAAK,UAAUlb,KAAKF,KAC9CpH,EAAMuwB,EAAQqV,aAAa,KAAO5lC,GAEtCA,EAAMoH,EAAKpH,EACXwiB,IAjBG,GASHmiE,GACAhhF,EACA6e,EAASxiB,EAQJkM,EACD4G,EAEKs+B,EACDwzC,CAJZ,KAlBApjF,EAAQid,EAAQ+lE,QAAQhjF,EAAOkiF,GAAQpkF,QAAQ,QAAS,IACpDokF,EAAS,IACK,MAAVliF,EACAA,EAAQ,GACS,OAAVA,IACPA,EAAQ,MAGZmjF,EAAKnjF,EAAM7C,OAAS,EACpBgF,KACA6e,EAAM,EAQDtW,EAAItM,EAAMjB,SAAUuN,GAAK,GAAI,CAGlC,IAFI4G,EAASlT,EAAMsM,GACnBlM,EAAM,GACGoxC,EAAIt+B,EAAOnU,SAAUyyC,GAAK,GAC3BwzC,EAAM9xE,EAAOnM,OAAOyqC,GACpBuzC,EAAK,EACM,KAAPC,EACAp1C,EAAI,KACU,KAAPo1C,GACPp1C,EAAI,MAIJA,EADS,KAAThuC,GAAuB,KAAPojF,EACZ,IAEApjF,EAAMmF,OAAOg+E,IAErBA,IAGR,IAAU,IAANz4E,EACA,KAAOy4E,GAAM,GACTn1C,EAAIhuC,EAAMmF,OAAOg+E,KAGzBhhF,GAAOqmB,QAAQhqB,GAEnB,MAAO2D,IAEXkhF,UAAW,SAAUrjF,EAAO5B,EAAO8jF,GAAxB,GAEHhgF,GAMAihF,EACAhhF,EACKuI,EACD4G,EACA9S,EACKoxC,EACDwzC,CAJZ,KATApjF,EAAQid,EAAQ+lE,QAAQhjF,EAAOkiF,GAC3BhgF,EAAMlC,EAAM2pB,QAAQ,KAEpB3pB,EADAkC,GAAO,EACClC,EAAMukB,OAAOriB,EAAM,GAAGpE,QAAQ,MAAO,IAErC,GAERqlF,EAAK,EACLhhF,KACKuI,EAAI,EAAGA,EAAItM,EAAMjB,SAAUuN,EAAG,CAGnC,IAFI4G,EAASlT,EAAMsM,GACflM,EAAM,GACDoxC,EAAI,EAAGA,EAAIt+B,EAAOnU,SAAUyyC,EAC7BwzC,EAAM9xE,EAAOnM,OAAOyqC,GACpBuzC,EAAKnjF,EAAM7C,OACXqB,GAAOwB,EAAMmF,OAAOg+E,KACN,KAAPC,EACP5kF,GAAO,IACO,KAAP4kF,IACP5kF,GAAO,IAGf2D,GAAO1F,KAAK+B,GAEhB,MAAO2D,IAEX6gF,QAAS,SAAUhjF,EAAOsjF,GACtB,MAAO,SAASN,GAAQhjF,GAAjB,GAUCxB,GACA0D,EACAqhF,EACAC,EAOA5nF,CAnBJ,IAAIoE,EAAQ,EACR,MAAO,IAAMgjF,GAAShjF,EAE1B,IAAiB,IAAbsjF,EACA,MAAcr4D,MAAKyd,MAAM1oC,GAAlBnC,EAEX,IAAImC,IAAU4J,SAAS5J,EAAO,IAC1B,MAAOA,GAAMgjF,QAAQM,EAMzB,IAJI9kF,EAAawB,EAAPnC,GACNqE,EAAM1D,EAAImrB,QAAQ,KAClB45D,EAAU/kF,EAAI+lB,OAAO,EAAGriB,GACxBshF,EAAUhlF,EAAI+lB,OAAOriB,EAAM,GAC3BshF,EAAQrmF,QAAUmmF,EAAU,CAC5B,KAAOE,EAAQrmF,OAASmmF,GACpBE,GAAW,GAEf,OAAOD,GAAU,IAAMC,EAG3B,MADI5nF,GAAIqvB,KAAK2mB,IAAI,GAAI0xC,GACdN,EAAQ/3D,KAAKyd,MAAM1oC,EAAQpE,GAAKA,IACzCqvB,KAAKyd,MAAc,KAAR1oC,GAA2B,QAuBhDlE,MAAM6Q,YAAYsE,YACd6yB,QAASA,EACTn9B,MAAOA,EACP2K,OAAQ,SAAUtR,EAAOsR,EAAQyd,GAAzB,GAIA1nB,GAIK5I,EACDwiB,EARJrlB,EAAIkoC,EAAQxyB,GAAQtR,EAAO+uB,GAC3B00D,EAAOxjC,EAAIpoC,QAAQ,OAMvB,KALA4rE,EAAKjW,WAAa5xE,EAAEiS,KAChBxG,EAAIzL,EAAE2F,KACN3F,EAAE6jC,QACFgkD,EAAKvlE,KAAKjf,OAAUwgC,MAAO7jC,EAAE6jC,QAExBhhC,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EACxBwiB,EAAK5Z,EAAE5I,GACM,gBAANwiB,GACPwiE,EAAK9gC,SAASlmD,KAAKwjD,EAAIriD,KAAKqjB,IACV,SAAXA,EAAGpT,MACV41E,EAAK9gC,SAASlmD,KAAKwjD,EAAIpoC,QAAQ,QAAU5Y,OAAS0mB,WAAY,YAAes6B,EAAIriD,KAAKqjB,EAAGjhB,SAGjG,OAAOyjF,IAEX7lF,KAAM,SAAUoC,EAAOsR,EAAQyd,GAC3B,GAAInzB,GAAIkoC,EAAQxyB,GAAQtR,EAAO+uB,EAC/B,OAAOnxB,GAAKhC,IAEhB8nF,aAAc,SAAU1jF,EAAOsR,EAAQyd,GACnC,GAAInzB,GAAIkoC,EAAQxyB,GAAQtR,EAAO+uB,EAC/B,QACInxB,KAAMA,EAAKhC,GACX6jC,MAAO7jC,EAAE6jC,MACT5xB,KAAMjS,EAAEiS,OAGhBA,KAAM,SAAU7N,EAAOsR,GACnB,MAAOwyB,GAAQxyB,GAAQtR,GAAO6N,MAElC0D,eAAgB,SAAUD,EAAQ2a,GAC9B,GAAI87B,GAAMphD,EAAM2K,EAEhB,OADAC,GAAew2C,EAAK97B,GACb5E,EAAM0gC,IAEjBjb,eAAgBA,KAEJ,kBAAVjxC,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,iCACH,sBACA,aACDD,IACL,WACE,YA8FA,SAAS+nF,GAAMphF,GACX,OAAQ0oB,KAAKw8B,IAAIllD,GAAK0oB,KAAKw8B,KAAKllD,IAAM,EAqB1C,QAASqhF,GAAMrhF,GACX,OAAQ0oB,KAAKw8B,IAAIllD,GAAK0oB,KAAKw8B,KAAKllD,IAAM,EAgD1C,QAASshF,GAAMthF,GACX,MAAOqhF,GAAMrhF,GAAKohF,EAAMphF,GA4U5B,QAASuhF,GAAKz8E,EAAGiZ,GACb,KAAOA,GAAG,CACN,GAAI7b,GAAI4C,EAAIiZ,CACZjZ,GAAIiZ,EACJA,EAAI7b,EAER,MAAO4C,GAEX,QAAS08E,GAAK18E,EAAGiZ,GACb,MAAO2K,MAAK6I,IAAIzsB,EAAIiZ,GAAKwjE,EAAKz8E,EAAGiZ,GAuUrC,QAAS0jE,GAAOr8C,EAAM/rC,GAElB,IAFJ,GASiBgV,GAEQQ,EAEG1F,EAZpBu4E,KAAaxlF,EAAI,EAAGylF,EAASv8C,EAAK,GAC/BlpC,EAAIkpC,EAAKxqC,QACZ8mF,EAAOxnF,MACHynF,OAAQv8C,EAAKlpC,KACb2I,KAAM+8E,EAAcx8C,EAAKlpC,OAI7B,KAASmS,EAAM,EAAGA,EAAMszE,EAAOplF,SAAU8R,EACrCq1C,EACI,IAAS70C,EAAM,EAAGA,EAAM8yE,EAAOrlF,QAASuS,EAAK,CACzC,IAAK3S,EAAI,EAAGA,EAAIwlF,EAAO9mF,SAAUsB,EAE7B,GADIiN,EAAMu4E,EAAOxlF,GAAGylF,OAAO3jF,IAAIqQ,EAAKQ,IAC/B6yE,EAAOxlF,GAAG2I,KAAY,MAAPsE,GAAuB,KAARA,EAAa,EAAIA,GAChD,QAASu6C,EAGjBrqD,GAAEgV,EAAKQ,IA8K3B,QAASgzE,GAAKC,GACV,MAAOA,GAAQh0D,OAAO,SAAUyW,EAAKlQ,GACjC,MAAOkQ,GAAMlQ,GACd,GAAKytD,EAAQlnF,OAEpB,QAASmnF,GAAQD,EAASE,EAASC,GAI/B,MAHW,OAAPA,IACAA,EAAMJ,EAAKC,IAERA,EAAQh0D,OAAO,SAAUyW,EAAKlQ,GACjC,MAAOkQ,GAAM7b,KAAK2mB,IAAIhb,EAAM4tD,EAAK,IAClC,GAAKD,EAEZ,QAASE,GAAUJ,EAASE,GACxB,MAAOt5D,MAAKC,KAAKo5D,EAAQD,EAASE,IAoXtC,QAASG,GAAaL,EAASv/E,EAAG6/E,GAC9B,GAAIC,GAAM,EAAGC,EAAM,EAAG3rE,EAAO,KAAME,EAAQ,KAAMqpE,GAAQ,CAYzD,OAXA4B,GAAQn2E,QAAQ,SAAU0oB,GAClBA,EAAM9xB,GACN8/E,IACA1rE,EAAe,MAARA,EAAe0d,EAAM3L,KAAKoK,IAAInc,EAAM0d,IACpCA,EAAM9xB,GACb+/E,IACAzrE,EAAiB,MAATA,EAAgBwd,EAAM3L,KAAKqK,IAAIlc,EAAOwd,IAE9C6rD,GAAQ,IAGXmC,GAAQC,EAGTpC,EACIkC,GACQC,EAAM,IAAMP,EAAQlnF,OAAS,GAElCynF,GAAOA,EAAMC,KAEfzrE,EAAQtU,GAAK4/E,EAAaL,EAASnrE,EAAMyrE,IAAQ7/E,EAAIoU,GAAQwrE,EAAaL,EAASjrE,EAAOurE,KAASvrE,EAAQF,GARzG,GAAImuB,GAAU,OAsD7B,QAASy9C,GAAYhgF,EAAGimB,EAAGw5D,GAA3B,GAKa9lF,GAJLqoC,EAAM,EACNi+C,EAAKX,EAAKt/E,GACVkgF,EAAKZ,EAAKr5D,GACVxoB,EAAIuC,EAAE3H,MACV,KAASsB,EAAI,EAAGA,EAAI8D,IAAK9D,EACrBqoC,IAAQhiC,EAAErG,GAAKsmF,IAAOh6D,EAAEtsB,GAAKumF,EAEjC,OAAOl+C,GAAMy9C,EAkMjB,QAASU,GAAYZ,EAASa,GAA9B,GAEQ3iF,GACAqtC,EAAc3qC,CAClB,OAHAo/E,GAAQhmF,KAAK4Y,GACT1U,EAAI8hF,EAAQlnF,OACZyyC,EAAW,EAAPs1C,EAAUjgF,EAAIigF,EAAOt1C,EACnB,IAANA,EACOy0C,EAAQ,GAEfz0C,GAAKrtC,EACE8hF,EAAQ9hF,EAAI,MAErBqtC,EACKy0C,EAAQz0C,GAAK3qC,GAAKo/E,EAAQz0C,EAAI,GAAKy0C,EAAQz0C,KAEtD,QAASu1C,GAAgBd,EAAS/2B,GAC9B,GAAI43B,GAAO53B,GAAK+2B,EAAQlnF,OAAS,GAAK,CACtC,OAAO8nF,GAAYZ,EAASa,GAEhC,QAASE,GAAgBf,EAAS/2B,GAC9B,GAAI43B,GAAO53B,GAAK+2B,EAAQlnF,OAAS,EACjC,OAAO8nF,GAAYZ,EAASa,GAmHhC,QAASG,GAAwBxzE,EAAM81B,EAAMxrC,GAA7C,GACQkI,MACAihF,EAAyB,EACzBC,EAAoB,EACpBC,EAAqB,CAsCzB,OArCC,SAASC,GAAY99C,GAClB,GAAIA,YAAgBrW,GAChBzf,EAAKo8B,YAAYtG,GAAM,GAAMz5B,QAAQ,SAAUmD,GAAV,GAMzB7S,GALJwB,EAAQqR,EAAKrR,KACjB,MAAI7D,EAAUmpF,GAA0Bj0E,EAAK+lC,QAA7C,CAGA,GAAI/lC,EAAK2e,QAAS,CAEd,GADIxxB,EAAM6S,EAAK2e,QAAQ3I,MAAMhW,EAAKT,IAAKS,EAAKD,KACxC,mCAAmCtL,KAAKtH,MAClCrC,EAAUqpF,GACZ,MAGJ,UAAWn0E,GAAK2e,UAChBhwB,EAAQqR,EAAK2e,QAAQhwB,OAGzB7D,EAAUopF,GAAqBvlF,YAAiBqnC,KAGhC,gBAATrnC,IAAqBA,YAAiBqnC,KAC7ChjC,EAAO5H,KAAKuD,UAGjB,IAAIy0B,MAAMsT,QAAQJ,GACrB,IAAK,GAAIlpC,GAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAC/BgnF,EAAY99C,EAAKlpC,QAEdkpC,aAAgB7G,GACvB6G,EAAKP,KAAKq+C,GACY,gBAAR99C,GACdtjC,EAAO5H,KAAKkrC,GACLA,YAAgBN,MAAelrC,EAAUopF,IAChDlhF,EAAO5H,KAAKkrC,IAElBA,GACKtjC,EAuJX,QAASqhF,GAAY5gF,EAAGvC,EAAG+qD,EAAGq4B,GAA9B,GAIY7+C,GACKp8B,CAJb,IAAKi7E,EAEE,CAEH,IADI7+C,EAAM,EACDp8B,EAAI,EAAGA,GAAK5F,IAAK4F,EACtBo8B,GAAO8+C,EAAcrjF,EAAGmI,GAAKugB,KAAK2mB,IAAI0b,EAAG5iD,GAAKugB,KAAK2mB,IAAI,EAAI0b,EAAG/qD,EAAImI,EAEtE,OAAOo8B,GANP,MAAO8+C,GAAcrjF,EAAGuC,GAAKmmB,KAAK2mB,IAAI0b,EAAGxoD,GAAKmmB,KAAK2mB,IAAI,EAAI0b,EAAG/qD,EAAIuC,GAstB1E,QAAS+gF,GAAY37C,GACjB,GAAIjlC,GAAI+lC,EAAWG,EAASjB,EAAM,EAAG,GACrC,OAAa,IAATjlC,EAAEolC,KAAqB,GAATplC,EAAEolC,KAAYptB,EAAQutB,WAAWN,GACxC,GAEJ,GA0KX,QAAS47C,GAAU95D,EAAOjP,EAAKuW,GAA/B,GACQyyD,GAAK/6C,EAAWhf,GAChBg6D,EAAKh7C,EAAWjuB,EAuBpB,OAtBIuW,IACe,IAAXyyD,EAAG37C,OACH27C,EAAG37C,KAAO,IAEC,IAAX47C,EAAG57C,OACH47C,EAAG57C,KAAO,MAGE,GAAZ27C,EAAG57C,OAA0B,GAAZ67C,EAAG77C,OAAc47C,EAAG37C,MAAQO,EAAYo7C,EAAG77C,KAAM,IAAM87C,EAAG57C,MAAQO,EAAYq7C,EAAG97C,KAAM,KACxG87C,EAAG57C,KAAO,IAEV27C,EAAG37C,MAAQO,EAAYo7C,EAAG77C,KAAM67C,EAAG57C,QACnC47C,EAAG37C,KAAO,GACK,IAAX47C,EAAG57C,OACH47C,EAAG57C,KAAO,KAGC,IAAX27C,EAAG37C,MAAyB,IAAX47C,EAAG57C,OACpB47C,EAAG57C,KAAO,KAIf,KAAO47C,EAAG97C,KAAO67C,EAAG77C,MAAQ,IAAM87C,EAAG77C,MAAQ47C,EAAG57C,QAAU67C,EAAG57C,KAAO27C,EAAG37C,MAmoBlF,QAAS67C,GAAUl3E,EAAMnR,GACrBtB,KAAKyS,KAAOA,EACZzS,KAAKsB,KAAOA,EAiJhB,QAASsoF,GAAiBx6E,GACtB,MAAqB,gBAAPA,IAAiC,iBAAPA,IAA2B,MAAPA,GAAuB,KAARA,EAE/E,QAASuL,GAAU5P,EAAGiZ,GAClB,MAAOjZ,KAAMiZ,EAAI,EAAIjZ,EAAIiZ,KAAS,EAEtC,QAAS6lE,GAAW9+E,EAAGiZ,GACnB,MAAOjZ,KAAMiZ,EAAI,EAAIjZ,EAAIiZ,EAAI,KAvpHnC,GAKMjjB,GACAsP,EACA4D,EACA0M,EACAwsB,EACA+H,EACAnK,EACA3V,EACAD,EACAE,EACAmP,EACAxP,EACAqZ,EACAQ,EACAH,EACAN,EAq0BA07C,EA4BAC,EA+CAC,EAyfAC,EA+HAC,EAoCAZ,EAoMAa,EA24CAC,EAoZAvC,CAjiHAroF,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DrP,EAAOvB,MAAMuB,KACbsP,EAAc7Q,MAAM6Q,YACpB4D,EAAO5D,EAAY4D,KACnB0M,EAAU1M,EAAK0M,QACfwsB,EAAiBxsB,EAAQwsB,eACzB+H,EAAcv0B,EAAQu0B,YACtBnK,EAAYpqB,EAAQoqB,UACpB3V,EAAW/kB,EAAY+kB,SACvBD,EAAU9kB,EAAY8kB,QACtBE,EAAWhlB,EAAYglB,SACvBmP,EAAS7jB,EAAQ6jB,OACjBxP,EAAM3kB,EAAY2kB,IAClBqZ,EAAc1tB,EAAQ0tB,YACtBQ,EAAWluB,EAAQkuB,SACnBH,EAAa/tB,EAAQ+tB,WACrBN,EAAaztB,EAAQytB,YAErB,MACA,MACA,MACA,OACA,OACA,MACA,OACA,MACA,QACFx8B,QAAQ,SAAU9F,GAChBqhC,EAAerhC,EAAM6iB,KAAK7iB,IAAOu/B,OACzB,KACA,cAGZ8B,EAAe,KAAMxe,KAAK0e,KAAKhC,OACvB,KACA,YAER8B,EAAe,MAAO,SAAU7S,EAAK9c,GACjC,MAAOmR,MAAK0e,IAAI/S,GAAO3L,KAAK0e,IAAI7vB,KACjC6tB,OAEK,OACA,aAGA,SAEI,KACA,YAEI,OACA,OAKR,KAEI,SACA,aACA,YAIZ8B,EAAe,QAAS,SAAU7S,GAC9B,MAAO3L,MAAK0e,IAAI/S,GAAO3L,KAAK0e,IAAI,MACjChC,OACK,OACA,cAER8B,EAAe,KAAM,WACjB,MAAOxe,MAAK07D,KACbh/C,SACH8B,EAAe,SAAU,SAAUlnC,GAC/B,MAAO0oB,MAAKC,KAAK3oB,EAAI0oB,KAAK07D,MAC3Bh/C,OACK,OACA,aAER8B,EAAe,UAAW,SAAUm9C,GAChC,MAAO,KAAMA,EAAM37D,KAAK07D,GAAK,MAC9Bh/C,OACK,WACA,YAER8B,EAAe,UAAW,SAAUo9C,GAChC,MAAO57D,MAAK07D,GAAKE,EAAM,MACxBl/C,OACK,WACA,YAKR8B,EAAe,OAAQk6C,GAAOh8C,OACtB,OACA,YAER8B,EAAe,QAAS,SAAUlnC,GAC9B,MAAO0oB,MAAK0e,IAAIpnC,EAAI0oB,KAAKC,KAAK3oB,EAAI,GAAK0oB,KAAKC,KAAK3oB,EAAI,MACtDolC,OAEK,OACA,WAGA,KAEI,SACA,gBAOZ8B,EAAe,OAAQm6C,GAAOj8C,OACtB,OACA,YAER8B,EAAe,QAAS,SAAUlnC,GAC9B,MAAO0oB,MAAK0e,IAAIpnC,EAAI0oB,KAAKC,KAAK3oB,EAAIA,EAAI,MACvColC,OACK,OACA,YAER8B,EAAe,MAAO,SAAUlnC,GAC5B,MAAO,GAAI0oB,KAAK67D,IAAIvkF,KACrBolC,OACK,OACA,YAER8B,EAAe,OAAQ,SAAUlnC,GAC7B,MAAO,GAAIohF,EAAMphF,KAClBolC,OACK,OACA,YAER8B,EAAe,MAAO,SAAUlnC,GAC5B,MAAO,GAAI0oB,KAAK87D,IAAIxkF,KACrBolC,OACK,OACA,YAER8B,EAAe,OAAQ,SAAUlnC,GAC7B,MAAO,GAAIqhF,EAAMrhF,KAClBolC,OACK,OACA,YAER8B,EAAe,QAAS,SAAU3kC,EAAGimB,GACjC,MAAOE,MAAK+7D,KAAKj8D,EAAIjmB,KACtB6iC,OAEK,KACA,YAGA,KACA,YAMR8B,EAAe,OAAQo6C,GAAOl8C,OACtB,OACA,YAER8B,EAAe,QAAS,SAAUlnC,GAC9B,MAAO0oB,MAAK0e,IAAI1e,KAAKC,KAAK,EAAI3oB,EAAIA,IAAM,EAAIA,MAC7ColC,OACK,QAEI,MACA,UAEI,eAEA,OAIhB8B,EAAe,MAAO,SAAUlnC,GAC5B,MAAO,GAAI0oB,KAAKg8D,IAAI1kF,KACrBolC,OACK,OACA,aAER8B,EAAe,OAAQ,SAAUlnC,GAC7B,MAAO,GAAIshF,EAAMthF,KAClBolC,OACK,OACA,aAER8B,EAAe,OAAQ,SAAUlnC,GAC7B,MAAO0oB,MAAK07D,GAAK,EAAI17D,KAAK+7D,KAAKzkF,KAChColC,OACK,OACA,YAER8B,EAAe,QAAS,SAAUlnC,GAC9B,MAAO0oB,MAAK0e,KAAKpnC,EAAI,IAAMA,EAAI,IAAM,IACtColC,OAEK,OACA,WAGA,KAEI,MAEI,SACA,cAGA,SACA,gBAKhB8B,EAAe,QAAS,SAAUpiC,EAAGiZ,GACjC,MAAO2K,MAAK2mB,IAAIvqC,EAAGiZ,KACpBqnB,OAEK,KACA,WAGA,KACA,YAGR8B,EAAe,MAAO,SAAUpiC,EAAGiZ,GAC/B,MAAOjZ,GAAIiZ,IACZqnB,OAEK,KACA,WAGA,KACA,aAGR8B,EAAe,WAAY,SAAUpiC,EAAGiZ,GACpC,MAAO2K,MAAK+F,MAAM3pB,EAAIiZ,KACvBqnB,OAEK,KACA,WAGA,KACA,aAGR8B,EAAe,UAAW,SAAU7S,EAAKwY,GACrC,MAAOA,GAAIA,EAAInkB,KAAK83B,KAAKnsB,EAAMwY,GAAK,IACrCzH,OAEK,UACA,WAGA,gBACA,WAGA,KAEI,SACA,wCAIZ8B,EAAe,kBAAmB,SAAU7S,EAAKwY,GAE7C,MADAA,GAAInkB,KAAK6I,IAAIsb,GACNA,EAAIA,EAAInkB,KAAK83B,KAAKnsB,EAAMwY,GAAK,IACrCzH,OAEK,UACA,WAGA,iBAEI,KACA,UAEI,OACA,OAKhB6J,EAAY,cAAe,mBAC3B/H,EAAe,eAAgB,SAAU7S,EAAKwY,EAAGjV,GAC7C,MAAKiV,IAAMxY,GAGPA,EAAM,KAAOuD,GAAQiV,EAAI,GAAKjV,GAAQiV,EAAI,KAC1CA,GAAKA,GAEFA,EAAIA,EAAInkB,KAAK83B,KAAKnsB,EAAMwY,GAAK,GALzB,IAMZzH,OAEK,UACA,WAGA,iBAEI,KACA,UAEI,OACA,2BAKR,SAEI,KACA,WAEI,OACA,OAKhB8B,EAAe,QAAS,SAAU7S,EAAKwY,GACnC,MAAOA,GAAIA,EAAInkB,KAAK+F,MAAM4F,EAAMwY,GAAK,IACtCzH,OAEK,UACA,WAGA,gBACA,WAGA,KAEI,SACA,wCAIZ8B,EAAe,gBAAiB,SAAU7S,EAAKwY,GAE3C,MADAA,GAAInkB,KAAK6I,IAAIsb;AACNA,EAAIA,EAAInkB,KAAK+F,MAAM4F,EAAMwY,GAAK,IACtCzH,OAEK,UACA,WAGA,iBAEI,KACA,UAEI,OACA,OAKhB8B,EAAe,aAAc,SAAU7S,EAAKwY,EAAGjV,GAC3C,MAAKiV,IAAMxY,GAGPA,EAAM,KAAOuD,GAAQiV,EAAI,GAAKjV,GAAQiV,EAAI,KAC1CA,GAAKA,GAEFA,EAAIA,EAAInkB,KAAK+F,MAAM4F,EAAMwY,GAAK,GAL1B,IAMZzH,OAEK,UACA,WAGA,iBAEI,KACA,UAEI,OACA,2BAKR,SAEI,KACA,WAEI,OACA,OAKhB8B,EAAe,MAAOxe,KAAK+F,OAAO2W,OAC1B,UACA,YAER8B,EAAe,SAAU,SAAU7S,EAAKswD,GACpC,MAAOA,GAAOA,EAAOj8D,KAAKyd,MAAM9R,EAAMswD,GAAQ,IAC/Cv/C,OAEK,UACA,WAGA,YACA,YAGR8B,EAAe,QAAS,SAAU7S,EAAKlyB,GACnC,GAAI8qC,GAAO5Y,EAAM,KAAS,CAO1B,OANI4Y,GAAO,IACP5Y,GAAOA,GAEXlyB,EAASumB,KAAK2mB,IAAI,GAAIltC,GACtBkyB,GAAOlyB,EACPkyB,EAAM3L,KAAKyd,MAAM9R,GACV4Y,EAAO5Y,EAAMlyB,IACrBijC,OAEK,UACA,WAGA,UACA,YAGR8B,EAAe,UAAW,SAAU7S,EAAKlyB,GAIrC,MAHAA,GAASumB,KAAK2mB,IAAI,GAAIltC,GACtBkyB,GAAOlyB,EACPkyB,EAAMA,EAAM,EAAI3L,KAAK+F,MAAM4F,GAAO3L,KAAK83B,KAAKnsB,GACrCA,EAAMlyB,IACdijC,OAEK,UACA,WAGA,UACA,YAGR8B,EAAe,YAAa,SAAU7S,EAAKlyB,GAIvC,MAHAA,GAASumB,KAAK2mB,IAAI,GAAIltC,GACtBkyB,GAAOlyB,EACPkyB,EAAMA,EAAM,EAAI3L,KAAK83B,KAAKnsB,GAAO3L,KAAK+F,MAAM4F,GACrCA,EAAMlyB,IACdijC,OAEK,UACA,WAGA,UACA,YAGR8B,EAAe,OAAQ,SAAU7S,GAC7B,GAAIr0B,GAAIq0B,EAAM,EAAI3L,KAAK+F,MAAM4F,GAAO3L,KAAK83B,KAAKnsB,EAC9C,OAAOr0B,GAAI,EAAIA,GAAKA,EAAI,KAAS,GAAKA,IACvColC,OACK,UACA,YAER8B,EAAe,MAAO,SAAU7S,GAC5B,GAAIr0B,GAAIq0B,EAAM,EAAI3L,KAAK+F,MAAM4F,GAAO3L,KAAK83B,KAAKnsB,EAC9C,OAAOr0B,GAAI,EAAIA,EAAIA,GAAKA,EAAI,KAAS,KACtColC,OACK,UACA,YAER8B,EAAe,OAAQ,SAAU7S,GAC7B,MAAOA,GAAM,KAASA,EAAM,EAAI,EAAI,IACrC+Q,OACK,UACA,YAaR8B,EAAe,MAAO,SAAU9B,GAAV,GAETlpC,GADL4I,EAAIsgC,EAAK,EACb,KAASlpC,EAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAC/B4I,EAAIy8E,EAAKz8E,EAAGsgC,EAAKlpC,GAErB,OAAO4I,KACRsgC,OACK,WAEI,UACA,aAGZ8B,EAAe,MAAO,SAAU9B,GAAV,GAETlpC,GADL4I,EAAIsgC,EAAK,EACb,KAASlpC,EAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAC/B4I,EAAI08E,EAAK18E,EAAGsgC,EAAKlpC,GAErB,OAAO4I,KACRsgC,OACK,WAEI,UACA,aAGZ8B,EAAe,MAAO,SAAU46C,GAC5B,MAAOA,GAAQh0D,OAAO,SAAUyW,EAAKlQ,GACjC,MAAOkQ,GAAMlQ,GACd,KACJ+Q,OACK,WAEI,UACA,aAGZ8B,EAAe,UAAW,SAAU46C,GAChC,MAAOA,GAAQh0D,OAAO,SAAU82D,EAAMvwD,GAClC,MAAOuwD,GAAOvwD,GACf,KACJ+Q,OACK,WAEI,UACA,aAGZ8B,EAAe,aAAc,SAAU5c,EAAOtF,GAC1C,GAAIuf,GAAM,CAaV,OAZAja,GAAMua,KAAK,SAAUkmB,EAAG18C,EAAKQ,GAAlB,GAEM3S,GACDmG,CAFZ,IAAgB,gBAAL0oD,GAAe,CACtB,IAAS7uD,EAAI,EAAGA,EAAI8oB,EAAKpqB,SAAUsB,EAAG,CAElC,GADImG,EAAI2iB,EAAK9oB,GAAG8B,IAAIqQ,EAAKQ,GACT,gBAALxM,GACP,MAEJ0oD,IAAK1oD,EAETkiC,GAAOwmB,KAGRxmB,IACRa,OAEK,KACA,WAGA,KAEI,MAEI,MACA,UAEI,SACA,2BAGA,SACA,iCAMpB8B,EAAe,QAAS,SAAU46C,GAC9B,MAAOA,GAAQh0D,OAAO,SAAUyW,EAAKlQ,GACjC,MAAOkQ,GAAMlQ,EAAMA,GACpB,KACJ+Q,OACK,WAEI,UACA,aAGZ8B,EAAe,WAAY,SAAUpiC,EAAGiZ,GACpC,GAAIwmB,GAAM,CAOV,OANAz/B,GAAE+/B,KAAK,SAAUtiC,EAAG8L,EAAKQ,GACrB,GAAI2Z,GAAIzK,EAAE/f,IAAIqQ,EAAKQ,EACH,iBAALtM,IAA6B,gBAALimB,KAC/B+b,GAAOhiC,EAAIA,EAAIimB,EAAIA,KAGpB+b,IACRa,OAEK,IACA,WAGA,KAEI,MACA,UAEI,SACA,yBAGA,SACA,8BAKhB8B,EAAe,WAAY,SAAUpiC,EAAGiZ,GACpC,GAAIwmB,GAAM,CAOV,OANAz/B,GAAE+/B,KAAK,SAAUtiC,EAAG8L,EAAKQ,GACrB,GAAI2Z,GAAIzK,EAAE/f,IAAIqQ,EAAKQ,EACH,iBAALtM,IAA6B,gBAALimB,KAC/B+b,GAAOhiC,EAAIA,EAAIimB,EAAIA,KAGpB+b,IACRa,OAEK,IACA,WAGA,KAEI,MACA,UAEI,SACA,yBAGA,SACA,8BAKhB8B,EAAe,UAAW,SAAUpiC,EAAGiZ,GACnC,GAAIwmB,GAAM,CAOV,OANAz/B,GAAE+/B,KAAK,SAAUtiC,EAAG8L,EAAKQ,GACrB,GAAI2Z,GAAIzK,EAAE/f,IAAIqQ,EAAKQ,EACH,iBAALtM,IAA6B,gBAALimB,KAC/B+b,IAAQhiC,EAAIimB,IAAMjmB,EAAIimB,MAGvB+b,IACRa,OAEK,IACA,WAGA,KAEI,MACA,UAEI,SACA,yBAGA,SACA,8BAKhB8B,EAAe,YAAa,SAAU3kC,EAAGvC,EAAG2C,EAAGmC,GAC3C,GAAIy/B,GAAM,CAQV,OAPAz/B,GAAE+/B,KAAK,SAAUggD,GACb,GAAmB,gBAARA,GACP,KAAM,IAAI//C,GAAU,QAExBP,IAAOsgD,EAAOn8D,KAAK2mB,IAAI9sC,EAAGvC,GAC1BA,GAAK2C,IAEF4hC,IACRa,OAEK,IACA,WAGA,IACA,WAGA,IACA,WAGA,IACA,YAGR8B,EAAe,MAAO,SAAU46C,GAC5B,MAAOA,GAAQlnF,OAAS8tB,KAAKqK,IAAI5vB,MAAMulB,KAAMo5D,GAAW,IACzD18C,OACK,WAEI,UACA,aAGZ8B,EAAe,MAAO,SAAU46C,GAC5B,MAAOA,GAAQlnF,OAAS8tB,KAAKoK,IAAI3vB,MAAMulB,KAAMo5D,GAAW,IACzD18C,OACK,WAEI,UACA,aAGZ8B,EAAe,SAAU,SAAUplC,GAC/B,MAAOA,GAAOlH,SACfwqC,OACK,UAEI,WACA,eAGZ8B,EAAe,QAAS,SAAU46C,GAC9B,MAAOA,GAAQlnF,SAChBwqC,OACK,WAEI,WACA,aAGZ8B,EAAe,cAAe,SAAUplC,GACpC,GAAIwV,GAAQ,EAAGwtE,IAOf,OANAhjF,GAAO6J,QAAQ,SAAUxC,GACjB27E,EAAK19D,QAAQje,GAAO,IACpBmO,IACAwtE,EAAK5qF,KAAKiP,MAGXmO,IACR8tB,OACK,UAEI,WACA,eAGZ8B,EAAe,aAAc,SAAUpiC,GAEnC,QAAS2mC,GAAItiC,GACE,MAAPA,GAAuB,KAARA,GACfmO,IAGR,QAAS8F,GAAKgoB,GAAd,GACalpC,GACDqG,CADR,KAASrG,EAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAC3BqG,EAAI6iC,EAAKlpC,GACTqG,YAAag8B,GACbh8B,EAAEsiC,KAAK4G,GAAK,GAEZA,EAAIlpC,GAZhB,GAAI+U,GAAQ,CAiBZ,OADA8F,GAAKtY,GACEwS,IACR8tB,OACK,KAEI,QAEI,KACA,SACA,gBAIhB8B,EAAe,SAAU,SAAU7S,GAC/B,MAAOA,GAAM,IAAM,IACpB+Q,OACK,UACA,YAER8B,EAAe,QAAS,SAAU7S,GAC9B,MAAOA,GAAM,IAAM,IACpB+Q,OACK,UACA,YAER8B,EAAe,IAAK,SAAU/9B,GAC1B,MAAkB,iBAAPA,GACAA,EAAM,EAAI,EAEH,gBAAPA,GACAA,EAEJ,IACRi8B,OACK,SACA,cAER8B,EAAe,KAAM,WACjB,MAAO,IAAIpC,GAAU,SACtBM,SAuBCy+C,IAEI,KACA,WAGA,KACA,cAII,KACA,WAGA,KACA,cAIZ38C,EAAe,WAAY,SAAU69C,EAAI/xD,EAAIhO,GACzC,GAAI1N,GAAQ,CAKZ,OAJA0N,GAAKiB,QAAQ8+D,EAAI/xD,GACjByuD,EAAOz8D,EAAM,WACT1N,MAEGA,IACR8tB,KAAKy+C,GACJC,IACI,QACA,WACDrzD,OAAOozD,GACd38C,EAAe,SAAU,SAAUx8B,EAAOq6E,EAAI/xD,EAAIoS,GAC9CA,EAAKnf,QAAQvb,EAAOi5E,EAAkBoB,EAAI/xD,EAC1C,IAAIuR,GAAM,CAOV,OANAk9C,GAAOr8C,EAAM,SAAU/2B,EAAKQ,GACxB,GAAI1F,GAAMuB,EAAM1M,IAAIqQ,EAAKQ,EACrB1F,KACAo7B,GAAOp7B,KAGRo7B,IACRa,KAAK0+C,GACR58C,EAAe,aAAc,SAAUx8B,EAAOq6E,EAAI/xD,EAAIoS,GAClDA,EAAKnf,QAAQvb,EAAOi5E,EAAkBoB,EAAI/xD,EAC1C,IAAIuR,GAAM,EAAGjtB,EAAQ,CASrB,OARAmqE,GAAOr8C,EAAM,SAAU/2B,EAAKQ,GACxB,GAAI1F,GAAMuB,EAAM1M,IAAIqQ,EAAKQ,EACd,OAAP1F,GAAuB,KAARA,IACfA,EAAM,GAEVo7B,GAAOp7B,EACPmO,MAEGA,EAAQitB,EAAMjtB,EAAQ,GAAIwtB,GAAU,WAC5CM,KAAK0+C,GACR58C,EAAe,UAAW,SAAUy6C,EAAQ9vB,GACxCA,EAAW+vB,EAAc/vB,EACzB,IAAIv6C,GAAQ,CAMZ,OALAqqE,GAAO98C,KAAK,SAAU17B,GACd0oD,EAAS1oD,IACTmO,MAGDA,IACR8tB,OAEK,QACA,WAGA,YACA,cAGJ2+C,IAEI,QACA,WAGA,YACA,aAGA,YAEI,MAEI,MACA,UAEI,SACA,oCAGA,SACA,uCAIJ,OACA,aAKhB78C,EAAe,QAAS,SAAUx8B,EAAOmnD,EAAUmzB,GAC/C,GAAIzgD,GAAM,CAUV,OATAstB,GAAW+vB,EAAc/vB,GACzBnnD,EAAMm6B,KAAK,SAAU17B,EAAKkF,EAAKQ,GAC3B,GAAIgjD,EAAS1oD,GAAM,CACf,GAAI9G,GAAI2iF,EAAShnF,IAAIqQ,EAAKQ,EACtB80E,GAAiBthF,KACjBkiC,GAAOliC,GAAK,MAIjBkiC,IACRa,KAAK2+C,GACR78C,EAAe,YAAa,SAAUx8B,EAAOmnD,EAAUmzB,GACnD,GAAIzgD,GAAM,EAAGjtB,EAAQ,CAWrB,OAVAu6C,GAAW+vB,EAAc/vB,GACzBnnD,EAAMm6B,KAAK,SAAU17B,EAAKkF,EAAKQ,GAC3B,GAAIgjD,EAAS1oD,GAAM,CACf,GAAI9G,GAAI2iF,EAAShnF,IAAIqQ,EAAKQ,EACtB80E,GAAiBthF,KACjBkiC,GAAOliC,GAAK,EACZiV,QAILA,EAAQitB,EAAMjtB,EAAQ,GAAIwtB,GAAU,WAC5CM,KAAK2+C,GACP,SAAUr+B,GACPA,EAAI,QAAS,SAAUo8B,EAASmD,GAC5B,MAAOnD,GAAQhmF,KAAK8nF,GAAYqB,KAEpCv/B,EAAI,QAAS,SAAUo8B,EAASmD,GAC5B,MAAOnD,GAAQhmF,KAAK4Y,GAAWuwE,MAErC,SAAUp/E,EAAMuf,GACd8hB,EAAerhC,EAAM,SAAU87E,EAAQsD,GAAlB,GACbnD,MACA52C,EAAQy2C,EAAO98C,KAAK,SAAU17B,GAC9B,MAAIA,aAAe27B,GACR37B,OAEO,gBAAPA,IACP24E,EAAQ5nF,KAAKiP,KAGrB,OAAI+hC,GACOA,EAEP+5C,EAAMnD,EAAQlnF,OACP,GAAIkqC,GAAU,OAElB1f,EAAQ08D,EAASmD,EAAM,KAC/B7/C,OAEK,QACA,WAGA,OACA,gBAoBZ8B,EAAe,UAAW,SAAU46C,GAChC,MAAOI,GAAUJ,EAASA,EAAQlnF,OAAS,KAC5CwqC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,uBACA,UAIZ8B,EAAe,UAAW,SAAU46C,GAChC,MAAOI,GAAUJ,EAASA,EAAQlnF,UACnCwqC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,uBACA,UAIZ8B,EAAe,QAAS,SAAU46C,GAC9B,MAAOC,GAAQD,EAASA,EAAQlnF,OAAS,KAC1CwqC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,uBACA,UAIZ8B,EAAe,QAAS,SAAU46C,GAC9B,MAAOC,GAAQD,EAASA,EAAQlnF,UACjCwqC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,uBACA,UAIZ8B,EAAe,SAAU,SAAU46C,GAC/B,GAAI9hF,GAAI8hF,EAAQlnF,MAEhB,OADAknF,GAAQhmF,KAAK4Y,GACT1U,EAAI,EACG8hF,EAAQ9hF,GAAK,IAEhB8hF,EAAQ9hF,IAAM,GAAK8hF,EAAQ9hF,EAAI,IAAM,IAC9ColC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,sBACA,UAIZ8B,EAAe,YAAa,SAAU46C,GAAV,GAEpB1/E,GAAakV,EAAWwb,EAAS8E,EAC5B17B,EACD8D,CADR,KAFA8hF,EAAQhmF,KAAK4Y,GACTtS,EAAO,KAAMkV,EAAQ,EAAGwb,EAAM,EAAG8E,EAAO,KACnC17B,EAAI,EAAGA,EAAI4lF,EAAQlnF,SAAUsB,EAC9B8D,EAAI8hF,EAAQ5lF,GACZ8D,GAAKoC,GACLkV,EAAQ,EACRlV,EAAOpC,GAEPsX,IAEAA,EAAQwb,IACRA,EAAMxb,EACNsgB,EAAO53B,EAGf,OAAe,OAAR43B,EAAe,GAAIkN,GAAU,OAASlN,IAC9CwN,OACK,WAEI,UACA,aAGZ8B,EAAe,YAAa,SAAU46C,GAAV,GAYpBn/E,GAXAmiF,EAAO/hF,OAAOC,OAAO,MAAO8vB,EAAM,EAAGoyD,IAezC,OAdApD,GAAQn2E,QAAQ,SAAU0oB,GACtB,GAAIwY,GAAIi4C,EAAKzwD,IAAQ,CACrBywD,GAAKzwD,KAASwY,EACVA,GAAK/Z,EACLoyD,EAAIhrF,KAAKm6B,GACFwY,EAAI/Z,IACXA,EAAM+Z,EACNq4C,GAAO7wD,MAGX1xB,EAAI,GAAI47B,GAAOxkC,MACnBmrF,EAAIv5E,QAAQ,SAAU0oB,EAAKn4B,GACvByG,EAAEupB,IAAIhwB,EAAG,EAAGm4B,KAET1xB,IACRyiC,OACK,WAEI,UACA,aAGZ8B,EAAe,UAAW,SAAU46C,GAAV,GAClB9hF,GAAI8hF,EAAQlnF,OACZmwD,EAAI+2B,EAAQh0D,OAAO,SAAUi9B,EAAG12B,GAChC,GAAIA,EAAM,EACN,KAAM,IAAIyQ,GAAU,MAExB,OAAOimB,GAAI12B,GACZ,EACH,OAAO3L,MAAK2mB,IAAI0b,EAAG,EAAI/qD,KACxBolC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,sBACA,UAIZ8B,EAAe,UAAW,SAAU46C,GAAV,GAClB9hF,GAAI8hF,EAAQlnF,OACZiyC,EAAIi1C,EAAQh0D,OAAO,SAAU+e,EAAGxY,GAChC,IAAKA,EACD,KAAM,IAAIyQ,GAAU,QAExB,OAAO+H,GAAI,EAAIxY,GAChB,EACH,OAAOr0B,GAAI6sC,IACZzH,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,sBACA,UAIZ8B,EAAe,WAAY,SAAU46C,EAAS/2B,GAAnB,GAGnBo6B,GAKA5gD,EACKroC,EARL8D,EAAI8hF,EAAQlnF,MAQhB,KAPAknF,EAAQhmF,KAAK4Y,GACTywE,EAAUz8D,KAAK+F,MAAMzuB,EAAI+qD,GACzBo6B,EAAU,KACRA,EAENA,GAAW,EACP5gD,EAAM,EACDroC,EAAIipF,EAASjpF,EAAI8D,EAAImlF,IAAWjpF,EACrCqoC,GAAOu9C,EAAQ5lF,EAEnB,OAAOqoC,IAAOvkC,EAAc,EAAVmlF,KACnB//C,OAEK,WAEI,UACA,SACA,KAIJ,WAEI,MACA,UAEI,YACA,EACA,MAKR,KAEI,SACA,sBACA,UAIZ8B,EAAe,YAAa,SAAU7iC,EAAM+gF,GAKxC,QAAS9tE,GAAMwb,GAEX,IADA,GAAI9yB,GAAI,EACD9D,EAAImI,EAAKzJ,QAAUyJ,EAAKnI,GAAKkG,GAAQiC,EAAKnI,IAAM42B,KACjD9yB,IACA9D,CAEN,OAAO8D,GAXa,GAGpBoC,GACAlG,EASAyG,CAOJ,OAnBA0B,GAAKvI,KAAK4Y,GACV0wE,EAAKtpF,KAAK4Y,GACNtS,IAAQwU,EAAAA,GACR1a,EAAI,EASJyG,EAAI,GAAI47B,GAAOxkC,MACnBqrF,EAAKz5E,QAAQ,SAAUxC,EAAKjN,GACxB,GAAI8D,GAAIsX,EAAMnO,EACd/G,GAAO+G,EACPxG,EAAEupB,IAAIhwB,EAAG,EAAG8D,KAEhB2C,EAAEupB,IAAIvpB,EAAEpG,OAAQ,EAAG8H,EAAKzJ,OAASsB,GAC1ByG,IACRyiC,OAEK,QAEI,UACA,SACA,KAIJ,QAEI,UACA,SACA,MAIZ8B,EAAe,UAAW,SAAU/9B,EAAK24E,EAASuD,GAC9CvD,EAAQhmF,KAAKupF,EAAM3wE,EAAYkvE,EAC/B,IAAIjkF,GAAMmiF,EAAQ16D,QAAQje,EAC1B,OAAOxJ,GAAM,EAAI,GAAImlC,GAAU,OAASnlC,EAAM,IAC/CylC,OAEK,QACA,WAGA,WAEI,UACA,YAIJ,SAEI,KACA,WAEI,QACA,OAKhB6J,EAAY,OAAQ,WACpB/H,EAAe,WAAY,SAAU/9B,EAAK24E,EAASuD,GAAxB,GAEnB1lF,GAIKzD,CAHT,IAFA4lF,EAAQhmF,KAAKupF,EAAM3wE,EAAYkvE,GAC3BjkF,EAAMmiF,EAAQ16D,QAAQje,GACtBxJ,EAAM,EACN,MAAO,IAAImlC,GAAU,MAEzB,KAAS5oC,EAAIyD,EAAKmiF,EAAQ5lF,IAAMiN,IAAOjN,GAEvC,OAAQyD,EAAMzD,EAAI,GAAK,IACxBkpC,OAEK,QACA,WAGA,WAEI,UACA,YAIJ,SAEI,KACA,WAEI,QACA,OAKhB8B,EAAe,OAAQ,SAAU46C,GAAV,GACf9hF,GAAI8hF,EAAQlnF,OACZqnF,EAAMJ,EAAKC,GACXwD,EAAWvD,EAAQD,EAAS9hF,EAAI,EAAGiiF,GACnCsD,EAAS78D,KAAKC,KAAK28D,GACnB/gD,EAAMu9C,EAAQh0D,OAAO,SAAUyW,EAAKlQ,GACpC,MAAOkQ,GAAM7b,KAAK2mB,KAAKhb,EAAM4tD,GAAOsD,EAAQ,IAC7C,EACH,OAAOvlF,IAAKA,EAAI,KAAOA,EAAI,IAAMA,EAAI,IAAMA,EAAI,IAAMukC,EAAM,EAAI7b,KAAK2mB,IAAIrvC,EAAI,EAAG,KAAOA,EAAI,IAAMA,EAAI,MACrGolC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,uBACA,UA4BR4+C,IAEI,SAEI,UACA,SACA,KAIJ,IACA,WAGA,gBAEI,MAEI,OACA,GAEJ,eAIJ,KAEI,SACA,oBACA,SAIZ98C,EAAe,kBAAmB,SAAU46C,EAASv/E,EAAGijF,GACpD,GAAIz6B,GAAIo3B,EAAaL,EAASv/E,EAAG,EAEjC,OADAwoD,GAAIA,EAAE01B,QAAQ+E,EAAe,GACtB/kC,WAAWsK,EAAE/oC,OAAO,EAAG+oC,EAAEnwD,OAAS,MAC1CwqC,KAAK4+C,GACR98C,EAAe,kBAAmB,SAAU46C,EAASv/E,EAAGijF,GACpD,GAAIz6B,GAAIo3B,EAAaL,EAASv/E,EAAG,EAEjC,OADAwoD,GAAIA,EAAE01B,QAAQ+E,EAAe,GACtB/kC,WAAWsK,EAAE/oC,OAAO,EAAG+oC,EAAEnwD,OAAS,MAC1CwqC,KAAK4+C,GACR/0C,EAAY,cAAe,mBAW3B/H,EAAe,eAAgB,SAAU3kC,EAAGimB,GACxC,MAAO+5D,GAAYhgF,EAAGimB,EAAGjmB,EAAE3H,UAC5BwqC,OAEK,UAEI,UACA,SACA,KAIJ,UAEI,UACA,SACA,KAIJ,KAEI,SACA,mCACA,SAIJ,KAEI,SACA,qBACA,YAIZ8B,EAAe,eAAgB,SAAU3kC,EAAGimB,GACxC,MAAO+5D,GAAYhgF,EAAGimB,EAAGjmB,EAAE3H,OAAS,KACrCwqC,OAEK,UAEI,UACA,SACA,KAIJ,UAEI,UACA,SACA,KAIJ,KAEI,SACA,mCACA,SAIJ,KAEI,SACA,qBACA,YAIZ6J,EAAY,QAAS,gBACjBg1C,EAAQnpF,EAAK+H,QAAQ,SAAU7C,GAC/B,IAAK,GAAI9D,GAAI,EAAGupF,EAAO,EAAGvpF,GAAK8D,IAAK9D,EAChCupF,GAAQvpF,CAEZ,OAAOupF,KAEXv+C,EAAe,OAAQ+8C,GAAO7+C,OACtB,KACA,cAER8B,EAAe,aAAc,SAAUlnC,GACnC,IAAK,GAAI9D,GAAI,GAAS,EAAJ8D,GAAQylF,EAAO,EAAGvpF,GAAK8D,EAAG9D,GAAK,EAC7CupF,GAAQvpF,CAEZ,OAAOupF,KACRrgD,OACK,KACA,cAER8B,EAAe,cAAe,SAAU46C,GACpC,GAAIpkE,GAAM,EAAG6mB,EAAM,CAQnB,OAPAu9C,GAAQn2E,QAAQ,SAAU3L,GACtB,GAAIA,EAAI,EACJ,KAAM,IAAI8kC,GAAU,MAExBP,IAAOvkC,EACP0d,GAAOumE,EAAMjkF,KAEVikF,EAAM1/C,GAAO7mB,IACrB0nB,OACK,WAEI,UACA,aAGRi+C,EAAgBvoF,EAAK+H,QAAQ,SAAU7C,EAAGqtC,GAC1C,IAAK,GAAIq4C,GAAKr4C,EAAI,EAAGs4C,EAAK,EAAGC,EAAK,EAAGC,EAAK,EAAGF,GAAM3lF,EAAIqtC,IAAKq4C,IAAMC,EAC9DC,GAAMF,EACNG,GAAMF,CAEV,OAAOC,GAAKC,IAEhB3+C,EAAe,SAAUm8C,GAAej+C,OAEhC,KACA,cAGA,MAEI,MACA,WAEI,YACA,EACA,UAKhB8B,EAAe,UAAW,SAAUlnC,EAAGqtC,GACnC,MAAOg2C,GAAcrjF,EAAIqtC,EAAI,EAAGrtC,EAAI,KACrColC,OAEK,KACA,cAGA,MAEI,MACA,WAEI,YACA,EACA,UAKhB8B,EAAe,UAAW,SAAU46C,GAChC,GAAIv9C,GAAMu9C,EAAQh0D,OAAO,SAAUyW,EAAKlQ,GACpC,MAAOkQ,GAAMlQ,GACd,EACH,OAAOkQ,GAAMu9C,EAAQlnF,SACtBwqC,OAEK,WAEI,UACA,aAIJ,KAEI,SACA,sBACA,YAIZ8B,EAAe,WAAY,SAAUplC,GACjC,GAAIyiC,GAAM,EAAGjtB,EAAQ,CAOrB,OANAxV,GAAO6J,QAAQ,SAAU0oB,GACH,gBAAPA,KACPkQ,GAAOlQ,KAET/c,IAECA,EAAQitB,EAAMjtB,EAAQ,GAAIwtB,GAAU,WAC5CM,OACK,UAEI,UACA,eAwBZ8B,EAAe,iBAAkB07C,GAAiBx9C,OAE1C,WAEI,UACA,SACA,KAIJ,KAEI,MACA,UAEI,YACA,EACA,OAKhB8B,EAAe,iBAAkB27C,GAAiBz9C,OAE1C,WAEI,UACA,SACA,KAIJ,KAEI,MACA,UAEI,YACA,EACA,OAKhB8B,EAAe,eAAgB,SAAU46C,EAASrH,GAC9C,MAAOmI,GAAgBd,EAASrH,EAAU,KAC3Cr1C,OAEK,WAEI,UACA,SACA,KAIJ,WAEI,SACA,EACA,EACA,EACA,EACA,MAIZ8B,EAAe,eAAgB,SAAU46C,EAASrH,GAC9C,MAAOoI,GAAgBf,EAASrH,EAAU,KAC3Cr1C,OAEK,WAEI,UACA,SACA,KAIJ,WAEI,SACA,EACA,EACA,EACA,EACA,MAIZ6J,EAAY,WAAY,gBACxBA,EAAY,aAAc,kBACtBi1C,GACA,UACA,QACA,SACA,MACA,MACA,UACA,UACA,UACA,MACA,QACA,QACA,SACA,YACA,QACA,QACA,iBACA,eACA,iBACA,gBA8CJh9C,EAAe,YAAa,SAAU17B,EAAUs6E,EAAQlsF,EAASwrC,GAC7D,GAAI91B,GAAOvV,IACXuV,GAAK07B,aAAa5F,EAAM,WAAA,GAChBtjC,GAGIurC,CAFR,IAAIy4C,EAAS,IAMT,GALAhkF,EAASghF,EAAwBxzE,EAAM81B,EAAK,GAAIxrC,GAC5CyzC,EAAIjI,EAAK,GACTiI,YAAane,KACbme,EAAI/9B,EAAKs8B,WAAWyB,IAER,gBAALA,GACP,MAAO7hC,GAAS,GAAIs5B,GAAU,cAGlChjC,GAASghF,EAAwBxzE,EAAM81B,EAAMxrC,EAEjD0V,GAAK63B,KAAK+8C,EAAgB4B,EAAS,GAAIt6E,EAAU1J,OAEtDylC,YAEK,UAEI,SACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,MAIJ,WAEI,MAEI,OACA,IAGA,SACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,MAKR,OACA,UAGRL,EAAe,WAAY,SAAU17B,EAAUs6E,GAApB,GAMnB1gD,GACKlpC,EANLoT,EAAOvV,KACPgsF,EAAeD,EAAS,GAK5B,KAJIC,IACAD,GAAU,KAEV1gD,KACKlpC,EAAI,EAAGA,EAAIgH,UAAUtI,SAAUsB,EACpCkpC,EAAKlrC,KAAKgJ,UAAUhH,GAExBoT,GAAK07B,aAAa5F,EAAM,WACpB,GAAItjC,GAASghF,EAAwBxzE,EAAM81B,EAAM2gD,EAAe,EAAI,EACpEz2E,GAAK63B,KAAK+8C,EAAgB4B,EAAS,GAAIt6E,EAAU1J,OAEtDylC,YAEK,UAEI,SACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GACA,GACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,OAIJ,KAEI,OAEI,KACA,MACA,eAKhBL,EAAe,SAAU,SAAU46C,GAC/B,GAAIG,GAAMH,EAAQh0D,OAAO,SAAUyW,EAAKlQ,GACpC,MAAOkQ,GAAMlQ,GACd,GAAKytD,EAAQlnF,MAChB,OAAOknF,GAAQh0D,OAAO,SAAUyW,EAAKlQ,GACjC,MAAOkQ,GAAM7b,KAAK6I,IAAI8C,EAAM4tD,IAC7B,GAAKH,EAAQlnF,SACjBwqC,OAEK,WAEI,UACA,YAIJ,KAEI,SACA,uBACA,UAeZ8B,EAAe,aAAci8C,GAAa/9C,OAElC,YACA,aAGA,UAEI,MACA,WAEI,SACA,4BAKR,eAEI,MACA,UAEI,YACA,EACA,MAKR,aACA,aAGR6J,EAAY,YAAa,cACzB/H,EAAe,YAAa,SAAUlnC,EAAG+qD,EAAGi7B,GACxC,IAAK,GAAIzjF,GAAI,EAAGA,GAAKvC,IAAKuC,EACtB,GAAI4gF,EAAY5gF,EAAGvC,EAAG+qD,GAAG,IAASi7B,EAC9B,MAAOzjF,EAGf,OAAO,IAAIuiC,GAAU,SACtBM,OAEK,SACA,aAGA,eAEI,MACA,UAEI,YACA,EACA,MAKR,SAEI,MACA,UAEI,YACA,EACA,OAKhB6J,EAAY,YAAa,aACzB/H,EAAe,mBAAoB,SAAUlnC,EAAG+qD,EAAGle,EAAGo5C,GAAnB,GAEtB54C,GADL9I,EAAM,CACV,KAAS8I,EAAIR,EAAGQ,GAAK44C,IAAM54C,EACvB9I,GAAO8+C,EAAcrjF,EAAGqtC,GAAK3kB,KAAK2mB,IAAI0b,EAAG1d,GAAK3kB,KAAK2mB,IAAI,EAAI0b,EAAG/qD,EAAIqtC,EAEtE,OAAO9I,KACRa,OAEK,SACA,aAGA,eAEI,MACA,UAEI,YACA,EACA,MAKR,iBAEI,MACA,WAEI,YACA,EACA,cAKR,iBAEI,MAEI,MACA,WAEI,YACA,iBACA,aAIJ,OACA,sBAKhB8B,EAAe,gBAAiB,SAAU3kC,EAAG8qC,EAAG0d,EAAGq4B,GAC/C,GAAIA,EAAY,CAEZ,IADA,GAAI7+C,GAAM,EACHhiC,GAAK,GACRgiC,GAAO8+C,EAAc9gF,EAAI8qC,EAAI,EAAG9qC,GAAKmmB,KAAK2mB,IAAI0b,EAAG1d,GAAK3kB,KAAK2mB,IAAI,EAAI0b,EAAGxoD,GACtEA,GAEJ,OAAOgiC,GAEX,MAAO8+C,GAAc9gF,EAAI8qC,EAAI,EAAG9qC,GAAKmmB,KAAK2mB,IAAI0b,EAAG1d,GAAK3kB,KAAK2mB,IAAI,EAAI0b,EAAGxoD,KACvE6iC,OAEK,WACA,aAGA,WACA,aAGA,iBAEI,MACA,UAEI,YACA,EACA,MAKR,aACA,aAGR6J,EAAY,eAAgB,iBAC5B/H,EAAe,UAAW,SAAU74B,EAAKQ,EAAK0iB,EAAKv2B,EAAI4Q,GACnD,GAAIkD,GAAO,GAAIogB,GAAQ7gB,EAAM,EAAGQ,EAAM,EAAG0iB,EAAM,EAI/C,OAHI3lB,IACAkD,EAAK+V,SAASjZ,GAAO,GAElB5Q,EAAK8T,EAAKgW,MAAM,EAAG,GAAKhW,EAAKgW,UACrCsgB,OAEK,MACA,cAGA,MACA,cAGA,OAEI,MAEI,OACA,IAGA,SACA,EACA,EACA,EACA,MAKR,MAEI,MAEI,QACA,GAEJ,aAIJ,SAEI,KACA,OACA,aAIZ8B,EAAe,QAAS,SAAUz7B,GAC9B,GAAI6L,GAAQ,CAQZ,OAPC,SAAS8F,GAAK7a,GACPA,YAAa2sB,IAAW3sB,YAAa4sB,GACrC7X,IACO/U,YAAa6sB,IACpB7sB,EAAEiuB,KAAK7kB,QAAQyR,IAErB3R,GACK6L,IACR8tB,OACK,MACA,SAER8B,EAAe,SAAU,SAAU1iC,EAAO4gC,GACtC,MAAI5gC,GAAQ4gC,EAAKxqC,OACN,GAAIkqC,GAAU,OAEdM,EAAK5gC,EAAQ,KAEzB4gC,OAEK,SACA,YAGA,KAEI,QACA,eAIZ8B,EAAe,SAAU,SAAUz7B,GAC/B,MAAKA,GAGDA,YAAeyjB,GACRzjB,EAAIoD,IAAM,EAEd9U,KAAKoxC,SAAS1/B,GAAKghC,OAAO,SAAU59B,GACvC,MAAOA,GAAMpD,EAAI2C,QAAQS,IAAM,IANxB9U,KAAK0zB,QAAQ5e,IAAM,IAQ/Bu2B,OACK,OAEI,KACA,OACA,WAGZ8B,EAAe,UAAW,SAAUvkC,GAChC,MAAOA,aAAaosB,GAAMpsB,EAAErG,QAAUqG,EAAErG,QACzC8oC,OACK,OAEI,KACA,OACA,cAGZ8B,EAAe,cAAe,SAAUz7B,GACpC,GAAIqD,GAAO/U,KAAK2xC,YAAYjgC,GAAK,EACjC,OAAKqD,GAAK2e,QAGH3e,EAAK2e,QAAQ3I,MAAMhW,EAAKT,IAAKS,EAAKD,KAF9B,GAAIi2B,GAAU,SAG1BM,OACK,MACA,SAER8B,EAAe,UAAW,SAAUzpC,EAAOkF,EAAG0L,EAAK63E,GAC/C,GAAIC,GAAY,IAahB,OAZAxjF,GAAE4pC,QAAQ,SAAU19B,GAChB,GAAIxK,GAAO1B,EAAE3E,IAAI,EAAG6Q,EACpB,IAAIq3E,EAAQ,CACR,GAAI7hF,EAAO5G,EACP,OAAO,CAEX0oF,GAAYt3E,MACT,IAAIxK,IAAS5G,EAEhB,MADA0oF,GAAYt3E,GACL,IAGE,MAAbs3E,EACO,GAAIrhD,GAAU,OAElBniC,EAAE3E,IAAIqQ,EAAM,EAAG83E,KACvB/gD,OAEK,QACA,aAGA,QACA,WAGA,MACA,cAGA,UAEI,KACA,WAEI,QACA,OAKhB8B,EAAe,QAAS,SAAU17B,EAAUC,EAAK4C,EAAKQ,EAAKu3E,GAAnC,GAgBRt3E,GAOAu3E,EAOAlvD,EA7BR7nB,EAAOvV,IAIX,IAHI0R,YAAe2jB,KACf3jB,EAAMA,EAAI+kB,KAAK41D,EAAU,KAExB/3E,IAAQQ,IAAQpD,EACjB,MAAOD,GAAS,GAAIs5B,GAAU,OAKlC,IAHIr5B,YAAeyjB,KACfzjB,EAAMA,EAAII,cAEVJ,YAAe0jB,GAAU,CACzB,GAAI9gB,GAAOQ,EACP,MAAIA,GAAMpD,EAAInP,SAAW+R,EAAM5C,EAAIlP,SACxBiP,EAAS,GAAIs5B,GAAU,SAE9Bh2B,EAAOrD,EAAIioB,OAAOrlB,EAAM,EAAGQ,EAAM,OACrCS,GAAK07B,cAAcl8B,GAAO,WACtBtD,EAAS8D,EAAKs8B,WAAW98B,MAIjC,KAAKT,EAKD,MAJIg4E,GAAW56E,EAAIokB,SAAShhB,EAAM,OAClCS,GAAK07B,cAAcq7C,GAAW,WAC1B76E,EAAS8D,EAAK67B,SAASk7C,KAI/B,KAAKx3E,EAKD,MAJIsoB,GAAW1rB,EAAImkB,MAAMvhB,EAAM,OAC/BiB,GAAK07B,cAAc7T,GAAW,WAC1B3rB,EAAS8D,EAAK67B,SAAShU,UAI5B,IAAI1rB,YAAe8yB,GAAQ,CAC9B,GAAI9yB,EAAInP,MAAQ,GAAKmP,EAAIlP,OAAS,EAAG,CACjC,GAAI8R,GAAOQ,EACP,MAAOrD,GAASC,EAAIzN,IAAIqQ,EAAM,EAAGQ,EAAM,GAE3C,KAAKR,EACD,MAAO7C,GAASC,EAAI+gC,OAAO,SAAUn+B,GACjC,MAAO5C,GAAIzN,IAAIqQ,EAAKQ,EAAM,KAGlC,KAAKA,EACD,MAAOrD,GAASC,EAAIghC,OAAO,SAAU59B,GACjC,MAAOpD,GAAIzN,IAAIqQ,EAAM,EAAGQ,MAIpC,GAAiB,GAAbpD,EAAInP,MACJ,MAAOkP,GAASC,EAAIzN,IAAIqQ,EAAM,EAAG,GAErC,IAAkB,GAAd5C,EAAIlP,OACJ,MAAOiP,GAASC,EAAIzN,IAAI,EAAG6Q,EAAM,QAGrCrD,GAAS,GAAIs5B,GAAU,UAE5ByC,YAEK,SAEI,KACA,MACA,YAIJ,OAEI,KACA,WACA,UAIJ,OAEI,KACA,WACA,UAIJ,WAEI,KACA,aAEI,OACA,OAKhBL,EAAe,WAAY,SAAUp/B,GAAV,GAEfzO,GACA6rD,CAFR,KAGI,GAFI7rD,EAAIU,KAAK0zB,QACTy3B,EAAMl3C,EAAKgiC,aAAa32C,EAAEuS,MAAOvS,EAAEgV,IAAKhV,EAAEwV,IAAK/G,KAC7Co9C,EAAIM,cAAez2B,IACrB,KAAM,EAEV,OAAOm2B,GAAIM,IAAIj2B,SAASl2B,EAAEgV,IAAKhV,EAAEwV,KACnC,MAAOlL,GACL,MAAO,IAAImhC,GAAU,UAE1BM,OACK,QACA,YAER8B,EAAe,QAAS,SAAU/9B,EAAKxG,EAAG2I,GACtC,GAAeg7E,GAAX9hF,EAAQ,CAQZ,OAPa,KAAT8G,EACAg7E,EAAM1E,EAAcz4E,GACbmC,OACPg7E,EAAM1E,EAAc,KAAOz4E,GACX,IAATmC,IACPg7E,EAAM1E,EAAc,KAAOz4E,IAE3BxG,EAAEkiC,KAAK,SAAUnmB,GACb,MAAU,OAANA,GAAc4nE,EAAI5nE,IACL,IAATpT,GAAcnC,GAAOuV,KACnBla,GAEC,OAEXA,OACD,IAASA,EAAQ,EACbA,EAEA,GAAIsgC,GAAU,SAE1BM,OAEK,QACA,aAGA,QACA,WAGA,QAEI,MAEI,YAEA,EACA,IAGA,OACA,OAKhB8B,EAAe,SAAU,SAAUz7B,EAAK8F,EAAMijB,EAAMj4B,EAAQD,GACxD,GAAI8R,IAAW3C,YAAeyjB,GAAUzjB,EAAMA,EAAI2C,SAASuW,OAG3D,OAFAvW,GAAQC,KAAOkD,EACfnD,EAAQS,KAAO2lB,EACXpmB,EAAQC,IAAM,GAAKD,EAAQS,IAAM,EAC1B,GAAIi2B,GAAU,SAErBvoC,EAAS,GAAKD,EAAQ,EACf,GAAI6yB,GAAS/gB,EAAS,GAAI8gB,GAAQ9gB,EAAQC,IAAM9R,EAAS,EAAG6R,EAAQS,IAAMvS,EAAQ,IAAIuoB,SAASpZ,EAAIG,MAAOH,EAAI4jB,YAElHjhB,IACRg3B,OAEK,MACA,SAGA,QACA,YAGA,QACA,YAGA,WAEI,KACA,aAEI,OACA,oBAKR,UAEI,KACA,aAEI,OACA,oBAKhB8B,EAAe,MAAO,SAAUz7B,GAC5B,MAAKA,GAGDA,YAAeyjB,GACRzjB,EAAI4C,IAAM,EAEdtU,KAAKoxC,SAAS1/B,GAAK+gC,OAAO,SAAUn+B,GACvC,MAAOA,GAAM5C,EAAI2C,QAAQC,IAAM,IANxBtU,KAAK0zB,QAAQpf,IAAM,IAQ/B+2B,OACK,OAEI,KACA,OACA,WAGZ8B,EAAe,OAAQ,SAAUvkC,GAC7B,MAAOA,aAAaosB,GAAMpsB,EAAEpG,SAAWoG,EAAEpG,SAC1C6oC,OACK,OAEI,KACA,OACA,cAGZ8B,EAAe,UAAW,SAAUzpC,EAAOkF,EAAGkM,EAAKq3E,GAC/C,GAAIK,GAAY,IAwBhB,OAvBoB,gBAAT9oF,KACPyoF,GAAS,GAEO,gBAATzoF,KACPA,EAAQA,EAAM6E,eAElBK,EAAE2pC,QAAQ,SAAUj+B,GAChB,GAAIhK,GAAO1B,EAAE3E,IAAIqQ,EAAK,EACtB,IAAI63E,EAAQ,CACR,GAAI7hF,EAAO5G,EACP,OAAO,CAEX8oF,GAAYl4E,MAKZ,IAHmB,gBAARhK,KACPA,EAAOA,EAAK/B,eAEZ+B,IAAS5G,EAET,MADA8oF,GAAYl4E,GACL,IAIF,MAAbk4E,EACO,GAAIzhD,GAAU,OAElBniC,EAAE3E,IAAIuoF,EAAW13E,EAAM,KAC/Bu2B,OAEK,QACA,aAGA,QACA,WAGA,MACA,cAGA,UAEI,KACA,WAEI,QACA,OAKhB8B,EAAe,OAAQ,SAAUS,EAAMC,EAAOC,GAC1C,MAAOe,GAASjB,EAAMC,EAAQ,EAAGC,KAClCzC,OAEK,QACA,YAGA,SACA,YAGA,QACA,aAGR8B,EAAe,MAAO,SAAUW,GAC5B,MAAOY,GAAWZ,GAAMA,OACzBzC,OACK,QACA,UAER8B,EAAe,QAAS,SAAUW,GAC9B,MAAOY,GAAWZ,GAAMD,MAAQ,IACjCxC,OACK,QACA,UAER8B,EAAe,OAAQ,SAAUW,GAC7B,MAAOY,GAAWZ,GAAMF,OACzBvC,OACK,QACA,UAER8B,EAAe,UAAW,SAAUW,GAChC,MAAOY,GAAWZ,GAAMC,IAAM,IAC/B1C,OACK,QACA,UAER8B,EAAe,UAAW,SAAUW,EAAMv8B,GAAhB,GAGlBoe,GAFA88D,EAAK59C,EAASH,EAAWZ,GAAMF,KAAM,EAAG,GACxC8+C,EAAKh+C,EAAW+9C,EAyBpB,OAvBY,KAARl7E,GACAoe,EAAO,GAAK+8D,EAAG3+C,IAAM,GAAK,EACtBpe,EAAO,IACPA,GAAQ,GAEZ88D,GAAM98D,EACN+8D,EAAG5+C,MAAQne,EACX+8D,EAAG3+C,IAAM,EACTx8B,EAAO,GAGHA,EADQ,GAARA,EACO,EACQ,GAARA,EACA,GAECA,EAAO,IAAM,EAG7Boe,EAAO+8D,EAAG3+C,IAAMx8B,EACZoe,EAAO,IACPA,GAAQ,GAEZ88D,GAAM98D,EACChB,KAAK83B,MAAM3Y,EAAO,EAAI2+C,GAAM,KACpCphD,OAEK,QACA,SAGA,SAEI,MAEI,OACA,IAGA,SACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,QAYhB8B,EAAe,aAAc,SAAoBW,GAApB,GACrBnlC,GAAI+lC,EAAWZ,GACf6+C,EAAMhkF,EAAEolC,KAAO,EACf6+C,EAAKj+D,KAAK+F,OAAO/rB,EAAEqlC,IAAM2+C,EAAM,IAAM,EACzC,OAAIC,GAAK,EACErD,EAAY5gF,EAAEilC,KAAO,GACf,IAANg/C,GAAYA,EAAKrD,EAAY5gF,EAAEilC,MAC/B,EAEJg/C,IACRvhD,OACK,QACA,UAER8B,EAAe,MAAO,WAClB,MAAOxsB,GAAQmvB,aAAa,GAAIhmC,SACjCuhC,SACH8B,EAAe,QAAS,WACpB,MAA0C,GAAnCxsB,EAAQmvB,aAAa,GAAIhmC,SACjCuhC,SACH8B,EAAe,OAAQ,SAAUwC,EAAIC,EAAIC,GACrC,MAAOlvB,GAAQ+uB,SAASC,EAAIC,EAAIC,EAAI,KACrCxE,OAEK,SACA,YAGA,WACA,YAGA,WACA,aAGR8B,EAAe,OAAQ,SAAU4C,GAC7B,MAAOpvB,GAAQmuB,WAAWiB,GAAMf,QACjC3D,OACK,QACA,cAER8B,EAAe,SAAU,SAAU4C,GAC/B,MAAOpvB,GAAQmuB,WAAWiB,GAAMd,UACjC5D,OACK,QACA,cAER8B,EAAe,SAAU,SAAU4C,GAC/B,MAAOpvB,GAAQmuB,WAAWiB,GAAMb,UACjC7D,OACK,QACA,cAER8B,EAAe,QAAS,SAAU3vB,EAAMgmE,GAAhB,GAChB76E,GAAI+lC,EAAWlxB,GACf5U,EAAID,EAAEklC,MAAQ21C,EACd/0D,EAAI9lB,EAAEilC,KAAOjf,KAAK+F,MAAM9rB,EAAI,GAMhC,OALAA,IAAK,GACDA,EAAI,IACJA,GAAK,IAETD,EAAIgmB,KAAKqK,IAAIrwB,EAAEmlC,KAAMO,EAAY5f,EAAG7lB,IAC7BimC,EAASpgB,EAAG7lB,EAAGD,KACvB0iC,OAEK,cACA,SAGA,UACA,aAGR8B,EAAe,UAAW,SAAU3vB,EAAMgmE,GAAhB,GAClB76E,GAAI+lC,EAAWlxB,GACf5U,EAAID,EAAEklC,MAAQ21C,EACd/0D,EAAI9lB,EAAEilC,KAAOjf,KAAK+F,MAAM9rB,EAAI,GAMhC,OALAA,IAAK,GACDA,EAAI,IACJA,GAAK,IAETD,EAAI0lC,EAAY5f,EAAG7lB,GACZimC,EAASpgB,EAAG7lB,EAAGD,KACvB0iC,OAEK,cACA,SAGA,UACA,aAGR8B,EAAe,UAAW,SAAUW,EAAM7nC,EAAG4mF,GAAnB,GAGlBF,GAFAG,EAAM7mF,EAAI,EAAI,IAGlB,KAFAA,EAAI0oB,KAAK6I,IAAIvxB,GACT0mF,EAAMj+C,EAAWZ,GAAMC,IACpB9nC,EAAI,GACP6nC,GAAQg/C,EACRH,GAAOA,EAAMG,GAAO,EAChBH,EAAM,GAAKA,EAAM,GAAKE,EAASx/D,QAAQygB,GAAQ,KAC7C7nC,CAGV,OAAO6nC,KACRzC,OAEK,aACA,SAGA,OACA,YAGA,YAEI,UACA,WAIZ8B,EAAe,cAAe,SAAUW,EAAMrtB,EAAKosE,GAArB,GAElBt+E,GAIJgP,EACAovE,CACJ,KAPI7+C,EAAOrtB,IACHlS,EAAMu/B,EACVA,EAAOrtB,EACPA,EAAMlS,GAENgP,EAAQ,EACRovE,EAAMj+C,EAAWZ,GAAMC,IACpBD,GAAQrtB,GACPksE,EAAM,GAAKA,EAAM,GAAKE,EAASx/D,QAAQygB,GAAQ,GAC/CvwB,IAEJuwB,IACA6+C,GAAOA,EAAM,GAAK,CAEtB,OAAOpvE,KACR8tB,OAEK,aACA,SAGA,WACA,SAGA,YAEI,UACA,WAIZ8B,EAAe,OAAQ,SAAUzd,EAAOjP,GACpC,MAAOA,GAAMiP,IACd2b,OAEK,cACA,SAGA,YACA,UA8BR1qB,EAAQ6oE,UAAYA,EACpBr8C,EAAe,UAAWq8C,GAAWn+C,OAE7B,cACA,SAGA,YACA,SAGA,WAEI,KACA,WAEI,QACA,OAKhB8B,EAAe,WAAY,SAAUzd,EAAOjP,EAAKuW,GAC7C,OAAQA,GACR,IAAK,GACD,MAAOwyD,GAAU95D,EAAOjP,GAAK,GAAS,GAC1C,KAAK,GACD,OAAQA,EAAMiP,GAAS0e,EAAWM,EAAWhf,GAAOke,KACxD,KAAK,GACD,OAAQntB,EAAMiP,GAAS,GAC3B,KAAK,GACD,OAAQjP,EAAMiP,GAAS,GAC3B,KAAK,GACD,MAAO85D,GAAU95D,EAAOjP,GAAK,GAAQ,OAE1C4qB,OAEK,cACA,SAGA,YACA,SAGA,WAEI,MAEI,OACA,IAGA,SACA,EACA,EACA,EACA,EACA,OAKhB8B,EAAe,YAAa,SAAU7rC,GAClC,GAAIwsC,GAAOntB,EAAQ4vB,UAAUjvC,EAC7B,OAAIwsC,GACOntB,EAAQmvB,aAAahC,GAEzB,GAAI/C,GAAU,WACtBM,OACK,QACA,YAER8B,EAAe,YAAa,SAAU7rC,GAAV,GAGhBquC,GACAC,EACAC,EACA22C,EALJ59E,EAAItH,EAAKiH,cAAciW,MAAM,8CACjC,OAAI5V,IACI+mC,EAAK+W,WAAW99C,EAAE,IAClBgnC,EAAK8W,WAAW99C,EAAE,IAClBinC,EAAKjnC,EAAE,GAAK89C,WAAW99C,EAAE,IAAM,EAC/B49E,EAAO59E,EAAE,GACT49E,IAAS72C,EAAK,IAAMA,EAAK,GAClB,GAAI5E,GAAU,UAErB,KAAKvhC,KAAKg9E,KACV72C,GAAM,IAEHhvB,EAAQ+uB,SAASC,EAAIC,EAAIC,EAAI,KAEjC,GAAI9E,GAAU,WACtBM,OACK,QACA,YAER8B,EAAe,UAAW,SAAUvkC,GAChC,GAAIuoC,GAAQvoC,EAAEkiC,KAAK,SAAU17B,GACzB,GAAkB,gBAAPA,GACP,MAAO,IAAI27B,GAAU,WAE1B,EACH,OAAOoG,IAASvoC,EAAEuqC,gBACnB9H,OACK,KAEI,MACA,UAEI,SACA,6BAIhB8B,EAAe,YAAa,SAAUvkC,GAClC,MAAOA,GAAE+pC,cACVtH,OACK,QACA,YAER8B,EAAe,QAAS,SAAUpiC,EAAGiZ,GACjC,MAAOjZ,GAAE8nC,SAAS7uB,KACnBqnB,OAEK,IACA,WAGA,KAEI,MACA,UAEI,SACA,6BAKhB8B,EAAe,QAAS,SAAUlnC,GAC9B,MAAO,IAAIu+B,GAAOxkC,MAAM4yC,KAAK3sC,KAC9BolC,OACK,IACA,cAER8B,EAAe,WAAY,SAAUvkC,GACjC,GAAIuoC,GAAQvoC,EAAEkiC,KAAK,SAAU17B,GACzB,GAAkB,gBAAPA,GACP,MAAO,IAAI27B,GAAU,WAE1B,EACH,OAAOoG,IAASvoC,EAAE2qC,WAAa,GAAIxI,GAAU,WAC9CM,OACK,KAEI,MACA,UAEI,SACA,6BAIhB8B,EAAe,OAAQ,WACnB,MAAOxe,MAAKo+D,WACb1hD,SACH8B,EAAe,cAAe,SAAUnU,EAAKD,GACzC,MAAOC,GAAMrK,KAAK+F,OAAOqE,EAAMC,EAAM,GAAKrK,KAAKo+D,YAChD1hD,OAEK,MACA,YAGA,OAEI,MACA,WAEI,SACA,oBAKhB8B,EAAe,OAAQ,WACnB,OAAO,IACR9B,SACH8B,EAAe,QAAS,WACpB,OAAO,IACR9B,SACH8B,EAAe,QAAS,SAAU7S,GAC9B,MAAOv5B,GAAKiF,cAAcs0B,GAAKjV,gBAChCgmB,OACK,UACA,aAER8B,EAAe,SAAU,SAAU6/C,GAC/B,GAAI1yD,GAAMv5B,EAAKmH,cAAc8kF,EAC7B,OAAc,OAAP1yD,EAAc,GAAIyQ,GAAU,SAAWzQ,IAC/C+Q,OACK,SACA,YAER8B,EAAe,OAAQ,SAAUsiB,EAAQw9B,EAAOC,GAE5C,IADA,GAAIhrF,GAAMutD,EAAO/5B,SAASu3D,GAAO5nE,cAC1BnjB,EAAIrB,OAASqsF,GAChBhrF,EAAM,IAAMA,CAEhB,OAAOA,KACRmpC,OAEK,UACA,YAGA,UAEI,MACA,WAEI,YACA,EACA,OAKR,WAEI,KACA,YAEI,OACA,OAKhB8B,EAAe,UAAW,SAAU7rC,EAAM2rF,GAAhB,GAElB79E,GACKjN,EACDwG,CADR,KAFArH,EAAOA,EAAK+jB,cACRjW,EAAM,EACDjN,EAAI,EAAGA,EAAIb,EAAKT,SAAUsB,EAAG,CAElC,GADIwG,EAAIrH,EAAKe,WAAWF,GACpBwG,GAAK,IAAMA,GAAK,GAChBA,GAAK,OACF,CAAA,KAAIA,GAAK,IAAMA,EAAI,GAAKskF,GAG3B,MAAO,IAAIliD,GAAU,QAFrBpiC,IAAK,GAITyG,EAAMA,EAAM69E,EAAQtkF,EAExB,MAAOyG,KACRi8B,OAEK,QACA,WAGA,UAEI,MACA,WAEI,YACA,EACA,QAKhB8B,EAAe,OAAQ,SAAU/iC,GAC7B,MAAO7I,QAAOiN,aAAapE,KAC5BihC,OACK,QACA,cAEJ++C,EAAmB,qtHACvBj9C,EAAe,QAAS,SAAU7rC,GAC9B,MAAOA,GAAKE,QAAQ4oF,EAAkB,MACvC/+C,OACK,QACA,YAER8B,EAAe,OAAQ,SAAU7rC,GAC7B,MAAOA,GAAKuH,OAAO,KACpBwiC,OACK,QACA,YAER6J,EAAY,UAAW,QACvBA,EAAY,UAAW,QACvB/H,EAAe,cAAe,SAAU9B,GAAV,GAEjBlpC,GADL+H,EAAM,EACV,KAAS/H,EAAI,EAAGA,EAAIkpC,EAAKxqC,SAAUsB,EAC/B+H,GAAOmhC,EAAKlpC,EAEhB,OAAO+H,KACRmhC,OACK,KAEI,QACA,aAGZ8B,EAAe,SAAU,SAAUsiB,EAAQu3B,GAIvC,IAJqB,GACjBhyE,GAAS,kCACTm4E,EAAM,GACNC,EAAc,EACXpG,KAAa,GAChBmG,GAAO,GAEX,QAASnG,EAAW,GAChBoG,GAAe,EAQnB,OANY,KAARD,EACAA,EAAM,IAAMA,EACW,IAAhBC,IACP39B,EAAS9gC,KAAKyd,MAAMqjB,EAAS29B,GAAeA,GAEhDp4E,EAASA,EAAOxT,QAAQ,YAAa2rF,GAC9B98E,EAAYsE,WAAWrT,KAAKmuD,EAAQz6C,KAC5Cq2B,OAEK,UACA,WAGA,aAEI,KACA,WAEI,OACA,OAKhB8B,EAAe,QAAS,SAAUpiC,EAAGiZ,GACjC,MAAOjZ,KAAMiZ,IACdqnB,OAEK,SACA,WAGA,SACA,YAGR8B,EAAe,OAAQ,SAAU9gB,EAAWghE,EAAQ39D,GAChD,GAAI9pB,GAAMynF,EAAOhgE,QAAQhB,EAAWqD,EAAQ,EAC5C,OAAO9pB,GAAM,EAAI,GAAImlC,GAAU,SAAWnlC,EAAM,IACjDylC,OAEK,aACA,WAGA,UACA,WAGA,UAEI,KACA,aAEI,OACA,OAKhB8B,EAAe,QAAS,SAAUsiB,EAAQu3B,EAAUsG,GAA5B,GAGhBt4E,GAFAgN,EAAQ2M,KAAK2mB,IAAI,GAAI0xC,EAGzB,IAFAv3B,EAAS9gC,KAAKyd,MAAMqjB,EAASztC,GAASA,EAClChN,EAASs4E,EAAW,IAAM,QAC1BtG,EAAW,EAEX,IADAhyE,GAAU,IACHgyE,KAAa,GAChBhyE,GAAU,GAGlB,OAAO3E,GAAYsE,WAAWrT,KAAKmuD,EAAQz6C,KAC5Cq2B,OAEK,UACA,WAGA,aAEI,KACA,WAEI,OACA,MAKR,aAEI,KACA,WAEI,QACA,OAKhB8B,EAAe,OAAQ,SAAU7rC,EAAMT,GACnC,MAAOS,GAAK2mB,OAAO,EAAGpnB,KACvBwqC,OAEK,QACA,WAGA,WAEI,KACA,YAEI,OACA,OAKhB8B,EAAe,QAAS,SAAU7rC,EAAMT,GACpC,MAAOS,GAAK2mB,QAAQpnB,KACrBwqC,OAEK,QACA,WAGA,WAEI,KACA,YAEI,OACA,OAKhB8B,EAAe,MAAO,SAAU7rC,GAC5B,MAAOA,GAAKT,SACbwqC,OACK,QACA,YAER8B,EAAe,QAAS,SAAU7rC,GAC9B,MAAOA,GAAKiH,gBACb8iC,OACK,QACA,YAER8B,EAAe,QAAS,SAAU7rC,GAC9B,MAAOA,GAAK+jB,gBACbgmB,OACK,QACA,YAER8B,EAAe,QAAS,SAAU7rC,GAC9B,MAAOA,GAAKE,QAAQ,OAAQ,MAC7B6pC,OACK,QACA,YAER8B,EAAe,QAAS,SAAU7rC,GAC9B,MAAOA,GAAKE,QAAQ,OAAQ,MAC7B6pC,OACK,QACA,YAER8B,EAAe,OAAQ,SAAU7rC,GAC7B,MAAOA,GAAKE,QAAQ,YAAa,MAClC6pC,OACK,QACA,YAER8B,EAAe,MAAO,SAAU7rC,EAAMouB,EAAO7uB,GACzC,MAAOS,GAAK2mB,OAAOyH,EAAQ,EAAG7uB,KAC/BwqC,OAEK,QACA,WAGA,SACA,cAGA,UACA,cAGR8B,EAAe,SAAU,SAAU7rC,GAC/B,MAAOA,GAAKiH,cAAc/G,QAAQ,OAAQ,SAAUsxC,GAChD,MAAOA,GAAEztB,kBAEdgmB,OACK,QACA,YAER8B,EAAe,UAAW,SAAU7rC,EAAMouB,EAAO7uB,EAAQ0sF,GACrD,MAAOjsF,GAAK2mB,OAAO,IAAKyH,GAAS69D,EAAUjsF,EAAK2mB,OAAOyH,EAAQ7uB,KAChEwqC,OAEK,QACA,WAGA,SACA,cAGA,UACA,aAGA,WACA,YAGR8B,EAAe,OAAQ,SAAU7rC,EAAMmuD,GAEnC,IADA,GAAIvlD,GAAM,GACHulD,KAAW,GACdvlD,GAAO5I,CAEX,OAAO4I,KACRmhC,OAEK,QACA,WAGA,UACA,cAGR8B,EAAe,SAAU,SAAU9gB,EAAWghE,EAAQ39D,GAClD,GAAI9pB,GAAMynF,EAAO9kF,cAAc8kB,QAAQhB,EAAU9jB,cAAemnB,EAAQ,EACxE,OAAO9pB,GAAM,EAAI,GAAImlC,GAAU,SAAWnlC,EAAM,IACjDylC,OAEK,aACA,WAGA,UACA,WAGA,UAEI,KACA,aAEI,OACA,OAKhB8B,EAAe,aAAc,SAAU7rC,EAAMksF,EAASD,EAASrC,GAK3D,QAAS1pF,KACLF,EAAOA,EAAK+qB,UAAU,EAAGzmB,GAAO2nF,EAAUjsF,EAAK+qB,UAAUzmB,EAAM4nF,EAAQ3sF,QAL3E,GAAI2sF,IAAYD,EACZ,MAAOjsF,EAMX,KAJA,GAAIsE,OAIIA,EAAMtE,EAAK+rB,QAAQmgE,EAAS5nF,EAAM,KAAO,GAC7C,GAAW,MAAPslF,EACA1pF,QACG,IAAc,MAAR0pF,EAAW,CACpB1pF,GACA,OAGR,MAAOF,KACR+pC,OAEK,QACA,WAGA,WACA,WAGA,WACA,WAGA,QAEI,KACA,YACA,WAIZ8B,EAAe,IAAK,SAAUzpC,GAC1B,MAAuB,gBAATA,GAAoBA,EAAQ,KAC3C2nC,OACK,SACA,cAER8B,EAAe,OAAQ,SAAUzpC,EAAOsR,GACpC,MAAO3E,GAAYsE,WAAWrT,KAAKoC,EAAOsR,KAC3Cq2B,OAEK,SACA,aAGA,UACA,YAGR8B,EAAe,QAAS,SAAUzpC,GAC9B,MAAoB,gBAATA,GACAA,EAES,iBAATA,IACCA,GAEZA,GAASA,EAAQ,IAAIlC,QAAQ,SAAU,IACvCkC,EAAQgjD,WAAWhjD,GACZ6J,MAAM7J,GAAS,GAAIqnC,GAAU,SAAWrnC,KAChD2nC,OACK,SACA,cAMRs+C,EAAU32E,UAAU0iB,SAAW,WAC3B,MAAO11B,MAAKsB,MAEhB6rC,EAAe,YAAa,SAAU16B,EAAMnR,GACxC,MAAO,IAAIqoF,GAAUl3E,EAAMnR,KAC5B+pC,OAEK,QACA,WAGA,SAEI,KACA,UAEI,OACA,aAKhB8B,EAAe,UAAW,SAAUzpC,EAAO+pF,GACvC,MAAO/pF,aAAiBqnC,GAAY0iD,EAAe/pF,IACpD2nC,OAEK,SACA,YAGA,kBACA,eAGJw8C,EAAgB,WAEhB,QAAS6F,GAAenB,EAAK/jF,GACzB,GAAgB,gBAALA,GAAe,CACtB,GAAI8xB,GAAMosB,WAAWl+C,EAChB+E,OAAM+sB,IAAQA,GAAO9xB,IACtBA,EAAI8xB,GAGZ,MAAO,UAAUvvB,GACb,GAAIiZ,GAAIxb,CAKR,OAJgB,gBAALuC,IAA6B,gBAALiZ,KAC/BjZ,EAAIA,EAAExC,cACNyb,EAAIA,EAAEzb,eAEHgkF,EAAIxhF,EAAGiZ,IAGtB,QAAS2pE,GAAG5iF,GACR,GAAIuvB,GAAKp4B,CAgBT,OAfgB,gBAAL6I,KACPA,EAAIA,EAAExC,eAEN,aAAaiB,KAAKuB,IAClB7I,EAAM6I,EAAEkd,OAAO,EAAGld,EAAElK,OAAS,GAC7By5B,EAAMosB,WAAWxkD,GACZqL,MAAM+sB,IAAQA,GAAOp4B,IACtB6I,EAAIuvB,EAAM,MAEP,YAAY9wB,KAAKuB,KACxBuvB,EAAMosB,WAAW37C,GACZwC,MAAM+sB,IAAQA,GAAOvvB,IACtBA,EAAIuvB,IAGLvvB,EAEX,QAAS6iF,GAAO7iF,EAAGiZ,GACf,MAAO2pE,GAAG5iF,GAAK4iF,EAAG3pE,GAEtB,QAAS6pE,GAAQ9iF,EAAGiZ,GAChB,MAAO2pE,GAAG5iF,IAAM4iF,EAAG3pE,GAEvB,QAAS8pE,GAAO/iF,EAAGiZ,GACf,MAAO2pE,GAAG5iF,GAAK4iF,EAAG3pE,GAEtB,QAAS+pE,GAAQhjF,EAAGiZ,GAChB,MAAO2pE,GAAG5iF,IAAM4iF,EAAG3pE,GAEvB,QAASgqE,GAAOjjF,EAAGiZ,GACf,OAAQiqE,EAAOljF,EAAGiZ,GAEtB,QAASiqE,GAAOljF,EAAGiZ,GACf,MAAIA,aAAaha,QACNga,EAAExa,KAAKuB,IAEF,gBAALA,IAA6B,gBAALiZ,KAC/BjZ,GAAIxJ,GACJyiB,GAAIziB,IAEDosF,EAAG5iF,IAAM4iF,EAAG3pE,IA3DvB,GAAIkqE,GAAUllF,OAAOC,OAAO,KA6D5B,OAAO,UAAUsjF,GAAV,GAIC3jF,GAoBI0nD,CAvBR,OAAkB,kBAAPi8B,GACAA,GAGP3jF,EAAI,UAAUkI,KAAKy7E,IACZmB,EAAeO,EAAQrlF,EAAE,KAEhCA,EAAI,WAAWkI,KAAKy7E,IACbmB,EAAeM,EAAQplF,EAAE,KAEhCA,EAAI,WAAWkI,KAAKy7E,IACbmB,EAAeG,EAASjlF,EAAE,KAEjCA,EAAI,UAAUkI,KAAKy7E,IACZmB,EAAeE,EAAQhlF,EAAE,KAEhCA,EAAI,WAAWkI,KAAKy7E,IACbmB,EAAeK,EAASnlF,EAAE,KAEjCA,EAAI,UAAUkI,KAAKy7E,IACZmB,EAAeI,EAAQllF,EAAE,IAEhC,OAAOkI,KAAKy7E,IACRj8B,EAAK49B,EAAQ3B,GACZj8B,IACDA,EAAKi8B,EAAI/qF,QAAQ,yCAA0C,SAAUsxC,GACjE,OAAQA,GACR,IAAK,KACD,MAAO,KACX,KAAK,KACD,MAAO,KACX,KAAK,IACD,MAAO,GACX,KAAK,IACD,MAAO,IACX,SACI,MAAO,KAAOA,KAGtBwd,EAAK49B,EAAQ3B,GAAWviF,OAAO,IAAMsmD,EAAK,IAAK,MAE5Co9B,EAAeO,EAAQ39B,IAE3Bo9B,EAAeO,EAAQ1B,SAYtB,kBAAVhtF,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,mCAAoC,uBAAwBD,IACrE,WACE,YA20EA,SAAS6uF,GAAI3lF,GAAb,GAIQ4lF,GAIAxlF,EAAOylF,EACFpoF,CART,IAAIqoF,GAAM9lF,IAAM,IACZ,MAAO,GAAI+lF,EAAK/lF,EAOpB,KALI4lF,EAAI5lF,EAAI,EAAI,KACZ4lF,QACA5lF,GAAKA,GAELI,EAAI,EAAGylF,EAAK,EACPpoF,EAAI,EAAGA,EAAI,IAAKA,IACrB2C,GAAKylF,EACLA,GAAM,EAAI7lF,EAAIA,GAAK,EAAIvC,EAAI,EAE/B,OAAW,GAAJmoF,EAAQz/D,KAAKC,KAAKD,KAAK07D,IAAM7hF,EAAImmB,KAAKw8B,KAAK3iD,EAAIA,GAAKI,EAE/D,QAAS2lF,GAAK/lF,GAAd,GAIQsqC,GAKA3D,EACKlpC,CATT,IAAIqoF,GAAM9lF,GAAK,IACX,MAAO,GAAI2lF,EAAI3lF,EAQnB,KANIsqC,EAAI,EACJtqC,EAAI,IACJsqC,KACAtqC,GAAKA,GAEL2mC,EAAO3mC,EACFvC,EAAI,EAAGA,GAAK,EAAGA,GAAK,GACzBkpC,EAAO3mC,EAAIvC,EAAIkpC,CAGnB,OADAA,GAAO,GAAK3mC,EAAI2mC,GACJ,GAAL2D,EAASnkB,KAAKw8B,KAAK3iD,EAAIA,GAAKmmB,KAAKC,KAAKD,KAAK07D,IAAMl7C,EAAO,EAAIxgB,KAAKw8B,KAAK3iD,EAAIA,GAAKmmB,KAAKC,KAAKD,KAAK07D,IAAMl7C,EAE/G,QAASq/C,GAAQhmF,GAAjB,GAYa4F,GAXLqgF,GACA,kBACA,qCAEA,qCAEA,wCAGAhgE,EAAIjmB,EAAG+F,EAAM/F,EAAI,IAAKkmF,EAAMD,EAAI,EAEpC,KADAlgF,IAAQ/F,EAAI,IAAOmmB,KAAK0e,IAAI9+B,GACnBH,EAAI,EAAGA,GAAK,EAAGA,IACpBqgB,GAAK,EACLigE,GAAOD,EAAIrgF,GAAKqgB,CAEpB,QAAQlgB,EAAMogB,KAAK0e,IAAI1e,KAAKC,KAAK,EAAID,KAAK07D,IAAMqE,EAAMlmF,GAE1D,QAASmmF,GAAMnmF,GACX,GAAIA,EAAI,EACJ,MAAOmmB,MAAKw8B,IAAIqjC,EAAQhmF,GAE5B,IAAIomF,GAAKjgE,KAAK07D,GAAI57D,GAAKjmB,CACvB,QAAQomF,GAAMngE,EAAIkgE,EAAMlgE,GAAKE,KAAK87D,IAAImE,EAAKngE,IAE/C,QAASogE,GAAO9jF,EAAGiZ,GACf,MAAOwqE,GAAQzjF,GAAKyjF,EAAQxqE,GAAKwqE,EAAQzjF,EAAIiZ,GAEjD,QAAS8qE,GAAK/jF,EAAGiZ,GACb,MAAO2K,MAAKw8B,IAAI0jC,EAAO9jF,EAAGiZ,IAE9B,QAAS+qE,GAAUhkF,EAAGvC,GAClB,MAAOA,GAAIuC,EAAI,EAAIikF,EAASjkF,EAAGvC,GAAK,EAAIymF,EAAWlkF,EAAGvC,GAE1D,QAASwmF,GAASjkF,EAAGvC,GAArB,GAE0BvC,GADlBukC,EAAM,EAAIz/B,EAAGokC,EAAO3E,EAAK0kD,EAAKnkF,EAC9BokF,EAAMX,EAAQzjF,EAClB,KAAK9E,EAAI,EAAGA,GAAKmpF,KACbF,IACA//C,GAAQ3mC,EAAI0mF,EACZ1kD,GAAO2E,IACHm/C,GAAMn/C,GAAQm/C,GAAM9jD,GAAO6kD,KAJVppF,KAQzB,MAAOukC,GAAM7b,KAAKw8B,KAAK3iD,EAAIuC,EAAI4jB,KAAK0e,IAAI7kC,GAAK2mF,GAEjD,QAASF,GAAWlkF,EAAGvC,GAAvB,GAGarG,GAUDuS,EAZJpV,EAAIgwF,GAAQ5mF,EAAIpJ,EAAGqJ,EAAI,EAAG4mF,EAAK,EAAGC,EAAKhnF,EAAI,EAAIuC,EAC/CokF,EAAMX,EAAQzjF,EAClB,KAAS5I,EAAI,EAAGA,GAAKitF,KACjBzmF,EAAI6mF,EAAKD,EAAK5mF,EACV2lF,GAAM3lF,GAAK2mF,KACX3mF,EAAI2mF,IAER5mF,EAAI8mF,EAAKD,EAAK7mF,EACV4lF,GAAM5lF,GAAK4mF,KACX5mF,EAAI4mF,IAER3mF,EAAI,EAAIA,EACJ+L,EAAQhM,EAAIC,EAChBrJ,GAAKoV,IACD45E,GAAM55E,EAAQ,GAAK26E,KAZEltF,IAezBqtF,GAAM,EACND,GAAMptF,GAAKA,EAAI4I,EAEnB,OAAOzL,GAAIqvB,KAAKw8B,KAAK3iD,EAAI2mF,EAAMpkF,EAAI4jB,KAAK0e,IAAI7kC,IAEhD,QAASinF,GAAWjnF,EAAGuC,EAAGiZ,EAAGqlE,GACzB,MAAKA,GAGE0F,EAAUhkF,EAAGvC,EAAIwb,GAFb2K,KAAK2mB,IAAI9sC,EAAIwb,EAAGjZ,EAAI,GAAK4jB,KAAKw8B,KAAK3iD,EAAIwb,IAAMA,EAAI2qE,EAAM5jF,IAItE,QAAS2kF,GAAU1+B,EAAGjmD,EAAGiZ,GAAzB,GAOQpb,GAAO+mF,EAAQnnF,EAAOonF,EAIjBztF,EAED0tF,CAZR,IAAU,IAAN7+B,EACA,MAAO,EAEX,IAAS,GAALA,EACA,MAAOn0C,GAAAA,CAMX,KAJIjU,EAAI,EAAG+mF,EAAI,GAAInnF,EAAI,EAAGonF,EAAK7kF,EAAIiZ,EAC/B4rE,EAAK,IACLD,GAAKC,GAEAztF,EAAI,EAAGA,EAAIitF,KAChB5mF,EAAI,IAAOI,EAAI+mF,GACXE,EAAIJ,EAAWjnF,EAAGuC,EAAGiZ,GAAG,KACxBsqE,GAAMt9B,EAAI6+B,GAAK,QAHK1tF,IAMpB0tF,EAAI7+B,EACJ2+B,EAAInnF,EAEJI,EAAIJ,CAGZ,OAAOA,GAEX,QAASsnF,GAAYtnF,EAAG6gF,GACpB,MAAKA,GAGE,GAAM,GAAM8E,EAAI3lF,EAAImmB,KAAKC,KAAK,IAF1BD,KAAKw8B,KAAK3iD,EAAIA,EAAI,GAAKmmB,KAAKC,KAAK,EAAID,KAAK07D;CAIzD,QAAS0F,GAAW/+B,GAApB,GA4BQ6+B,GAAG1nF,EA3BH4C,sBAEI,qCAEA,oCAEA,mBACDiZ,sBAEC,qCAEA,sCAEDtb,iFAKC,kBACA,mBACDC,GACC,oBACA,kBACA,kBACA,mBAEJqnF,EAAO,OAASC,EAAQ,EAAID,CAEhC,OAAIh/B,GAAIg/B,GACJH,EAAIlhE,KAAKC,QAAUD,KAAK0e,IAAI2jB,SAChBtoD,EAAE,GAAKmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,QAAUC,EAAE,GAAKknF,EAAIlnF,EAAE,IAAMknF,EAAIlnF,EAAE,IAAMknF,EAAIlnF,EAAE,IAAMknF,EAAI,IAElII,EAAQj/B,GACR6+B,EAAIlhE,KAAKC,QAAUD,KAAK0e,IAAI,EAAI2jB,UACnBtoD,EAAE,GAAKmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,IAAMmnF,EAAInnF,EAAE,QAAUC,EAAE,GAAKknF,EAAIlnF,EAAE,IAAMknF,EAAIlnF,EAAE,IAAMknF,EAAIlnF,EAAE,IAAMknF,EAAI,KAEvIA,EAAI7+B,EAAI,GACR7oD,EAAI0nF,EAAIA,OACI9kF,EAAE,GAAK5C,EAAI4C,EAAE,IAAM5C,EAAI4C,EAAE,IAAM5C,EAAI4C,EAAE,IAAM5C,EAAI4C,EAAE,IAAM5C,EAAI4C,EAAE,IAAM8kF,OAAS7rE,EAAE,GAAK7b,EAAI6b,EAAE,IAAM7b,EAAI6b,EAAE,IAAM7b,EAAI6b,EAAE,IAAM7b,EAAI6b,EAAE,IAAM7b,EAAI,IAEvJ,QAAS+nF,GAAU1nF,EAAGI,EAAGkqC,EAAGu2C,GACxB,MAAKA,GAGEyG,GAAatnF,EAAII,GAAKkqC,GAAG,GAFrBnkB,KAAKw8B,MAAM3iD,EAAII,IAAMJ,EAAII,IAAM,EAAIkqC,EAAIA,KAAOA,EAAInkB,KAAKC,KAAK,EAAID,KAAK07D,KAIpF,QAAS8F,GAASn/B,EAAGpoD,EAAGkqC,GACpB,MAAOlqC,GAAIkqC,EAAIi9C,EAAW/+B,GAE9B,QAASo/B,GAAY5nF,EAAGuC,EAAGiZ,GACvB,MAAO2K,MAAKw8B,KAAKpgD,EAAI,GAAK4jB,KAAK0e,IAAI7kC,IAAMwb,EAAI,GAAK2K,KAAK0e,IAAI,EAAI7kC,GAAKqmF,EAAO9jF,EAAGiZ,IAElF,QAASqsE,GAAY7nF,EAAGuC,EAAGiZ,GACvB,GAAIsvB,GAAI3kB,KAAKw8B,IAAIpgD,EAAI4jB,KAAK0e,IAAI7kC,GAAKwb,EAAI2K,KAAK0e,IAAI,EAAI7kC,GAAKqmF,EAAO9jF,EAAGiZ,GACnE,OAAOxb,IAAKuC,EAAI,IAAMA,EAAIiZ,EAAI,GAAKsvB,EAAIg9C,EAAWvlF,EAAGiZ,EAAGxb,GAAKuC,EAAI,EAAIuoC,EAAIg9C,EAAWtsE,EAAGjZ,EAAG,EAAIvC,GAAKwb,EAEvG,QAASssE,GAAWvlF,EAAGiZ,EAAGxb,GAA1B,GACQI,GAAG2nF,EACHz7D,EAAU07D,EAAKr+C,EAAGs+C,EAChB1lF,EAAIiZ,EADsB0sE,EAE1B3lF,EAAI,EAFiB4lF,EAGrB5lF,EAAI,EAHFrC,EAIJ,EAJOC,EAKP,EAAI8nF,EAAMjoF,EAAIkoF,CAMlB,KALIpC,GAAM3lF,GAAK2mF,KACX3mF,EAAI2mF,IAER3mF,EAAI,EAAIA,EACRwpC,EAAIxpC,EACCC,EAAI,EAAGA,GAAKwmF,KACbmB,EAAK,EAAI3nF,EACTksB,EAAKlsB,GAAKob,EAAIpb,GAAKJ,IAAMmoF,EAAMJ,IAAOxlF,EAAIwlF,IAC1C5nF,EAAI,EAAImsB,EAAKnsB,EACT2lF,GAAM3lF,GAAK2mF,KACX3mF,EAAI2mF,IAER5mF,EAAI,EAAIosB,EAAKpsB,EACT4lF,GAAM5lF,GAAK4mF,KACX5mF,EAAI4mF,IAER3mF,EAAI,EAAIA,EACRwpC,GAAKxpC,EAAID,EACTosB,IAAO/pB,EAAInC,IAAM6nF,EAAM7nF,GAAKJ,IAAMuC,EAAIwlF,IAAOG,EAAMH,IACnD5nF,EAAI,EAAImsB,EAAKnsB,EACT2lF,GAAM3lF,GAAK2mF,KACX3mF,EAAI2mF,IAER5mF,EAAI,EAAIosB,EAAKpsB,EACT4lF,GAAM5lF,GAAK4mF,KACX5mF,EAAI4mF,IAER3mF,EAAI,EAAIA,EACR6nF,EAAM7nF,EAAID,EACVypC,GAAKq+C,IACDlC,GAAMkC,EAAM,GAAKnB,KAzBAzmF,KA6BzB,MAAOupC,GAEX,QAASy+C,GAAY5/B,EAAGjmD,EAAGiZ,GAA3B,GAEa7hB,GAED0tF,EAHJjnF,EAAI,EAAG+mF,EAAI,EAAGnnF,EAAI,CACtB,KAASrG,EAAI,EAAGA,EAAIitF,KAChB5mF,EAAI,IAAOI,EAAI+mF,GACXE,EAAIQ,EAAY7nF,EAAGuC,EAAGiZ,KACtBsqE,GAAMt9B,EAAI6+B,GAAKR,KAHKltF,IAMpB0tF,EAAI7+B,EACJ2+B,EAAInnF,EAEJI,EAAIJ,CAGZ,OAAOA,GAEX,QAASqoF,GAASroF,EAAGuC,EAAGiZ,EAAGpb,EAAG+mF,GAC1B,MAAOU,IAAa7nF,EAAII,IAAM+mF,EAAI/mF,GAAImC,EAAGiZ,GAE7C,QAAS8sE,GAAUtoF,EAAGuC,EAAGiZ,EAAG+sE,EAAKnoF,EAAG+mF,GAChC,MAAIoB,GACOV,GAAa7nF,EAAII,IAAM+mF,EAAI/mF,GAAImC,EAAGiZ,GAEtCosE,GAAa5nF,EAAII,IAAM+mF,EAAI/mF,GAAImC,EAAGiZ,IAAM2rE,EAAI/mF,GAEvD,QAASooF,GAAShgC,EAAGjmD,EAAGiZ,EAAGpb,EAAG+mF,GAC1B,MAAO/mF,IAAK+mF,EAAI/mF,GAAKgoF,EAAY5/B,EAAGjmD,EAAGiZ,GAE3C,QAASitE,GAAWzoF,EAAGvC,EAAGirF,GACtB,MAAOzB,GAAWjnF,EAAGvC,EAAI,EAAG,EAAGirF,GAEnC,QAASC,GAAY3oF,EAAGvC,GACpB,MAAO,GAAIgrF,EAAWzoF,EAAGvC,GAAG,GAEhC,QAASmrF,GAAepgC,EAAG/qD,GACvB,MAAOypF,GAAU1+B,EAAG/qD,EAAI,EAAG,GAE/B,QAASorF,GAAgBrgC,EAAG/qD,GACxB,MAAOmrF,GAAe,EAAIpgC,EAAG/qD,GAEjC,QAASqrF,GAAWC,EAAMC,GAA1B,GAEervF,GAAGiM,EAGFqjF,EACA/8E,EAKRzO,EAVAuR,EAAO+5E,EAAK1wF,OAAQ45B,EAAO82D,EAAK,GAAG1wF,OACnC2H,EAAI,CACR,KAAKrG,EAAI,EAAGA,EAAIqV,EAAMrV,IAClB,IAAKiM,EAAI,EAAGA,EAAIqsB,EAAMrsB,IACdqjF,EAAMD,EAAOrvF,GAAGiM,GAChBsG,EAAQ68E,EAAKpvF,GAAGiM,GAAKqjF,EACzB/8E,GAASA,EACTlM,GAAKkM,EAAQ+8E,CAIrB,OADIxrF,IAAKuR,EAAO,IAAMijB,EAAO,GACtB02D,EAAY3oF,EAAGvC,GAE1B,QAASyrF,GAAMlpF,EAAGL,EAAG4oF,GACjB,MAAIA,GACO,EAAIpiE,KAAKw8B,KAAKhjD,EAAIK,GAEtBL,EAAIwmB,KAAKw8B,KAAKhjD,EAAIK,GAE7B,QAASmpF,GAAQr+C,EAAG1qC,EAAGmoF,GAAvB,GAIQa,GACKzvF,CAJT,IAAI4uF,EACA,MAAO,GAAIE,EAAW,EAAIroF,EAAG,GAAK0qC,EAAI,IAAI,EAG9C,KADIs+C,EAAM,EACDzvF,EAAI,EAAGA,GAAKmxC,EAAGnxC,IACpByvF,GAAOjjE,KAAK0e,IAAIlrC,EAEpB,OAAOwsB,MAAKw8B,IAAI7X,EAAI3kB,KAAK0e,IAAIzkC,GAAKA,EAAIgpF,GAE1C,QAASC,GAAMrpF,EAAGvC,EAAG0C,EAAGooF,GACpB,GAAIA,EACA,MAAOV,GAAYpqF,EAAIuC,GAAKG,EAAI1C,EAAIuC,GAAIvC,EAAI,EAAG0C,EAAI,EAEvD,IAAIgyB,GAAI10B,EAAI0C,CAGZ,OAFA1C,IAAK,EACL0C,GAAK,EACEgyB,EAAIm0D,EAAK7oF,EAAG0C,GAAKgmB,KAAK2mB,IAAI3a,EAAInyB,EAAGvC,EAAI,GAAK0oB,KAAK2mB,IAAI,EAAI3a,EAAInyB,EAAGvC,EAAI0C,GAE7E,QAASmpF,GAAYtpF,EAAGvC,EAAG0C,GACvB,MAAO,GAAIkpF,EAAMrpF,EAAGvC,EAAG0C,GAAG,GAE9B,QAASopF,GAAW/gC,EAAG/qD,EAAG0C,GACtB,MAAOA,GAAI1C,GAAK,EAAI+qF,EAAShgC,EAAGroD,EAAI,EAAG1C,EAAI,EAAG,EAAG,GAAK,GAE1D,QAAS+rF,GAAKhhC,EAAG/qD,EAAG0C,GAChB,MAAOA,GAAI1C,GAAK,EAAI+qF,EAAS,EAAIhgC,EAAGroD,EAAI,EAAG1C,EAAI,EAAG,EAAG,GAAK,GAE9D,QAASgsF,GAAM30B,GAAf,GAEan7D,GADL+vF,EAAK,EAAGjsF,EAAIq3D,EAAIz8D,MACpB,KAASsB,EAAI,EAAGA,EAAI8D,EAAG9D,IACnB+vF,GAAM50B,EAAIn7D,EAEd,OAAO+vF,GAAKjsF,EAEhB,QAASksF,GAAQ70B,EAAK10D,GAAtB,GAEazG,GACDuS,EAFJpM,EAAI,EAAGrC,EAAIq3D,EAAIz8D,MACnB,KAASsB,EAAI,EAAGA,EAAI8D,EAAG9D,IACfuS,EAAQ4oD,EAAIn7D,GAAKyG,EACrBN,GAAKoM,EAAQA,CAEjB,OAAOpM,IAAKrC,EAAI,GAEpB,QAASmsF,GAAMC,EAAMC,GAArB,GACQC,GAAKF,EAAKxxF,OAAS,EAAG2xF,EAAKF,EAAKzxF,OAAS,EACzC4xF,EAAMN,EAAQE,EAAMJ,EAAMI,IAAQK,EAAMP,EAAQG,EAAML,EAAMK,GAChE,KAAKG,IAAQC,EACT,KAAM,IAAI3nD,IAAU,QAExB,OAAO,GAAI8mD,EAAMY,EAAMC,EAAKH,EAAIC,GAAI,GAExC,QAASG,GAAOnqF,GACZ,MAAO,GAAMmmB,KAAK0e,KAAK,EAAI7kC,IAAM,EAAIA,IAEzC,QAASoqF,GAAUpqF,GACf,GAAIqqF,GAAKlkE,KAAKw8B,IAAI,EAAI3iD,EACtB,QAAQqqF,EAAK,IAAMA,EAAK,GAE5B,QAASC,GAAMtqF,EAAGvC,EAAG8qF,GACjB,MAAIA,GACO,EAAI,GAAMV,EAAYpqF,GAAKuC,EAAIA,EAAIvC,GAAIA,EAAI,EAAG,IAElD,GAAK0oB,KAAKC,KAAK3oB,GAAK6oF,EAAK,GAAK7oF,EAAI,IAAM0oB,KAAK2mB,IAAI,EAAI9sC,EAAIA,EAAIvC,IAAKA,EAAI,GAAK,GAEtF,QAAS8sF,GAAYvqF,EAAGvC,GACpB,MAAO,GAAI6sF,EAAMtqF,EAAGvC,GAAG,GAE3B,QAAS+sF,GAAYxqF,EAAGvC,GAIpB,MAHIuC,GAAI,IACJA,GAAKA,GAEF,EAAIuqF,EAAYvqF,EAAGvC,GAE9B,QAASgtF,GAAUjiC,EAAG/qD,GAClB,GAAIuC,GAAIooF,EAAY,EAAIjiE,KAAKqK,IAAIg4B,EAAG,EAAIA,GAAI/qD,EAAI,EAAG,GAEnD,OADAuC,GAAImmB,KAAKC,KAAK3oB,GAAK,EAAIuC,GAAKA,GACrBwoD,EAAI,GAAMxoD,GAAKA,EAE1B,QAAS0qF,GAAgBliC,EAAG/qD,GACxB,MAAOgtF,GAAU,EAAIjiC,EAAI,EAAG/qD,GAEhC,QAASktF,GAAWC,EAAKC,EAAKC,EAAM/hF,GAApC,GAEQgiF,GAAMC,EAEF7qF,EAAO+gF,EACFvnF,EACDuS,EAIJ++E,EAIJzI,EAAiBuF,EAAiBmD,EAAuBC,EAErDC,EAAcC,EAAcl5D,EAC5Bm5D,EAAaC,EAhBjBxB,EAAKa,EAAIvyF,OAAQ2xF,EAAKa,EAAIxyF,MAE9B,IAAY,GAAR0Q,EAAW,CAEX,IADI5I,EAAI,EAAG+gF,EAAK,EACPvnF,EAAI,EAAGA,EAAIowF,EAAIpwF,IAChBuS,EAAQ0+E,EAAIjxF,GAAKkxF,EAAIlxF,GACzBwG,GAAK+L,EACLg1E,GAAMh1E,EAAQA,CAIlB,OAFI++E,GAAK9qF,EAAI4pF,EACbgB,EAAOE,EAAK9kE,KAAKC,MAAM86D,EAAK/gF,EAAI8qF,IAAOlB,GAAMA,EAAK,KACnC,GAARe,EAAYP,EAAYQ,EAAMhB,EAAK,GAAKS,EAAYO,EAAMhB,EAAK,GAG1E,MADIvH,GAAKiH,EAAMmB,GAAM7C,EAAK0B,EAAMoB,GAAMK,EAAKvB,EAAQiB,EAAKpI,GAAK2I,EAAKxB,EAAQkB,EAAK9C,GACnE,GAARh/E,GACIqiF,EAAKF,EAAKnB,EAAIsB,EAAKF,EAAKnB,EAAI73D,EAAIi5D,EAAKC,EACrCC,EAAKF,EAAKj5D,EAAGo5D,EAAKF,EAAKl5D,EAC3B64D,EAAK,GAAKM,EAAKA,GAAMvB,EAAK,GAAKwB,EAAKA,GAAMvB,EAAK,IAC/Ce,EAAOjF,GAAMtD,EAAKuF,GAAM5hE,KAAKC,KAAK+L,GACnB,GAAR24D,EAAYP,EAAYQ,EAAMC,GAAMR,EAAYO,EAAMC,KAE7DA,EAAKjB,EAAKC,EAAK,EACfe,EAAOjF,GAAMtD,EAAKuF,GAAM5hE,KAAKC,KAAK4kE,EAAKjB,EAAKC,IAAOD,EAAKC,KAAQD,EAAK,GAAKmB,GAAMlB,EAAK,GAAKmB,KAC3E,GAARL,EAAYP,EAAYQ,EAAMC,GAAMR,EAAYO,EAAMC,IAGrE,QAASQ,GAAa/H,EAAOT,EAAQnoF,GACjC,OAAQ4vF,EAAUhH,EAAQ,EAAG5oF,EAAO,GAAKmoF,EAAS78D,KAAKC,KAAKvrB,GAEhE,QAAS4wF,GAAgBhI,EAAOT,EAAQnoF,GACpC,OAAQ0sF,EAAW9D,EAAQ,GAAKT,EAAS78D,KAAKC,KAAKvrB,GAEvD,QAAS6wF,GAAMC,GACX,MAAOrE,GAAYqE,GAAG,GAAQ,GAElC,QAASC,GAAI5rF,GACT,MAAOsnF,GAAYtnF,GAEvB,QAAS6rF,GAAa7rF,EAAGI,EAAGkqC,EAAGu2C,GAC3B,GAAIA,EACA,MAAO,GAAM,GAAM8E,GAAKx/D,KAAK0e,IAAI7kC,GAAKI,IAAMkqC,EAAInkB,KAAKC,KAAK,IAE9D,IAAI6gB,GAAI9gB,KAAK0e,IAAI7kC,GAAKI,CACtB,OAAO+lB,MAAKw8B,KAAK1b,EAAIA,GAAK,EAAIqD,EAAIA,KAAOtqC,EAAIsqC,EAAInkB,KAAKC,KAAK,EAAID,KAAK07D,KAExE,QAASiK,GAAYtjC,EAAGpoD,EAAGkqC,GACvB,MAAOnkB,MAAKw8B,IAAIglC,EAASn/B,EAAGpoD,EAAGkqC,IAEnC,QAASyhD,GAAKC,EAAIC,EAAIC,EAAItvB,GAA1B,GAEejjE,GAUPgpF,EAEI3iF,EAbJvC,EAAIuuF,EAAG3zF,OACPiyC,EAAI,CACR,KAAK3wC,EAAI,EAAGA,EAAI8D,EAAG9D,IAAK,CACpB,GAAIsyF,EAAGtyF,IAAM,GAAKsyF,EAAGtyF,GAAK,EACtB,KAAM,IAAI4oC,IAAU,MAExB+H,IAAK2hD,EAAGtyF,GAEZ,GAAS,GAAL2wC,EACA,KAAM,IAAI/H,IAAU,MAGxB,KADIogD,EAAM,EACLhpF,EAAI,EAAGA,EAAI8D,EAAG9D,IACXqG,EAAIgsF,EAAGryF,GACPqG,GAAKksF,GAAMlsF,GAAK48D,IAChB+lB,GAAOsJ,EAAGtyF,GAGlB,OAAOgpF,GAEX,QAASwJ,GAAMC,EAAIJ,GAAnB,GAEaryF,GAAO8D,EACRwpC,EAFJolD,EAAK5C,EAAMuC,GAAKM,EAAK7C,EAAM2C,GAAKG,EAAK,EAAGC,EAAK,CACjD,KAAS7yF,EAAI,EAAG8D,EAAI2uF,EAAG/zF,OAAQsB,EAAI8D,EAAG9D,IAC9BstC,EAAI+kD,EAAGryF,GAAK0yF,EAChBE,GAAMtlD,GAAKmlD,EAAGzyF,GAAK2yF,GACnBE,GAAMvlD,EAAIA,CAEd,OAAOslD,GAAKC,EAEhB,QAASC,GAAUL,EAAIJ,GAAvB,GAGaryF,GAAO8D,EACRwpC,EAHJolD,EAAK5C,EAAMuC,GAAKM,EAAK7C,EAAM2C,GAC3BG,EAAK,EAAGC,EAAK,CACjB,KAAS7yF,EAAI,EAAG8D,EAAI2uF,EAAG/zF,OAAQsB,EAAI8D,EAAG9D,IAC9BstC,EAAI+kD,EAAGryF,GAAK0yF,EAChBE,GAAMtlD,GAAKmlD,EAAGzyF,GAAK2yF,GACnBE,GAAMvlD,EAAIA,CAEd,OAAOqlD,GAAKC,EAAKF,EAAKG,EAE1B,QAASE,GAAQV,EAAII,GAArB,GAEQC,GAAgBC,EAChBK,EAAQjJ,EAAQkJ,EACXjzF,EAAO8D,EACRohC,EAAiBC,CADzB,KAHA+tD,GAAiBb,EAAII,GACjBC,EAAK5C,EAAMuC,GAAKM,EAAK7C,EAAM2C,GAC3BO,EAAK,EAAGjJ,EAAK,EAAGkJ,EAAK,EAChBjzF,EAAI,EAAG8D,EAAIuuF,EAAG3zF,OAAQsB,EAAI8D,EAAG9D,IAC9BklC,EAAKmtD,EAAGryF,GAAK0yF,EAAIvtD,EAAKstD,EAAGzyF,GAAK2yF,EAClCK,GAAM9tD,EAAKC,EACX4kD,GAAM7kD,EAAKA,EACX+tD,GAAM9tD,EAAKA,CAEf,OAAO6tD,GAAKxmE,KAAKC,KAAKs9D,EAAKkJ,GAE/B,QAASE,IAAId,EAAII,GACb,GAAIzsF,GAAI+sF,EAAQV,EAAII,EACpB,OAAOzsF,GAAIA,EAEf,QAASotF,IAAMX,EAAIJ,GAAnB,GAIaryF,GACDklC,EAAiBC,EAJrBrhC,EAAIuuF,EAAG3zF,OACPg0F,EAAK5C,EAAMuC,GAAKM,EAAK7C,EAAM2C,GAC3BO,EAAK,EAAGjJ,EAAK,EAAGkJ,EAAK,CACzB,KAASjzF,EAAI,EAAGA,EAAI8D,EAAG9D,IACfklC,EAAKmtD,EAAGryF,GAAK0yF,EAAIvtD,EAAKstD,EAAGzyF,GAAK2yF,EAClCK,GAAM7tD,EAAKA,EACX4kD,GAAM7kD,EAAKC,EACX8tD,GAAM/tD,EAAKA,CAEf,OAAO1Y,MAAKC,MAAMumE,EAAKjJ,EAAKA,EAAKkJ,IAAOnvF,EAAI,IAEhD,QAASuvF,IAAShtF,EAAGosF,EAAIJ,GAAzB,GAGaryF,GAAO8D,EACRohC,EAAiBC,EAOrBtjB,EAAajZ,EAVb8pF,EAAK5C,EAAMuC,GAAKM,EAAK7C,EAAM2C,GAC3BO,EAAK,EAAGjJ,EAAK,CACjB,KAAS/pF,EAAI,EAAG8D,EAAIuuF,EAAG3zF,OAAQsB,EAAI8D,EAAG9D,IAC9BklC,EAAKmtD,EAAGryF,GAAK0yF,EAAIvtD,EAAKstD,EAAGzyF,GAAK2yF,EAClCK,GAAM9tD,EAAKC,EACX4kD,GAAM7kD,EAAKA,CAEf,IAAW,IAAP6kD,EACA,KAAM,IAAInhD,IAAU,MAGxB,OADI/mB,GAAImxE,EAAKjJ,EAAInhF,EAAI+pF,EAAK9wE,EAAI6wE,EACvB9pF,EAAIiZ,EAAIxb,EAEnB,QAASitF,IAAUC,GAAnB,GAEavzF,GADL8D,EAAIyvF,EAAIlzF,OAAQgoC,EAAM,CAC1B,KAASroC,EAAI,EAAGA,EAAI8D,EAAG9D,IACnBqoC,GAAOkrD,EAAIprF,KAAKnI,GAAG,EAEvB,OAAOqoC,GAAMvkC,EAEjB,QAAS0vF,IAAWD,EAAKE,GAAzB,GAEazzF,GACDqG,EAFJvC,EAAIyvF,EAAIlzF,OAAQqzF,EAAK,CACzB,KAAS1zF,EAAI,EAAGA,EAAI8D,EAAG9D,IACfqG,EAAIktF,EAAIprF,KAAKnI,GAAG,GAAKyzF,EACzBC,GAAMrtF,EAAIA,CAEd,OAAOqtF,GAEX,QAASC,IAAOC,EAAGC,EAAGC,EAAOC,GAA7B,GAcQC,GACAC,EACAC,EAUAC,EACAC,EACAC,EACAC,EACAvE,EACAwE,EACAC,EAEAC,EACAC,EACAC,EACAC,EAEAC,EACAC,EAEAC,EACAC,EA1CAh1F,EAAI,CAgBR,KAfK6zF,IACDA,EAAID,EAAEpyF,IAAI,WACN,QAASxB,KAGb8zF,IACAD,EAAIA,EAAEprE,QACNorE,EAAEzjD,QAAQ,SAAUj+B,GAChB0hF,EAAE1rF,KAAKgK,GAAK4X,QAAQ,OAEtB8pE,EAAEzzF,OAEJ4zF,EAAKH,EAAErjD,YACPyjD,EAAID,EAAGtjD,SAASmjD,GAAGziD,UAAUV,SAASsjD,GAAItjD,SAASkjD,GACnDM,KACCl0F,EAAIi0F,EAAE5zF,OAAS,EAAGL,GAAK,EAAGA,IAC3Bk0F,EAAOl2F,KAAKi2F,EAAE9rF,KAAKnI,GAAG,GAK1B,IAHK8zF,GACDI,EAAOl2F,KAAK,IAEX+1F,EACD,MAAOl2F,MAAKoxC,UAAUilD,GAoB1B,KAlBIC,EAAKN,EAAEnjD,SAASujD,GAChBG,EAAOR,EAAE9iD,KAAKqjD,GAAI,GAClBE,EAAMP,EAAYR,GAAUa,GAAd,EACdG,EAAQd,GAAWW,EAAIE,GACvBtE,EAAM+D,EAAYR,GAAUc,GAAd,EACdG,EAAUf,GAAWY,EAAMrE,GAC3ByE,KACJA,EAAOx2F,KAAKs2F,EAAOC,GACfE,EAAKH,GAASA,EAAQC,GACtBG,EAASd,EAAEvzF,OAASwzF,EAAEzzF,MACtBu0F,EAAUnoE,KAAKC,KAAK8nE,EAAUG,GAC9BE,KACJA,EAAO52F,KAAKy2F,EAAIE,GACZE,EAASf,EAA6CQ,GAAST,EAAEzzF,MAAQ,IAAMm0F,EAAUG,GAAxED,EAAKZ,EAAEzzF,QAAU,EAAIq0F,GAAMC,GAC5CI,KACJA,EAAO92F,KAAK62F,EAAOH,GACfK,EAAMf,EAAGtjD,SAASmjD,GAAGziD,UACrB4jD,KACCh1F,EAAI+0F,EAAI10F,OAAS,EAAGL,GAAK,EAAGA,IAC7Bg1F,EAAOh3F,KAAKwuB,KAAKC,KAAKsoE,EAAI5sF,KAAKnI,GAAGA,GAAKu0F,EAAUG,GAErD,OAAO72F,MAAKoxC,UACRilD,EACAc,EACAJ,EACAE,EACAN,IAGR,QAASS,IAAOrB,EAAGC,EAAGC,EAAOC,GACzB,MAAOJ,IAAO/1F,KAAKC,KAAM+1F,EAAEpyF,IAAIgrB,KAAK0e,KAAM2oD,EAAGC,EAAOC,GAAOvyF,IAAIgrB,KAAKw8B,KAExE,QAASksC,IAAMtB,EAAGC,EAAGsB,EAAGrB,GAAxB,GAcQE,GACAC,EAdAj0F,EAAI,CA0BR,OAzBK6zF,KACDA,EAAID,EAAEpyF,IAAI,WACN,QAASxB,KAGb8zF,IACAD,EAAIA,EAAEprE,QACNorE,EAAEzjD,QAAQ,SAAUj+B,GAChB0hF,EAAE1rF,KAAKgK,GAAK4X,QAAQ,OAEtB8pE,EAAEzzF,OAEJ4zF,EAAKH,EAAErjD,YACPyjD,EAAID,EAAGtjD,SAASmjD,GAAGziD,UAAUV,SAASsjD,GAAItjD,SAASkjD,GAClDuB,EAGGrB,IACAqB,EAAIA,EAAE1sE,QACN0sE,EAAE/kD,QAAQ,SAAUj+B,GAChBgjF,EAAEhtF,KAAKgK,GAAK4X,QAAQ,OAEtBorE,EAAE/0F,OAPR+0F,EAAItB,EAUDsB,EAAEzkD,SAASujD,GAEtB,QAASmB,IAAOxB,EAAGC,EAAGwB,EAAOvB,GACzB,MAAOoB,IAAMt3F,KAAKC,KAAM+1F,EAAEpyF,IAAIgrB,KAAK0e,KAAM2oD,EAAGwB,EAAOvB,GAAOtyF,IAAIgrB,KAAKw8B,KAEvE,QAASssC,IAAYrqD,EAAMsqD,EAAOC,EAAQC,GAA1C,GAGaxpF,GACDypF,EAAkBv4F,EAAYk0F,EAC9BrlE,EAJJihE,EAASuI,GAAU,GAAItI,EAAMuI,GAAO,KACpC3nE,EAAOynE,CACX,KAAStpF,EAAI,EAAGA,GAAKghF,EAAQhhF,IAIzB,GAHIypF,EAAMzqD,EAAKnd,GAAO3wB,EAAIu4F,EAAI,GAAIrE,EAAKqE,EAAI,GACvC1pE,EAAK7uB,EAAIk0F,EACbvjE,GAAQ9B,EACJQ,KAAK6I,IAAIrJ,GAAMkhE,EACf,MAAOp/D,EAGf,OAAO,IAAI8a,IAAU,OAEzB,QAAS+sD,IAAGC,EAAMC,EAAMC,EAAKC,EAAI3mF,GAAjC,GACQ4mF,GAAKxpE,KAAK2mB,IAAI,EAAIyiD,EAAMC,GACxBI,EAAKL,GAAQI,EAAK,GAAKJ,EAAOC,CAClC,SAASE,EAAKC,EAAKF,EAAMG,GAAM,EAAIL,EAAOxmF,IAE9C,QAAS8mF,IAAGN,EAAMC,EAAMC,EAAKK,EAAI/mF,GAC7B,IAAKwmF,EACD,OAAQO,EAAKL,EAAMD,CAEvB,IAAIG,GAAKxpE,KAAK2mB,IAAI,EAAIyiD,EAAMC,EAC5B,SAASM,EAAKL,GAAOE,EAAK,GAAKJ,GAAQ,EAAIA,EAAOxmF,IAAS4mF,EAE/D,QAASI,IAAIR,EAAMC,EAAME,EAAII,EAAI/mF,GAC7B,IAAKwmF,EACD,QAASO,EAAKJ,GAAMF,CAExB,IAAIG,GAAKxpE,KAAK2mB,IAAI,EAAIyiD,EAAMC,EAC5B,QAAQD,GAAQO,EAAKJ,EAAKC,KAAQ,EAAIJ,EAAOxmF,IAAS4mF,EAAK,IAE/D,QAASK,IAAKT,EAAME,EAAKC,EAAII,EAAI/mF,GAC7B,IAAKwmF,EACD,QAASO,EAAKJ,GAAMD,CAExB,IAAIE,GAAKF,GAAO,EAAIF,EAAOxmF,EAC3B,OAAOod,MAAK0e,KAAK8qD,EAAKG,EAAKP,IAASI,EAAKD,EAAKH,IAASppE,KAAK0e,IAAI,EAAI0qD,GAExE,QAASU,IAAKT,EAAMC,EAAKC,EAAII,EAAI/mF,EAAMmmF,GACnC,QAASgB,GAAIlwF,GACT,GAAI4vF,GAAKzpE,KAAK2mB,IAAI,EAAI9sC,EAAGwvF,EAAO,GAAIG,EAAKC,GAAM,EAAI5vF,EACnD,QACI0vF,EAAKC,EAAKF,GAAO,EAAIzvF,EAAI+I,IAAS4mF,EAAK,GAAKG,EAC5CN,EAAOE,EAAKE,EAAKH,KAASE,EAAK,IAAM3vF,EAAIA,IAAM,EAAIA,EAAI+I,GAAQymF,EAAOI,IAG9E,MAAOX,IAAYiB,EAAKhB,GAE5B,QAASiB,IAAKZ,EAAMa,EAAKZ,EAAME,EAAII,EAAI/mF,GAAvC,GAIQ0mF,GACAY,CAJJ,OAAY,IAARtnF,GAAoB,GAAPqnF,EACN,GAEPX,EAAMM,GAAIR,EAAMC,EAAME,EAAII,EAAI/mF,GAC9BsnF,EAAOf,GAAGC,EAAMa,EAAM,EAAGX,EAAKC,EAAI3mF,GAAQwmF,EACvCxmF,EAAOsnF,GAAQ,EAAId,GAAQc,GAEtC,QAASC,IAAKf,EAAMa,EAAKZ,EAAME,EAAII,EAAI/mF,GACnC,GAAI0mF,GAAMM,GAAIR,EAAMC,EAAME,EAAII,EAAI/mF,EAClC,OAAO0mF,GAAMU,GAAKZ,EAAMa,EAAKZ,EAAME,EAAII,EAAI/mF,GAE/C,QAASwnF,IAAShB,EAAMC,EAAME,EAAIxoE,EAAOjP,EAAKlP,GAA9C,GAKQynF,GAA+BC,EAAoCC,EACnEC,EACAC,EACAC,CACJ,OARY,IAAR9nF,IACAme,IACAjP,KAEAu4E,EAAKrqE,KAAK2mB,IAAI,EAAIyiD,EAAMC,GAAOiB,EAAKtqE,KAAK2mB,IAAI,EAAIyiD,EAAMroE,EAAQ,GAAIwpE,EAAKvqE,KAAK2mB,IAAI,EAAIyiD,EAAMt3E,GAC3F04E,EAAiBpB,EAAOG,EAAKc,GAAMA,EAAK,GACxCI,EAA0BH,EAAKf,GAAMe,EAAK,GAAKlB,EAAOoB,EACtDE,EAAwBH,EAAKhB,GAAMgB,EAAK,GAAKnB,EAAOoB,EACjDE,EAAwBD,EAEnC,QAASE,IAAQvB,EAAMC,EAAME,EAAIxoE,EAAOjP,EAAKlP,GAA7C,GAEapP,GADLo3F,EAAM,CACV,KAASp3F,EAAIutB,EAAOvtB,GAAKse,EAAKte,IAC1Bo3F,GAAOZ,GAAKZ,EAAM51F,EAAG61F,EAAME,EAAI,EAAG3mF,EAEtC,OAAOgoF,GAEX,QAASC,IAAIzB,EAAM0B,GAAnB,GAEat3F,GAAO8D,EADZyzF,EAAM,CACV,KAASv3F,EAAI,EAAG8D,EAAIwzF,EAAM54F,OAAQsB,EAAI8D,EAAG9D,IACrCu3F,GAAOD,EAAMt3F,GAAKwsB,KAAK2mB,IAAI,EAAIyiD,GAAO51F,EAAI,EAE9C,OAAOu3F,GAEX,QAASC,IAAIF,EAAO/B,GAChB,QAASgB,GAAIlwF,GAAb,GAEa4F,GAAOnI,EADZyzF,EAAM,EAAGE,EAAO,CACpB,KAASxrF,EAAI,EAAGnI,EAAIwzF,EAAM54F,OAAQuN,EAAInI,EAAGmI,IACrCsrF,GAAOD,EAAMrrF,GAAKugB,KAAK2mB,IAAI,EAAI9sC,GAAI4F,EAAI,GACvCwrF,IAASxrF,EAAIqrF,EAAMrrF,GAAKugB,KAAK2mB,IAAI,EAAI9sC,GAAI4F,EAAI,EAEjD,QACIsrF,EACAE,GAGR,MAAOnC,IAAYiB,EAAKhB,GAE5B,QAASmC,IAAOC,EAAcC,GAC1B,MAAOprE,MAAK2mB,IAAI,EAAIwkD,EAAeC,EAAOA,GAAS,EAEvD,QAASC,IAAQC,EAAaF,GAC1B,MAAOA,IAASprE,KAAK2mB,IAAI2kD,EAAc,EAAG,EAAIF,GAAS,GAE3D,QAASG,IAAKnC,EAAMhwF,EAAQy5E,GAA5B,GAEar/E,GAAO8D,EADZyzF,EAAM,CACV,KAASv3F,EAAI,EAAG8D,EAAI8B,EAAOlH,OAAQsB,EAAI8D,EAAG9D,IACtCu3F,GAAO3xF,EAAO5F,GAAKwsB,KAAK2mB,IAAI,EAAIyiD,GAAOvW,EAAM,GAAKA,EAAMr/E,IAAM,IAElE,OAAOu3F,GAEX,QAASS,IAAKpyF,EAAQy5E,EAAOkW,GACzB,QAASgB,GAAIlwF,GAAb,GAEa4F,GAAOnI,EACRyO,EAFJglF,EAAM3xF,EAAO,GAAI6xF,EAAO,CAC5B,KAASxrF,EAAI,EAAGnI,EAAI8B,EAAOlH,OAAQuN,EAAInI,EAAGmI,IAClCsG,GAAS8sE,EAAM,GAAKA,EAAMpzE,IAAM,IACpCsrF,GAAO3xF,EAAOqG,GAAKugB,KAAK2mB,IAAI,EAAI9sC,EAAGkM,GACnCklF,GAAQllF,EAAQ3M,EAAOqG,GAAKugB,KAAK2mB,IAAI,EAAI9sC,EAAGkM,EAAQ,EAExD,QACIglF,EACAE,GAGR,MAAOnC,IAAYiB,EAAKhB,GAE5B,QAAS0C,IAAMrC,EAAMa,EAAKZ,EAAME,GAC5B,GAAI3pF,IAAO2pF,EAAKH,CAChB,OAAOxpF,IAAO,EAAIqqF,EAAMZ,GAE5B,QAASqC,IAAGC,EAAMC,EAASC,EAAMC,EAAQ5sD,GAAzC,GAGQ6sD,GAIKv4F,EANL41F,EAAO,EAAIppE,KAAK2mB,IAAIilD,EAAUD,EAAM,EAAIE,EAG5C,IAFAzC,EAAOppE,KAAK+F,MAAa,IAAPqjE,EAAc,IAAO,IACnC2C,EAAKJ,EAAOvC,EAAOlqD,EAAQ,GACjB,GAAV4sD,EACA,MAAOC,EAEX,KAASv4F,EAAI,EAAGA,EAAIq4F,EAAMr4F,IAAK,CAC3B,GAAIA,GAAKs4F,EAAS,EACd,OAAQH,EAAOI,GAAM3C,CAEzB2C,KAAOJ,EAAOI,GAAM3C,EAExB,OAAQuC,EAAOI,GAAM3C,GAAQ,GAAKlqD,GAAS,GAE/C,QAAS8sD,IAAIL,EAAMC,EAASC,EAAMC,EAAQG,GAA1C,GACQt7F,GAAIs7F,EAASJ,EACbK,GAASP,GAAQ3rE,KAAK2mB,IAAI,EAAIh2C,EAAGm7F,EAAS,GAAK,GAC/CK,GAAOR,EAAOO,GAASv7F,CAE3B,OADAw7F,GAAMnsE,KAAKqK,IAAI8hE,EAAKnsE,KAAKoK,IAAI,EAAGuhE,EAAOO,EAAQN,IAGnD,QAASQ,IAAIT,EAAMC,EAASC,GACxB,OAAQF,EAAOC,GAAWC,EAE9B,QAASQ,IAAIV,EAAMC,EAASC,EAAM5B,GAC9B,OAAQ0B,EAAOC,IAAYC,EAAO5B,EAAM,GAAK,GAAK4B,GAAQA,EAAO,IAErE,QAASS,IAAIX,EAAMC,EAASC,EAAM9qE,EAAOjP,EAAKm6E,EAAQM,GAElD,QAASC,GAAQz3F,EAAO+2F,GACpB,GAAIW,GAAKC,EAAUrwE,CAQnB,OANIqwE,GADY,GAAZC,EACqB,GAAVb,EAAc/2F,EAAQ,EAEtBA,EAAQirB,KAAK2mB,IAAI,EAAIgmD,EAAUb,EAAS,GAEvDzvE,EAAWtnB,EAAQirB,KAAK2mB,IAAI,EAAIgmD,EAAUb,GAC1CW,EAAMpwE,EAAWuvE,EAAUc,EAAWd,EAAUc,EAAWrwE,EACpDowE,EAAM,EAAI,EAAIA,EAEzB,QAASG,GAAUjB,EAAMkB,EAAOf,GAAhC,GAGQgB,GACKt5F,EAEGi5F,EALRM,EAAWpB,EAAOC,EAClBoB,EAAShtE,KAAK83B,KAAKg0C,GACbmB,EAAM,EAAGC,EAAM,EAAGC,GAAS,CACrC,KAAS35F,EAAI,EAAGA,GAAKw5F,EAAQx5F,IACpB25F,EAWDL,EAAOG,GAVHR,EAAMD,EAAQb,EAAMn4F,GACxBy5F,EAAMF,GAAYF,EAAQr5F,EAAI,GAC1By5F,EAAMR,GACNK,EAAOG,EACPE,GAAS,IAETL,EAAOL,EACPM,GAAYN,IAKhBj5F,GAAKw5F,IACLF,GAAQhB,EAAS,EAAIkB,GAEzBE,GAAOJ,CAEX,OAAOI,GApCf,GAyCiB15F,GACDs5F,EAWJD,EAIY1gC,EAxDhBwgC,EAAWV,GAAUJ,EAAO,EAAII,EAASJ,EAqCzCuB,EAAWptE,KAAK+F,MAAMhF,GAAQisE,EAAShtE,KAAK83B,KAAKhmC,GACjDo7E,EAAM,CACV,IAAIX,EACA,IAAS/4F,EAAI45F,EAAW,EAAG55F,GAAKw5F,EAAQx5F,IAChCs5F,EAAON,EAAQb,EAAMn4F,GACrBA,GAAK45F,EAAW,EAChBN,GAAQ9sE,KAAKqK,IAAIvY,EAAKs7E,EAAW,GAAKrsE,EAElCvtB,GAAKw5F,IACLF,GAAQh7E,EAAM,EAAIk7E,GAG1BE,GAAOJ,MAGPD,GAAQhB,EACR9qE,GAASf,KAAK+F,MAAMhF,IAChBkrE,EAAS,GACLlrE,GAAS8qE,EAAO,IACZ1/B,EAAOprC,EAAQ8qE,EAAO,EAC1B9qE,EAAQ8qE,EAAO,EACf/5E,GAAOq6C,EACP0gC,GAAS,GAIrBlB,GAAQiB,EAAUjB,EAAMkB,EAAO9rE,GAC/BmsE,EAAMN,EAAUjB,EAAME,EAAO9qE,EAAOjP,EAAMiP,EAE9C,OAAOmsE,GAEX,QAASG,IAAOx+E,EAAMgmE,GAAtB,GACQ76E,GAAI+lC,GAAWlxB,GACf5U,EAAID,EAAEklC,MAAQ21C,EACd/0D,EAAI9lB,EAAEilC,KAAOjf,KAAK+F,MAAM9rB,EAAI,GAMhC,OALAA,IAAK,GACDA,EAAI,IACJA,GAAK,IAETD,EAAIgmB,KAAKqK,IAAIrwB,EAAEmlC,KAAMO,GAAY5f,EAAG7lB,IAC7BimC,GAASpgB,EAAG7lB,EAAGD,GAE1B,QAASszF,IAAatmD,EAAMO,EAAIgmD,GAC5B,MAAa,IAATA,GAAuB,GAATA,GAAuB,GAATA,EACrBhmD,EAAKP,EAET6zC,GAAU7zC,EAAMO,EAAIgmD,GAE/B,QAASC,IAAeC,EAAYC,EAAUC,GAA9C,GAMQj0F,GAAM2rC,EAAMwvC,EALZ+Y,EAAO7tD,GAAW0tD,GAAa5+E,EAAOkxB,GAAW2tD,GACjDG,EAAUh/E,EAAKowB,KAAO2uD,EAAK3uD,IAC3B4uD,GAAU,IACVA,GAAWA,EAAU,GAAKF,GAEd9Y,EAAS,GAAK8Y,CAC9B,GACIE,KACAn0F,EAAO2zF,GAAOK,GAAWG,EAAUhZ,SAC9B4Y,EAAa/zF,EAGtB,OAFAm0F,KACAxoD,EAAOgoD,GAAOK,GAAWG,EAAUhZ,IAE/Bn7E,EACA2rC,GAGR,QAASyoD,IAAkBlsE,EAAO6rE,EAAYE,GAA9C,GAMQj0F,GAAc2rC,EAAMwvC,EALpB+Y,EAAO7tD,GAAW0tD,GAAa5+E,EAAOkxB,GAAWne,GACjDisE,EAAUD,EAAK3uD,KAAOpwB,EAAKowB,IAK/B,KAJI4uD,EAAU,IACVA,GAAWA,EAAU,GAAKF,GAE1Bj0F,EAAOkoB,EAAaizD,EAAS,GAAK8Y,EAC/BF,EAAa/zF,GAChB2rC,EAAO3rC,EACPm0F,IACAn0F,EAAO2zF,GAAOzrE,EAAOisE,EAAUhZ,EAEnC,QACIxvC,EACA3rC,GAGR,QAASq0F,IAAUN,EAAYC,EAAUM,EAAWT,GAChD,GAAI7zF,GAAO8zF,GAAeC,EAAYC,EAAUM,GAAW,EAC3D,OAAOV,IAAa5zF,EAAM+zF,EAAYF,GAE1C,QAASU,IAASC,EAAOC,EAAOR,EAAMJ,GAClC,GAAa,GAATA,EAAY,CACZ,GAAI34D,GAAU44D,GAAeU,EAAOC,EAAOR,EAC3C,OAAOL,IAAa14D,EAAQ,GAAIA,EAAQ,GAAI,GAEhD,MAAa,IAAT24D,EACO,IAAMI,EAEV,IAAMA,EAEjB,QAASS,IAAWF,EAAOC,EAAOR,EAAMJ,GACpC,GAAIloD,GAAOmoD,GAAeU,EAAOC,EAAOR,GAAM,EAC9C,OAAOL,IAAaY,EAAO7oD,EAAMkoD,GAErC,QAASc,IAAQH,EAAOC,EAAOR,GAC3B,MAAOH,IAAeU,EAAOC,EAAOR,GAAM,GAE9C,QAASW,IAAQJ,EAAOC,EAAOR,GAC3B,MAAOH,IAAeU,EAAOC,EAAOR,GAAM,GAE9C,QAASY,IAAQL,EAAOC,EAAOR,GAA/B,GACQC,GAAO7tD,GAAWmuD,GAAQM,EAAMzuD,GAAWouD,GAC3CtZ,EAAS,IAAM2Z,EAAIvvD,KAAO2uD,EAAK3uD,MAAQuvD,EAAItvD,MAAQ0uD,EAAK1uD,KAC5D,OAAO,IAAK21C,EAAS8Y,EAAO,GAAK,GAErC,QAASluD,IAAWD,EAAI+tD,GACpB,MAAa,IAATA,EACO,IAEE,GAATA,EACOhuD,GAAWC,GAAM,IAAM,IAE3B,IAEX,QAASivD,IAASC,EAAOhB,EAAUtE,EAAMuF,EAAKpB,GAC1C,GAAIqB,GAAYnvD,GAAWM,GAAW2tD,GAAUzuD,KAAMsuD,EACtD,OAAOnE,GAAOuF,EAAMrB,GAAaoB,EAAOhB,EAAUH,GAASqB,EAE/D,QAASC,IAAQH,EAAO9sE,EAAOssE,EAAO9E,EAAMuF,EAAKhB,EAAMJ,EAAOjoF,GAI1D,QAASwpF,GAAY9nD,EAAMO,GACvB,OAAQA,EAAKP,GAAQ2mD,EAAOoB,EAAS,EAL7C,GAEQC,GAAOt1F,EAAM2rC,EAAM4pD,EAAOC,EAAOC,EADjCC,EAAO,EAAGzD,EAAOgD,EAAMvF,EAAOuE,EAE9BoB,EAASxB,EAAQ,IAAM,EAAI,IAAM,GAIrC,OAAIW,IAAStsE,GACTotE,EAAQxB,GAAeU,EAAOtsE,EAAO+rE,GACrCj0F,EAAOs1F,EAAM,GACb3pD,EAAO2pD,EAAM,GACTt1F,GAAQg1F,EACD/C,EAAO2B,GAAaoB,EAAOR,EAAOX,GAASD,GAAa5zF,EAAM2rC,EAAMkoD,IAE/EyB,EAAQxB,GAAekB,EAAOh1F,EAAMi0F,GACpCsB,EAAQD,EAAM,GACdE,EAAQF,EAAM,GACdG,EAAML,EAAYI,EAAOhB,GAClBvC,GAAQwD,EAAM7B,GAAaoB,EAAOQ,EAAO3B,GAASD,GAAa2B,EAAOC,EAAO3B,IAAUW,EAAQ7oD,EAAOioD,GAAa5zF,EAAMw0F,EAAOX,GAASD,GAAa5zF,EAAM2rC,EAAMkoD,GAAS,OAElLyB,EAAQlB,GAAkBlsE,EAAOssE,EAAOP,GACxCj0F,EAAOs1F,EAAM,GACb3pD,EAAO2pD,EAAM,GACbG,EAAML,EAAYltE,EAAOssE,GAErBkB,EADA/pD,GAAQ6oD,EACDvC,EAAOwD,EAEPxD,GAAQwD,EAAM7B,GAAa5zF,EAAMw0F,EAAOX,GAASD,GAAa5zF,EAAM2rC,EAAMkoD,IAEhFjoF,GAGL0pF,EAAQxB,GAAekB,EAAO9sE,EAAO+rE,GACrCj0F,EAAOs1F,EAAM,GACb3pD,EAAO2pD,EAAM,GACbG,EAAML,EAAYJ,EAAO9sE,GACzBwtE,GAAQzD,GAAQwD,EAAM7B,GAAaoB,EAAOrpD,EAAMkoD,GAASD,GAAa5zF,EAAM2rC,EAAMkoD,KANvE6B,GAUnB,QAASC,IAAKnB,EAAOC,EAAOmB,EAAIC,EAAYhC,GACxC,GAAIwB,GAASxB,EAAQ,IAAM,EAAI,IAAMhuD,GAAWQ,GAAWmuD,GAAOjvD,MAAQ,IAAM,GAChF,QAAQswD,EAAaD,GAAMC,EAAaR,EAASzB,GAAaY,EAAOC,EAAOZ,GAEhF,QAASiC,IAAQtB,EAAOC,EAAOsB,EAAYF,EAAYhC,GACnD,GAAIwB,GAASxB,EAAQ,IAAM,EAAI,IAAMhuD,GAAWQ,GAAWmuD,GAAOjvD,MAAQ,IAAM,GAChF,QAAQswD,EAAaE,GAAcA,EAAaV,EAASzB,GAAaY,EAAOC,EAAOZ,GAExF,QAASmC,IAASxB,EAAOC,EAAOsB,EAAYE,EAAUpC,GAClD,GAAIwB,GAASxB,EAAQ,IAAM,EAAI,IAAMhuD,GAAWQ,GAAWmuD,GAAOjvD,MAAQ,IAAM,GAChF,OAAOwwD,IAAc,EAAIE,EAAWrC,GAAaY,EAAOC,EAAOZ,GAASwB,GAE5E,QAASa,IAAM1B,EAAOC,EAAO/E,EAAMyG,EAAKN,EAAY5B,EAAMJ,GAA1D,GACQuC,GAAI,IAAM3B,EAAQD,GAASP,GAAQJ,EAAQ,IAAM,EAAI,IAAM,KAAO,GAClEyB,EAAQxB,GAAeU,EAAOC,EAAOR,GAAOj0F,EAAOs1F,EAAM,GAAI3pD,EAAO2pD,EAAM,GAC1Ee,EAAYzC,GAAa5zF,EAAMw0F,EAAOX,GAAQyC,EAAY1C,GAAaY,EAAO7oD,EAAMkoD,GAAQ0C,EAAU3C,GAAa5zF,EAAM2rC,EAAMkoD,GAC/H2C,EAAM,IAAM9G,EAAOuE,EAAMwC,EAAKN,EAAMlC,EAAMntD,EAAOwvD,EAAYC,CACjE,OAAS,IAALH,GACQP,EAAaW,IAAQ,EAAI1vD,EAAO2vD,GAAMJ,EAAYE,EAAUC,EAEjEX,EAAavvE,KAAK2mB,IAAI,EAAIwpD,EAAIL,EAAI,EAAItvD,GAAQ0vD,EAAMlwE,KAAK2mB,IAAI,EAAIwpD,EAAI,EAAIL,EAAItvD,IAASxgB,KAAK2mB,IAAI,EAAIwpD,EAAIL,GAAK,GAAKK,EAAKJ,EAAYE,EAAUC,EAEvJ,QAASE,IAAUlC,EAAOC,EAAOwB,EAAUJ,EAAYhC,GACnD,GAAI8C,GAAM/C,GAAaY,EAAOC,EAAOZ,GAAQ9tE,EAAKggB,GAAWM,GAAWouD,GAAOlvD,KAAMsuD,EACrF,OAAOgC,GAAaI,EAAWJ,EAAac,EAAM5wE,EAEtD,QAASinE,IAAiBtqF,EAAGiZ,GACzB,IAAK,GAAI7hB,GAAI4I,EAAElK,SAAUsB,GAAK,GACP,gBAAR4I,GAAE5I,IAAiC,gBAAR6hB,GAAE7hB,KACpC4I,EAAEgwB,OAAO54B,EAAG,GACZ6hB,EAAE+W,OAAO54B,EAAG,IA7zG1B,GAKMkO,IACA4D,GACA0M,GACAwsB,GACApC,GACA8D,GACAH,GACAR,GACAG,GACAm7C,GAu3DAyV,GAscA7P,GAAcC,GAAkBC,GAAgBhB,EAz0EhD9uF,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DC,GAAc7Q,MAAM6Q,YACpB4D,GAAO5D,GAAY4D,KACnB0M,GAAU1M,GAAK0M,QACfwsB,GAAiBxsB,GAAQwsB,eACzBpC,GAAYpqB,GAAQoqB,UACpB8D,GAAWluB,GAAQkuB,SACnBH,GAAa/tB,GAAQ+tB,WACrBR,GAAavtB,GAAQutB,WACrBG,GAAc1tB,GAAQ0tB,YACtBm7C,GAAY7oE,GAAQ6oE,UACxBr8C,GAAe,MAAO,SAAU+xD,EAAIn4C,GAChC,MAAU,OAANA,EACOonC,EAAI+Q,GAER/Q,EAAIpnC,GAAMonC,EAAI+Q,KACtB7zD,OAEK,cACA,WAGA,eAEI,KACA,SACA,WAIZ8B,GAAe,OAAQohD,GAAMljD,OACrB,IACA,YAER8B,GAAe,UAAWqhD,GAASnjD,OAC3B,IACA,cAER8B,GAAe,QAASwhD,GAAOtjD,OACvB,IACA,YAER8B,GAAe,aAAcsiD,GAAYpkD,OAEjC,IACA,YAGA,QACA,aAGA,OACA,aAGA,aACA,aAGR8B,GAAe,YAAauiD,GAAWrkD,OAE/B,KAEI,MACA,UAEI,YACA,EACA,MAKR,QACA,aAGA,OACA,cAGR8B,GAAe,cAAe2iD,GAAazkD,OAEnC,IACA,WAGA,aACA,aAGR8B,GAAe,aAAc4iD,GAAY1kD,OACjC,KAEI,MACA,UAEI,YACA,EACA,OAIhB8B,GAAe,YAAa+iD,GAAW7kD,OAE/B,IACA,WAGA,OACA,WAGA,SACA,aAGA,aACA,aAGR8B,GAAe,WAAYgjD,GAAU9kD,OAE7B,KAEI,MACA,UAEI,YACA,EACA,MAKR,OACA,WAGA,SACA,cAGR8B,GAAe,WAAY0jD,GAAUxlD,OAE7B,IACA,WAGA,QACA,aAGA,OACA,aAGA,KAEI,KACA,UAEI,OACA,MAKR,KAEI,KACA,UAEI,OACA,MAKR,KAEI,SACA,WACA,SAIJ,KAEI,SACA,WACA,SAIJ,KAEI,SACA,UACA,UAIZ8B,GAAe,YAAa2jD,GAAWzlD,OAE/B,IACA,WAGA,QACA,aAGA,OACA,aAGA,aACA,YAGA,KAEI,KACA,UAEI,OACA,MAKR,KAEI,KACA,UAEI,OACA,MAKR,KAEI,SACA,WACA,SAIJ,KAEI,SACA,WACA,SAIJ,KAEI,SACA,UACA,UAIZ8B,GAAe,WAAY6jD,GAAU3lD,OAE7B,KAEI,MACA,UAEI,YACA,EACA,MAKR,QACA,aAGA,OACA,aAGA,KAEI,KACA,UAEI,OACA,MAKR,KAEI,KACA,UAEI,OACA,OAKhB8B,GAAe,aAAc8jD,GAAY5lD,OAEjC,IACA,YAGA,cACA,cAGA,aACA,aAGR8B,GAAe,gBAAiBgkD,GAAa9lD,OAErC,IACA,YAGA,cACA,eAGR8B,GAAe,YAAaikD,GAAgB/lD,OAEpC,KAEI,MACA,UAEI,YACA,EACA,MAKR,cACA,eAGR8B,GAAe,eAAgBkkD,GAAiBhmD,OAExC,KAEI,MACA,UAEI,YACA,EACA,MAKR,cACA,eAGR8B,GAAe,aAAc,SAAUgyD,EAAIv1F,GACvC,MAAO0nF,GAAW6N,EAAG70F,KAAMV,EAAGU,QAC/B+gC,OAEK,eACA,WAGA,iBACA,WAGA,KAEI,SACA,kDAIJ,KAEI,SACA,qDAIZ8B,GAAe,aAAcukD,GAAOrmD,OAE5B,IACA,YAGA,SACA,aAGA,aACA,aAGR8B,GAAe,eAAgBwkD,GAAStmD,OAEhC,IACA,aAGA,OACA,YAGA,aACA,aAGR8B,GAAe,SAAU0kD,GAAOxmD,OAExB,IACA,YAGA,eACA,cAGA,eACA,cAGA,aACA,aAGR8B,GAAe,YAAa2kD,GAAazmD,OAEjC,IACA,YAGA,eACA,cAGA,eACA,eAGR8B,GAAe,QAAS6kD,GAAM3mD,OAEtB,KAEI,MACA,UAEI,YACA,EACA,MAKR,eACA,cAGA,eACA,eAGR8B,GAAe,WAAY4kD,GAAY1mD,OAE/B,KAEI,MACA,UAEI,YACA,EACA,MAKR,eACA,cAGA,eACA,eAGR8B,GAAe,SAAUilD,GAAO/mD,OAExB,UAEI,UACA,SACA,KAIJ,UAEI,UACA,SACA,KAIJ,KAEI,SACA,sBACA,WAIJ,KAEI,SACA,sBACA,YAIZ8B,GAAe,SAAUwlD,GAAQtnD,OACzB,KAEI,MACA,UAEI,eAEA,OAIhB8B,GAAe,YAAaylD,GAAWvnD,OAC/B,IACA,YAER8B,GAAe,SAAU2lD,GAAOznD,OAExB,IACA,WAGA,cACA,cAGA,aACA,aAGR8B,GAAe,YAAa4lD,GAAa1nD,OAEjC,IACA,WAGA,cACA,eAGR8B,GAAe,YAAa6lD,GAAa3nD,OAEjC,IACA,YAGA,cACA,eAGR8B,GAAe,QAAS8lD,GAAW5nD,OAE3B,KAEI,MACA,UAEI,YACA,EACA,MAKR,cACA,eAGR8B,GAAe,WAAY+lD,GAAiB7nD,OAEpC,KAEI,MACA,UAEI,YACA,EACA,MAKR,cACA,eAGR8B,GAAe,SAAUgmD,GAAY9nD,OAE7B,UAEI,UACA,SACA,KAIJ,UAEI,UACA,SACA,KAIJ,SAEI,MACA,WAEI,SACA,EACA,MAKR,QAEI,MACA,WAEI,SACA,EACA,EACA,MAKR,KAEI,SACA,iDACA,SAIJ,KAEI,SACA,sBACA,WAIJ,KAEI,SACA,sBACA,YAIZ8B,GAAe,eAAgB6mD,GAAc3oD,OAErC,SAEI,MACA,UAEI,YACA,EACA,MAKR,eACA,aAGA,QAEI,MACA,aAEI,SACA,aACA,aAKhB8B,GAAe,kBAAmB8mD,GAAiB5oD,OAE3C,SAEI,MACA,UAEI,YACA,EACA,MAKR,eACA,aAGA,QAEI,MACA,gBAIZ8B,GAAe,QAAS+mD,GAAO7oD,OACvB,IACA,YAER8B,GAAe,MAAOinD,GAAK/oD,OACnB,IACA,YAER8B,GAAe,eAAgBknD,GAAchpD,OAErC,IACA,aAGA,OACA,WAGA,eACA,aAGA,aACA,aAGR8B,GAAe,cAAemnD,GAAajpD,OAEnC,eAEI,MACA,UAEI,YACA,EACA,MAKR,OACA,WAGA,eACA,cAGR8B,GAAe,OAAQonD,GAAMlpD,OAErB,WAEI,UACA,SACA,KAIJ,cAEI,UACA,SACA,KAIJ,cACA,WAGA,eAEI,KACA,UAEI,OACA,mBAKR,KAEI,SACA,wCACA,UAIZ8B,GAAe,QAASwnD,GAAOtpD,OAEvB,WAEI,UACA,SACA,KAIJ,WAEI,UACA,SACA,KAIJ,KAEI,SACA,qCACA,SAIJ,KAEI,SACA,6CACA,UAIZ8B,GAAe,YAAa8nD,GAAW5pD,OAE/B,WAEI,UACA,SACA,KAIJ,WAEI,UACA,SACA,KAIJ,KAEI,SACA,qCACA,SAIJ,KAEI,SACA,6CACA,UAIZ8B,GAAe,UAAW+nD,GAAS7pD,OAE3B,UAEI,WACA,WACA,KAIJ,UAEI,WACA,WACA,KAIJ,KAEI,SACA,mCACA,SAIJ,KAEI,SACA,2CACA,UAIZ8B,GAAe,MAAOmoD,IAAKjqD,OAEnB,WAEI,UACA,SACA,KAIJ,WAEI,UACA,SACA,KAIJ,KAEI,SACA,qCACA,SAIJ,KAEI,SACA,6CACA,SAIJ,KAEI,SACA,+CACA,UAIZ8B,GAAe,QAASooD,IAAOlqD,OAEvB,WAEI,UACA,SACA,KAIJ,WAEI,UACA,SACA,KAIJ,KAEI,SACA,qCACA,SAIJ,KAEI,SACA,+CACA,YAIZ8B,GAAe,WAAYqoD,IAAUnqD,OAE7B,IACA,WAGA,WAEI,UACA,SACA,KAIJ,WAEI,UACA,SACA,KAIJ,KAEI,SACA,qCACA,SAIJ,KAEI,SACA,6CACA,UAIZ8B,GAAe,SAAU2oD,IAAQzqD,OAEzB,UACA,WAGA,WAEI,KACA,SACA,UAIJ,SAEI,KACA,WAEI,QACA,MAKR,SAEI,KACA,WAEI,QACA,OAKhB8B,GAAe,SAAUiqD,IAAQ/rD,OAEzB,UACA,WAGA,WAEI,KACA,SACA,UAIJ,SAEI,KACA,WAEI,QACA,MAKR,SAEI,KACA,WAEI,QACA,OAKhB8B,GAAe,QAASkqD,IAAOhsD,OAEvB,UACA,WAGA,WAEI,KACA,SACA,UAIJ,SAEI,KACA,SACA,UAIJ,SAEI,KACA,WAEI,QACA,OAKhB8B,GAAe,SAAUoqD,IAAQlsD,OAEzB,UACA,WAGA,WAEI,KACA,SACA,UAIJ,SAEI,KACA,SACA,UAIJ,SAEI,KACA,WAEI,QACA,OAKhB8B,GAAe,KAAM2qD,IAAIzsD,OAEjB,OACA,WAGA,OACA,WAGA,OAEI,KACA,UAEI,OACA,MAKR,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,MAKR,KAEI,SACA,kBAIZ8B,GAAe,KAAMkrD,IAAIhtD,OAEjB,OACA,WAGA,OACA,WAGA,OAEI,KACA,UAEI,OACA,MAKR,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,OAKhB8B,GAAe,MAAOorD,IAAKltD,OAEnB,OACA,WAGA,OACA,WAGA,MACA,WAGA,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,OAKhB8B,GAAe,OAAQqrD,IAAMntD,OAErB,OACA,WAGA,MACA,WAGA,KACA,WAGA,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,OAKhB8B,GAAe,OAAQsrD,IAAMptD,OAErB,OACA,WAGA,OAEI,KACA,UAEI,OACA,MAKR,KACA,WAGA,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,MAKR,SAEI,KACA,YAEI,OACA,QAKR,KAEI,SACA,kBAIZ8B,GAAe,OAAQwrD,IAAMttD,OAErB,OACA,WAGA,MACA,aAGA,OACA,aAGA,KACA,WAGA,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,MAKR,KAEI,SACA,iCAIZ8B,GAAe,OAAQ2rD,IAAMztD,OAErB,OACA,WAGA,MACA,aAGA,OACA,aAGA,KACA,WAGA,MAEI,KACA,UAEI,OACA,MAKR,QAEI,MAEI,SACA,EACA,IAGA,OACA,MAKR,KAEI,SACA,iCAIZ8B,GAAe,WAAY4rD,IAAU1tD,OAE7B,OACA,aAGA,OACA,aAGA,KACA,aAGA,eACA,aAGA,aACA,aAGA,QAEI,MAEI,SACA,EACA,IAGA,OACA,MAKR,KAEI,SACA,+BACA,UAIZ8B,GAAe,UAAWmsD,IAASjuD,OAE3B,OACA,aAGA,OACA,aAGA,KACA,aAGA,eACA,aAGA,aACA,aAGA,QAEI,MAEI,SACA,EACA,IAGA,OACA,MAKR,KAEI,SACA,+BACA,UAIZ8B,GAAe,MAAOqsD,IAAKnuD,OAEnB,OACA,WAGA,UAEI,UACA,YAIJ,KAEI,SACA,qBACA,UAIZ8B,GAAe,MAAOwsD,IAAKtuD,OAEnB,UAEI,UACA,SACA,KAIJ,SAEI,KACA,UAEI,OACA,QAKhB8B,GAAe,SAAU0sD,IAAQxuD,OAEzB,eACA,aAGA,QACA,eAGR8B,GAAe,UAAW6sD,IAAS3uD,OAE3B,cACA,aAGA,QACA,eAGR8B,GAAe,OAAQ+sD,IAAM7uD,OAErB,OACA,WAGA,UAEI,UACA,SACA,KAIJ,SAEI,UACA,OACA,KAIJ,KAEI,SACA,kCACA,UAIZ8B,GAAe,OAAQgtD,IAAM9uD,OAErB,UAEI,UACA,SACA,KAIJ,SAEI,UACA,OACA,KAIJ,SAEI,KACA,UAEI,OACA,OAKR,KAEI,SACA,kCACA,UAIZ8B,GAAe,QAASitD,IAAO/uD,OAEvB,OACA,WAGA,MACA,aAGA,OACA,aAGA,KACA,WAGA,KAEI,SACA,iCAIZ8B,GAAe,KAAMktD,IAAIhvD,OAEjB,OACA,WAGA,UACA,WAGA,OACA,aAGA,SACA,aAGA,SAEI,KACA,UAEI,OACA,QAKhB8B,GAAe,MAAOwtD,IAAKtvD,OAEnB,OACA,WAGA,UACA,WAGA,OACA,aAGA,SACA,aAGA,UAEI,KACA,UAEI,OACA,OAKhB8B,GAAe,MAAO4tD,IAAK1vD,OAEnB,OACA,WAGA,UACA,WAGA,OACA,cAGR8B,GAAe,MAAO6tD,IAAK3vD,OAEnB,OACA,WAGA,UACA,WAGA,OACA,aAGA,MACA,cAGR8B,GAAe,MAAO8tD,IAAK5vD,OAEnB,OACA,YAGA,UACA,YAGA,OACA,aAGA,eACA,YAGA,aACA,YAGA,UAEI,KACA,WAEI,OACA,MAKR,aAEI,KACA,WAEI,QACA,MAKR,KAEI,SACA,+BACA,UAIR4zD,KAEI,aACA,SAGA,WACA,SAGA,aAEI,MACA,WAEI,SACA,EACA,EACA,MAKR,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,0BACA,SAIZ9xD,GAAe,YAAauvD,IAAWrxD,KAAK4zD,IAC5C9xD,GAAe,WAAYyvD,IAAUvxD,KAAK4zD,IAC1C9xD,GAAe,aAAc4vD,IAAY1xD,KAAK4zD,IAC9C9xD,GAAe,UAAW6vD,IAAS3xD,KAAK4zD,IACxC9xD,GAAe,UAAW8vD,IAAS5xD,KAAK4zD,IACxC9xD,GAAe,UAAW+vD,IAAS7xD,KAAK4zD,IACxC9xD,GAAe,WAAYiwD,IAAU/xD,OAE7B,QACA,SAGA,aACA,SAGA,OACA,aAGA,OAEI,MAEI,OACA,KAEJ,cAIJ,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,uBACA,UAIZ8B,GAAe,UAAWqwD,IAASnyD,OAE3B,QACA,SAGA,iBACA,SAGA,aACA,SAGA,OACA,aAGA,OAEI,MAEI,OACA,KAEJ,cAIJ,aAEI,MACA,WAEI,SACA,EACA,EACA,MAKR,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,eAEI,KACA,WAEI,QACA,MAKR,KAEI,SACA,uBACA,UAIZ8B,GAAe,OAAQ6wD,IAAM3yD,OAErB,aACA,SAGA,WACA,SAGA,KACA,aAGA,aACA,aAGA,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,0BACA,UAIZ8B,GAAe,UAAWgxD,IAAS9yD,OAE3B,aACA,SAGA,WACA,SAGA,aACA,aAGA,aACA,aAGA,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,0BACA,UAIZ8B,GAAe,WAAYkxD,IAAUhzD,OAE7B,aACA,SAGA,WACA,SAGA,aACA,aAGA,WACA,aAGA,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,0BACA,UAIZ8B,GAAe,QAASoxD,IAAOlzD,OAEvB,aACA,SAGA,WACA,SAGA,OACA,aAGA,MACA,aAGA,aACA,aAGA,aAEI,MACA,WAEI,SACA,EACA,EACA,MAKR,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,0BACA,UAIZ8B,GAAe,YAAa4xD,IAAW1zD,OAE/B,aACA,SAGA,WACA,SAGA,WACA,aAGA,aACA,aAGA,SAEI,MAEI,OACA,IAGA,MACA,WAEI,SACA,EACA,EACA,EACA,EACA,OAMZ,KAEI,SACA,0BACA,UAIR+jD,GAAS,IAAKC,GAAM,WAAYC,GAAS,MAAOhB,GAAQ3/D,KAAK6I,MAs/BjD,kBAAVj4B,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,6BACH,aACA,oBACA,eACDD,IACL,YACG,SAAUE,GAmCP,QAAS4/F,GAAmB9/F,GACxB,MAAO,UAAU4mB,GAEb,MADAA,GAAE5N,iBACKhZ,EAAE8J,MAAMpJ,KAAMmJ,YAtChC,GAIO/H,GACAi+F,EAYAC,EAYAC,EAYAC,EA+JAC,CAvMAjgG,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACV65F,GACA,aACA,gBACA,0BACA,wBACA,iBACA,aACA,YACA,cACA,eACA,aAEAC,EAA0B9/F,EAAM6Q,YAAY8iE,SAASusB,eACrD/pF,WAAY,cACZF,cAAe,iBACfe,wBAAyB,4BACzBC,sBAAuB,0BACvBf,eAAgB,kBAChBE,WAAY,cACZM,UAAW,aACXH,YAAa,eACbM,aAAc,gBACdb,UAAW,aAEX+pF,EAAwB//F,EAAM6Q,YAAY8iE,SAASwsB,aACnD1rD,MAAO,cACP2rD,YAAa,kBACbx2F,MAAO,QACPy2F,OAAQ,UAQRL,EAAehgG,EAAMqgB,GAAGC,OAAOngB,QAC/BC,KAAM,SAAU2b,EAAS1b,GACrBL,EAAMqgB,GAAGC,OAAO/f,KAAKC,KAAMub,EAAS1b,GACpCG,KAAKub,QAAUA,EACfvb,KAAKmjC,MAAQtjC,EAAQsjC,MACrBnjC,KAAK8/F,eACL9/F,KAAK+/F,gBACL//F,KAAKggG,sBACLhgG,KAAKigG,qBACLjgG,KAAKkgG,YAAYn+E,GAAG,QAASq9E,EAAmBp/F,KAAKmgG,WAAWpuF,KAAK/R,QACrEA,KAAKogG,kBAAkBr+E,GAAG,QAASq9E,EAAmBp/F,KAAK4/F,YAAY7tF,KAAK/R,SAEhFH,SAAWiM,KAAM,gBACjB5L,QAAS,UACT+f,QAAS,WACLzgB,EAAM8gE,OAAOtgE,KAAK44E,OAAOr9D,QAAQ0qB,KAAK,sBACtCjmC,KAAK44E,OAAO34D,UACZjgB,KAAKqgG,aAAapgF,UAClBjgB,KAAKkgG,YAAY50E,IAAI,SACrBtrB,KAAKogG,kBAAkB90E,IAAI,UAE/B5nB,MAAO,SAAUA,GACb,MAAc+J,UAAV/J,EAMO1D,KAAKmjC,OALZnjC,KAAKmjC,MAAQz/B,EACb1D,KAAKogG,kBAAkBn6D,KAAK,WAAWpkB,IAAI,mBAAoB7hB,KAAKmjC,OACpEnjC,KAAKqgG,aAAa38F,MAAM,MACxB1D,KAAKsgG,gBAAgB58F,MAAM1D,KAAKmjC,OAHhCnjC,SAQRugG,QAAS,SAAU78F,GACf1D,KAAKmjC,MAAQz/B,EACb1D,KAAKU,QAAQ,UAAYgD,MAAOA,KAEpCq8F,cAAe,WAAA,GACPxkF,GAAUna,EAAE,WAAao/F,QAAS,gCAClCH,EAAergG,KAAKqgG,aAAej/F,EAAE,WAAWq/F,mBAChDC,SACI,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJh9F,MAAO1D,KAAKmjC,MACZtd,OAAQ,SAAUK,GACdlmB,KAAKogG,kBAAkBn6D,KAAK,WAAWpkB,IAAI,mBAAoB,eAC/D7hB,KAAKsgG,gBAAgB58F,MAAM,MAC3B1D,KAAKugG,QAAQr6E,EAAExiB,QACjBqO,KAAK/R,QACRsK,KAAK,oBACRiR,GAAQ6xD,OAAOizB,EAAazgF,SAASvQ,SAASrP,KAAKub,UAEvDykF,oBAAqB,WAAA,GAoBbM,GACAK,EApBAplF,EAAUna,EAAE,WACZo/F,QAAS,uBACTvxF,KAAQ,wGAA0HswF,EAAsBn2F,MAAQ,8DAAyEm2F,EAAsBM,OAAS,oBAExQjnB,EAAS54E,KAAK44E,OAASr9D,EAAQlM,SAASlL,SAASc,MAAM27F,aACvDh5C,WAAW,EACXnD,YAAY,EACZo8C,WAAW,EACXC,aAAa,EACbC,OAAO,EACPt5E,SAAS,EACTllB,MAAO,IACP+d,KAAM,WACFtgB,KAAKghG,YAEV12F,KAAK,cACRsuE,GAAOqoB,IAAI,WAAY,WACnBjhG,KAAKub,QAAQ0qB,KAAK,+BAA+B37B,KAAK,wBAAwB42F,WAAWvkF,WAEzF2jF,EAAkBtgG,KAAKsgG,gBAAkB1nB,EAAOr9D,QAAQ8qC,WAAW91B,QAAQ4wE,uBAAuB72F,KAAK,wBACvGq2F,EAAYnhG,EAAM4hG,YAClBh4F,MAAO,WACHpJ,KAAKogG,kBAAkBn6D,KAAK,WAAWpkB,IAAI,mBAAoBy+E,EAAgB58F,SAC/E1D,KAAKqgG,aAAa38F,MAAM,MACxB1D,KAAKugG,QAAQD,EAAgB58F,SAC7Bk1E,EAAOv4D,SACTtO,KAAK/R,MACPqgB,MAAO,WACHigF,EAAgB58F,MAAM,MACtBk1E,EAAOv4D,WAGf7gB,EAAMuS,KAAK6mE,EAAOr9D,QAAQ0qB,KAAK,qBAAsB06D,IAEzDb,aAAc,WACV9/F,KAAKkgG,YAAc9+F,EAAE,0FAAuGm+F,EAAsBtrD,MAAQ,QAAQ5kC,SAASrP,KAAKub,UAEpL0kF,mBAAoB,WAChBjgG,KAAKogG,kBAAoBh/F,EAAE,2EAAwFm+F,EAAsBK,YAAc,QAAQvwF,SAASrP,KAAKub,UAEjL4kF,WAAY,WACRngG,KAAKqgG,aAAa38F,MAAM,MACxB1D,KAAKsgG,gBAAgB58F,MAAM,MAC3B1D,KAAKugG,QAAQ,OAEjBX,YAAa,WACT5/F,KAAK44E,OAAOt4D,UAGhBm/E,EAAgBjgG,EAAMqgB,GAAGC,OAAOngB,QAChCC,KAAM,SAAU2b,EAAS1b,GACrBL,EAAMqgB,GAAGC,OAAO/f,KAAKC,KAAMub,EAAS1b,GACpCG,KAAKub,QAAUA,EACfvb,KAAKmjC,MAAQ,OACbnjC,KAAKub,QAAQpM,SAAS,gCACtBnP,KAAKqhG,qBACLrhG,KAAKshG,sBACLthG,KAAKub,QAAQwG,GAAG,QAAS,+CAAgDq9E,EAAmBp/F,KAAKuhG,OAAOxvF,KAAK/R,SAEjHH,SAAWiM,KAAM,iBACjB5L,QAAS,UACT+f,QAAS,WACLjgB,KAAKwhG,aAAavhF,UAClBjgB,KAAKub,QAAQ+P,IAAI,UAErB+1E,mBAAoB,WAAA,GACZluB,GAAWmsB,EACXmC,EAAUpC,EAAa17F,IAAI,SAAU4N,GACrC,MAAO,aAAe4hE,EAAS5hE,GAAQ,iBAAmB4hE,EAAS5hE,GAAQ,gCAAkCA,EAAO,4DAAmE/R,EAAMsG,UAAUyL,GAAQ,kBAChNvP,KAAK,IACJuZ,EAAUna,EAAE,WACZo/F,QAAS,oCACTvxF,KAAQwyF,GAEZlmF,GAAQlM,SAASrP,KAAKub,UAE1B+lF,oBAAqB,WACjB,GAAI/lF,GAAUna,EAAE,WAAao/F,QAAS,sCACtCjlF,GAAQlM,SAASrP,KAAKub,SACtBvb,KAAKwhG,aAAe,GAAIhC,GAAajkF,GACjC4nB,MAAOnjC,KAAKmjC,MACZtd,OAAQ7lB,KAAK0hG,aAAa3vF,KAAK/R,SAGvCuhG,OAAQ,SAAUr7E,GACdlmB,KAAKuR,KAAOnQ,EAAE8kB,EAAEy7E,eAAer3F,KAAK,cACpCtK,KAAKU,QAAQ,UACT6Q,KAAMvR,KAAKuR,KACX4xB,MAAOnjC,KAAKmjC,SAGpBu+D,aAAc,SAAUx7E,GACpBlmB,KAAKmjC,MAAQjd,EAAExiB,MACX1D,KAAKuR,MACLvR,KAAKU,QAAQ,UACT6Q,KAAMvR,KAAKuR,KACX4xB,MAAOnjC,KAAKmjC,WAK5B3jC,EAAM6Q,YAAYmvF,aAAeA,EACjChgG,EAAM6Q,YAAYovF,cAAgBA,IACpCt8F,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,uBACH,gBACA,oBACA,iBACA,qBACA,cACA,6BACDD,IACL,YACG,SAAUE,GAAV,GAIO4B,GACAwgG,EACAC,EA2EAC,EAkDAC,EAwLAC,EAuMAC,EA8DAC,EA6CAC,EAUAC,EAiCAC,EAgBAC,EAmBAC,EACAC,EA4CAC,EAgBAC,EAQAC,EACAC,EAeAC,EAgBAC,EAYAC,EA+EAC,EAMAC,EA8BAC,EAMAC,EAoGAC,EAMAC,EAyDAC,EAMAC,EAyDAC,EAMAC,EAmDAC,EAMAtjD,EAiBAujD,EAgBAC,CAtuCApkG,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVo8F,EAAUpiG,EAAMqgB,GAAG+hF,QACnBC,EAAWriG,EAAM6Q,YAAY8iE,SAAS4C,SACtCp4D,cAAe,kBACfC,eAAgB,mBAChBI,YAAa,gBACbC,YAAa,gBACb4lF,UAAW,YACXC,kBACIC,aAAc,aACdC,cAAe,SACfC,aAAc,cACdC,YAAa,UACbC,SAAU,YACVC,YAAa,eACbC,YAAa,gBAEjBxzB,gBAAiB,aACjBltC,KAAM,OACNJ,QAAS,UACT9pB,KAAM,OACND,IAAK,MACLqE,aAAc,gBACdK,UAAW,aACX3D,OAAQ,SACR+rB,WAAY,OACZ9C,SAAU,YACVxuB,OAAQ,mBACRsvF,aACIC,UAAW,YACXjjG,KAAM,OACNmuD,OAAQ,SACRwH,QAAS,UACTutC,UAAW,YACX/8D,SAAU,WACVqG,KAAM,OACNiC,KAAM,OACN00D,SAAU,YACVC,SAAU,WACVC,YAAa,mBAEjBC,sBAAuB,mBACvBC,sBAAuB,mBACvBC,OAAQ,eACRC,eACIC,YAAa,eACbC,WAAY,cACZC,cAAe,iBACfxtF,SAAU,kBAEdgsB,OAAQ,SACR3sB,MAAO,cACPouF,cACIC,WAAY,YACZC,kBAAmB,qBACnBC,gBAAiB,mBACjBzuF,QAAS,WAEbyJ,KAAM,UACNnH,MAAO,QACPosF,aACI5kG,KAAM,OACNH,KAAM,QAEVglG,SAAU,YACVC,gBAAiB,mBACjB1jG,KAAM,OACN2jG,aACIC,aAAc,oBACdC,cAAe,qBAEnBC,UAAW,aACXC,SAAU,YACVlzF,UAAW,YACXwL,WAAY,qBACZ2nF,UAAW,QAEXjE,GACA18E,MACI,OACA,YAEI,MACA,OACA,UAGA,OACA,SACA,aAEJ,YACA,kBACA,YACA,UACA,WACA,aACA,YACA,YAEI,wBACA,yBAEJ,SACA,QACA,SACA,SACA,mBAEJmK,SAEQ,gBACA,iBACA,cACA,gBAGA,eACA,cAGRjlB,MACI,OACA,SACA,eAGJy3F,GACAzhF,MACI/O,KAAM,OACNuH,SAAU,QACVktF,UAAW,cAEfR,UACIj0F,KAAM,iBACN00F,WAAY,WACZntF,SAAU,QACVxX,KAAM,GACN0kG,UAAW,cAEfriE,MACIpyB,KAAM,SACNnR,QAAS,wBACTqQ,SAAU,OACV/M,OAAO,EACPsiG,UAAW,OACXE,WAAW,GAEfxiE,QACInyB,KAAM,SACNnR,QAAS,wBACTqQ,SAAU,SACV/M,OAAO,EACPsiG,UAAW;AACXE,WAAW,GAEftzF,WACIrB,KAAM,SACNnR,QAAS,wBACTqQ,SAAU,YACV/M,OAAO,EACPsiG,UAAW,YACXE,WAAW,GAEftB,uBACIrzF,KAAM,SACNnR,QAAS,wBACTsD,SACAsiG,UAAW,oBAEfnB,uBACItzF,KAAM,SACNnR,QAAS,wBACTsD,MAAO,EACPsiG,UAAW,oBAEfF,UACIv0F,KAAM,SACNnR,QAAS,kBACTqQ,SAAU,OACV/M,OAAO,EACPsiG,UAAW,YACXE,WAAW,GAEf1sF,KACIjI,KAAM,SACNnR,QAAS,oBACT4lG,UAAW,OAEfvsF,MACIlI,KAAM,SACNnR,QAAS,qBACT4lG,UAAW,QAEf7sF,OACI5H,KAAM,SACNnR,QAAS,sBACT4lG,UAAW,SAEfG,WAAa50F,KAAM,aACnBsyF,WACItyF,KAAM,YACNy0F,UAAW,cAEfn1B,iBACIt/D,KAAM,cACNd,SAAU,aACVu1F,UAAW,SAEfH,WACIt0F,KAAM,cACNd,SAAU,QACVu1F,UAAW,oBAEf1/D,YACI/0B,KAAM,aACNd,SAAU,aACVu1F,UAAW,eAEfxiE,UACIjyB,KAAM,WACNd,SAAU,WACVu1F,UAAW,aAEfhxF,QACIzD,KAAM,SACNd,SAAU,SACVu1F,UAAW,iBAEfzrF,QACIhJ,KAAM,SACNd,SAAU,YACVu1F,UAAW,UAEfjvF,OACIxF,KAAM,QACNy0F,UAAW,eAEflB,QACIvzF,KAAM,SACNy0F,UAAW,eAEfziE,SACIhyB,KAAM,UACNy0F,UAAW,eAEfI,aACI70F,KAAM,SACN00F,WAAY,cACZntF,SAAU,SAEditF,WACIx0F,KAAM,SACN00F,WAAY,YACZD,UAAW,kBACXltF,SAAU,QACVxX,KAAM,IAEVmkG,iBACIl0F,KAAM,SACNnR,QAAS,yBACTqQ,SAAU,YACV/M,OAAO,EACPsiG,UAAW,YACXE,WAAW,GAEfvoF,eACIpM,KAAM,SACNnR,QAAS,mBACTsD,MAAO,OACPsiG,UAAW,4BAEfpoF,gBACIrM,KAAM,SACNnR,QAAS,mBACTsD,MAAO,QACPsiG,UAAW,6BAEf/nF,aACI1M,KAAM,SACNnR,QAAS,gBACTsD,MAAO,QACPsiG,UAAW,0BAEfhoF,aACIzM,KAAM,SACNnR,QAAS,gBACTsD,MAAO,QACPsiG,UAAW,0BAEfnoF,cACItM,KAAM,SACNnR,QAAS,sBACT4lG,UAAW,uBAEf9nF,WACI3M,KAAM,SACNnR,QAAS,mBACT4lG,UAAW,oBAEfjkG,MACIwP,KAAM,OACNy0F,UAAW,aAEf5nF,YACI7M,KAAM,SACN00F,WAAY,aACZD,UAAW,YACXltF,SAAU,UAGdkpF,EAAqBJ,EAAQjiG,QAC7BC,KAAM,SAAU2b,EAAS1b,GAAnB,GAGEwmG,GAGAjuE,CALJv4B,GAAQwyD,MAAQryD,KAAKsmG,aAAazmG,EAAQ0mG,OAASvE,EAAmBhvF,UAAUnT,QAAQ0mG,MAAM1mG,EAAQ2mG,cACtG5E,EAAQ9hG,GAAGF,KAAKG,KAAKC,KAAMub,EAAS1b,GAChCwmG,EAAcrmG,KAAKuhG,OAAOxvF,KAAK/R,MACnCA,KAAKub,QAAQpM,SAAS,yBACtBnP,KAAKymG,eAAezmG,KAAKub,SACrB6c,EAAOp4B,KACXA,KAAKub,QAAQwG,GAAG,UAAW,SAAUmE,GACjC,GAAIwgF,EACc,KAAdxgF,EAAEgB,UACFw/E,EAAOtuE,EAAKuuE,UAAUzgF,EAAEiJ,YAAgB,GACpCu3E,IACAviG,SAASyiG,cAAcC,OACnBzlG,EAAEslG,GAAMx4F,GAAG,qBACX9M,EAAEslG,GAAMv3F,SAAS,mBAEjB/N,EAAEslG,GAAMzgE,KAAK,SAASplC,OACtBO,EAAEslG,GAAMzgE,KAAK,SAAS32B,QAEtBo3F,EAAKp3F,QAET4W,EAAE5N,qBAIdtY,KAAKub,QAAQwG,GAAG,WAAY,WACxB3gB,EAAEpB,MAAMimC,KAAK,4BAA4B6gE,YAAY,qBAEzD9mG,KAAK+R,MACDg1F,MAAOV,EACPz8E,OAAQy8E,KAGhBM,UAAW,SAAUjoE,GAAV,GACHtG,GAAOp4B,KACPumG,EAAQnuE,EAAK7c,QAAQ0qB,KAAK,6CAC1B+gE,EAAcT,EAAM97F,MAAMrJ,EAAE+C,SAASyiG,eAAe7+C,QAAQ,6CAChE,IAAIi/C,EAAc,EACd,MAAOT,GAAMS,EAActoE,IAGnC+nE,eAAgB,SAAUlrF,GACtB,GAAI0rF,GAAS1rF,EAAQ8qC,SAAS,yCAC9B4gD,GAAOC,OAAO,iCAElBZ,aAAc,SAAUC,GACpB,QAASY,GAAWC,GAApB,GACQvnG,GAAUuB,EAAEimG,cAAcD,GAAYA,EAAWrF,EAAaqF,OAC9DE,EAAiB,cAAgBznG,EAAQmmG,UACzCz0F,EAAO1R,EAAQ0R,KACfg2F,GACAh5E,QAAUi5E,SAAU,YACpB7H,aACI8H,SAAUH,EACVA,eAAgBA,GAEpB/jE,SAAW+jE,eAAgBA,GAC3BzD,WAAayD,eAAgBA,GAC7BvwF,OAASuwF,eAAgBA,GACzBxC,QAAUwC,eAAgBA,IAE1BZ,EAAOtlG,EAAEzB,QACTmM,KAAMjM,EAAQiM,MAAQs7F,EACtB9lG,KAAMugG,EAAShiG,EAAQiM,MAAQs7F,GAC/Bp0B,KAAMnzE,EAAQmmG,UACd0B,YACIt2F,MAAOywF,EAAShiG,EAAQiM,MAAQs7F,GAChCO,aAAc9F,EAAShiG,EAAQiM,MAAQs7F,KAE5CG,EAAah2F,GAAO1R,EAQvB,OAPY,eAAR0R,IACAm1F,EAAKkB,YAAclB,EAAKkB,YAAYjkG,IAAIwjG,IAE5CT,EAAKgB,WAAW,aAAeN,EAC3BvnG,EAAQ4Q,WACRi2F,EAAKgB,WAAW,iBAAmB7nG,EAAQ4Q,UAExCi2F,EAEX,MAAOH,GAAMxyE,OAAO,SAAUwyE,EAAOG,GASjC,MAPIH,GAAMpmG,KADNiB,EAAEqqC,QAAQi7D,IAENn1F,KAAM,cACNkwF,QAASiF,EAAK/iG,IAAIwjG,IAGXA,EAAWpnG,KAAKC,KAAM0mG,IAE9BH,QAGfhF,OAAQ,SAAUr7E,GAAV,GAOAmlB,GANA+7D,EAAWlhF,EAAEjU,OAAO2P,KAAK,aACzB8kF,EAAO3E,EAAaqF,OACpBS,EAAcnB,EAAKtmG,OAClBynG,KAGDx8D,GACAjrC,QAASynG,EACThoG,SACI4Q,SAAUi2F,EAAKj2F,UAAY,KAC3B/M,MAAOgjG,EAAKhjG,OAAS,OAGK,iBAAvB2nC,GAAKxrC,QAAQ6D,QACpB2nC,EAAKxrC,QAAQ6D,QAAQwiB,EAAE4hF,SAAiB,MAE5C9nG,KAAKu+B,OAAO8M,KAEhBnrC,QACI,QACA,SACA,OACA,QACA,eACA,gBACA,SACA,UAEJL,SACIiM,KAAM,qBACN+0F,WAAW,EACX0F,MAAOzE,GAEXvjE,OAAQ,SAAU8M,GACdrrC,KAAKU,QAAQ,SAAU2qC,IAE3ButC,OAAQ,SAAUvtC,GACdrrC,KAAKU,QAAQ,SAAU2qC,IAE3Bg2B,QAAS,SAAUzqD,GAGf,QAASmxF,GAAUrB,EAAMhjG,GAAzB,GAOQkmB,GANAmsD,EAAU2wB,EAAK3wB,QACfj9D,EAAW4tF,EAAK5tF,SAChBotF,EAAYnwB,GAAWA,EAAQl2E,QAAQqmG,WAAaptF,GAAYA,EAASjZ,QAAQqmG,SAChFA,KAGDt8E,GAAS,EACQ,iBAAVlmB,GACPkmB,EAASlmB,EACe,gBAAVA,KACdkmB,EAASmsD,EAAQl2E,QAAQ6D,QAAUA,GAEvCqyE,EAAQnsD,OAAOA,GACX9Q,GACAA,EAAS8Q,OAAOA,IAGxB,QAASo+E,GAAOtB,EAAMhjG,GAAtB,GACQqyE,GAAU2wB,EAAK3wB,QACfj9D,EAAW4tF,EAAK5tF,QAChBi9D,IAAWA,EAAQiyB,QACnBjyB,EAAQiyB,OAAOtkG,GAEfoV,GAAYA,EAASkvF,QACrBlvF,EAASkvF,OAAOtkG,GA5BnB,GA+BIvB,GACDsO,EACAi2F,EACAhjG,EAjCJiN,EAAQiG,EACR2vF,EAAQvmG,KAAKioG,QA6BjB,KAAS9lG,EAAI,EAAGA,EAAIokG,EAAM1lG,OAAQsB,IAC1BsO,EAAW81F,EAAMpkG,GAAGsO,SACpBi2F,EAAOH,EAAMpkG,GAAGukG,KAChBhjG,EAAQlE,EAAM0oG,WAAWv3F,EAAMF,IAAaE,EAAMF,KAAcE,EACpD,aAAZF,IACA/M,EAAQiN,EAAMkB,QAAQkB,iBAER,WAAd2zF,EAAKn1F,KACLw2F,EAAUrB,EAAMhjG,GAEhBskG,EAAOtB,EAAMhjG,EAGrB1D,MAAK2c,UAETsrF,OAAQ,WACJ,MAAOjoG,MAAKub,QAAQ0qB,KAAK,mBAAmBkiE,UAAUxkG,IAAI,SAAU4X,GAEhE,MADAA,GAAUna,EAAEma,IAER9K,SAAU8K,EAAQqG,KAAK,iBACvB8kF,KAAM1mG,KAAKooG,SAAS7sF,KAE1BxJ,KAAK/R,QAEXigB,QAAS,WACLjgB,KAAKub,QAAQ0qB,KAAK,4BAA4B6E,KAAK,WAAA,GAC3CvvB,GAAUna,EAAEpB,MACZqoG,EAAW9sF,EAAQjR,KAAK,WACxB+9F,IAAYA,EAASpoF,SACrBooF,EAASpoF,YAGjB2hF,EAAQ9hG,GAAGmgB,QAAQlgB,KAAKC,SAGhCR,EAAM6Q,YAAYuxF,QAAUI,EACxBC,EAAeziG,EAAMu2E,QAAQuyB,KAAK3oG,QAClCC,KAAM,SAAUC,EAASk2E,GACrB,GAAIwyB,GAAennG,EAAE,cAAcwgB,KAAK,QAAS/hB,EAAQ6nG,WAAWt2F,OAAOwQ,KAAK,aAAc/hB,EAAQ6nG,WAAWt2F,OAAOo3F,mBAAoBhmG,OAAQ,SAAU8H,KAAK,oBACnKtK,MAAKuoG,aAAeA,EACpBvoG,KAAKub,QAAUgtF,EAAa3oF,QAC5B5f,KAAKH,QAAUA,EACfG,KAAK+1E,QAAUA,EACf/1E,KAAK0nG,aACL1nG,KAAKyoG,aACLzoG,KAAK0oG,kBACLH,EAAax2F,KAAK,OAAQ/R,KAAK2oG,MAAM52F,KAAK/R,OAC1CuoG,EAAax2F,KAAK,SAAU/R,KAAKugG,QAAQxuF,KAAK/R,OAC9CA,KAAKub,QAAQhZ,MAAM1C,EAAQ0C,OAAOqf,MAC9BgnF,eAAgB,wBAChBC,gBAAiBhpG,EAAQ4Q,YAGjCk4F,MAAO,WAAA,GAGCG,GAFAC,EAAM/oG,KAAKuoG,aACX/iF,EAAOujF,EAAIvjF,IAEfA,GAAK3D,KACDyH,WAAY,SACZ/mB,MAAO,SAEXumG,EAAYtjF,EAAKjjB,QACbumG,EAAY,EACZA,GAAa,GAEbA,EAAYC,EAAIC,WAEpBxjF,EAAK3D,IAAI,QAASinF,EAAYtpG,EAAMyQ,QAAQupE,aAC5CuvB,EAAIC,WAAaF,GAErBvI,QAAS,SAAUr6E,GAAV,GACDkS,GAAOp4B,KACPqoG,EAAWniF,EAAEmiC,OACb3kD,EAAQ2kG,EAAS3kG,QACjBulG,EAAWZ,EAASY,WACpBC,EAAYD,EAAWA,EAASriF,MAAQnZ,MACxCy7F,GACA5hF,WAAW,WACP8Q,EAAK29C,QAAQ6C,QAAS9sE,KAAMo9F,MAGhC9wE,EAAK29C,QAAQx3C,QACTn+B,QAAS,wBACTP,SACI4Q,SAAUzQ,KAAKH,QAAQ4Q,SACvB/M,MAAgB,QAATA,EAAkB,KAAOA,MAKhDA,MAAO,SAAUA,GACb,MAAc+J,UAAV/J,EAGO1D,KAAKuoG,aAAa7kG,YAFzB1D,MAAKuoG,aAAa7kG,MAAMA,MAMhCw+F,EAAY1iG,EAAMu2E,QAAQuyB,KAAK3oG,QAC/BC,KAAM,SAAUC,EAASk2E,GACrB/1E,KAAKub,QAAUna,EAAE,2DAAuEvB,EAAQynG,eAAiB,+DACjHtnG,KAAKub,QAAQwG,GAAG,iBAAkB/hB,KAAKsgB,KAAKvO,KAAK/R,OAAO4hB,KAAK,eAAgB/hB,EAAQO,SACrFJ,KAAKH,QAAUA,EACfG,KAAK+1E,QAAUA,EACf/1E,KAAK0nG,aACL1nG,KAAKyoG,aACLzoG,KAAK0oG,kBACL1oG,KAAKqiB,UAETpC,QAAS,WACLjgB,KAAK4mB,MAAM3G,WAEfK,KAAM,SAAUuH,GACZA,EAAGvP,iBACHtY,KAAK4mB,MAAMgD,UAEfvH,OAAQ,WACJ,GAAI9G,GAAUvb,KAAKub,OACnBvb,MAAK4mB,MAAQxlB,EAAE,uCAAyCiO,SAASkM,GAASojE,YAAa73D,OAAQvL,IAAWjR,KAAK,iBAGvH9K,EAAMu2E,QAAQozB,kBAAkB,SAAU3pG,EAAMu2E,QAAQqzB,cAAczpG,QAClEC,KAAM,SAAUC,EAASk2E,GACrBv2E,EAAMu2E,QAAQqzB,cAActpG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACxD/1E,KAAKqpG,YAAcxpG,EAAQomG,WAC3BjmG,KAAKub,QAAQxJ,KAAK,iBAAkB/R,KAAKsgB,KAAKvO,KAAK/R,OAAOsK,KAAK,WAAYtK,OAE/EsgB,KAAM,WACFtgB,KAAK+1E,QAAQ6C,QAAS9sE,KAAM9L,KAAKqpG,kBAGzC7pG,EAAMu2E,QAAQozB,kBAAkB,iBAAkB3pG,EAAMu2E,QAAQuyB,KAAK3oG,QACjEC,KAAM,SAAUC,EAASk2E,GACrB/1E,KAAKqpG,YAAcxpG,EAAQomG,WAC3BjmG,KAAK+1E,QAAUA,EACf/1E,KAAKspG,OAASzpG,EAAQ6nG,WAAWt2F,MACjCpR,KAAKub,QAAUna,EAAE,sGAAsHwgB,KAAK,QAAS5hB,KAAKspG,QAAQ1nF,KAAK,aAAc5hB,KAAKspG,QAAQh/F,KAAK,WAAYtK,MACnNA,KAAKub,QAAQxJ,KAAK,QAAS/R,KAAKsgB,KAAKvO,KAAK/R,OAAOsK,KAAK,WAAYtK,OAEtEsgB,KAAM,WACFtgB,KAAK+1E,QAAQ6C,QAAS9sE,KAAM9L,KAAKqpG,kBAGrClH,EAAuB3iG,EAAMu2E,QAAQwzB,eAAe5pG,QACpDC,KAAM,SAAUC,EAASk2E,GACrBv2E,EAAMu2E,QAAQwzB,eAAezpG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACzD/1E,KAAKub,QAAQwG,GAAG,iBAAkB/hB,KAAKuhG,OAAOxvF,KAAK/R,OACnDA,KAAKqR,QAAUrR,KAAKH,QAAQyB,IAC5B,IAAI+mG,GAAWroG,KAAKub,QAAQjR,KAAK,SACjCtK,MAAKub,QAAQjR,KAAKtK,KAAKH,QAAQ0R,KAAM82F,IAEzC9G,OAAQngG,EAAEwY,OAEVwoF,EAAcF,EAAUviG,QACxBC,KAAM,SAAUC,EAASk2E,GACrBmsB,EAAUpiG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACtC/1E,KAAK4mB,MAAMrL,QAAQpM,SAAS,6BAC5BnP,KAAKwhG,aAAe,GAAIhiG,GAAM6Q,YAAYmvF,aAAax/F,KAAK4mB,MAAMrL,SAAWsK,OAAQ7lB,KAAK0hG,aAAa3vF,KAAK/R,QAC5GA,KAAKub,QAAQqG,MAAOinF,gBAAiBhpG,EAAQ4Q,WAC7CzQ,KAAKub,QAAQjR,MACTiH,KAAM,cACNouF,YAAa3/F,KACbqoG,SAAUroG,QAGlBigB,QAAS,WACLjgB,KAAKwhG,aAAavhF,UAClBiiF,EAAUpiG,GAAGmgB,QAAQlgB,KAAKC,OAE9BgoG,OAAQ,SAAUtkG,GACd1D,KAAK0D,MAAMA,IAEfA,MAAO,SAAUA,GACb1D,KAAKwhG,aAAa99F,MAAMA,IAE5Bg+F,aAAc,SAAUx7E,GACpBlmB,KAAK+1E,QAAQx3C,QACTn+B,QAAS,wBACTP,SACI4Q,SAAUzQ,KAAKH,QAAQ4Q,SACvB/M,MAAOwiB,EAAEmiC,OAAO3kD,WAGxB1D,KAAK4mB,MAAMvG,WAGfgiF,EAAoBF,EAAqBxiG,QACzCC,KAAM,SAAUC,EAASk2E,GACrBl2E,EAAQ2pG,SAAW,OACnBrH,EAAqBriG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,IAErDwrB,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QACT9sE,KAAM,cACNjM,SACIuR,MAAOpR,KAAKH,QAAQ4Q,SACpBA,SAAUzQ,KAAKH,QAAQ4Q,eAKvCjR,EAAMu2E,QAAQozB,kBAAkB,cAAe/G,EAAaC,GACxDC,GACA,EACA,EACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,IAEAC,EAAoB,GACpBC,EAAWhjG,EAAMu2E,QAAQuyB,KAAK3oG,QAC9BC,KAAM,SAAUC,EAASk2E,GACrB,GAAI0zB,GAAWroG,EAAE,aAAawgB,KAAK,aAAc/hB,EAAQ6nG,WAAWt2F,OAAOs4F,eACvE7jF,OAAQ7lB,KAAK2pG,aAAa53F,KAAK/R,MAC/B4pG,aAAa,EACb7jF,WAAYlmB,EAAQgqG,WAAavH,EACjC5+F,MAAO6+F,IACRj4F,KAAK,gBACRtK,MAAKypG,SAAWA,EAChBzpG,KAAKub,QAAUkuF,EAAS7pF,QACxB5f,KAAKH,QAAUA,EACfG,KAAK+1E,QAAUA,EACf/1E,KAAK0nG,aACL1nG,KAAKyoG,aACLzoG,KAAK0oG,kBACL1oG,KAAKub,QAAQhZ,MAAM1C,EAAQ0C,OAAOqf,MAC9BgnF,eAAgB,wBAChBC,gBAAiBhpG,EAAQ4Q,WAE7BzQ,KAAKub,QAAQjR,MACTiH,KAAM,WACNiyB,SAAUxjC,QAGlB2pG,aAAc,SAAUzjF,GACpBlmB,KAAK+1E,QAAQx3C,QACTn+B,QAAS,wBACTP,SACI4Q,SAAUzQ,KAAKH,QAAQ4Q,SACvB/M,MAAOlE,EAAM8N,SAAS4Y,EAAEmiC,OAAO3kD,aAI3CskG,OAAQ,SAAUtkG,GACd1D,KAAK0D,MAAMlE,EAAM8N,SAAS5J,IAAU6+F,IAExC7+F,MAAO,SAAUA,GACb,MAAc+J,UAAV/J,EAGO1D,KAAKypG,SAAS/lG,YAFrB1D,MAAKypG,SAAS/lG,MAAMA,MAM5B++F,EAAiBN,EAAqBxiG,QACtC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QACT9sE,KAAM,WACNjM,SACIiqG,MAAOxH,EACPyH,YAAaxH,MAIzByF,OAAQ,SAAUtkG,GACd1D,KAAKkS,OAASxO,GAAS6+F,EACvBviG,KAAKub,QAAQ0qB,KAAK,WAAW3kC,KAAKtB,KAAKqR,QAAU,KAAOrR,KAAKkS,OAAS,YAG9E1S,EAAMu2E,QAAQozB,kBAAkB,WAAY3G,EAAUC,GAClDC,GACA,QACA,cACA,UACA,kBACA,eACA,WAEAC,EAAsB,QACtBC,EAAaX,EAAatiG,QAC1BC,KAAM,SAAUC,EAASk2E,GACrBksB,EAAaniG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,EACzC,IAAIgzB,GAAM/oG,KAAKuoG,YACfQ,GAAItuD,cAAc56C,EAAQmqG,cAAgBtH,GAC1CqG,EAAIrlG,MAAMi/F,GACV3iG,KAAKub,QAAQjR,MACTiH,KAAM,aACN+0B,WAAYtmC,QAGpBgoG,OAAQ,SAAUtkG,GACd1D,KAAK0D,MAAMA,GAASi/F,MAGxBE,EAAmBV,EAAqBxiG,QACxC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QACT9sE,KAAM,aACNjM,SACI46D,MAAOioC,EACPuH,YAAatH,MAIzBqF,OAAQ,SAAUtkG,GACd1D,KAAKkS,OAASxO,GAASi/F,EACvB3iG,KAAKub,QAAQ0qB,KAAK,WAAW3kC,KAAKtB,KAAKqR,QAAU,KAAOrR,KAAKkS,OAAS,YAG9E1S,EAAMu2E,QAAQozB,kBAAkB,aAAcvG,EAAYC,GACtDC,EAAiBtjG,EAAM6Q,YAAYkiB,SACnCgyE,UAAW,KACXjjG,KAAM,IACNmuD,OAAQ,SACRwH,QAAS,QACTutC,UAAW,2DACX/8D,SAAU,2BACVqG,KAAM,WACNiC,KAAM,gBACN00D,SAAU,gBACVC,SAAU,aAEV3B,EAASd,EAAatiG,QACtBuqG,aAAc,SAAUhkF,GACpBA,EAAEmiC,OAAO3kD,MAAM,IACfwiB,EAAEmiC,OAAOzoC,QAAQrd,MAAM,SAE3B3C,KAAM,SAAUC,EAASk2E,GAAnB,GAEEgzB,GACA/1B,CAFJivB,GAAaniG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACrCgzB,EAAM/oG,KAAKuoG,aACXv1B,EAAO,2BAA8BnzE,EAAQmmG,UAAY,qDAC7D+C,EAAIh3F,KAAK,SAAU/R,KAAKkqG,aAAan4F,KAAK/R,OAC1C+oG,EAAIh3F,KAAK,YAAa/R,KAAKkqG,aAAan4F,KAAK/R,OAC7C+oG,EAAIjqB,YACA94D,eAAgB,SAChBmwD,cAAe,OACfg0B,oBAAoB,EACpBC,cAAep3B,EACf/sD,SAAU,wGAEd8iF,EAAIznG,KAAK0xE,GACT+1B,EAAItuD,gBAEIzlC,OAAQ8tF,EAAeyB,UACvBz4F,KAAM+1F,EAASyC,YAAYC,YAG3BvvF,OAAQ8tF,EAAexhG,KACvBwK,KAAM+1F,EAASyC,YAAYhjG,OAG3B0T,OAAQ8tF,EAAerzC,OACvB3jD,KAAM+1F,EAASyC,YAAY70C,OAC3B46C,OAAQ,aAGRr1F,OAAQ8tF,EAAe7rC,QACvBnrD,KAAM+1F,EAASyC,YAAYrtC,QAC3BozC,OAAQ,WAGRr1F,OAAQ8tF,EAAe0B,UACvB14F,KAAM+1F,EAASyC,YAAYE,UAC3B6F,OAAQ,eAGRr1F,OAAQ8tF,EAAer7D,SACvB37B,KAAM+1F,EAASyC,YAAY78D,SAC3B4iE,OAAQ,cAGRr1F,OAAQ8tF,EAAeh1D,KACvBhiC,KAAM+1F,EAASyC,YAAYx2D,KAC3Bu8D,OAAQ,cAGRr1F,OAAQ8tF,EAAe/yD,KACvBjkC,KAAM+1F,EAASyC,YAAYv0D,KAC3Bs6D,OAAQ,eAGRr1F,OAAQ8tF,EAAe2B,SACvB34F,KAAM+1F,EAASyC,YAAYG,SAC3B4F,OAAQ,sBAGRr1F,OAAQ8tF,EAAe4B,SACvB54F,KAAM+1F,EAASyC,YAAYI,SAC3B2F,OAAQ,cAGRzjF,MAAO,cACP9a,KAAM+1F,EAASyC,YAAYK,eAGnC3kG,KAAKub,QAAQjR,MACTiH,KAAM,SACNyD,OAAQhV,UAIhBgjG,EAAeb,EAAqBxiG,QACpC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QAAS9sE,KAAM,mBAGpCtM,EAAMu2E,QAAQozB,kBAAkB,SAAUpG,EAAQC,GAC9CC,EAAmBf,EAAUviG,QAC7BC,KAAM,SAAUC,EAASk2E,GACrBmsB,EAAUpiG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACtC/1E,KAAKsqG,iBACLtqG,KAAKub,QAAQjR,MACTiH,KAAM,UACN82F,SAAUroG,QAGlBigB,QAAS,WACLjgB,KAAK0/F,cAAcz/E,UACnBiiF,EAAUpiG,GAAGmgB,QAAQlgB,KAAKC,OAE9BsqG,eAAgB,WACZ,GAAI/uF,GAAUna,EAAE,WAAWiO,SAASrP,KAAK4mB,MAAMrL,QAC/Cvb,MAAK0/F,cAAgB,GAAIlgG,GAAM6Q,YAAYovF,cAAclkF,GAAWsK,OAAQ7lB,KAAKuqG,QAAQx4F,KAAK/R,SAElGuqG,QAAS,SAAUrkF,GACflmB,KAAK+1E,QAAQx3C,QACTn+B,QAAS,sBACTP,SACIuV,OAAQ8Q,EAAE3U,KACV5O,OACIU,KAAM,EACN8/B,MAAOjd,EAAEid,aAMzB+/D,EAAqBf,EAAqBxiG,QAC1C4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QAAS9sE,KAAM,eAGpCtM,EAAMu2E,QAAQozB,kBAAkB,UAAWlG,EAAkBC,GACzDC,EAAgBjB,EAAUviG,QAC1BC,KAAM,SAAUC,EAASk2E,GACrBmsB,EAAUpiG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACtC/1E,KAAKub,QAAQqG,MAAOinF,gBAAiB,cACrC7oG,KAAKwqG,iBACLxqG,KAAKyqG,kBACLzqG,KAAK4mB,MAAMrL,QAAQwG,GAAG,QAAS,YAAa,SAAUmE,GAClDlmB,KAAKuqG,QAAQnpG,EAAE8kB,EAAEy7E,iBACnB5vF,KAAK/R,OACPA,KAAKub,QAAQjR,MACTiH,KAAM,YACNsyF,UAAW7jG,KACXqoG,SAAUroG,QAGlBwqG,eAAgB,WACZxqG,KAAKyhG,UAEGhxF,SAAU,YACV/M,MAAO,OACPsiG,UAAW,aACX1kG,KAAMugG,EAASiC,iBAAiBC,eAGhCtzF,SAAU,YACV/M,MAAO,SACPsiG,UAAW,eACX1kG,KAAMugG,EAASiC,iBAAiBE,gBAGhCvzF,SAAU,YACV/M,MAAO,QACPsiG,UAAW,cACX1kG,KAAMugG,EAASiC,iBAAiBG,eAGhCxzF,SAAU,YACV/M,MAAO,UACPsiG,UAAW,gBACX1kG,KAAMugG,EAASiC,iBAAiBI,cAGhCzzF,SAAU,gBACV/M,MAAO,MACPsiG,UAAW,YACX1kG,KAAMugG,EAASiC,iBAAiBK,WAGhC1zF,SAAU,gBACV/M,MAAO,SACPsiG,UAAW,eACX1kG,KAAMugG,EAASiC,iBAAiBM,cAGhC3zF,SAAU,gBACV/M,MAAO,SACPsiG,UAAW,eACX1kG,KAAMugG,EAASiC,iBAAiBO,eAI5CpkF,QAAS,WACLjgB,KAAK4mB,MAAMrL,QAAQ+P,MACnB42E,EAAUpiG,GAAGmgB,QAAQlgB,KAAKC,OAE9BgoG,OAAQ,SAAUr3F,GAAV,GACAizB,GAAYjzB,EAAMizB,YAClBC,EAAgBlzB,EAAMkzB,gBACtBtoB,EAAUvb,KAAK4mB,MAAMrL,OACzBA,GAAQ0qB,KAAK,aAAa6gE,YAAY,kBAClCljE,GACAroB,EAAQ0qB,KAAK,wCAA0CrC,EAAY,KAAKz0B,SAAS,kBAEjF00B,GACAtoB,EAAQ0qB,KAAK,4CAA8CpC,EAAgB,KAAK10B,SAAS,mBAGjGs7F,gBAAiB,WAAA,GACThJ,GAAUzhG,KAAKyhG,QACflmF,EAAUna,EAAE,WAAWiO,SAASrP,KAAK4mB,MAAMrL,QAC/CkmF,GAAQ7vF,QAAQ,SAAU/R,EAAS4K,GAC/B,GAAI8jB,GAAS,aAAgB1uB,EAAQyB,KAAO,oBAAwBzB,EAAQ4Q,SAAW,iBAAqB5Q,EAAQ6D,MAAQ,4DAAuE7D,EAAQmmG,UAAY,eACzM,KAAVv7F,GAAeg3F,EAAQh3F,EAAQ,GAAGgG,WAAa5Q,EAAQ4Q,UACvD8K,EAAQ6xD,OAAOhsE,EAAE,iCAErBma,EAAQ6xD,OAAO7+C,MAGvBg8E,QAAS,SAAUh8E,GAAV,GACD9d,GAAW8d,EAAO3M,KAAK,iBACvBle,EAAQ6qB,EAAO3M,KAAK,aACxB5hB,MAAK+1E,QAAQx3C,QACTn+B,QAAS,wBACTP,SACI4Q,SAAUA,EACV/M,MAAOA,QAKnB0/F,EAAkBjB,EAAqBxiG,QACvC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QAAS9sE,KAAM,iBAGpCtM,EAAMu2E,QAAQozB,kBAAkB,YAAahG,EAAeC,GACxDC,EAAYnB,EAAUviG,QACtBC,KAAM,SAAUC,EAASk2E,GACrBmsB,EAAUpiG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACtC/1E,KAAKwqG,iBACLxqG,KAAKyqG,kBACLzqG,KAAK4mB,MAAMrL,QAAQwG,GAAG,QAAS,YAAa,SAAUmE,GAClDlmB,KAAKuqG,QAAQnpG,EAAE8kB,EAAEy7E,iBACnB5vF,KAAK/R,OACPA,KAAKub,QAAQjR,MACTiH,KAAM,QACNwF,MAAO/W,KACPqoG,SAAUroG,QAGlBwqG,eAAgB,WACZxqG,KAAKyhG,UAEG/9F,MAAO,QACPsiG,UAAW,cACX1kG,KAAMugG,EAASsD,aAAaC,aAG5B1hG,MAAO,eACPsiG,UAAW,2BACX1kG,KAAMugG,EAASsD,aAAaE,oBAG5B3hG,MAAO,aACPsiG,UAAW,yBACX1kG,KAAMugG,EAASsD,aAAaG,kBAG5B5hG,MAAO,UACPsiG,UAAW,gBACX1kG,KAAMugG,EAASsD,aAAatuF,WAIxCoJ,QAAS,WACLjgB,KAAK4mB,MAAMrL,QAAQ+P,MACnB42E,EAAUpiG,GAAGmgB,QAAQlgB,KAAKC,OAE9ByqG,gBAAiB,WACb,GAAIlvF,GAAUna,EAAE,WAAWiO,SAASrP,KAAK4mB,MAAMrL,QAC/Cvb,MAAKyhG,QAAQ7vF,QAAQ,SAAU/R,GAC3B,GAAI0uB,GAAS,aAAgB1uB,EAAQyB,KAAO,iBAAqBzB,EAAQ6D,MAAQ,gEAA2E7D,EAAQmmG,UAAY,YAAenmG,EAAQyB,KAAO,MAC9Mia,GAAQ6xD,OAAO7+C,MAGvBg8E,QAAS,SAAUh8E,GACf,GAAI7qB,GAAQ6qB,EAAO3M,KAAK,aACxB5hB,MAAK+1E,QAAQx3C,QACTn+B,QAAS,mBACTP,SAAW6D,MAAOA,QAI1B4/F,EAAcnB,EAAqBxiG,QACnC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QAAS9sE,KAAM,aAGpCtM,EAAMu2E,QAAQozB,kBAAkB,QAAS9F,EAAWC,GAChDC,EAAarB,EAAUviG,QACvBC,KAAM,SAAUC,EAASk2E,GACrBmsB,EAAUpiG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACtC/1E,KAAKwqG,iBACLxqG,KAAKyqG,kBACLzqG,KAAK4mB,MAAMrL,QAAQwG,GAAG,QAAS,YAAa,SAAUmE,GAClDlmB,KAAKuqG,QAAQnpG,EAAE8kB,EAAEy7E,iBACnB5vF,KAAK/R,OACPA,KAAKub,QAAQjR,MACTiH,KAAM,SACNuzF,OAAQ9kG,KACRqoG,SAAUroG,QAGlBwqG,eAAgB,WACZxqG,KAAKyhG,UAEG/9F,MAAO,QACPsiG,UAAW,cACX1kG,KAAMugG,EAASkD,cAAcC,cAG7BthG,MAAO,OACPsiG,UAAW,aACX1kG,KAAMugG,EAASkD,cAAcE,aAG7BvhG,MAAO,UACPsiG,UAAW,gBACX1kG,KAAMugG,EAASkD,cAAcG,gBAG7BxhG,MAAO,WACPsiG,UAAW,gBACX1kG,KAAMugG,EAASkD,cAAcrtF,YAIzCuI,QAAS,WACLjgB,KAAK4mB,MAAMrL,QAAQ+P,MACnB42E,EAAUpiG,GAAGmgB,QAAQlgB,KAAKC,OAE9ByqG,gBAAiB,WACb,GAAIlvF,GAAUna,EAAE,WAAWiO,SAASrP,KAAK4mB,MAAMrL,QAC/Cvb,MAAKyhG,QAAQ7vF,QAAQ,SAAU/R,GAC3B,GAAI0uB,GAAS,aAAgB1uB,EAAQyB,KAAO,iBAAqBzB,EAAQ6D,MAAQ,gEAA2E7D,EAAQmmG,UAAY,YAAenmG,EAAQyB,KAAO,MAC9Mia,GAAQ6xD,OAAO7+C,MAGvBg8E,QAAS,SAAUh8E,GACf,GAAI7qB,GAAQ6qB,EAAO3M,KAAK,aACxB5hB,MAAK+1E,QAAQx3C,QACTn+B,QAAS,qBACTP,SAAW6D,MAAOA,QAI1B8/F,EAAerB,EAAqBxiG,QACpC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QAAS9sE,KAAM,cAGpCtM,EAAMu2E,QAAQozB,kBAAkB,SAAU5F,EAAYC,GAClDC,EAAOxB,EAAatiG,QACpBuqG,aAAc,SAAUhkF,GACpBA,EAAEmiC,OAAO3kD,MAAM,IACfwiB,EAAEmiC,OAAOzoC,QAAQrd,MAAM,SAE3B3C,KAAM,SAAUC,EAASk2E,GACrBksB,EAAaniG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,EACzC,IAAIgzB,GAAM/oG,KAAKuoG,YACfQ,GAAIh3F,KAAK,SAAU/R,KAAKkqG,aAAan4F,KAAK/R,OAC1C+oG,EAAIh3F,KAAK,YAAa/R,KAAKkqG,aAAan4F,KAAK/R,OAC7C+oG,EAAIjqB,YACAsrB,cAAe,2BAA8BvqG,EAAQmmG,UAAY,qDACjE//E,SAAU,kGACVkwD,cAAe,OACfnwD,eAAgB,UAEpB+iF,EAAItuD,gBAEI/2C,MAAO,MACPmO,OAAO,EACPvQ,KAAMugG,EAAS6D,YAAYC,aAC3BK,UAAW,aAGXtiG,MAAO,OACPmO,OAAO,EACPvQ,KAAMugG,EAAS6D,YAAYE,cAC3BI,UAAW,eAGnB+C,EAAIx5F,OAAO,GACXvP,KAAKub,QAAQjR,MACTiH,KAAM,OACNxP,KAAM/B,QAGdugG,QAAS,SAAUr6E,GAAV,GACDmiF,GAAWniF,EAAEmiC,OACb4gD,EAAWZ,EAASY,UACpBA,IACAjpG,KAAK+1E,QAAQx3C,QACTn+B,QAAS,cACTP,SACI6D,MAAOulG,EAASvlG,MAChBmO,MAAOo3F,EAASp3F,UAKhCnO,MAAOtC,EAAEwY,OAET8pF,EAAavB,EAAqBxiG,QAClC4hG,OAAQ,WACJvhG,KAAK+1E,QAAQ6C,QAAS9sE,KAAM,YAGpCtM,EAAMu2E,QAAQozB,kBAAkB,OAAQ1F,EAAMC,GAC1CtjD,EAAS5gD,EAAMu2E,QAAQqzB,cAAczpG,QACrCC,KAAM,SAAUC,EAASk2E,GACrBl2E,EAAQ2nG,SAAW,WACnBhoG,EAAMu2E,QAAQqzB,cAActpG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACxD/1E,KAAKub,QAAQwG,GAAG,QAAS/hB,KAAKuhG,OAAOxvF,KAAK/R,OAC1CA,KAAKub,QAAQjR,MACTiH,KAAM,SACNgJ,OAAQva,QAGhBuhG,OAAQ,WACJvhG,KAAK+1E,QAAQx3C,QAASn+B,QAAS,mBAEnC4nG,OAAQ,SAAUtkG,GACd1D,KAAK4pB,OAAOlmB,MAGhBigG,EAAexB,EAAqBxiG,QACpCC,KAAM,SAAUC,EAASk2E,GACrBosB,EAAqBriG,GAAGF,KAAKG,KAAKC,KAAMH,EAASk2E,GACjD/1E,KAAKub,QAAQjR,MACTiH,KAAM,SACNgJ,OAAQva,QAGhBuhG,OAAQ,WACJvhG,KAAK+1E,QAAQx3C,QAASn+B,QAAS,mBAEnC4nG,OAAQ,SAAUtkG,GACd1D,KAAK4pB,OAAOlmB,MAGpBlE,EAAMu2E,QAAQozB,kBAAkB,SAAU/oD,EAAQujD,GAC9CC,EAAOpkG,EAAMu2E,QAAQuyB,KAAK3oG,QAC1BC,KAAM,SAAUC,EAASk2E,GACrB/1E,KAAK+1E,QAAUA,EACf/1E,KAAKub,QAAUna,EAAE,qGAAmHkJ,KAAK,WAAYtK,MACrJA,KAAKspG,OAASzpG,EAAQ6nG,WAAWt2F,MACjCpR,KAAK0qG,UAETA,OAAQ,WACJ1qG,KAAKub,QAAQ0qB,KAAK,SAASx2B,SAC3BrO,EAAE,0DAAgEwgB,KAAK,QAAS5hB,KAAKspG,QAAQ1nF,KAAK,aAAc5hB,KAAKspG,QAAQrI,IAAI,SAAUjhG,KAAKugG,QAAQxuF,KAAK/R,OAAOqP,SAASrP,KAAKub,UAEtLglF,QAAS,SAAUr6E,GACflmB,KAAK+1E,QAAQx3C,QACTn+B,QAAS,cACTP,SAAW0e,KAAM2H,EAAEjU,OAAO8oD,MAAM,MAEpC/6D,KAAK0qG,YAGblrG,EAAMu2E,QAAQozB,kBAAkB,OAAQvF,GACxCpkG,EAAM6Q,YAAY6lE,SAAW12E,EAAMqgB,GAAGq2D,SAASv2E,QAC3CC,KAAM,SAAU2b,EAAS1b,GACrBL,EAAMqgB,GAAGq2D,SAASp2E,GAAGF,KAAKG,KAAKC,KAAMub,EAAS1b,GAC9C0b,EAAQpM,SAAS,0BACjBnP,KAAK2qG,sBACL3qG,KAAK4qG,WACL,IAAI52B,GAAOn0E,EAAQkmB,UACnB/lB,MAAK6qG,gBAAgB//D,KAAK,SAAU1gB,EAAK7O,GACrCvb,KAAK8qG,SAAS1pG,EAAEma,GAAUy4D,EAAK5pD,GAAKlhB,GAAIrJ,EAAQw2E,eAAerC,EAAK5pD,GAAKlhB,MAC3E6I,KAAK/R,OACPA,KAAKihG,IAAI,WAAY,WACjBjhG,KAAK4qG,SAAS5qG,KAAKH,QAAQkmB,WAAW,GAAG7c,IAAIyT,YAGrDzc,OAAQV,EAAMqgB,GAAGq2D,SAASp2E,GAAGI,OAAOw2B,QAChC,SACA,WAEJzW,QAAS,WACLjgB,KAAK+qG,mBAAmBz/E,IAAI,SAC5B9rB,EAAMqgB,GAAGq2D,SAASp2E,GAAGmgB,QAAQlgB,KAAKC,KAClC,KAAK,GAAI8L,KAAQ9L,MAAK4qG,SAClB5qG,KAAK4qG,SAAS9+F,GAAMmU,WAG5Bse,OAAQ,SAAU8M,GACdrrC,KAAKU,QAAQ,SAAU2qC,IAE3ButC,OAAQ,SAAUvtC,GACdrrC,KAAKU,QAAQ,SAAU2qC,IAE3BysC,aAAc,SAAUnnE,GAAV,GAED7E,GADL8+F,EAAW5qG,KAAK4qG,QACpB,KAAS9+F,IAAQ8+F,GACTA,EAASI,eAAel/F,IACxB8+F,EAAS9+F,GAAMu1D,QAAQ1wD,IAInCg6F,oBAAqB,WAAA,GACblJ,KAEIrwF,MAAOywF,EAAS0D,YAAY/kG,KAC5BwlG,UAAW,OACXznE,OAAQ,SAGRntB,MAAOywF,EAAS0D,YAAY5kG,KAC5BqlG,UAAW,OACXznE,OAAQ,SAGZ0sE,EAAiBzrG,EAAMymB,SAAS,sKACpCjmB,MAAK+qG,mBAAqB3pG,EAAE,WACxBo/F,QAAS,qCACTvxF,KAAQzP,EAAMqkD,OAAOonD,EAAgBxJ,KACtCyJ,aAAalrG,KAAK4f,SACrB5f,KAAK+qG,mBAAmBhpF,GAAG,QAAS,YAAa,SAAUmE,GACvDA,EAAE5N,gBACF,IAAIimB,GAASn9B,EAAE8kB,EAAEy7E,eAAe//E,KAAK,cACrC5hB,MAAKu+B,QAASA,OAAQA,KACxBxsB,KAAK/R,OACPA,KAAK41E,qBAETA,kBAAmB,WACf51E,KAAKmrG,SAAStpF,IAAI,eAAgBriB,EAAMqiD,YAAY7hD,KAAK+qG,sBAE7DD,SAAU,SAAUnjD,EAAW77C,EAAMy6F,GAA3B,GACFhrF,GACA1b,CACAG,MAAK4qG,SAAS9+F,KACd9L,KAAK4qG,SAAS9+F,GAAMmU,UACpB0nC,EAAUtB,SAAS,cAAc52C,UAEjC82F,IACAhrF,EAAUosC,EAAU14C,KAAK,WAAWo3C,SAAS,OAC7CxmD,GACI0mG,MAAwB,iBAAVA,GAAsB94F,OAAY84F,EAChDC,YAAa16F,EACbyyB,OAAQv+B,KAAKu+B,OAAOxsB,KAAK/R,MACzB44E,OAAQ54E,KAAK44E,OAAO7mE,KAAK/R,OAE7BA,KAAK4qG,SAAS9+F,GAAQ,GAAItM,GAAM6Q,YAAYuxF,QAAQrmF,EAAS1b,SAI3EsD,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,uBACH,aACA,eACA,mBACDD,IACL,YACG,SAAUE,GA6OP,QAAS4rG,GAAe1nG,EAAOsR,GAC3B,MAAOxV,GAAM6Q,YAAYsE,WAAWrT,KAAKoC,EAAOsR,GAgGpD,QAASq2F,GAASvhF,EAAO2tB,GAAzB,GAGat1C,GAFL0D,KACAkC,IACJ,KAAS5F,EAAI,EAAGA,EAAIs1C,EAAM52C,OAAQsB,IAC1Bf,EAAEkqG,QAAQ7zD,EAAMt1C,GAAG2nB,GAAQ/hB,SAC3BlC,EAAO1F,KAAKs3C,EAAMt1C,IAClB4F,EAAO5H,KAAKs3C,EAAMt1C,GAAG2nB,IAG7B,OAAOjkB,GA4hCX,QAAS0lG,GAAiBriG,EAAIyB,GAC1BnL,EAAM6Q,YAAYwoE,QAAQ2yB,SAAStiG,EAAIuiG,EAAc9rG,QAASE,SAAW6rG,UAAW/gG,MAp3C3F,GAIOvJ,GACAuqG,EACA9J,EAyJA+J,EAeAC,EAkEAC,EAyGAC,EAwHAN,EAsBAO,EAoCAC,EA2BAC,EA+BAC,EA+BAC,EA2CA5M,EA+BA6M,EA4EAC,EAaAC,EA4EAC,EAmDAC,EAmDAC,EA4IAC,EA8HAC,EA2LAC,EAQAC,EAQAC,CA74CAvtG,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVmmG,EAAmBnsG,EAAM8K,KAAKqhG,iBAC9B9J,EAAWriG,EAAM6Q,YAAY8iE,SAAS0F,SACtCzvE,MAAO,QACPiC,KAAM,OACNw0F,OAAQ,SACRpwF,OAAQ,SACRu9F,MAAO,QACPC,OAAQ,SACRC,OAAQ,KACRC,mBACI/7F,MAAO,SACPg8F,YACI39C,OAAQ,SACRhoB,SAAU,WACVqG,KAAM,SAGdu/D,kBAAoBj8F,MAAO,QAC3Bk8F,gBAAkBl8F,MAAO,aACzBm8F,eAAiBn8F,MAAO,WACxBo8F,iBACIp8F,MAAO,YACPqwF,SACIsC,aAAc,aACdC,cAAe,SACfC,aAAc,cACdC,YAAa,UACbC,SAAU,YACVC,YAAa,eACbC,YAAa,iBAGrBoJ,aACIr8F,MAAO,cACPqwF,SACI2D,WAAY,YACZC,kBAAmB,qBACnBC,gBAAiB,mBACjBzuF,QAAS,YAGjB62F,cACIt8F,MAAO,eACPqwF,SACIuD,YAAa,eACbC,WAAY,cACZC,cAAe,iBACfxtF,SAAU,mBAGlBi2F,oBACIrsG,KAAM,8CACN8P,MAAO,gBAEXw8F,kBACIx8F,MAAO,kBACPy8F,YAAa,sCACbC,UAAW,iBACXh2C,UACIi2C,IAAK,YACLt+C,OAAQ,SACRnuD,KAAM,OACNwsC,KAAM,OACNuI,OAAQ,iBACR7wB,KAAM,QAEVwoF,WACI/1D,YAAa,eACbC,SAAU,YACVC,QAAS,UACTK,WAAY,cACZJ,QAAS,WACTC,WAAY,eACZC,qBAAsB,2BACtBC,kBAAmB,yBAEvB01D,kBACIh2D,YAAa,mBACbC,SAAU,gBACVC,QAAS,sBACTK,WAAY,0BACZJ,QAAS,eACTC,WAAY,mBACZC,qBAAsB,+BACtBC,kBAAmB,4BACnBlC,OAAQ,mCAEZ63D,QACIp2C,SAAU,WACV3mC,SAAU,WACV6H,IAAK,MACLD,IAAK,MACLr1B,MAAO,QACPgsB,MAAO,QACPjP,IAAK,MACL0tF,cAAe,kBACfC,YAAa,eACbC,YAAa,eACbC,SAAU,YACVR,UAAW,aACXD,YAAa,eACbU,YAAa,eACbC,eAAgB,8BAChBC,mBAAoB,mCAExBC,cACIC,UAAW,aACXC,YAAa,iBAGrBC,gBACIz9F,MAAO,YACP88F,QACIlsF,MAAO,QACP8sF,IAAK,cACL/vF,SAAU,YACVgwF,WAAY,eACZC,WAAY,SACZC,UAAW,aACXC,QAAS,UACTC,YAAa,cACbpkF,MAAO,QACPqkF,WAAY,aACZpO,OAAQ,SACRhqF,aAAc,eACdC,WAAY,eAGpBo4F,oBAAsBC,aAAc,wCACpCC,qBAAuBD,aAAc,8CACrCE,uBAAyBF,aAAc,qCACvCG,0BAA4BH,aAAc,uBAC1CI,uBAAyBJ,aAAc,mCACvCK,0BAA4BL,aAAc,wBAC1CM,gBAAkBN,aAAc,2FAChCO,mBACIz+F,MAAO,sBACPk+F,aAAc,+FACdpB,QACI4B,QAAS,WACTC,OAAQ,UACRC,SAAU,cAGlBC,4BAA8BX,aAAc,0DAC5CY,YACI9+F,MAAO,YACP88F,QACI5sG,KAAM,OACN6uG,IAAK,UACLC,WAAY,iBAIpBxE,KACJpsG,EAAM6Q,YAAYwoE,SACd2yB,SAAU,SAAU1/F,EAAMukG,GACtBzE,EAAS9/F,GAAQukG,GAErBh3B,WAAY,SAAUvtE,GAClB,QAAS8/F,EAAS9/F,IAEtB7C,OAAQ,SAAU6C,EAAMjM,GACpB,GAAIwwG,GAAczE,EAAS9/F,EAC3B,IAAIukG,EACA,MAAO,IAAIA,GAAYxwG,KAI/BgsG,EAAoBrsG,EAAM6Q,YAAYw7F,kBAAoBrsG,EAAME,WAAWC,QAC3EC,KAAM,SAAUC,GACZL,EAAME,WAAWI,GAAGF,KAAKG,KAAKC,KAAMH,GACpCG,KAAKH,QAAUuB,EAAEzB,QAAO,KAAUK,KAAKH,QAASA,GAChDG,KAAK+R,KAAK/R,KAAKE,OAAQL,IAE3BK,QACI,QACA,YAEJL,SAAWywG,WAAW,GACtB13B,OAAQ,WACJ,IAAK54E,KAAKuwG,QAAS,CACf,GAAI1wG,IACAywG,WAAW,EACX7rD,YAAY,EACZo8C,WAAW,EACXE,OAAO,EACPt5E,SAAS,EACTllB,MAAOvC,KAAKH,QAAQ0C,OAAS,IAC7B6O,MAAOpR,KAAKH,QAAQuR,MACpBkP,KAAM,WACFtgB,KAAKghG,UAET3gF,MAAOrgB,KAAKwwG,eAAez+F,KAAK/R,MAChC2W,SAAU3W,KAAKywG,kBAAkB1+F,KAAK/R,MACtC8pE,WAAY9pE,KAAK0wG,oBAAoB3+F,KAAK/R,MAE9CA,MAAKuwG,QAAUnvG,EAAE,0EAA4E+N,SAASnP,KAAKH,QAAQklC,WAAa,IAAIqoC,OAAO5tE,EAAMymB,SAASjmB,KAAKH,QAAQomB,WACnKktD,SAAU3zE,EAAM6Q,YAAY8iE,SAAS0F,SAAWgpB,EAChDljF,OAAQ3e,KAAKH,QAAQ8e,UACrBiiF,YAAY/gG,GAASyK,KAAK,eAElC,MAAOtK,MAAKuwG,SAEhBC,eAAgB,WACZxwG,KAAKU,QAAQ,SAAW69B,OAAQv+B,KAAKuqG,WAEzCkG,kBAAmB,WACfzwG,KAAKU,QAAQ,aAEjBgwG,oBAAqB,WACjB1wG,KAAKU,QAAQ,cACbV,KAAKigB,WAETA,QAAS,WACDjgB,KAAKuwG,UACLvwG,KAAKuwG,QAAQtwF,UACbjgB,KAAKuwG,QAAU,OAGvBjwF,KAAM,WACFtgB,KAAK44E,SAASt4D,OACdtgB,KAAK44E,SAASr9D,QAAQ0qB,KAAK,cAAc32B,SAE7ClG,MAAO,WACHpJ,KAAKqgB,SAETA,MAAO,WACHrgB,KAAKuqG,QAAU,QACfvqG,KAAK44E,SAASv4D,WAMlByrF,EAAuBtsG,EAAM6Q,YAAYy7F,qBAAuBH,EAAiBhsG,QACjFC,KAAM,SAAUC,GACZ8rG,EAAiB7rG,GAAGF,KAAKG,KAAKC,KAAMH,GACpCG,KAAK2wG,YAAY3wG,KAAK4wG,WAE1BD,YAAa,SAAUC,GAAV,GACLr/F,GAAOq/F,GAAYA,EAASr/F,MAAQ,SACpCs/F,EAAyB,YAARt/F,CACrBvR,MAAK4wG,SAAWA,EAChB5wG,KAAKmyB,IAAI,qBAAsB0+E,GAAkB7wG,KAAK8wG,WAAWjwG,OAAS,GACrEgwG,EAGD7wG,KAAKynC,SAASznC,KAAK8wG,WAAW,IAF9B9wG,KAAKmyB,IAAI,UAAWnyB,KAAK+wG,WAAWx/F,EAAO,YAI/CvR,KAAKgxG,kBAETA,eAAgB,WACRhxG,KAAKuyB,QAAQ1xB,QACbb,KAAKmyB,IAAI,SAAUnyB,KAAKuyB,QAAQ,GAAG7uB,QAG3C+jC,SAAU,SAAUA,GAAV,GAGEwpE,GACA1+E,CAyBR,OA5BiB9kB,UAAbg6B,IACAznC,KAAKkxG,UAAYzpE,EACbwpE,EAAOxpE,EAAS/jC,MAChB6uB,IAEIkV,SAAUwpE,EACVjqB,UAAU,IAGVv/C,SAAUwpE,EACVjqB,UAAU,EACVmqB,KAAK,IAGL1pE,SAAUwpE,EACVjqB,UAAU,IAGlBz0D,EAAUA,EAAQ5uB,IAAI,SAAUqR,GAE5B,MADAA,GAAS82F,EAAqBsF,QAAQ3pE,SAASzyB,IAE3CtR,MAAOsR,EACPlJ,KAAMs/F,EAAe,IAAMp2F,MAGnChV,KAAKmyB,IAAI,UAAWI,GACpBvyB,KAAKgxG,kBAEFhxG,KAAKkxG,WAAalxG,KAAK8wG,WAAW,IAE7CO,eAAgB,SAAUT,GAItB,MAHiBnjG,UAAbmjG,GACA5wG,KAAK2wG,YAAYC,GAEd5wG,KAAK4wG,UAEhBpwE,QAAS,WAAA,GACDxrB,GAAShV,KAAKiE,IAAI,UAClBP,EAAQ1D,KAAK0D,OAAS,CAC1B,OAAIsR,IAAUA,EAAOnU,OACVuqG,EAAe1nG,EAAOsR,GAEtBtR,KAInBooG,EAAqBsF,SACjB3pE,SAAU,SAAU5nC,GAChB,QAAS8wD,GAAOlqC,EAAOxgB,GACnB,MAAWkyB,OAAMlyB,EAAI,GAAGjE,KAAKykB,GAF3B,GAIFwqF,GAAOpxG,EAAQ4nC,SACfzyB,EAASi8F,EAAKK,QAAQ,EAU1B,OATIzxG,GAAQmnF,WACRhyE,EAASA,EAAOxT,QAAQ,KAAM,IAAMyvG,EAAK,KAAOtgD,EAAO,IAAKsgD,EAAKjqB,YAGjEhyE,EADAnV,EAAQsxG,IACC,IAAMF,EAAKM,KAAO,KAAOv8F,EAAOxT,QAAQ,YAAa,IAErDwT,EAAOxT,QAAQ,MAAO6wB,KAAKC,UAAU2+E,EAAKvhD,SAEvD16C,EAASA,EAAOxT,QAAQ,KAAM,MAGlCssC,KAAM,SAAU94B,GACZ,MAAI,MAAMxL,KAAKwL,GACJ,GAEJA,EAAOzM,cAAc/G,QAAQ,MAAO,SAASA,QAAQ,KAAM,OActEuqG,EAAoBF,EAAkBlsG,QACtCC,KAAM,SAAUC,GAAV,GACEszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQs0B,mBAAqBtL,EACnE2P,GACApgG,MAAO+hE,EAAS/hE,MAChBg8F,aAEQ77F,KAAM,SACNzF,KAAMqnE,EAASi6B,WAAW39C,SAG1Bl+C,KAAM,WACNzF,KAAMqnE,EAASi6B,WAAW3lE,WAG1Bl2B,KAAM,OACNzF,KAAMqnE,EAASi6B,WAAWt/D,OAItC+9D,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,OAAO6xG,EAAgB3xG,IAC9DG,KAAKyxG,oBAET5xG,SACIklC,UAAW,6BACX9e,SAAU,+6BAEdwrF,iBAAkB,WAAA,GA0BNC,GAzBJ7xG,EAAUG,KAAKH,OACdA,GAAQixG,aACTjxG,EAAQixG,WAAa/E,EAAkB4F,eAAenyG,EAAM+jF,WAE3D1jF,EAAQ+xG,gBACT/xG,EAAQ+xG,gBAEAluG,MAAO,QACPoI,KAAM,YAGNpI,MAAO,KACPoI,KAAM,SAGNpI,MAAO,OACPoI,KAAM,YAGNpI,MAAO,WACPoI,KAAM,cAIbjM,EAAQgyG,cACLH,EAAmBlyG,EAAM+jF,SAASzgF,QAAQsjF,UAAUC,SAAS1zD,SACjE9yB,EAAQgyG,YAAcxG,EAAS,QAASjqG,EAAEuC,IAAI+tG,EAAkB,SAAU18F,GAEtE,GADAA,EAAS82F,EAAqBsF,QAAQtjE,KAAK94B,GAI3C,OACItR,MAAOsR,EACPlJ,KAAMs/F,EAAe,WAAYp2F,SAKjDsL,KAAM,SAAU3P,GAAV,GAIE4K,GAiBAu2F,EApBAjyG,EAAUG,KAAKH,QACf6D,EAAQiN,EAAMjN,QACd0pG,EAAavtG,EAAQutG,WAAW9sG,MAAM,EAE1CN,MAAK2gG,UAAY,GAAImL,IACjBgF,WAAYjxG,EAAQixG,WAAWxwG,MAAM,GACrCywG,YACIa,cAAe/xG,EAAQ+xG,cAActxG,MAAM,GAC3CuxG,YAAahyG,EAAQgyG,YAAYvxG,MAAM,IAE3C8sG,WAAYA,EACZp4F,OAAQrE,EAAMqE,SACd47F,SAAUltG,YAAiBoG,MAAOsjG,EAAW,GAAKA,EAAW,GAC7DhkG,MAAOpJ,KAAKoJ,MAAM2I,KAAK/R,MACvBqgB,MAAOrgB,KAAKqgB,MAAMtO,KAAK/R,MACvB0D,MAAOA,IAEXmoG,EAAkB/rG,GAAGwgB,KAAKvgB,KAAKC,MAC/Bub,EAAUvb,KAAK44E,SAASr9D,QACxB/b,EAAMuS,KAAKwJ,EAASvb,KAAK2gG,WACrBmR,EAAiBv2F,EAAQ0qB,KAAK,0BAA0B37B,KAAK,qBAC7DzK,EAAQixG,WAAWjwG,OAAS,IAC5BixG,EAAehzB,YAAavkE,OAAQ,aAExCgB,EAAQ0qB,KAAKzmC,EAAMuyG,aAAa,eAAe/gE,SAAS7hC,SAAS,mBAErE/F,MAAO,WACH,GAAI4L,GAAShV,KAAK2gG,UAAU3rF,MAC5B62F,GAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,wBACTP,SACI4Q,SAAU,SACV/M,MAAOsR,QAKvB+2F,EAAkB4F,eAAiB,SAAUpuB,GACzC,MAAO8nB,GAAS,cAAejqG,EAAEuC,IAAI4/E,EAAU,SAAU9wD,EAAS3mB,GAAnB,GAIvC27B,GACAuqE,CAJJ,IAAK,IAAIxoG,KAAKsC,GAKd,MAFI27B,GAAWhV,EAAQqV,aAAaL,SAChCuqE,EAAcxyG,EAAMwV,OAAO,iBAAkByyB,EAAS37B,KAAM27B,EAAS8pE,KAAM9pE,EAASioB,SAEpFsiD,YAAaA,EACbtuG,MAAO+jC,OAInBjoC,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,cAAeO,GAClDvsG,EAAM6Q,YAAYwoE,QAAQkzB,kBAAoBA,EAC1CN,EAAgBI,EAAkBlsG,QAClCE,SACIklC,UAAW,wBACX3zB,MAAO,GACPs6F,UAAW,GACXpqG,KAAM,GACN2kB,SAAU,qMAEd3F,KAAM,WAAA,GAEEzgB,GACAyB,CAFJuqG,GAAkB/rG,GAAGwgB,KAAKvgB,KAAKC,MAC3BH,EAAUG,KAAKH,QACfyB,EAAOzB,EAAQyB,KACfzB,EAAQ6rG,YACRpqG,EAAO9B,EAAMyyG,OAAOpyG,EAAQ6rG,WAAW,GAAMlsG,EAAM6Q,YAAY8iE,SAAS0F,UAE5Er5E,EAAMuS,KAAK/R,KAAK44E,SAASr9D,SACrBja,KAAMA,EACN+e,MAAOrgB,KAAKqgB,MAAMtO,KAAK/R,WAInCR,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,UAAWC,GAC1CO,EAAqBH,EAAkBlsG,QACvCC,KAAM,SAAUC,GAAV,GACEszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQ80B,oBAAsB9L,EACpE2P,GACApgG,MAAO+hE,EAAS/hE,MAChB9P,KAAM6xE,EAAS7xE,KAEnBuqG,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,OAAO6xG,EAAgB3xG;EAElEA,SACIklC,UAAW,wBACX2mE,UAAW,GACXzlF,SAAU,uRAEd3F,KAAM,WAAA,GAEEzgB,GACAyB,CAFJuqG,GAAkB/rG,GAAGwgB,KAAKvgB,KAAKC,MAC3BH,EAAUG,KAAKH,QACfyB,EAAOzB,EAAQyB,KACfzB,EAAQ6rG,YACRpqG,EAAO9B,EAAMyyG,OAAOpyG,EAAQ6rG,WAAW,GAAMlsG,EAAM6Q,YAAY8iE,SAAS0F,UAE5Er5E,EAAMuS,KAAK/R,KAAK44E,SAASr9D,SACrBja,KAAMA,EACN4wG,QAASlyG,KAAKkyG,QAAQngG,KAAK/R,MAC3B6/F,OAAQ7/F,KAAKqgB,MAAMtO,KAAK/R,SAGhCsoD,YAAa,WACT,MAAOtoD,MAAKmyG,YAEhBD,QAAS,WACLlyG,KAAKmyG,YAAa,EAClBnyG,KAAKqgB,WAGb7gB,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,eAAgBQ,GAC/CC,EAAwBJ,EAAkBlsG,QAC1CE,SACIklC,UAAW,wBACX3zB,MAAO,GACPs6F,UAAW,GACXpqG,KAAM,GACN2kB,SAAU,oRAEd3F,KAAM,WAAA,GAEEzgB,GACAyB,CAFJuqG,GAAkB/rG,GAAGwgB,KAAKvgB,KAAKC,MAC3BH,EAAUG,KAAKH,QACfyB,EAAOzB,EAAQyB,KACfzB,EAAQ6rG,YACRpqG,EAAO9B,EAAMyyG,OAAOpyG,EAAQ6rG,WAAW,GAAMlsG,EAAM6Q,YAAY8iE,SAAS0F,UAE5Er5E,EAAMuS,KAAK/R,KAAK44E,SAASr9D,SACrBja,KAAMA,EACN0rG,MAAOhtG,KAAKgtG,MAAMj7F,KAAK/R,MACvB6/F,OAAQ7/F,KAAKqgB,MAAMtO,KAAK/R,SAGhCgtG,MAAO,WACHhtG,KAAKo5E,QAAS,EACdp5E,KAAKqgB,WAGb7gB,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,kBAAmBS,GAClDC,EAAmBL,EAAkBlsG,QACrCC,KAAM,SAAUC,GACZ,GAAIszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQw0B,kBAAoBxL,CACtEgK,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,QAASyR,MAAO+hE,EAAS/hE,OAASvR,IACzEG,KAAKoyG,SAETvyG,SAAWomB,SAAU,oCACrBmsF,MAAO,WAAA,GACCrrD,GAAK/mD,KAAK44E,SAASr9D,QAAQ0qB,KAAK,MAChCw0B,EAAQz6D,KAAKH,QAAQ46D,MACrBwvC,EAAcjqG,KAAKH,QAAQoqG,WAC/BjqG,MAAKwlB,KAAO,GAAIhmB,GAAMqgB,GAAG4F,WAAWshC,GAChChhC,WAAY,GAAIvmB,GAAM8K,KAAKib,YAAajb,KAAMmwD,IAC9Cx0C,SAAU,YACVviB,MAAOumG,EACPpkF,OAAQ7lB,KAAKoJ,MAAM2I,KAAK/R,QAE5BA,KAAKwlB,KAAKO,WAAWwrB,SAEzBnoC,MAAO,SAAU8c,GACb2lF,EAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,wBACTP,SACI4Q,SAAU,aACV/M,MAAOwiB,EAAEmiC,OAAO3kD,QAAQ,SAKxClE,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,aAAcU,GAC7CC,EAAiBN,EAAkBlsG,QACnCC,KAAM,SAAUC,GACZ,GAAIszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQy0B,gBAAkBzL,CACpEgK,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,QAASyR,MAAO+hE,EAAS/hE,OAASvR,IACzEG,KAAKoyG,SAETvyG,SAAWomB,SAAU,oCACrBmsF,MAAO,WAAA,GACCrrD,GAAK/mD,KAAK44E,SAASr9D,QAAQ0qB,KAAK,MAChC6jE,EAAQ9pG,KAAKH,QAAQiqG,MACrBC,EAAc/pG,KAAKH,QAAQkqG,WAC/B/pG,MAAKwlB,KAAO,GAAIhmB,GAAMqgB,GAAG4F,WAAWshC,GAChChhC,WAAY,GAAIvmB,GAAM8K,KAAKib,YAAajb,KAAMw/F,IAC9C7jF,SAAU,YACVviB,MAAOqmG,EACPlkF,OAAQ7lB,KAAKoJ,MAAM2I,KAAK/R,QAE5BA,KAAKwlB,KAAKO,WAAWwrB,SAEzBnoC,MAAO,SAAU8c,GACb2lF,EAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,wBACTP,SACI4Q,SAAU,WACV/M,MAAOlE,EAAM8N,SAAS4Y,EAAEmiC,OAAO3kD,QAAQ,UAKvDlE,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,WAAYW,GAC3CC,EAAgBP,EAAkBlsG,QAClCC,KAAM,SAAUC,GACZ,GAAIszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQ00B,eAAiB1L,CACnEgK,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,QAASyR,MAAO+hE,EAAS/hE,OAASvR,IACzEG,KAAKub,QAAUvb,KAAK44E,SAASr9D,QAC7Bvb,KAAKsqG,iBACLtqG,KAAK2gG,UAAYnhG,EAAM4hG,YACnBh4F,MAAOpJ,KAAKoJ,MAAM2I,KAAK/R,MACvBqgB,MAAOrgB,KAAKqgB,MAAMtO,KAAK/R,QAE3BR,EAAMuS,KAAK/R,KAAKub,QAAQ0qB,KAAK,qBAAsBjmC,KAAK2gG,YAE5D9gG,SACI0C,MAAO,IACP0jB,SAAU,0NAEd7c,MAAO,WACHyiG,EAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,KAChC,IAAIiR,GAAQjR,KAAK0D,OACjB1D,MAAKU,QAAQ,UACTN,QAAS,sBACTP,SACIuV,OAAQnE,EAAMM,KACd5O,OACIU,KAAM,EACN8/B,MAAOlyB,EAAMkyB,WAK7BmnE,eAAgB,WACZ,GAAI/uF,GAAUvb,KAAK44E,SAASr9D,QAAQ0qB,KAAK,YACzCjmC,MAAK0/F,cAAgB,GAAIlgG,GAAM6Q,YAAYovF,cAAclkF,GAAWsK,OAAQ7lB,KAAK0D,MAAMqO,KAAK/R,SAEhG0D,MAAO,SAAUuN,GACb,MAAcxD,UAAVwD,EACOjR,KAAK0Q,YAEZ1Q,KAAK0Q,OAASO,MAI1BzR,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,UAAWY,GAC1C5M,EAAeqM,EAAkBlsG,QACjCC,KAAM,SAAUC,GACZgsG,EAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMH,GACrCG,KAAKub,QAAUvb,KAAK44E,SAASr9D,QAC7Bvb,KAAKyQ,SAAW5Q,EAAQ4Q,SACxBzQ,KAAKH,QAAQuR,MAAQvR,EAAQuR,MAC7BpR,KAAK2gG,UAAYnhG,EAAM4hG,YACnBh4F,MAAOpJ,KAAKoJ,MAAM2I,KAAK/R,MACvBqgB,MAAOrgB,KAAKqgB,MAAMtO,KAAK/R,QAE3BR,EAAMuS,KAAK/R,KAAKub,QAAQ0qB,KAAK,qBAAsBjmC,KAAK2gG,YAE5D9gG,SAAWomB,SAAU,0NACrB7c,MAAO,WACHyiG,EAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,wBACTP,SACI4Q,SAAUzQ,KAAKyQ,SACf/M,MAAO1D,KAAK0D,YAIxBA,MAAO,SAAUwiB,GACb,MAAUzY,UAANyY,EACOlmB,KAAKkS,YAEZlS,KAAKkS,OAASgU,EAAExiB,UAIxB2oG,EAAoB7M,EAAa7/F,QACjCC,KAAM,SAAUC,GACZA,EAAQ0C,MAAQ,IAChBi9F,EAAa1/F,GAAGF,KAAKG,KAAKC,KAAMH,GAChCG,KAAK+/F,iBAETA,cAAe,WACX,GAAIxkF,GAAUvb,KAAK44E,SAASr9D,QAAQ0qB,KAAK,YACzCjmC,MAAKqgG,aAAe9kF,EAAQklF,mBACxBC,SACI,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJ76E,OAAQ7lB,KAAK0D,MAAMqO,KAAK/R,QACzBsK,KAAK,wBAGhB9K,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,cAAea,GAC9CC,EAAoB9M,EAAa7/F,QACjCC,KAAM,SAAUC,GACZA,EAAQ0C,MAAQ,IAChBi9F,EAAa1/F,GAAGF,KAAKG,KAAKC,KAAMH,GAChCG,KAAK44E,SAASkG,YAAal3B,WAAW,IACtC5nD,KAAK44E,SAASqoB,IAAI,WAAYjhG,KAAKqyG,aAAatgG,KAAK/R,QAEzDqyG,aAAc,WACV,GAAI92F,GAAUvb,KAAK44E,SAASr9D,QAAQ0qB,KAAK,YACzCjmC,MAAK2/F,YAAcpkF,EAAQ4lF,sBAAuBt7E,OAAQ7lB,KAAK0D,MAAMqO,KAAK/R,QAASsK,KAAK,2BAGhG9K,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,cAAec,GAC9CC,EAAkBV,EAAkBlsG,QACpCC,KAAM,SAAUC,GAAV,GACEszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQ20B,iBAAmB3L,EACjE2P,GACApgG,MAAO+hE,EAAS/hE,MAChBqwF,UAEQhxF,SAAU,YACV/M,MAAO,OACPsiG,UAAW,aACX1kG,KAAM6xE,EAASsuB,QAAQsC,eAGvBtzF,SAAU,YACV/M,MAAO,SACPsiG,UAAW,eACX1kG,KAAM6xE,EAASsuB,QAAQuC,gBAGvBvzF,SAAU,YACV/M,MAAO,QACPsiG,UAAW,cACX1kG,KAAM6xE,EAASsuB,QAAQwC,eAGvBxzF,SAAU,YACV/M,MAAO,UACPsiG,UAAW,gBACX1kG,KAAM6xE,EAASsuB,QAAQyC,cAGvBzzF,SAAU,gBACV/M,MAAO,MACPsiG,UAAW,YACX1kG,KAAM6xE,EAASsuB,QAAQ0C,WAGvB1zF,SAAU,gBACV/M,MAAO,SACPsiG,UAAW,eACX1kG,KAAM6xE,EAASsuB,QAAQ2C,cAGvB3zF,SAAU,gBACV/M,MAAO,SACPsiG,UAAW,eACX1kG,KAAM6xE,EAASsuB,QAAQ4C,cAInCwH,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,OAAO6xG,EAAgB3xG,IAC9DG,KAAKoyG,SAETvyG,SAAWomB,SAAU,oCACrBmsF,MAAO,WACH,GAAIrrD,GAAK/mD,KAAK44E,SAASr9D,QAAQ0qB,KAAK,KACpCjmC,MAAKwlB,KAAO,GAAIhmB,GAAMqgB,GAAG4F,WAAWshC,GAChChhC,WAAY,GAAIvmB,GAAM8K,KAAKib,YAAajb,KAAMtK,KAAKH,QAAQ4hG,UAC3Dx7E,SAAU,gIACVJ,OAAQ7lB,KAAKoJ,MAAM2I,KAAK/R,QAE5BA,KAAKwlB,KAAKO,WAAWwrB,SAEzBnoC,MAAO,SAAU8c,GACb,GAAI+iF,GAAW/iF,EAAEmiC,OAAO3kD,QAAQ,EAChCmoG,GAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,wBACTP,SACI4Q,SAAUw4F,EAASx4F,SACnB/M,MAAOulG,EAASvlG,YAKhClE,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,YAAae,GAC5CC,EAAcX,EAAkBlsG,QAChCC,KAAM,SAAUC,GAAV,GACEszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQ40B,aAAe5L,EAC7D2P,GACApgG,MAAO+hE,EAAS/hE,MAChBqwF,UAEQ/9F,MAAO,QACPsiG,UAAW,cACX1kG,KAAM6xE,EAASsuB,QAAQ2D,aAGvB1hG,MAAO,eACPsiG,UAAW,2BACX1kG,KAAM6xE,EAASsuB,QAAQ4D,oBAGvB3hG,MAAO,aACPsiG,UAAW,yBACX1kG,KAAM6xE,EAASsuB,QAAQ6D,kBAGvB5hG,MAAO,UACPsiG,UAAW,gBACX1kG,KAAM6xE,EAASsuB,QAAQ5qF,UAInCg1F,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,OAAO6xG,EAAgB3xG,IAC9DG,KAAKoyG,SAETvyG,SAAWomB,SAAU,oCACrBmsF,MAAO,WACH,GAAIrrD,GAAK/mD,KAAK44E,SAASr9D,QAAQ0qB,KAAK,KACpCjmC,MAAKwlB,KAAO,GAAIhmB,GAAMqgB,GAAG4F,WAAWshC,GAChChhC,WAAY,GAAIvmB,GAAM8K,KAAKib,YAAajb,KAAMtK,KAAKH,QAAQ4hG,UAC3Dx7E,SAAU,2GACVJ,OAAQ7lB,KAAKoJ,MAAM2I,KAAK/R,QAE5BA,KAAKwlB,KAAKO,WAAWwrB,SAEzBnoC,MAAO,SAAU8c,GACb,GAAI+iF,GAAW/iF,EAAEmiC,OAAO3kD,QAAQ,EAChCmoG,GAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,mBACTP,SAAW6D,MAAOulG,EAASvlG,YAIvClE,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,QAASgB,GACxCC,EAAeZ,EAAkBlsG,QACjCC,KAAM,SAAUC,GAAV,GACEszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQ60B,cAAgB7L,EAC9D2P,GACApgG,MAAO+hE,EAAS/hE,MAChBqwF,UAEQ/9F,MAAO,QACPsiG,UAAW,cACX1kG,KAAM6xE,EAASsuB,QAAQuD,cAGvBthG,MAAO,OACPsiG,UAAW,aACX1kG,KAAM6xE,EAASsuB,QAAQwD,aAGvBvhG,MAAO,UACPsiG,UAAW,gBACX1kG,KAAM6xE,EAASsuB,QAAQyD,gBAGvBxhG,MAAO,WACPsiG,UAAW,gBACX1kG,KAAM6xE,EAASsuB,QAAQ/pF,WAInCm0F,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,OAAO6xG,EAAgB3xG,IAC9DG,KAAKoyG,SAETvyG,SAAWomB,SAAU,oCACrBmsF,MAAO,WACH,GAAIrrD,GAAK/mD,KAAK44E,SAASr9D,QAAQ0qB,KAAK,KACpCjmC,MAAKwlB,KAAO,GAAIhmB,GAAMqgB,GAAG4F,WAAWshC,GAChChhC,WAAY,GAAIvmB,GAAM8K,KAAKib,YAAajb,KAAMtK,KAAKH,QAAQ4hG,UAC3Dx7E,SAAU,2GACVJ,OAAQ7lB,KAAKoJ,MAAM2I,KAAK/R,QAE5BA,KAAKwlB,KAAKO,WAAWwrB,SAEzBnoC,MAAO,SAAU8c,GACb,GAAI+iF,GAAW/iF,EAAEmiC,OAAO3kD,QAAQ,EAChCmoG,GAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,qBACTP,SAAW6D,MAAOulG,EAASvlG,YAIvClE,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,SAAUiB,GACzCC,EAAsBltG,EAAM6Q,YAAYiiG,yBAA2B3G,EAAiBhsG,QACpFC,KAAM,SAAUC,GACZ8rG,EAAiB7rG,GAAGF,KAAKG,KAAKC,KAAMH,GACpCG,KAAK+R,KAAK,SAAU,SAAUmU,GACV,cAAZA,EAAE4D,QACF9pB,KAAKi0C,QACkB,WAAnBj0C,KAAKuyG,WAA6C,SAAnBvyG,KAAKuyG,WACpCvyG,KAAKwyG,0BAGG,aAAZtsF,EAAE4D,OACF9pB,KAAKwyG,yBAEO,eAAXtsF,EAAE4D,OAAqC,aAAX5D,EAAE4D,OAA0B9pB,KAAKwmB,QAC9DxmB,KAAKyyG,aAAc,GAEP,QAAXvsF,EAAE4D,OAA8B,MAAX5D,EAAE4D,OAA4B,uBAAX5D,EAAE4D,OAA6C,QAAX5D,EAAE4D,QAAoB9pB,KAAKyyG,aACxGzyG,KAAK0yG,iBAEX3gG,KAAK/R,OACPA,KAAKi0C,SAETy+D,cAAe,WACX1yG,KAAKwmB,OAAQ,EACbxmB,KAAKmyB,IAAI,YAAanyB,KAAK2yG,kBAAoBnzG,EAAMwV,OAAOhV,KAAK2yG,kBAAmB3yG,KAAKuR,MAAQ,IACjGvR,KAAKmyB,IAAI,cAAenyB,KAAK4yG,oBAAsBpzG,EAAMwV,OAAOhV,KAAK4yG,oBAAqB5yG,KAAK21C,KAAM31C,KAAKk2C,IAAM,IAChHl2C,KAAKwmB,OAAQ,GAEjBytB,MAAO,WACHj0C,KAAK6yG,eACL7yG,KAAKmyB,IAAI,WAAYnyB,KAAKguG,UAAU,GAAGz8F,MACvCvR,KAAKmyB,IAAI,OAAQ,MACjBnyB,KAAKmyB,IAAI,KAAM,MACfnyB,KAAKmyB,IAAI,qBAAqB,GAC9BnyB,KAAKyyG,aAAc,EACnBzyG,KAAK2yG,kBAAoB3yG,KAAK8yG,iBAC9B9yG,KAAK0yG,iBAETG,aAAc,WAAA,GAIFE,GAIK3oF,EAPTg1B,EAAMp/C,KAAKgzG,iBACXhF,IACJ,IAAuB,SAAnBhuG,KAAKuyG,UAKL,IAJIQ,GACA,UACA,cAEK3oF,EAAM,EAAGA,EAAMg1B,EAAIv+C,OAAQupB,IAC5B2oF,EAAe,IAAM3zD,EAAIh1B,GAAK7Y,OAC9By8F,EAAU7tG,KAAKi/C,EAAIh1B,IACnB2oF,EAAe9qG,aAIvB+lG,GAAY5uD,EAAI9+C,OAEpBN,MAAKmyB,IAAI,YAAa67E,IAE1BwE,uBAAwB,WACG,WAAnBxyG,KAAKuyG,WAA6C,SAAnBvyG,KAAKuyG,UACpCvyG,KAAKmyB,IAAI,sBAAuB3yB,EAAMwV,OAAOhV,KAAKizG,mBAAoBjzG,KAAKuyG,UAAWvyG,KAAKiuG,iBAAiBjuG,KAAKmxB,aAEjHnxB,KAAKmyB,IAAI,sBAAuB,IAChCnyB,KAAKmyB,IAAI,cAAe,MAGhC+gF,MAAO,WACH,MAAiC,QAA1BlzG,KAAKiE,IAAI,cAEpBkvG,SAAU,WACN,MAAiC,WAA1BnzG,KAAKiE,IAAI,cAEpBmvG,gBAAiB,WACb,MAAOpzG,MAAKqzG,UAAYrzG,KAAKmzG,YAEjCG,cAAe,WACX,MAAOtzG,MAAKqzG,UAAYrzG,KAAKuzG,UAEjCC,OAAQ,WACJ,MAAiC,SAA1BxzG,KAAKiE,IAAI,cAEpBsvG,OAAQ,WACJ,MAAiC,SAA1BvzG,KAAKiE,IAAI,cAEpBwvG,OAAQ,WACJ,MAAiC,SAA1BzzG,KAAKiE,IAAI,cAEpByvG,SAAU,WACN,MAAiC,WAA1B1zG,KAAKiE,IAAI,cAEpB0vG,WAAY,WACR,MAAO3zG,MAAKiE,IAAI,kBAEpBovG,OAAQ,WACJ,MAA+B,WAAxBrzG,KAAKiE,IAAI,aAAoD,cAAxBjE,KAAKiE,IAAI,aAEzD+jG,OAAQ,SAAU5pF,GACdpe,KAAKmyB,IAAI,kBAAmB/T,GACxBA,GACApe,KAAK4zG,qBAAqBx1F,IAGlCw1F,qBAAsB,SAAUx1F,GAC5Bpe,KAAKmyB,IAAI,YAAa/T,EAAWw3B,UACjC51C,KAAKmyB,IAAI,WAAY/T,EAAWk4B,cAChCt2C,KAAKmyB,IAAI,OAAQ/T,EAAWu3B,MAC5B31C,KAAKmyB,IAAI,KAAM/T,EAAW83B,IAC1Bl2C,KAAKmyB,IAAI,OAAQ/T,EAAW7M,MAC5BvR,KAAKmyB,IAAI,cAAe/T,EAAWs4B,YACnC12C,KAAKmyB,IAAI,aAAc/T,EAAWy4B,YAC9Bz4B,EAAW44B,iBAAmB54B,EAAW64B,eACzCj3C,KAAK4yG,oBAAsBx0F,EAAW44B,gBACtCh3C,KAAK6tG,YAAczvF,EAAW44B,gBAC9Bh3C,KAAK2yG,kBAAoBv0F,EAAW64B,cACpCj3C,KAAK8tG,UAAY1vF,EAAW64B,cAC5Bj3C,KAAK6zG,mBAAoB,EACzB7zG,KAAK0yG,iBAEL1yG,KAAK6zG,mBAAoB,GAGjCC,mBAAoB,WAChB,GAAuB,QAAnB9zG,KAAKuyG,UACL,MAAO,KAEX,IAAI1yG,IACA0R,KAAMvR,KAAKuR,KACXqkC,SAAU51C,KAAKuyG,UACfj8D,aAAct2C,KAAKmxB,SACnBwkB,KAAM31C,KAAK21C,KACXO,GAAIl2C,KAAKk2C,GACTQ,WAAY12C,KAAKuuG,YACjB13D,WAAY72C,KAAK62C,WAMrB,OAJI72C,MAAK6zG,oBACLh0G,EAAQm3C,gBAAkBh3C,KAAKyyG,YAAczyG,KAAK4yG,oBAAsB5yG,KAAK6tG,YAC7EhuG,EAAQo3C,cAAgBj3C,KAAK8tG,WAE1BjuG,KAGX8sG,EAAmBd,EAAkBlsG,QACrCC,KAAM,SAAUC,GAAV,GACEszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQ+0B,kBAAoB/L,EAClE2P,GACApgG,MAAO+hE,EAAS/hE,MAChBy8F,YAAa16B,EAAS06B,YACtBC,UAAW36B,EAAS26B,UACpBh2C,WAEQvmD,KAAM,MACNzF,KAAMqnE,EAASrb,SAASi2C,MAGxBx8F,KAAM,SACNzF,KAAMqnE,EAASrb,SAASrI,SAGxBl+C,KAAM,OACNzF,KAAMqnE,EAASrb,SAASx2D,OAGxBiQ,KAAM,OACNzF,KAAMqnE,EAASrb,SAAShqB,OAGxBv8B,KAAM,SACNzF,KAAMqnE,EAASrb,SAASzhB,SAGxB9kC,KAAM,OACNzF,KAAMqnE,EAASrb,SAAStyC,OAGhCwoF,YAEQz8F,KAAM,cACNzF,KAAMqnE,EAAS66B,UAAU/1D,cAGzB1mC,KAAM,WACNzF,KAAMqnE,EAAS66B,UAAU91D,WAGzB3mC,KAAM,UACNzF,KAAMqnE,EAAS66B,UAAU71D,UAGzB5mC,KAAM,aACNzF,KAAMqnE,EAAS66B,UAAUx1D,aAGzBjnC,KAAM,UACNzF,KAAMqnE,EAAS66B,UAAU51D,UAGzB7mC,KAAM,aACNzF,KAAMqnE,EAAS66B,UAAU31D,aAGzB9mC,KAAM,uBACNzF,KAAMqnE,EAAS66B,UAAU11D,uBAGzB/mC,KAAM,oBACNzF,KAAMqnE,EAAS66B,UAAUz1D,oBAGjC01D,iBAAkB96B,EAAS86B,iBAE/BpC,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,OAAO6xG,EAAgB3xG,KAElEA,SACI0C,MAAO,IACPgwG,UAAW,MACXhhG,KAAM,SACNg9F,aAAa,EACb13D,YAAY,EACZg9D,mBAAmB,EACnBE,cAAe,iLACf9tF,SAAU,+vNAEd3F,KAAM,SAAU3P,GAAV,GAEE4K,GADA1b,EAAUG,KAAKH,OAEnBG,MAAK2gG,UAAY,GAAI+L,IACjBn7F,KAAM1R,EAAQ0R,KACd0hG,mBAAoBpzG,EAAQguG,YAC5BiF,iBAAkBjzG,EAAQiuG,UAC1BkF,iBAAkBnzG,EAAQmuG,UAAU1tG,MAAM,GAC1C2tG,iBAAkBpuG,EAAQouG,iBAC1Bn2C,SAAUj4D,EAAQi4D,SAASx3D,MAAM,GACjCiyG,UAAW1yG,EAAQ0yG,UACnBhE,YAAa1uG,EAAQ0uG,YACrB13D,WAAYh3C,EAAQg3C,WACpBztC,MAAOpJ,KAAKoJ,MAAM2I,KAAK/R,MACvBqgB,MAAOrgB,KAAKqgB,MAAMtO,KAAK/R,MACvByP,OAAQzP,KAAKyP,OAAOsC,KAAK/R,QAE7BA,KAAK2gG,UAAUqH,OAAOr3F,EAAMyN,cAC5BytF,EAAkB/rG,GAAGwgB,KAAKvgB,KAAKC,MAC/Bub,EAAUvb,KAAK44E,SAASr9D,QACpBvb,KAAKg0G,aACLh0G,KAAKg0G,YAAY/zF,UAErBzgB,EAAMuS,KAAKwJ,EAASvb,KAAK2gG,WACzB3gG,KAAKg0G,YAAc,GAAIx0G,GAAMqgB,GAAGo0F,UAAU14F,EAAQ0qB,KAAK,2BACnDiuE,gBAAgB,EAChBH,cAAe/zG,KAAKH,QAAQk0G,eAAiBtmG,UAGrDrE,MAAO,WACCpJ,KAAKg0G,YAAYG,aACjBtI,EAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,wBACTP,SAAW6D,MAAO1D,KAAK2gG,UAAUmT,0BAI7CrkG,OAAQ,WACJzP,KAAK2gG,UAAUxuE,IAAI,YAAa,OAChCnyB,KAAKoJ,WAGb5J,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,aAAcmB,GACjDntG,EAAM6Q,YAAYwoE,QAAQ8zB,iBAAmBA,EACzCC,EAAiBf,EAAkBlsG,QACnCC,KAAM,SAAUC,GAAV,GAiCE+4E,GAhCAzF,EAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQg2B,gBAAkBhN,CACpEgK,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,QAASyR,MAAO+hE,EAAS/hE,OAASvR,IACzEG,KAAK2gG,UAAYnhG,EAAM4hG,YACnBhwF,MAAOpR,KAAKH,QAAQuR,MACpBtF,KAAM9L,KAAKH,QAAQiM,KACnBkT,UAAWhf,KAAKH,QAAQmf,UACxBo1F,YAAap0G,KAAKH,QAAQu0G,YAC1B5xC,MAAO3iE,EAAQ6vE,YACfvwD,KACI0jD,SAAUhjE,EAAQ4vE,UAAU5M,SAC5BC,WAAYjjE,EAAQ4vE,UAAU3M,WAC9B1xD,MAAOvR,EAAQ4vE,UAAUr+D,MACzBijG,OAAQx0G,EAAQ4vE,UAAU4kC,OAC1BC,QAASz0G,EAAQ4vE,UAAU6kC,QAC3BC,SAAU10G,EAAQ4vE,UAAU8kC,SAC5BC,QAAS30G,EAAQ4vE,UAAU+kC,QAC3B1mE,KAAMjuC,EAAQ4vE,UAAU3hC,KACxB2mE,SAAUz0G,KAAKH,QAAQsf,IAAIs1F,SAC3BlxC,KAAMvjE,KAAKH,QAAQsf,IAAIokD,KACvBmxC,MAAO10G,KAAKH,QAAQsf,IAAIu1F,MACxBzF,UAAWjvG,KAAKH,QAAQsf,IAAI8vF,UAC5B0F,WAAY30G,KAAKH,QAAQsf,IAAIw1F,WAC7BC,OAAQ50G,KAAKH,QAAQsf,IAAIy1F,OACzB1F,QAASlvG,KAAKH,QAAQsf,IAAI+vF,QAC1B2F,UAAW70G,KAAKH,QAAQsf,IAAI01F,UAC5BzF,WAAYpvG,KAAKH,QAAQsf,IAAIiwF,WAC7B0F,QAAS90G,KAAKH,QAAQsf,IAAI21F,QAC1BC,QAAS/0G,KAAKH,QAAQsf,IAAI41F,SAE9B3rG,MAAOpJ,KAAKoJ,MAAM2I,KAAK/R,MACvBqgB,MAAOrgB,KAAKqgB,MAAMtO,KAAK/R,QAEvB44E,EAAS54E,KAAK44E,SAClB54E,KAAK2gG,UAAU5uF,KAAK,SAAU,SAAUmU,GACpB,cAAZA,EAAE4D,QACF9pB,KAAKmyB,IAAI,iBAAqC,SAAnBnyB,KAAKgf,WAChC45D,EAAOooB,YAGfxhG,EAAMuS,KAAK6mE,EAAOr9D,QAASvb,KAAK2gG,YAEpC9gG,SACIiM,KAAM,WACNkT,UAAW,QACXo1F,cAEQpC,YAAa,yBACbhzF,UAAW,UAGXgzF,YAAa,iCACbhzF,UAAW,SAGnBG,KACIs1F,UAAU,EACVlxC,KAAM,WACNmxC,QAEQnxC,KAAM,WACNjiE,KAAM,oBAGNiiE,KAAM,QACNjiE,KAAM,iBAGNiiE,KAAM,YACNjiE,KAAM,cAGd2tG,UAAW,KACX0F,aAEQjxG,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,KACPpC,KAAM,8BAGNoC,MAAO,QACPpC,KAAM,8BAGNoC,MAAO,QACPpC,KAAM,8BAGNoC,MAAO,SACPpC,KAAM,8BAGNoC,MAAO,UACPpC,KAAM,8BAGNoC,MAAO,YACPpC,KAAM,8BAGdszG,QACIz3F,OAAQ,SACRP,KAAM,QACNE,MAAO,QACPI,IAAK,UAETgyF,UAEQxrG,OACIyZ,OAAQ,SACRP,KAAM,QACNE,MAAO,QACPI,IAAK,UAET5b,KAAM,WAGNoC,OACIyZ,OAAQ,SACRP,KAAM,SACNE,MAAO,SACPI,IAAK,UAET5b,KAAM,WAGNoC,OACIyZ,OAAQ,MACRP,KAAM,MACNE,MAAO,MACPI,IAAK,OAET5b,KAAM,SAGduzG,WAAW,EACXzF,YAAY,EACZ0F,SAAS,EACTC,SAAS,GAEbxyG,MAAO,IACP0jB,SAAU,0oHAEd7c,MAAO,WACHyiG,EAAkB/rG,GAAGsJ,MAAMrJ,KAAKC,MAChCA,KAAKU,QAAQ,UACTN,QAAS,gBACTP,QAASG,KAAK2gG,eAI1BnhG,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,WAAYoB,GAI/CrB,EAAiB,eAAgB,mCACjCA,EAAiB,gBAAiB,oCAClCA,EAAiB,kBAAmB,sCACpCA,EAAiB,WAAY,+BAC7BA,EAAiB,uBAAwB,2CACzCA,EAAiB,qBAAsB,yCACvCA,EAAiB,kBAAmB,sCACpCA,EAAiB,qBAAsB,yCACnCsB,EAAoBpB,EAAc9rG,QAClCE,SACI0C,MAAO,IACP6O,MAAO,mBACP6U,SAAU,qnBAGlBzmB,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,cAAeqB,GAC9CC,EAAoBrB,EAAc9rG,QAClCC,KAAM,SAAUC,GACZ,GAAIszE,GAAW3zE,EAAM6Q,YAAY8iE,SAAS0F,QAAQg3B,mBAAqBhO,CACvEgK,GAAkB/rG,GAAGF,KAAKG,KAAKC,KAAMoB,EAAEzB,QAASyR,MAAO+hE,EAAS/hE,OAASvR,KAE7EA,SAAWomB,SAAU,iXAEzBzmB,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,cAAesB,GAC9CC,EAAkBlB,EAAkBlsG,QACpCE,SACIomB,SAAU,8gBACV7U,MAAOywF,EAASqO,WAAW9+F,MAC3Bk/F,WAAW,GAEfhwF,KAAM,SAAU3P,GAAV,GAGE4K,GACAy5F,EAHAz/F,EAAOvV,IACX6rG,GAAkB/rG,GAAGwgB,KAAKlX,MAAMmM,EAAMpM,WAClCoS,EAAUhG,EAAKqjE,SAASr9D,QACxBy5F,EAAQx1G,EAAM4hG,YACd+O,IAAKx/F,EAAM8B,OACXrJ,MAAO,WACE,KAAKI,KAAKwrG,EAAM7E,OACjB6E,EAAM7E,IAAM,MAEhB56F,EAAK7U,QAAQ,UACTN,QAAS,mBACTP,SAAW4S,KAAMuiG,EAAM7E,OAE3B56F,EAAK8K,SAET5Q,OAAQ,WACJulG,EAAM7E,IAAM,KACZ6E,EAAM5rG,SAEVy2F,OAAQtqF,EAAK8K,MAAMtO,KAAKwD,KAE5B/V,EAAMuS,KAAKwJ,EAASy5F,GACpBz5F,EAAQ0qB,KAAK,SAAS32B,QAAQyS,GAAG,UAAW,SAAU8F,GAChC,IAAdA,EAAGX,SACH8tF,EAAM7E,IAAM/uG,EAAEpB,MAAMoP,MACpByY,EAAGotF,kBACHptF,EAAGvP,iBACH08F,EAAM5rG,SACe,IAAdye,EAAGX,UACVW,EAAGotF,kBACHptF,EAAGvP,iBACH08F,EAAMnV,eAKtBrgG,EAAM6Q,YAAYwoE,QAAQ2yB,SAAS,YAAauB,KAClD5pG,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,2BACH,aACA,aACA,qBACDD,IACL,YACG,SAAUE,GAAV,GAIOuuD,GAGApT,CANAn7C,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9D29C,EAAW,SAAUmnD,GACrB,MAAOA,IAEPv6D,EAAwBn7C,EAAM4D,MAAMzD,QACpCC,KAAM,SAAUC,GACZG,KAAKH,QAAUL,EAAMgG,OAAO7F,UAAWK,KAAKH,QAASA,GACrDG,KAAKyX,QAAUzX,KAAKm1G,kBAAkBn1G,KAAKH,QAAQ4X,SACnDzX,KAAKoY,SACLpY,KAAKo1G,cACLp1G,KAAKq1G,UACLr1G,KAAKs1G,gBAAkB,EACvBt1G,KAAK+lB,WAAWwrB,SAEpBn5B,OAAQ,WACJpY,KAAK6R,MAAQ7R,KAAKH,QAAQgS,MAC1B7R,KAAKu1G,oBAAsBv1G,KAAKugE,aAAaxuD,KAAK/R,MAClDA,KAAKw1G,uBAAyBx1G,KAAK0gE,gBAAgB3uD,KAAK/R,MACxDA,KAAKy1G,uBAAyBz1G,KAAKwgE,gBAAgBzuD,KAAK/R,MACxDA,KAAK6R,MAAME,KAAK,SAAU/R,KAAKu1G,qBAAqBxjG,KAAK,iBAAkB/R,KAAKw1G,wBAAwBzjG,KAAK,iBAAkB/R,KAAKy1G,yBAExIj1C,gBAAiB,SAAUt6C,GACPzY,SAAZyY,EAAEzb,OACFzK,KAAK+lB,WAAWwJ,OAAOZ,KAAKoK,IAAI7S,EAAEzb,MAAQ,EAAG,QAGrDi2D,gBAAiB,SAAUx6C,GAAV,GAELH,GACAivF,CAFQvnG,UAAZyY,EAAEzb,QACEsb,EAAa/lB,KAAK+lB,WAClBivF,EAAQjvF,EAAWyB,OAAOtB,EAAEzb,MAAQ,GACpCuqG,GACAjvF,EAAWtW,OAAOulG,KAI9BK,QAAS,WACLr1G,KAAK6R,MAAM+C,MAAM,WACb5U,KAAKyX,QAAQ7F,QAAQ,SAAU8I,EAAQjQ;AACnCzK,KAAK6R,MAAMlB,MAAM,EAAGlG,GAAO/G,MAAMgX,EAAOtJ,QAC1CW,KAAK/R,QACT+R,KAAK/R,QAEXugE,aAAc,SAAUr6C,GAAV,GAKFH,GACAzb,EACAmN,EACAi+F,EAOAC,EAQAC,EACA7tG,CAvBJme,GAAElJ,WAAakJ,EAAEhI,WAGjBgI,EAAEvN,QAAUuN,EAAExU,MACVqU,EAAa/lB,KAAK+lB,WAClBzb,EAAOyb,EAAWyB,OAClB/P,EAAUzX,KAAKyX,QAEfsO,EAAW0rC,OAAOujD,QAClBU,EAAS3vF,EAAW0rC,OAAOujD,MAAMU,SAEhCj+F,EAAQ5W,QAAUyJ,EAAKzJ,SACxB4W,EAAUzO,OAAOiY,KAAK3W,EAAK,GAAG+9B,WAE9BstE,EAAUl+F,EAAQ9T,IAAI,SAAU+W,GAChC,GAAIoP,GAAQpP,EAAOoP,KACnB,OAAIA,IAAS4rF,GAAUA,EAAO5rF,IAAgC,QAAtB4rF,EAAO5rF,GAAOvY,KAC3C/R,EAAM6Q,YAAYu3B,aAEtBmmB,IAEX/tD,KAAK61G,aAAc,EACfD,EAAgB51G,KAAK6R,MAAMwpB,MAAMtD,UAAU7R,EAAExU,KAC7C3J,EAAS/H,KAAK6R,MAAMlB,MAAMilG,GAAe7tG,SAC7C6tG,EAAchkG,QAAQ,SAAUF,GAAV,GAEdokG,GACAC,EACK/xE,EAMDgyE,EACK/xE,CAPb,KAHAvyB,EAAMA,EAAII,aAENikG,EAAa,EACR/xE,EAAKtyB,EAAI2C,QAAQC,IAAK0vB,GAAMtyB,EAAI6kB,YAAYjiB,IAAK0vB,IAAM,CAO5D,IANA8xE,EAASxrG,EAAK05B,EAAK,GACd8xE,IACDA,EAAS/vF,EAAWwJ,OAAOyU,EAAK,MAChC15B,EAAOyb,EAAWyB,QAElBwuF,EAAgB,EACX/xE,EAAKvyB,EAAI2C,QAAQS,IAAKmvB,GAAMvyB,EAAI6kB,YAAYzhB,KAAOmvB,EAAKxsB,EAAQ5W,OAAQojC,IAC7E6xE,EAAO3jF,IAAI1a,EAAQwsB,GAAIna,MAAO6rF,EAAQ1xE,GAAIl8B,EAAOguG,GAAYC,MAEjED,QAGR/1G,KAAKs1G,gBAAkBvvF,EAAWyB,OAAO3mB,OACzCb,KAAK61G,aAAc,IAG3BV,kBAAmB,SAAU19F,GACzB,MAAOA,GAAQ9T,IAAI,SAAU+W,GACzB,GAAIoP,GAAQpP,EAAOoP,OAASpP,CAC5B,QACIoP,MAAOA,EACP1Y,MAAOsJ,EAAOtJ,OAAS0Y,MAInCsrF,YAAa,WAAA,GACLv1G,GAAUG,KAAKH,QACfkmB,EAAalmB,EAAQkmB,UACzBA,GAAaoS,MAAMsT,QAAQ1lB,IAAgBzb,KAAMyb,GAAeA,EAC5D/lB,KAAK+lB,YAAc/lB,KAAKi2G,eACxBj2G,KAAK+lB,WAAWu6C,OAAO,SAAUtgE,KAAKi2G,gBAEtCj2G,KAAKi2G,eAAiBj2G,KAAKugG,QAAQxuF,KAAK/R,MAE5CA,KAAK+lB,WAAavmB,EAAM8K,KAAKib,WAAWtc,OAAO8c,GAAYhU,KAAK,SAAU/R,KAAKi2G,iBAEnF1V,QAAS,WAAA,GAIDj2F,GACAmN,EAKAk+F,CATA31G,MAAK61G,cAGLvrG,EAAOtK,KAAK+lB,WAAWyB,OACvB/P,EAAUzX,KAAKyX,SACdA,EAAQ5W,QAAUyJ,EAAKzJ,SACxBb,KAAKyX,QAAUA,EAAUzX,KAAKm1G,kBAAkBnsG,OAAOiY,KAAK3W,EAAK,GAAG+9B,WACpEroC,KAAKq1G,WAELM,EAAUl+F,EAAQ9T,IAAI,SAAU+W,GAChC,MAAOlb,GAAMyyG,OAAOv3F,EAAOoP,SAE/B9pB,KAAK6R,MAAM+C,MAAM,WAAA,GAEJwV,GACI8rF,EACDxyG,EAHR7C,EAAS8tB,KAAKoK,IAAIzuB,EAAKzJ,OAAQb,KAAKs1G,gBACxC,KAASlrF,EAAM,EAAGA,EAAMvpB,EAAQupB,IAC5B,IAAS8rF,EAAY,EAAGA,EAAYP,EAAQ90G,OAAQq1G,IAC5CxyG,EAAQ4G,EAAK8f,GAAOurF,EAAQO,GAAW5rG,EAAK8f,IAAQ,KACxDpqB,KAAK6R,MAAMlB,MAAMyZ,EAAM,EAAG8rF,GAAWxyG,MAAMA,IAGrDqO,KAAK/R,OACPA,KAAKs1G,gBAAkBhrG,EAAKzJ,SAEhCof,QAAS,WACLjgB,KAAK+lB,WAAWu6C,OAAO,SAAUtgE,KAAKi2G,gBACtCj2G,KAAK6R,MAAMyuD,OAAO,SAAUtgE,KAAKu1G,qBAAqBj1C,OAAO,YAAatgE,KAAKw1G,wBAAwBl1C,OAAO,YAAatgE,KAAKy1G,yBAEpI51G,SAAW4X,cAEfjY,EAAM6Q,YAAYsqC,sBAAwBA,IAC5Cn7C,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,0BACH,aACA,cACA,iBACA,uBACA,mBACA,wBACDD,IACL,YACG,SAAUE,GAkIP,QAAS22G,GAAepuG,GAAxB,GAGa5F,GAFLC,KACAyD,IACJ,KAAS1D,EAAI,EAAGA,EAAI4F,EAAOlH,OAAQsB,IAC1BC,EAAK2F,EAAO5F,GAAGuB,QAGRtB,EAAK2F,EAAO5F,GAAGuB,OAAOokG,SAAW//F,EAAO5F,GAAG2lG,UACnD1lG,EAAK2F,EAAO5F,GAAGuB,OAAOokG,SAAU,IAHhC1lG,EAAK2F,EAAO5F,GAAGuB,OAASqE,EAAO5F,GAC/B0D,EAAO1F,KAAK4H,EAAO5F,IAK3B,OAAO0D,GAEX,QAAS0U,GAAOwL,EAAYqwF,GAA5B,GAKaj0G,GACDymD,EACAtnD,EACA+0G,EACAC,EACAC,EATJC,GAAqB,EACrBlsG,EAAOyb,YAAsBvmB,GAAM8K,KAAKmsG,wBAA0B1wF,EAAWzb,OAC7EosG,EAAe12G,KACf+H,EAAS/H,KAAK+H,MAClB,KAAS5F,EAAI,EAAGA,EAAImI,EAAKzJ,OAAQsB,IACzBymD,EAAOt+C,EAAKnI,GACZb,GAAOsnD,GAAAA,EAAKtnD,MAAgBiH,cAC5B8tG,EAAcD,KAAU,GAAkB,KAAVA,GAAgB90G,EAAK+rB,QAAQ+oF,IAAU,EACvEE,EAAe/7F,EAAOxI,KAAK2kG,GAC3BH,EAAqBD,EAAa1tD,EAAKvC,SAAU+vD,GACrDI,EAAqBA,GAAsBD,GAAsBF,EACjEztD,EAAK9N,QAAUu7D,IAAgBE,EAC3BH,EAAMv1G,QAAUkH,IAAWA,EAAOlH,OAClC+nD,EAAKk/C,SAAWl/C,EAAK9N,OACd/yC,GAAUA,EAAOslB,QAAQu7B,EAAKtnD,YACrCsnD,EAAKk/C,SAAU,EAUvB,OAPIx9F,IACAyb,EAAWxL,QACPuP,MAAO,SACPC,SAAU,MACVrmB,OAAO,IAGR8yG,EAEX,QAASG,GAAW5wF,GAApB,GAEa5jB,GACDymD,EAFJt+C,EAAOyb,YAAsBvmB,GAAM8K,KAAKmsG,wBAA0B1wF,EAAWzb,MACjF,KAASnI,EAAI,EAAGA,EAAImI,EAAKzJ,OAAQsB,IACzBymD,EAAOt+C,EAAKnI,GAChBymD,EAAKk/C,SAAU,EACXl/C,EAAKguD,aACLD,EAAW/tD,EAAKvC,UA6E5B,QAASwwD,GAAiBC,GAA1B,GAGavlG,GAIIwY,EANTopD,EAAW4jC,EAAoBD,UAC/BjxG,IACJ,KAAS0L,IAAQulG,GACb,GAAKA,EAAU9L,eAAez5F,GAG9B,IAASwY,IAAY+sF,GAAUvlG,GACtBulG,EAAUvlG,GAAMy5F,eAAejhF,IAGpClkB,EAAO1F,MACHmB,KAAM6xE,EAAS5hE,GAAMwY,GACrBrmB,MAAOqmB,EACPyH,OAAQjgB,EAAO,IAAMwY,EACrBxY,KAAMA,GAIlB,OAAO1L,GAjRd,GAIOzE,GACA0e,EACAJ,EAgBAs3F,EA6BAD,EAyEAE,EAyDAC,EA8FAC,EAsHA/+B,CAxYA54E,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVsa,EAAStgB,EAAMqgB,GAAGC,OAClBJ,GACA03F,QAAS,YACT7oF,OAAQ,WACR8oF,eAAgB,oBAChBC,eAAgB,oBAChBtkC,KAAM,SACNukC,aAAc,0BACdC,WAAY,qBACZC,WAAY,WACZC,QAAS,YACT93F,QAAS,4BACT+3F,kBAAmB,iCACnBC,cAAe,6BACfC,sBAAuB,uCACvBC,cAAe,oBAEfd,EAAUl3F,EAAOngB,QACjBC,KAAM,SAAU2b,EAAS1b,GACrBigB,EAAOhgB,GAAGF,KAAKG,KAAKC,KAAMub,EAAS1b,GACnCG,KAAKub,QAAQpM,SAASipE,EAAW14D,WAAW03F,SAC5Cp3G,KAAK+3G,SAAW/3G,KAAKub,QAAQ0qB,KAAK,IAAMmyC,EAAW14D,WAAW23F,gBAAgBt1F,GAAG,QAAS/hB,KAAKg4G,QAAQjmG,KAAK/R,MAC5G,IAAIgmG,GAAYnmG,EAAQi5C,SAAWs/B,EAAW14D,WAAW63F,aAAen/B,EAAW14D,WAAW83F,UAC9Fx3G,MAAKi4G,MAAQ72G,EAAE,YAAco/F,QAASpoB,EAAW14D,WAAWszD,KAAO,IAAMgzB,IAAanwB,UAAU71E,KAAK+3G,UACrG/3G,KAAKk4G,WAAa14G,EAAMuU,KAAK/T,KAAK+3G,SAAS/jE,QAAQ,GAC9Cn0C,EAAQi5C,UACT94C,KAAKk4G,WAAWluF,QAGxBnqB,SAAWiM,KAAM,WACjB5L,QAAS,UACTunB,QAAS,WACL,MAAOznB,MAAKH,QAAQi5C,UAExBlvB,OAAQ,SAAUD,GACd,GAAIi+B,GAAYpoD,EAAM24G,GAAGn4G,KAAKk4G,YAAYE,OAAO,WACjDxwD,GAAUgO,OAAOjsC,EAAO,UAAY,UACpC3pB,KAAKi4G,MAAMh1F,YAAYm1D,EAAW14D,WAAW83F,WAAY7tF,GAAM1G,YAAYm1D,EAAW14D,WAAW63F,cAAe5tF,GAChH3pB,KAAKH,QAAQi5C,UAAYnvB,GAE7BquF,QAAS,WACL,GAAIruF,GAAO3pB,KAAKynB,SAChBznB,MAAK4pB,OAAOD,GACZ3pB,KAAKU,QAAQ,UAAYipB,KAAMA,OAGnCotF,EAAsBv3G,EAAM6Q,YAAY8iE,SAAS1E,YACjD4pC,cAAe,oBACfC,eAAgB,oBAChBV,cAAe,kBACfD,kBAAmB,sBACnBvuG,MAAO,QACPmvG,OAAQ,SACRC,aAAc,2BACdv4G,MAAO,QACP83D,OAAQ,WACR0gD,aAAc,OACd9hD,IAAK,MACLkJ,GAAI,KACJi3C,WACIzpB,QACIn1D,SAAU,gBACVwgF,eAAgB,wBAChBC,WAAY,mBACZC,SAAU,iBACV73D,QAAS,eACT83D,aAAc,uBAElB/qE,MACIxyB,GAAI,UACJw9F,IAAK,cACLpqG,GAAI,iBACJC,GAAI,iBAER8gD,QACIn0C,GAAI,cACJw9F,IAAK,kBACLC,IAAK,8BACLpqG,GAAI,kBACJqqG,IAAK,2BACLtqG,GAAI,kBAIhBlP,EAAM8K,KAAK2uG,QAAQC,uBAAyB15G,EAAM8K,KAAK6uG,OAAOx5G,QAC1DC,KAAM,SAAU2b,EAAS69F,EAAUv5G,GAC/BL,EAAM8K,KAAK6uG,OAAOr5G,GAAGF,KAAKG,KAAKC,KAAMub,EAAS69F,EAAUv5G,GACxDG,KAAKugG,QAAUn/F,EAAEi4G,MAAMr5G,KAAK6lB,OAAQ7lB,MACpCoB,EAAEpB,KAAKub,SAASwG,GAAG,SAAU/hB,KAAKugG,UAEtCl/B,QAAS,WACL,GAAIjpC,GAAOp4B,KAAM0D,EAAQ00B,EAAKghF,SAASF,uBAAuBj1G,KAC9D7C,GAAEg3B,EAAK7c,SAASnM,IAAI1L,YAAiBoG,MAAO,GAAKpG,IAErDmiB,OAAQ,WACJ,GAAIniB,GAAQ1D,KAAKub,QAAQ7X,KACzB1D,MAAKo5G,SAASF,uBAAuB/mF,IAAIzuB,MAGjDlE,EAAM8K,KAAK2uG,QAAQK,OAAOJ,uBAAyB15G,EAAM8K,KAAK6uG,OAAOx5G,QACjEC,KAAM,SAAU05G,EAAQF,EAAUv5G,GAC9BL,EAAM8K,KAAK6uG,OAAOr5G,GAAGF,KAAKG,KAAKC,KAAMs5G,EAAO/9F,QAAQ,GAAI69F,EAAUv5G,GAClEG,KAAKs5G,OAASA,EACdt5G,KAAKugG,QAAUn/F,EAAEi4G,MAAMr5G,KAAK6lB,OAAQ7lB,MACpCA,KAAKs5G,OAAO/oF,MAAM,SAAUvwB,KAAKugG,UAErCl/B,QAAS,WACL,GAAIk4C,GAAUv5G,KAAKo5G,SAASF,uBAAwBx1G,EAAQ61G,EAAQt1G,MAAOsN,EAAOnQ,EAAEpB,KAAKs5G,OAAO/9F,SAASjR,KAAK,aAE1GtK,MAAKs5G,OAAO51G,MADH,SAAT6N,GAAmB7N,YAAiBoG,OAAiB,WAATyH,IAAsBhE,MAAM7J,GACtDA,EAEA,OAG1BmiB,OAAQ,WACJ,GAAIniB,GAAQ1D,KAAKs5G,OAAO51G,QAAS61G,EAAUv5G,KAAKo5G,SAASF,sBACzDK,GAAQpnF,IAAIzuB,MAGhBuzG,GACAW,cAAe,eAAkBl4F,EAAW23F,eAAiB,kDAA2D33F,EAAW43F,eAAiB,kaAA0d53F,EAAWm4F,sBAAwB,iMACjpBF,kBAAmB,eAAkBj4F,EAAW23F,eAAiB,sDAA+D33F,EAAW43F,eAAiB,4zBAC5JkC,SAAU,4GACV1B,cAAe,gLAqDfZ,EAAsB13G,EAAM6Q,YAAY6mG,oBAAsB13G,EAAM8K,KAAKqhG,iBAAiBhsG,QAC1F85G,aAAc,SAAUvzF,GAAV,GACNH,GAAaG,EAAIA,EAAEmiC,OAAOtiC,WAAa/lB,KAAK05G,iBAC5C5R,EAAU,SAAUl/C,GACpB,MAAOA,GAAKk/C,SAEZpkG,EAAQ,SAAUklD,GAClB,MAAyB,SAAlBA,EAAKhT,SAAsBp2C,EAAM6Q,YAAYmiB,aAAao2B,EAAKllD,OAASklD,EAAKllD,OAEpF8tB,EAAS,SAAU9tB,EAAO+G,EAAOgtC,GACjC,MAAOA,GAAMkiE,YAAYj2G,KAAW+G,GAEpCH,EAAOyb,EAAWzb,OAClBvC,EAASuC,EAAK,GAAG+7C,SAAS/7C,OAAO+9B,SACjC0vB,EAAShwD,EAAOwS,OAAO,SAAUquC,GACjC,MAAyB,UAAlBA,EAAKhT,UAEhBmiB,KAASA,EAAOl3D,QAASk3D,EAAO,GAAG+vC,QACnC//F,EAASA,EAAOwS,OAAOutF,GAASnkG,IAAID,GAChC1D,KAAK45G,gBAAkB55G,KAAKkb,aAAelb,KAAKkb,YAAYnT,OAAOlH,SACnEkH,EAASA,EAAO2uB,OAAO12B,KAAKkb,YAAYnT,OAAOsgC,UAAUtmC,OAAOwY,OAAOiX,IAE3ExxB,KAAKmyB,IAAI,eACLpqB,OAAQA,EACRgwD,OAAQA,KAGhB8hD,YAAa,SAAU3zF,GACnBA,EAAE5N,gBACF,IAAIgL,GAAO4C,EAAEmiC,OAAO4gD,SAAS/iF,EAAE5C,KAC/BA,GAAK6O,IAAI,WAAY7O,EAAKwkF,UAE9BgS,iBAAiB,EACjBF,gBAAgB,EAChBG,aAAc,SAAU7zF,GAAV,GAINowF,GAHAF,EAAoB,gBAALlwF,GAAgBA,EAAI9kB,EAAE8kB,EAAEjU,QAAQ7C,MAAM7G,cACrDwd,EAAa/lB,KAAK05G,gBACtB15G,MAAKmyB,IAAI,oBAAqBikF,GAC1BE,EAAe/7F,EAAOxI,KAAK/R,KAAKkb,aACpCy7F,EAAW5wF,GACXuwF,EAAavwF,EAAYqwF,IAE7BniE,MAAO,WACHj0C,KAAKmyB,IAAI,gBACL0lC,MAAO,MACPC,WACQ/tC,SAAU,KACVrmB,MAAO,SAGnB1D,KAAKmyB,IAAI,eAAiBpqB,aAE9BiyG,eAAgB,SAAU9zF,GACtB,GAAI+iF,GAAW/iF,EAAEmiC,OAAO4gD,UACxBjpG,MAAKmyB,IAAI,eAAgB82E,EAAS13F,MAC7BvR,KAAKiE,IAAI,iBACVjE,KAAKi0C,QAETj0C,KAAKmyB,IAAI,oCAAqC82E,EAASvlG,QAE3Du2G,OAAQ,WACJ,MAAoCxsG,UAA7BzN,KAAKiE,IAAI,iBAEpBi2G,SAAU,WACN,MAAoC,WAA7Bl6G,KAAKiE,IAAI,iBAEpBkvG,SAAU,WACN,MAAoC,WAA7BnzG,KAAKiE,IAAI,iBAEpBsvG,OAAQ,WACJ,MAAoC,SAA7BvzG,KAAKiE,IAAI,mBAwBpBkzG,EAAuB33G,EAAM6Q,YAAY8mG,sBACzCgD,WAAY,SAAUxpG,EAAO+J,GACzB,QACQpZ,KAAM,MACNw3C,UAAU,EACVgvD,SAAS,EACTz1C,MAAOryD,KAAK+H,OAAO4I,EAAMgM,QAASO,IAAK,IAAMxC,MAGzD3S,OAAQ,SAAU4I,EAAO+J,GAAjB,GACA3S,MACAorE,EAAW4jC,EACX95E,EAActsB,EAAM+J,OAAOA,GAC3B7I,EAAQlB,EAAMkB,OAkDlB,OAjDAorB,GAAYpoB,YAAY,SAAUP,EAAKQ,EAAKC,GAApB,GAKhBrR,GACAkyC,EACAt0C,EANAwmG,GAAU,CACVj2F,GAAMsuB,YAAY7rB,KAClBwzF,GAAU,GAEVpkG,EAAQqR,EAAKrR,MACbkyC,EAAW7gC,EAAK6gC,SAChBt0C,EAAOyT,EAAKzT,KAEZs0C,EADUnoC,SAAV/J,EACW,QACJqR,EAAKC,OACDxV,EAAM6Q,YAAYsE,WAAWpD,KAAK7N,EAAOqR,EAAKC,cAEvCtR,GAGlBpC,EADU,OAAVoC,GAAkBqR,EAAKC,OAChBxV,EAAM6Q,YAAYsE,WAAWrT,KAAKoC,EAAOqR,EAAKC,QAElC,SAAZ4gC,EAAsBu9B,EAASpb,OAASr0D,EAElC,YAAbkyC,GAAuC,aAAbA,IAC1BA,EAAW,UAEE,SAAbA,IACAlyC,EAAQlE,EAAM6Q,YAAYu3B,aAAalkC,IAE3CqE,EAAO5H,MACHy1C,SAAUA,EACVlyC,MAAOA,EACPpC,KAAMA,EACNwmG,QAASA,MAGjB//F,EAASouG,EAAepuG,GACxBA,EAAOhG,KAAK,SAAUgJ,EAAGiZ,GACrB,MAAIjZ,GAAE6qC,WAAa5xB,EAAE4xB,SACV,EAEQ,UAAf7qC,EAAE6qC,UAAuC,UAAf5xB,EAAE4xB,SACN,UAAf7qC,EAAE6qC,YAA4B,EAEtB,WAAf7qC,EAAE6qC,UAAwC,WAAf5xB,EAAE4xB,SACP,WAAf7qC,EAAE6qC,YAA6B,EAEvB,SAAf7qC,EAAE6qC,UAAsC,SAAf5xB,EAAE4xB,SACL,SAAf7qC,EAAE6qC,YAA2B,EAEjC,IAEJ7tC,GAEXqyG,WAAY,SAAUzpG,EAAO+J,GAAjB,GAGJnJ,GAGI7N,EAUA22G,EAfJxoG,EAAQlB,EAAMkB,QACd0I,EAASva,KAAKs6G,gBAAgB5/F,EAAQ7I,EAoB1C,OAlBA0I,GAASA,GAAUA,EAAOA,OAAO8tB,SAC7B9tB,GAA2B,UAAjBA,EAAOA,SACb7W,EAAQ6W,EAAOu9C,SAAS,GAAGp0D,MAC3BA,YAAiBoG,MACjByH,EAAO,OACgB,gBAAT7N,GACd6N,EAAO,SACgB,gBAAT7N,KACd6N,EAAO,WAGVA,IACG8oG,EAAWr6G,KAAK+H,OAAO4I,EAAM2D,IAAI,GAAIoG,GAAQ,GACjDnJ,EAAO8oG,GAAYA,EAASzkE,SAChB,SAARrkC,IACAA,EAAO,OAGRA,GAEX+oG,gBAAiB,SAAU5/F,EAAQ7I,GAAlB,GAETgjD,GADA0lD,EAAa1oG,EAAM0I,QAOvB,OALIggG,KACA1lD,EAAU0lD,EAAW9iG,QAAQ8C,OAAO,SAAUquC,GAC1C,MAAOA,GAAKn+C,QAAUiQ,IACvB,IAEAm6C,GAEXt6C,OAAQ,SAAUG,EAAQ7I,GAAlB,GAKAhS,GACA0R,EAEA1L,EAIAiyD,EAXA0iD,EAAgBx6G,KAAKs6G,gBAAgB5/F,EAAQ7I,EACjD,IAAK2oG,EAcL,MAXI36G,GAAU26G,EAAcjgG,OAAO8tB,SAC/B92B,EAAO1R,EAAQ0a,aACZ1a,GAAQ0a,OACX1U,GACA0L,KAAMA,EACN1R,QAASA,GAETi4D,EAAWj4D,EAAQi4D,SACnBA,GAAYA,EAASj3D,SACrBgF,EAAOkkB,SAAW+tC,EAAS,GAAG/tC,UAE3BlkB,IAGXuyE,EAAat4D,EAAOngB,QACpBC,KAAM,SAAU2b,EAAS1b,GACrBigB,EAAO/f,KAAKC,KAAMub,EAAS1b,GAC3BG,KAAKub,QAAQpM,SAASipE,EAAW14D,WAAWE,SAC5C5f,KAAK2gG,UAAY,GAAIuW,IACjBnrF,OAAQ,QACRhC,SAAU,KACV+sF,UAAWD,EAAiB72G,KAAKH,QAAQi3G,WACzC72G,MAAOD,KAAKC,MAAM8R,KAAK/R,MACvBoJ,MAAOpJ,KAAKoJ,MAAM2I,KAAK/R,QAE3BA,KAAKy6G,cACLz6G,KAAKqiB,SACLriB,KAAKggD,QACLhgD,KAAK06G,qBACL16G,KAAK26G,iBACL36G,KAAK46G,kBAET/6G,SACIiM,KAAM,aACN4O,OAAQ,EACR/J,MAAO,KACPmmG,WACIzpB,QACIn1D,SAAU,gBACVwgF,eAAgB,wBAChBC,WAAY,mBACZC,SAAU,iBACV73D,QAAS,eACT83D,aAAc,uBAElB/qE,MACIxyB,GAAI,UACJw9F,IAAK,cACLpqG,GAAI,iBACJC,GAAI,iBAER8gD,QACIn0C,GAAI,cACJw9F,IAAK,kBACLC,IAAK,8BACLpqG,GAAI,kBACJqqG,IAAK,2BACLtqG,GAAI,kBAIhBxO,QAAS,UACT+f,QAAS,WACLH,EAAOhgB,GAAGmgB,QAAQlgB,KAAKC,MACvBA,KAAKgsE,KAAK/rD,UACVjgB,KAAK66G,eAAe56F,UACpBjgB,KAAK4mB,MAAM3G,WAEf0uD,QAAS,SAAU7nD,GACf9mB,KAAK4mB,MAAMk4D,YAAah4D,OAAQA,IAChC9mB,KAAK4mB,MAAMtG,QAEfD,MAAO,WACHrgB,KAAK4mB,MAAMvG,SAEfpgB,MAAO,WACHD,KAAKu+B,QACDn+B,QAAS,qBACTP,SAAW6a,OAAQ1a,KAAKH,QAAQ6a,UAEpC1a,KAAK2gG,UAAU1sD,QACfj0C,KAAKqgB,SAETjX,MAAO,WAAA,GAECvJ,GAIAqb,EACAE,CANJpb,MAAK86G,UACDj7G,GACA0+C,eAAgBv+C,KAAKH,QAAQ8Q,MAC7B+J,OAAQ1a,KAAKH,QAAQ6a,QAIK,UAA1B1a,KAAK2gG,UAAU50E,QACf/rB,KAAK2gG,UAAU8Y,cAAepxD,OAAQroD,KAAK66G,iBAC3C3/F,EAAclb,KAAK2gG,UAAUzlF,YAAYmtB,UACrCntB,EAAY68C,QAAU78C,EAAYnT,QAAUmT,EAAYnT,OAAOlH,UAC/DhB,EAAQqb,YAAcA,IAEO,WAA1Blb,KAAK2gG,UAAU50E,SACtB3Q,EAAepb,KAAK2gG,UAAUvlF,aAAaitB,SACvCjtB,EAAa08C,SAASj3D,QAA6C,OAAnCua,EAAa08C,SAAS,GAAGp0D,QACzD7D,EAAQub,aAAeA,KAG3Bvb,EAAQqb,aAAerb,EAAQub,eAC/Bpb,KAAKu+B,QACDn+B,QAAS,qBACTP,QAASA,KAIrB0+B,OAAQ,SAAU1+B,GACdG,KAAKU,QAAQ,SAAUU,EAAEzB,UAAWE,KAExC46G,YAAa,WAAA,GAMDL,GALJ1/F,EAAS1a,KAAKH,QAAQ6a,OACtB/J,EAAQ3Q,KAAKH,QAAQ8Q,MACrBkB,EAAQlB,EAAMkB,QACdkpG,EAAe5D,EAAqB58F,OAAOG,EAAQ7I,EACnDkpG,IACIX,EAAajD,EAAqBiD,WAAWzpG,EAAO+J,GACxD1a,KAAK2gG,UAAUxuE,IAAI,SAAU4oF,EAAaxpG,MAC1CvR,KAAK2gG,UAAUxuE,IAAI4oF,EAAaxpG,KAAO,SAAUwpG,EAAal7G,SACrC,UAArBk7G,EAAaxpG,OACbvR,KAAK2gG,UAAUxuE,IAAI,WAAYioF,EAAa,IAAMW,EAAahxF,UAC/D/pB,KAAK2gG,UAAUxuE,IAAI,eAAgBioF,KAGvCp6G,KAAK2gG,UAAU1sD,SAGvB5xB,OAAQ,WACJriB,KAAK4mB,MAAQ5mB,KAAKub,QAAQojE,YAAaq8B,kBAAkB,IAAS1wG,KAAK,eAE3E01C,MAAO,WAAA,GACC/5B,GAAWzmB,EAAMymB,SAASmyD,EAAW6+B,UAAUuC,UAC/CrmC,EAAW4jC,EACX1kD,IAEIjyD,QAAS,OACT66G,IAAK,MACL35G,KAAM6xE,EAASklC,cACfrS,UAAW,aAGX5lG,QAAS,OACT66G,IAAK,OACL35G,KAAM6xE,EAASmlC,eACftS,UAAW,cAGfj/C,EAAK3lD,EAAE,UAAY6N,KAAQzP,EAAMqkD,OAAO59B,EAAUosC,KAAUhjD,SAASrP,KAAKub,QAC9Evb,MAAKgsE,KAAOjlB,EAAGm0D,WACX/L,YAAa,WACb5/F,OAAQ,SAAU2W,GAAV,GACA+0F,GAAM75G,EAAE8kB,EAAE0iC,MAAMt+C,KAAK,OACrBqG,EAAQ3Q,KAAKH,QAAQ8Q,MAAMgM,QAASO,IAAK,IACzCrd,GACA6D,MAAOu3G,EACPppG,OAAO,EACP0sC,eAAgB5tC,EAChB+J,OAAQ1a,KAAKH,QAAQ6a,OAErB/J,GAAM04B,aACNrpC,KAAKu+B,QACDn+B,QAAS,cACTP,QAASA,IAGbG,KAAKqgB,SAEXtO,KAAK/R,QACRsK,KAAK,cAEZ6wG,gBAAiB,SAAUl1F,EAAU8e,EAAWqyE,EAASt+D,GAAxC,GACTsiE,GAAmB57G,EAAMymB,SAASA,GAClCrG,EAAUxe,EAAE,eAAkB2jC,EAAY,OAAQ91B,KAAKmsG,GACvDjoC,SAAU4jC,EACV9xE,KAAMzlC,EAAMylC,OACZjkB,GAAIxhB,EAAMwhB,KAUd,OARAhhB,MAAKub,QAAQ6xD,OAAOxtD,GAChBw3F,IACAA,EAAU,GAAIJ,GAAQp3F,GAClBk5B,SAAUA,EACVlvB,OAAQ5pB,KAAKq7G,cAActpG,KAAK/R,SAGxCR,EAAMuS,KAAK6N,EAAS5f,KAAK2gG,WAClB/gF,GAEXy7F,cAAe,SAAUn1F,GACrBlmB,KAAKub,QAAQ0qB,KAAK,uBAAuBq1E,IAAIp1F,EAAEmiC,OAAO9sC,SAASjR,KAAK,gBAAgBsf,QAAQ1D,EAAEyD,OAElG+wF,mBAAoB,WAChB,GAAIa,GAAuC,WAA1Bv7G,KAAK2gG,UAAU50E,MAChC/rB,MAAKm7G,gBAAgB/iC,EAAW6+B,UAAUU,kBAAmBv/B,EAAW14D,WAAWi4F,mBAAmB,EAAM4D,IAEhHZ,eAAgB,WAAA,GAIR5yG,GAHAwzG,EAAuC,UAA1Bv7G,KAAK2gG,UAAU50E,OAC5BnM,EAAU5f,KAAKm7G,gBAAgB/iC,EAAW6+B,UAAUW,cAAex/B,EAAW14D,WAAWk4F,eAAe,EAAM2D,EAClHv7G,MAAK66G,eAAiBj7F,EAAQqmB,KAAK,wBAAwB37B,KAAK,iBAC5DvC,EAASovG,EAAqBgD,WAAWn6G,KAAKH,QAAQ8Q,MAAO3Q,KAAKH,QAAQ6a,QAC9E1a,KAAK2gG,UAAUxuE,IAAI,mBAAoB,GAAI3yB,GAAM8K,KAAKmsG,wBAAyBnsG,KAAMvC,MAEzF6yG,eAAgB,WACZ56G,KAAKm7G,gBAAgB/iC,EAAW6+B,UAAUa,cAAe1/B,EAAW14D,WAAWo4F,eAAe,IAElGgD,QAAS,WACL,GAAIU,GAAkBx7G,KAAKub,QAAQ0qB,KAAK,uBAAuB1rB,OAAO,SAAU9P,EAAO8Q,GACnF,MAAOna,GAAEma,GAASjR,KAAK,gBAAgBmd,WAEvC+zF,GAAgBC,SAASrjC,EAAW14D,WAAWk4F,eAC/C53G,KAAK2gG,UAAUxuE,IAAI,SAAU,SACtBqpF,EAAgBC,SAASrjC,EAAW14D,WAAWi4F,oBACtD33G,KAAK2gG,UAAUxuE,IAAI,SAAU,aAIzC3yB,EAAM6Q,YAAY+nE,WAAaA,EAC/Bh3E,EAAEzB,QAAO,EAAMy4E,GACX14D,WAAYA,EACZu3F,UAAWA,MAEjB9zG,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,sBAAuB,cAAeD,IAC/C,YACG,SAAUE,GAoIP,QAASi5D,GAASijD,EAASC,GACvB,MAAOD,KAAYA,EAAQx+F,MAAQy+F,EAAQz+F,KAAOw+F,EAAQ9+F,OAAS++F,EAAQ/+F,MApI/E,KAAIpd,EAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,GAAlE,CAGA,GAAI0kE,GAAct1E,EAAME,WAAWC,QAC/BC,KAAM,SAAU4nB,GACZhoB,EAAME,WAAWI,GAAGF,KAAKG,KAAKC,MAC9BA,KAAKwnB,KAAOA,EACZxnB,KAAKq1E,WAAa7tD,EAAK6tD,WACvBr1E,KAAK86G,SAAU,EACf96G,KAAK47G,SAAWp0F,EAAK6tD,WAAWt1D,aAChC/f,KAAK67G,UAAYr0F,EAAKzH,aACtB/f,KAAK47G,SAAS1wF,SAASlrB,KAAK67G,WAC5B77G,KAAK67G,UAAU3wF,SAASlrB,KAAK47G,UAC7B57G,KAAK47G,SAAS7pG,KAAK,QAAS/R,KAAK87G,eAAe/pG,KAAK/R,OACrDA,KAAK67G,UAAU9pG,KAAK,QAAS/R,KAAK87G,eAAe/pG,KAAK/R,OACtDA,KAAK47G,SAAS7pG,KAAK,OAAQ/R,KAAKyiB,MAAM1Q,KAAK/R,OAC3CA,KAAK67G,UAAU9pG,KAAK,OAAQ/R,KAAKyiB,MAAM1Q,KAAK/R,QAEhDE,QACI,WACA,aACA,SACA,UAEJuiB,MAAO,WACHziB,KAAK8pE,cAETgyC,eAAgB,WACZ97G,KAAKU,QAAQ,UAAYgD,MAAO1D,KAAK0D,WAEzCspE,aAAc,WAAA,GACNzE,GAAS,KACTq+B,EAAgBpnG,EAAMqqB,gBAM1B,OALI7pB,MAAKwpE,aAAa,KAAOo9B,EACzBr+B,EAASvoE,KAAK47G,SACP57G,KAAK0pE,cAAc,KAAOk9B,IACjCr+B,EAASvoE,KAAK67G,WAEXtzC,GAEX5xD,SAAU,SAAU9W,GAUhB,MATAG,MAAK86G,SAAU,EACf96G,KAAK+7G,MAAQl8G,EAAQkvE,KACrB/uE,KAAK6Q,OAAShR,EAAQ8Q,MACtB3Q,KAAK67G,UAAUzyF,SAASvpB,EAAQkvE,MAChC/uE,KAAK67G,UAAUl/F,OAAO9c,EAAQkvE,MAC9B/uE,KAAK67G,UAAUpyF,QAAQ5pB,EAAQ4pB,SAC/BzpB,KAAK67G,UAAUjlG,WAAa5W,KAAK47G,SAAShlG,WAAa5W,KAAK6Q,OAAOwD,UACnErU,KAAK67G,UAAUxjG,YAAcrY,KAAK47G,SAASvjG,YAAcrY,KAAK6Q,OAAOuH,OACrEpY,KAAKU,QAAQ,YACNV,MAEX8pE,WAAY,SAAUkyC,GAClB,GAAIH,GAAY77G,KAAK67G,SAChB77G,MAAK86G,UAGV96G,KAAK86G,SAAU,EACVkB,GAAYH,EAAUn4G,SAAW1D,KAAKkS,QACvClS,KAAKU,QAAQ,UACTgD,MAAOm4G,EAAUn4G,QACjBiN,MAAO3Q,KAAK6Q,SAGpB7Q,KAAK+7G,MAAQ,KACbF,EAAU7xF,OACVhqB,KAAKU,QAAQ,gBAEjBwS,OAAQ,SAAUA,GACdlT,KAAK47G,SAAS1oG,OAAOA,GACrBlT,KAAK67G,UAAU3oG,OAAOA,IAE1Bs2D,WAAY,WACR,MAAOxpE,MAAK47G,SAASrgG,SAEzBmuD,YAAa,WACT,MAAO1pE,MAAK67G,UAAUtgG,SAE1BjM,MAAO,SAAU2sG,GACbA,EAAYA,GAAa,OACP,SAAdA,GACAj8G,KAAK67G,UAAUtgG,QAAQjM,QACvBtP,KAAK67G,UAAUp7F,OAEfzgB,KAAK47G,SAASrgG,QAAQjM,SAG9B0Z,SAAU,WACN,MAAOhpB,MAAK86G,SAEhB3rC,WAAY,WACR,MAAOnvE,MAAK47G,SAASh1F,MAAMa,WAAaznB,KAAK67G,UAAUj1F,MAAMa,WAEjEyC,aAAc,SAAUC,GACpB,GAAIo+C,GAASvoE,KAAKgtE,cAClB,OAAOzE,IAAUA,EAAOr+C,aAAaC,IAEzCsB,gBAAiB,WAAA,GACT88C,GAASvoE,KAAKgtE,eACdv2C,IAIJ,OAHI8xC,KACA9xC,EAAO8xC,EAAO98C,mBAEXgL,GAEXzU,MAAO,WACHhiB,KAAK67G,UAAU75F,SAEnB0H,cAAe,SAAUqlD,GACrB/uE,KAAK67G,UAAUnyF,cAAc+uC,EAASz4D,KAAK+7G,MAAOhtC,KAEtDrrE,MAAO,SAAUA,EAAOqxD,GACpB,MAActnD,UAAV/J,EACO1D,KAAK47G,SAASl4G,SAEX,OAAVA,IACAA,EAAQ,IAEZ1D,KAAKkS,OAASxO,EACd1D,KAAK47G,SAASl4G,MAAMA,GACpB1D,KAAK67G,UAAUn4G,MAAMA,OACrB1D,MAAK47G,SAASrgG,QAAQ0H,YAAY,gCAAiC8xC,KAEvExoC,cAAe,WACXvsB,KAAKgtE,eAAezgD,gBACpBvsB,KAAKgiB,SAETzS,OAAQ,WACJvP,KAAKgtE,eAAez9D,WAM5B/P,GAAM6Q,YAAYykE,YAAcA,IAClCt1E,QACc,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,wBACH,sBACA,qBACDD,IACL,WACE,YAqGA,SAAS48G,GAAiB5xG,GAA1B,GAManI,GACDklC,EAAiBC,EASrBtjB,EAAajZ,EAfb0zF,EAAIn0F,EAAKzJ,OACTg0F,GAAM4J,EAAI,GAAK,EAAG3J,EAAKxqF,EAAKypB,OAAO,SAAUhpB,EAAGiZ,GAC5C,MAAOjZ,GAAIiZ,GACZ,GAAKy6E,EACRtJ,EAAK,EAAGjJ,EAAK,CACjB,KAAS/pF,EAAI,EAAGA,EAAIs8F,EAAGt8F,IACfklC,EAAKllC,EAAI,EAAI0yF,EAAIvtD,EAAKh9B,EAAKnI,GAAK2yF,EACpCK,GAAM9tD,EAAKC,EACX4kD,GAAM7kD,EAAKA,CAEf,OAAK6kD,IAKDloE,EAAImxE,EAAKjJ,EAAInhF,EAAI+pF,EAAK9wE,EAAI6wE,EACvB,SAAU4J,GACb,MAAO1zF,GAAIiZ,GAAKy6E,EAAI,KANb,SAAUA,GACb,MAAOn0F,GAAKm0F,EAAIn0F,EAAKzJ,SAQjC,QAASs7G,GAAW7oF,GAChB,QAAS8oF,GAASrxG,GAAlB,GAEa5I,GADLwtB,EAAO5kB,EAAE,GAAKA,EAAE,EACpB,KAAS5I,EAAI,EAAGA,EAAI4I,EAAElK,SAAUsB,EAC5B,GAAI4I,EAAE5I,GAAK4I,EAAE5I,EAAI,IAAMwtB,EACnB,MAAO,KAGf,OAAOA,GAEX,QAAS5H,GAAQhd,GACb,MAAOA,GAAEpH,IAAI,SAAU2E,GACnB,MAAOA,GAAEmnD,SAZrB,GAeQ7jC,MACAthB,EAAOgpB,EAAW3vB,IAAI,SAAU6E,GAChC,MAAOA,GAAEkrB,SAAWlrB,EAAE9E,OAqD1B,OAnDA24G,GAAc/xG,EAAM,SAAUkW,EAAOC,EAAKlP,EAAMxG,GAA5B,GACZzL,GAAGyI,EAcK4nB,EA0BRmjB,EAMK3wC,CAAT,KA7CY,UAARoP,GACAxJ,EAASggB,EAAQhd,GACjBzL,EAAI48G,EAAiBn0G,IACN,UAARwJ,GAA4B,WAARA,GAA6B,WAARA,EAChDjS,EAAI,SAAUm/F,EAAGt8F,GACb,MAAOmI,GAAKnI,IAETg2B,MAAMsT,QAAQl6B,GACL,GAAZxG,EAAElK,OACFvB,EAAI,SAAUm/F,GACV,MAAOltF,IAAMxG,EAAE,GAAG0kD,OAASgvC,GAAKltF,EAAK1Q,UAGrC8uB,EAAOysF,EAASr0F,EAAQhd,IAExBzL,EADQ,MAARqwB,EACI,SAAU8uE,GACV,MAAO1zF,GAAE0zF,EAAI1zF,EAAElK,QAAQ6C,OAGvB,SAAU+6F,GACV,GAAIr0E,GAAMrf,EAAE,GAAG0kD,OAAS9/B,EAAO8uE,CAC/B,OAAOltF,GAAK6Y,EAAM7Y,EAAK1Q,UAIpB,QAAR0Q,GACPxJ,EAASggB,EAAQhd,GACI,GAAjBhD,EAAOlH,QACPkH,EAAO5H,KAAK4H,EAAO,GAAK,GAE5BA,EAASm0G,EAAiBn0G,GAC1BzI,EAAI,SAAUm/F,EAAGt8F,GACb,MAAOmI,GAAKnI,GAAGX,QAAQ,aAAc,KAAOuG,EAAO02F,EAAGt8F,MAG1D7C,EAAI,WACA,MAAO,OAGXwzC,GACAxzC,EAAGA,EACHkhB,MAAOA,EACPC,IAAKA,EACLiE,IAAKjE,EAAMD,GAENre,EAAIqe,EAAOre,EAAIse,IAAOte,EAC3BypB,EAAOzpB,GAAK2wC,IAGb,SAAU2rD,EAAGt8F,GAAb,GACC2wC,GAAIlnB,EAAOzpB,GACX0tF,EAAI4O,EAAIn0F,EAAKzJ,OAAS,EACtBsH,EAAIs2F,EAAIn0F,EAAKzJ,OACboF,EAAI4pF,EAAI/8C,EAAEpuB,IAAMvc,EAAI2qC,EAAEtyB,MACtB9c,EAAQovC,EAAExzC,EAAE2G,EAAG9D,GACfwmC,EAAQ/d,EAAM0I,EAAWnxB,GAO7B,cANOwmC,GAAMz1B,OACTxP,YAAiBymC,GACjBxB,EAAMjV,QAAUhwB,EAEhBilC,EAAMjlC,MAAQA,EAEXilC,GAGf,QAAS/d,GAAMlhB,GACX,GAAI+P,KAIJ,OAHAzQ,QAAOiY,KAAKvX,OAAWkI,QAAQ,SAAU/P,GACrC4X,EAAK5X,GAAO6H,EAAI7H,KAEb4X,EAEX,QAAS4iG,GAAc/xG,EAAMhL,GAA7B,GACwCiS,GAC3BpP,EADLkG,EAAO,KAAMqnB,EAAQ,EAAG3kB,IAC5B,KAAS5I,EAAI,EAAGA,EAAImI,EAAKzJ,SAAUsB,EAC/BoP,EAAO+qG,EAAQhyG,EAAKnI,IACpB4I,EAAE5K,KAAKoR,GACK,MAARlJ,GAAgBkJ,EAAKA,OAASlJ,EAAKkJ,OACnCjS,EAAEowB,EAAOvtB,EAAGkG,EAAKkJ,KAAMxG,EAAEzK,MAAMovB,EAAOvtB,IACtCutB,EAAQvtB,GAEZkG,EAAOkJ,CAEXjS,GAAEowB,EAAOvtB,EAAGkG,EAAKkJ,KAAMxG,EAAEzK,MAAMovB,EAAOvtB,IAE1C,QAASm6G,GAAQ33F,GAAjB,GAQY43F,GAIA3zG,CAXR,IAAiB,gBAAN+b,GACP,OACIpT,KAAM,SACNk+C,OAAQ9qC,EAGhB,IAAiB,gBAANA,GAEP,OADI43F,EAAMC,EAAe73F,IAEd43F,GAEP3zG,EAAI,eAAekI,KAAK6T,GACxB/b,GACA+b,EAAKA,EAAGnjB,QAAQ,aAAc,cAE1B+P,KAAMoT,EACNnG,MAAO5V,EACP6mD,OAAQ/I,WAAW99C,EAAE,OAGpB2I,KAAM,UAEnB,IAAiB,iBAANoT,GACP,OAASpT,KAAM,UAEnB,IAAU,MAANoT,EACA,OAASpT,KAAM,OAEnB,IAAIoT,YAAcwlB,GACd,OAAS54B,KAAM,UAGnB,MADApO,QAAOmqC,QAAQ6D,MAAMxsB,GACX/Z,MAAM,oBAEpB,QAAS6xG,KACL,GAAIhqF,GAAUjzB,MAAMizB,SACpB,QACIA,EAAQ2zD,UAAUC,SAASC,KAAKC,UAChC9zD,EAAQ2zD,UAAUC,SAASC,KAAKjkB,MAChC5vC,EAAQ2zD,UAAUC,SAAS7C,OAAO+C,UAClC9zD,EAAQ2zD,UAAUC,SAAS7C,OAAOnhB,OAG1C,QAASm6C,GAAet6G,GAAxB,GAGaC,GACD4I,EACKqD,EACDuW,EALR+3F,EAAOx6G,EAAIqG,cACXgrB,EAAQkpF,GACZ,KAASt6G,EAAI,EAAGA,EAAIoxB,EAAM1yB,SAAUsB,EAEhC,IADI4I,EAAIwoB,EAAMpxB,GACLiM,EAAIrD,EAAElK,SAAUuN,GAAK,GAE1B,GADIuW,EAAK5Z,EAAEqD,GAAG7F,cACVoc,GAAM+3F,EACN,OACInrG,KAAMxG,EACN0kD,OAAQrhD,EACR1K,MAAOxB,GAM3B,QAASywC,GAAU5nC,GAAnB,GAGa5I,GAEIiM,EAJT5L,EAASuI,EAAElK,OAAQ0B,EAAQwI,EAAE,GAAGlK,OAChC4uC,IACJ,KAASttC,EAAI,EAAGA,EAAII,IAASJ,EAEzB,IADAstC,EAAEttC,MACOiM,EAAI,EAAGA,EAAI5L,IAAU4L,EAC1BqhC,EAAEttC,GAAGiM,GAAKrD,EAAEqD,GAAGjM,EAGvB,OAAOstC,GA3Sb,GAKMp/B,GACA8J,EACAwG,EACAwpB,EACAwyE,EACAC,EACAxiG,CATA5a,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DC,EAAc7Q,MAAM6Q,YACpB8J,EAAQ9J,EAAY8J,MACpBwG,EAAUtQ,EAAY4D,KAAK0M,QAC3BwpB,EAAUxpB,EAAQwpB,QAClBwyE,EAAmB,qBACnBC,EAAmB,kBACnBxiG,EAAYD,EAAMC,UAAY,SAAUzP,GACxC3K,KAAKoK,KAAOO,GAEhBwP,EAAMnH,UAAU4tB,iBAAmB,SAAUi8E,EAAUn+E,GAApB,GAK3BmhB,GACAnf,EAwCAw8B,EACA2sB,EAIAv/E,EAA+BrE,EAO/By2D,EACAn8B,EACKp+B,EACD2wC,EACAxzC,EACAyL,EACKqD,EACDgc,EACA0yF,EACA/nG,EAlERgoG,EAAY/8G,KAAM6R,EAAQkrG,EAAU3kG,MAMxC,IALuB,gBAAZykG,KACPA,EAAWhrG,EAAMlB,MAAMksG,IAEvBh9D,EAAMg9D,EAASlrG,KAAKG,aAAa8Y,QAAQE,SAASjZ,EAAM/F,QACxD40B,EAAOq8E,EAAUprG,KAAKG,aAAa8Y,QAAQE,SAASjZ,EAAM/F,QAC1D+zC,EAAI9vB,WAAW2Q,GAAO,CACtB,GAAImf,EAAIvkC,GAAGolB,GACP,MAAO,KAGX,IADAA,EAAOA,EAAK9V,QACRi1B,EAAIxrC,QAAQiH,GAAGolB,EAAKrsB,SACpB,GAAIwrC,EAAIt9C,SAAWm+B,EAAKn+B,QACpBm+B,EAAKrsB,QAAQC,KAAOurC,EAAIr9C,SACxBk8B,EAAY,MACT,CAAA,GAAImhB,EAAIr9C,UAAYk+B,EAAKl+B,SAI5B,KAAM,IAAI4X,GAAUuiG,EAHpBj8E,GAAKrsB,QAAQS,KAAO+qC,EAAIt9C,QACxBm8B,EAAY,MAIb,CAAA,IAAImhB,EAAItpB,YAAYjb,GAAGolB,EAAKnK,aAW/B,KAAM,IAAInc,GAAUuiG,EAVpB,IAAI98D,EAAIt9C,SAAWm+B,EAAKn+B,QACpBm+B,EAAKnK,YAAYjiB,KAAOurC,EAAIr9C,SAC5Bk8B,EAAY,MACT,CAAA,GAAImhB,EAAIr9C,UAAYk+B,EAAKl+B,SAI5B,KAAM,IAAI4X,GAAUuiG,EAHpBj8E,GAAKnK,YAAYzhB,KAAO+qC,EAAIt9C,QAC5Bm8B,EAAY,GAOpB,MAAO7sB,GAAMlB,MAAM+vB,GAAME,iBAAiBi8E,EAAUn+E,GAExD,GAAiB,MAAbA,EACA,GAAImhB,EAAIxrC,QAAQS,KAAO4rB,EAAKrsB,QAAQS,IAChC4pB,EAAYmhB,EAAIxrC,QAAQC,IAAMosB,EAAKrsB,QAAQC,IAAM,EAAI,MAClD,CAAA,GAAIurC,EAAIxrC,QAAQC,KAAOosB,EAAKrsB,QAAQC,IAGvC,KAAM,IAAI8F,GAAUwiG,EAFpBl+E,GAAYmhB,EAAIxrC,QAAQS,IAAM4rB,EAAKrsB,QAAQS,IAAM,EAAI,EAO7D,GAFIooD,EAAyB,EAAZx+B,EACbmrD,EAAyB,EAAZnrD,EACbw+B,GAAcrd,EAAIr9C,UAAYk+B,EAAKl+B,WAAa06D,GAAcrd,EAAIt9C,SAAWm+B,EAAKn+B,QAClF,KAAM,IAAI6X,GAAUuiG,EAWxB,KATIryG,EAAOuyG,EAASn0E,cACfw0B,EAIDj3D,EAAIy6B,EAAKn+B,SAHT+H,EAAOqoC,EAAUroC,GACjBrE,EAAIy6B,EAAKl+B,UAITk6D,EAAWvkC,MAAM7tB,EAAKzJ,QACtB0/B,EAAO,KACFp+B,EAAI,EAAGA,EAAImI,EAAKzJ,SAAUsB,EAI/B,IAHI2wC,EAAIxoC,EAAKnI,GACT7C,EAAI68G,EAAWrpE,GACf/nC,EAAI2xD,EAAKv6D,GAASg2B,MAAMlyB,GACnBmI,EAAI,EAAGA,EAAInI,IAAKmI,EACjBgc,EAAMy/D,GAAcz7E,EAAI,EAAI0kC,EAAEjyC,OAASuN,EACvC0uG,EAASjzB,EAAa/2C,EAAEjyC,OAASuN,EAAI0kC,EAAEjyC,OAAS,EAAIuN,EAAI0kC,EAAEjyC,OAC1DkU,EAAOhK,EAAE8+E,EAAa5jF,EAAImI,EAAI,EAAIA,GAAK9O,EAAE8qB,EAAK0yF,GAChC,MAAd/nG,EAAKrR,QACL68B,EAAOxrB,EAAKrR,MAOxB,OAHKw5D,KACDR,EAAO/pB,EAAU+pB,KAGjB/zB,MAAO+zB,EACPh+B,UAAWA,EACXgC,KAAMq8E,EACNx8E,KAAMA,IAGdpmB,EAAMnH,UAAUkH,SAAW,SAAU2iG,EAAUn+E,GAC3C,GAAIl2B,GAAIxI,KAAK4gC,iBAAiBi8E,EAAUn+E,EAExC,OADAl2B,GAAEk4B,KAAKgI,YAAYlgC,EAAEmgC,OACdngC,EAAEk4B,QAyMG,kBAAVnhC,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,0BAA2B,cAAeD,IACnD,YACG,SAAUE,GAAV,GAIO4B,GACA47G,EAIAlnC,CARAt2E,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVw3G,GACAlpG,MAAO,4BACP0R,KAAM,2BAENswD,EAAat2E,EAAMqgB,GAAGC,OAAOngB,QAC7BC,KAAM,SAAU2b,EAAS1b,GAAnB,GAGEo9G,GACAl3F,EAcAm3F,CAjBJ19G,GAAMqgB,GAAGC,OAAO/f,KAAKC,KAAMub,EAAS1b,GACpC0b,EAAQpM,SAAS6tG,EAAYlpG,OACzBmpG,EAAgBp9G,EAAQszE,SAASC,SAAW,WAC5CrtD,EAAa,GAAIvmB,GAAM8K,KAAKib,YAC5B43F,WACIh+B,KAAM,SAAUt/E,GACZ,GAAIyK,KACJtK,MAAKsQ,UAAU0xD,YAAY,SAAUrW,IAC5BA,EAAI7Q,QAAU6Q,EAAIjoD,gBAAiBlE,GAAM6Q,YAAY2kB,KACtD1qB,EAAKnK,MAAO2L,KAAM6/C,EAAI7/C,SAG9BjM,EAAQu9G,QAAQ9yG,IAClByH,KAAK/R,MACP+I,OAAO,KAGXm0G,EAAe97G,EAAE,aAAawgB,KAAK,QAASq7F,GAAer7F,KAAK,aAAcq7F,GAClFj9G,KAAKq9G,MAAQH,EAAa7tG,SAASkM,GAASmuF,eACxCE,aAAa,EACbzzB,cAAe,OACfnwD,eAAgB,OAChBC,SAAU,+FACVF,WAAYA,EACZJ,UAAU,EACV23F,YAAY,EACZz3F,OAAQ7lB,KAAKu9G,eAAexrG,KAAK/R,MACjCw9G,eAAgB,cAChBl9F,KAAM,WACFyF,EAAWo5D,UAEhBs+B,mBACHz9G,KAAKq9G,MAAMvpG,MAAMiO,GAAG,UAAW/hB,KAAK09G,YAAY3rG,KAAK/R,OAAO+hB,GAAG,QAAS/hB,KAAK29G,UAAU5rG,KAAK/R,OAC5FA,KAAKq9G,MAAMz2F,MAAMrL,QAAQpM,SAAS,6BAA6B4S,GAAG,YAAa,SAAU8F,GACrFA,EAAGotF,oBACJlzF,GAAG,QAAS,mBAAoB,SAAU8F,GACzCA,EAAGvP,iBACHuP,EAAGotF,iBACH,IAAIrsD,GAAOxnD,EAAEymB,EAAG5V,QAAQ81C,QAAQ,UAChCa,GAAO5oD,KAAKq9G,MAAMpU,SAASrgD,GAC3B5oD,KAAK49G,YAAYh1D,EAAK98C,OACxBiG,KAAK/R,QAEX0D,MAAO,SAAU0L,GACb,MAAY3B,UAAR2B,EACOpP,KAAKq9G,MAAM35G,YAElB1D,MAAKq9G,MAAM35G,MAAM0L,IAGzBwuG,YAAa,SAAU9xG,GACnB9L,KAAKU,QAAQ,UAAYoL,KAAMA,KAEnC4xG,YAAa,SAAU71F,GACnB,OAAQA,EAAGX,SACX,IAAK,IACDlnB,KAAKq9G,MAAM35G,MAAM1D,KAAK69G,YACtB79G,KAAKU,QAAQ,SACb,MACJ,KAAK,IACDV,KAAKU,QAAQ,WAIrBi9G,UAAW,WACP39G,KAAK69G,WAAa79G,KAAKq9G,MAAM35G,SAEjC65G,eAAgB,WACZ,GAAIzxG,GAAO9L,KAAKq9G,MAAM35G,OAClBoI,IACA9L,KAAKU,QAAQ,UAAYoL,KAAMA,OAI3CtM,EAAM6Q,YAAYylE,WAAaA,IACjC3yE,OAAO3D,QACO,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,qBACH,YACA,oBACA,oBACA,yBACA,wBACA,qBACDD,IACL,WACE,YAUA,SAASw+G,GAAiBC,EAASC,EAAYC,EAAUC,EAAYC,GAArE,GACQC,GAAO,EACPl0G,KACAiT,EAAS6gG,EACTK,EAAS,CAqBb,OApBIL,IAAcC,IACdA,GAAYD,GAEhBD,EAAQnsG,QAAQ,SAAUugC,EAAGhwC,GACP,MAAd+7G,GAAsB/7G,EAAI+7G,IAC1BG,GAAUlsE,GAEV6rE,GAAcI,EAAOjsE,EAAIh1B,IACrBA,EAASihG,EAAOH,IAChBG,EAAOJ,EAAarvF,KAAK83B,KAAK23D,EAAOJ,GAAcK,EAC/CA,EAAS,GACTF,EAAah+G,KAAKi+G,EAAOC,IAGjClhG,GAAU6gG,EAAarvF,KAAK83B,KAAKtU,EAAI6rE,IAEzC9zG,EAAI/J,KAAKi+G,GACTA,GAAQjsE,IAEZjoC,EAAI/J,KAAKi+G,GACFl0G,EAEX,QAASmyE,GAASxqE,EAAOlB,EAAO9Q,GAAhC,GAGQiX,GACAwnG,EACAC,EACA17E,EACAic,EAAaC,EAiDby/D,EACAR,EACAS,EAEIl8G,EAOJm8G,EACAjiC,EACAF,EACAoiC,EACAC,EACAC,EAvEAzjF,EAAOvpB,EAAMwpB,KA8IjB,OA7IA1qB,GAAQyqB,EAAKrD,UAAUpnB,GACnBmG,KACAwnG,KACAC,KACA17E,EAAchxB,EAAM63B,gBAAgB/4B,GACpCmuC,KAAaC,KACjBltC,EAAMD,QAAQjB,EAAO,SAAU2D,EAAKQ,EAAKC,GAApB,GAcb+pG,GAIA51G,EAYAN,EA7BAm2G,EAASzqG,EAAM3D,EAAM0D,QAAQC,IAC7B0qG,EAASlqG,EAAMnE,EAAM0D,QAAQS,IAC7BmqG,EAAKptG,EAAMS,UAAUgC,GACrB4qG,EAAKrtG,EAAMO,YAAY0C,EACtBkqG,IACDV,EAAWn+G,KAAK8+G,GAEfF,GACDR,EAAUp+G,KAAK++G,IAEfrtG,EAAMuuB,eAAetrB,KAAQjD,EAAMsuB,YAAY7rB,IAAS2qG,GAAOC,IAG/DJ,EAAWj/G,EAAQy8E,WAAa6iC,EAAepqG,IAC7ClV,EAAQu/G,YAAcN,KAGxB51G,EAAK,GAAIisB,GAAQ7gB,EAAKQ,GAAKiW,QAC3B8X,EAAY2G,UAAUtgC,KAGtB41G,GACAhgE,EAASnwB,KAAKoK,IAAI+lB,EAAQigE,GAC1BhgE,EAASpwB,KAAKoK,IAAIgmB,EAAQigE,IAE1BjqG,EAAK6lB,OAAQ,EAEjB7lB,EAAKT,IAAMyqG,EACXhqG,EAAKD,IAAMkqG,EACPp2G,EAAIi6B,EAAY0G,QAAQrgC,GACxBN,SACOi6B,GAAY0G,QAAQrgC,GAC3B6L,EAAKurB,QAAS,EACdvrB,EAAKslE,QAAUzxE,EAAEpG,SACjBuS,EAAKqlE,QAAUxxE,EAAErG,QACb1C,EAAQy8E,YACRvnE,EAAKxS,MAAQsP,EAAMirB,SAAS0N,IAAI5hC,EAAEyL,QAAQS,IAAKlM,EAAE2tB,YAAYzhB,KAC7DC,EAAKvS,OAASqP,EAAMsrB,MAAMqN,IAAI5hC,EAAEyL,QAAQC,IAAK1L,EAAE2tB,YAAYjiB,QAG/DS,EAAKslE,QAAU,EACftlE,EAAKqlE,QAAU,GAEnBtjE,EAAM3W,KAAK4U,QAEfupG,EAAaA,EAAWh+G,MAAM,EAAGw+C,EAAS,GAC1Cy/D,EAAYA,EAAUj+G,MAAM,EAAGy+C,EAAS,GACpCy/D,EAAY3+G,EAAQ2+G,UACpBR,EAAan+G,EAAQm+G,WACrBS,EAAc5+G,EAAQmiB,OAAS,EAC/BniB,EAAQ40G,WACJlyG,EAAQg8G,EAAUxqF,OAAOyW,EAAK,GAC9BjoC,EAAQi8G,IACRC,EAAcD,EAAYj8G,IAGlCi8G,EAAY7vF,KAAK83B,KAAK+3D,EAAYC,GAClCT,EAAarvF,KAAK83B,KAAKu3D,EAAaS,GAChCC,KACAjiC,EAAUqhC,EAAiBQ,EAAYN,GAAc,EAAGn+G,EAAQo+G,SAAUp+G,EAAQq+G,WAAYQ,GAC9FniC,EAAUuhC,EAAiBS,EAAWC,GAAa,EAAG3+G,EAAQo+G,UAC9DU,EAAW,EACXC,EAAY,EACZC,KACJ/nG,EAAQA,EAAMyD,OAAO,SAAUxF,GAC3B,QAAIA,EAAK6lB,SAAU7lB,EAAKT,IAAMwqC,GAAU/pC,EAAKD,IAAMiqC,MAG/Cl/C,EAAQq+G,YAAcnpG,EAAKT,IAAMzU,EAAQq+G,YACzCW,EAAY1+G,KAAK4U,GAErBA,EAAK6H,KAAO2/D,EAAQxnE,EAAKD,KACzBC,EAAKmI,IAAMu/D,EAAQ1nE,EAAKT,KACpBS,EAAKurB,OACAzgC,EAAQy8E,WAMTvnE,EAAK+H,MAAQ/H,EAAK6H,KAAO7H,EAAKxS,MAC9BwS,EAAKoI,OAASpI,EAAKmI,IAAMnI,EAAKvS,SAN9BuS,EAAK+H,MAAQuiG,EAAO9iC,EAASxnE,EAAKD,IAAMC,EAAKqlE,SAC7CrlE,EAAKoI,OAASkiG,EAAO5iC,EAAS1nE,EAAKT,IAAMS,EAAKslE,SAC9CtlE,EAAKxS,MAAQwS,EAAK+H,MAAQ/H,EAAK6H,KAC/B7H,EAAKvS,OAASuS,EAAKoI,OAASpI,EAAKmI,MAMrCnI,EAAKxS,MAAQg8G,EAAUxpG,EAAKD,KAC5BC,EAAKvS,OAAS87G,EAAWvpG,EAAKT,KAC9BS,EAAKoI,OAASpI,EAAKmI,IAAMnI,EAAKvS,OAC9BuS,EAAK+H,MAAQ/H,EAAK6H,KAAO7H,EAAKxS,OAElCo8G,EAAWhwF,KAAKoK,IAAI4lF,EAAU5pG,EAAK+H,OACnC8hG,EAAYjwF,KAAKoK,IAAI6lF,EAAW7pG,EAAKoI,SAC9B,KAEXnU,OAAOiY,KAAK4hB,EAAY0G,SAAS33B,QAAQ,SAAU1I,GAC/C,GAAIwI,GAAMmxB,EAAY0G,QAAQrgC,EAC9B2I,GAAMD,QAAQF,EAAI2C,QAAQvC,aAAc,SAAUwC,EAAKQ,EAAKC,GAApB,GAChCgqG,GAASzqG,EAAM3D,EAAM0D,QAAQC,IAC7B0qG,EAASlqG,EAAMnE,EAAM0D,QAAQS,GACjCC,GAAKurB,QAAS,EACdvrB,EAAKqlE,QAAU1oE,EAAInP,QACnBwS,EAAKslE,QAAU3oE,EAAIlP,SAEfuS,EAAKmI,IADL6hG,EAAS,GACGltG,EAAMsrB,MAAMqN,IAAIl2B,EAAKA,EAAMyqG,EAAS,GAErCtiC,EAAQsiC,GAGnBhqG,EAAK6H,KADLoiG,EAAS,GACIntG,EAAMirB,SAAS0N,IAAI11B,EAAKA,EAAMkqG,EAAS,GAExCziC,EAAQyiC,GAExBjqG,EAAKvS,OAASqP,EAAMsrB,MAAMqN,IAAI94B,EAAI2C,QAAQC,IAAK5C,EAAI6kB,YAAYjiB,KAC/DS,EAAKxS,MAAQsP,EAAMirB,SAAS0N,IAAI94B,EAAI2C,QAAQS,IAAKpD,EAAI6kB,YAAYzhB,KAC7DC,EAAKvS,OAAS,GAAKuS,EAAKxS,MAAQ,IAChCwS,EAAK+H,MAAQ/H,EAAK6H,KAAO7H,EAAKxS,MAC9BwS,EAAKoI,OAASpI,EAAKmI,IAAMnI,EAAKvS,OAC9BuS,EAAKT,IAAMyqG,EACXhqG,EAAKD,IAAMkqG,EACXloG,EAAM3W,KAAK4U,QAInBlV,EAAQq+G,aACRQ,EAAS9sG,QAAQ,SAAU6c,GACvBowF,EAAYjtG,QAAQ,SAAUmD,GAC1BA,EAAO6V,EAAM7V,GACbA,EAAKmI,KAAOuR,EACZ1Z,EAAKoI,OAASpI,EAAKmI,IAAMnI,EAAKvS,OAC9BsU,EAAM3W,KAAK4U,KAEf0nE,EAAQt8E,KAAKsuB,KAEjBguD,EAAQ16E,KAAKu9G,KAGb/8G,MAAOo8G,EACPn8G,OAAQo8G,EACR9nG,MAAOA,EAAM/U,KAAKw9G,GAClBv9F,MAAOy8F,EACPliC,QAASA,EACTE,QAASA,GAGjB,QAAS7xD,GAAMxoB,EAAM6P,GAIjB,MAHKA,KACDA,MAEAjJ,OAAOw2G,OACAx2G,OAAOw2G,OAAOvtG,EAAQ7P,GAE1B4G,OAAOiY,KAAK7e,GAAM2xB,OAAO,SAAUta,EAAM5X,GAE5C,MADA4X,GAAK5X,GAAOO,EAAKP,GACV4X,GACRxH,GAEP,QAASwtG,GAAW10G,EAAGiZ,GACnB,MAAOjZ,GAAE1H,OAAS2gB,EAAE3gB,MAAQ0H,EAAEo4B,QAAUnf,EAAEmf,MAE9C,QAASqH,GAAIz/B,EAAGiZ,GACZ,MAAOjZ,GAAIiZ,EAEf,QAASq7F,GAAOt0G,EAAG5I,GACf,MAAOA,GAAI4I,EAAElK,OAASkK,EAAE5I,GAAK4I,EAAEA,EAAElK,OAAS,GAE9C,QAASs+G,GAAepqG,GACpB,MAAqB,OAAdA,EAAKrR,OAAiBqR,EAAKurB,QAA6B,MAAnBvrB,EAAK0uB,YAA0C,MAApB1uB,EAAKkB,aAA4C,MAArBlB,EAAKwB,cAA2C,MAAnBxB,EAAKqJ,aAAuBrJ,EAAKqJ,WAAW1a,MAEhL,QAAS67G,GAAWx0G,EAAGiZ,GACnB,MAAIjZ,GAAEmS,IAAM8G,EAAE9G,OAEHnS,EAAEmS,KAAO8G,EAAE9G,IACdnS,EAAE6R,KAAOoH,EAAEpH,QAEJ7R,EAAE6R,MAAQoH,EAAEpH,KACZ,EAEA,EAGJ,EAGf,QAAS0iG,GAAYv0G,EAAGiZ,GACpB,MAAOjZ,GAAIiZ,KAASjZ,EAAIiZ,EAAI,EAAI,EAEpC,QAAS07F,GAAW7tG,EAAO4K,EAAQsmD,EAAOljE,GAUtC,QAAS8/G,GAAQrrG,EAAKQ,GAAtB,GAiBY8qG,GAEA3pC,EASA2R,EAcIv/E,EASJk7B,EAKAs8E,EAvDJjjG,EAAO9H,EAAM0pG,EACb1hG,EAAQF,EAAO4hG,EACfthG,EAAM5I,EAAM0pG,EACZ7gG,EAASD,EAAM8gG,EACf8B,EAAY,EAAGC,EAAW,EAC1BjpG,EAAQ2F,EAAO3F,MAAMyD,OAAO,SAAUxF,GACtC,QAAIA,EAAK+H,OAASF,GAAQ7H,EAAK6H,MAAQE,GAAS/H,EAAKoI,QAAUD,GAAOnI,EAAKmI,KAAOC,KAGlF2iG,EAAYnxF,KAAKoK,IAAIhkB,EAAKoI,OAAQ2iG,GAClCC,EAAWpxF,KAAKoK,IAAIhkB,EAAK+H,MAAOijG,IACzB,IAEXD,GAAYnxF,KAAKqK,IAAI8mF,EAAW3iG,GAChC4iG,EAAWpxF,KAAKqK,IAAI+mF,EAAUjjG,GAC1BhG,EAAMjW,OAAS,IACX++G,EAAO,GAAIz8C,GAAQ68C,MACvBj9C,EAAMqK,OAAOwyC,GACT3pC,EAAU,GAAI9S,GAAQ68C,MAC1BJ,EAAKxyC,OAAO6I,GACZA,EAAQgqC,KAAK98C,EAAQ+8C,KAAKC,SAAS,GAAIC,GAAIC,MACvCzjG,EAAO,EACPM,EAAM,IAEN6iG,EAAW,EACXD,EAAY,MAEZl4B,EAASw4B,EAAI57E,OAAOxiB,MAAMvF,EAAOuF,MAAOvF,EAAOuF,OAAOs+F,aAAaF,EAAI57E,OAAO+7E,WAAW3jG,GAAOM,KAChGrd,EAAQi1G,SAAWj1G,EAAQk1G,WAC3BntB,EAASA,EAAO04B,aAAaF,EAAI57E,OAAO+7E,UAAU1gH,EAAQi1G,SAAWh4F,EAAQijG,GAAY,EAAI,EAAGlgH,EAAQk1G,SAAW53F,EAAS2iG,GAAa,EAAI,KAEjJ7pC,EAAQ+G,UAAU4K,GACd/nF,EAAQuvG,aACJ/mG,EAAO,KACXoU,EAAO8/D,QAAQ3qE,QAAQ,SAAUpJ,GAC7BA,EAAImmB,KAAKqK,IAAIxwB,EAAGu3G,GACZv3G,IAAMH,GAAQG,GAAKoU,GAAQpU,GAAKsU,IAChCzU,EAAOG,EACPytE,EAAQ7I,QAAO,GAAIjK,GAAQ+8C,MAAOM,OAAOh4G,EAAG0U,GAAKujG,OAAOj4G,EAAGs3G,GAAWz/F,QAAQqgG,OAAO7gH,EAAQ8gH,WAAYC,OAG7Gv4G,EAAO,KACXoU,EAAOggE,QAAQ7qE,QAAQ,SAAU6c,GAC7BA,EAAIE,KAAKqK,IAAIvK,EAAGqxF,GACZrxF,IAAMpmB,GAAQomB,GAAKvR,GAAOuR,GAAKtR,IAC/B9U,EAAOomB,EACPwnD,EAAQ7I,QAAO,GAAIjK,GAAQ+8C,MAAOM,OAAO5jG,EAAM6R,GAAGgyF,OAAOV,EAAUtxF,GAAGpO,QAAQqgG,OAAO7gH,EAAQ8gH,WAAYC,QAIjHr9E,EAAUm5C,IACd5lE,EAAMlF,QAAQ,SAAUmD,GACpBo7D,EAASp7D,EAAMkhE,EAASp2E,GACxB0jC,EAAQmO,IAAI38B,EAAMlD,KAElBguG,EAAe,GAAI18C,GAAQ68C,MAC/Bz8E,EAAQs5C,KAAKjrE,QAAQ,SAAU7G,GAC3BA,EAAE6G,QAAQ,SAAUoS,GACXA,EAAE84D,WACH94D,EAAE84D,UAAW,EACb+iC,EAAazyC,QAAO,GAAIjK,GAAQ+8C,MAAOM,OAAOx8F,EAAExb,EAAGwb,EAAE9G,KAAKujG,OAAOz8F,EAAExb,EAAGwb,EAAE7G,QAAQkD,QAAQqgG,OAAO18F,EAAEmf,MAAOnf,EAAE3gB,YAItHkgC,EAAQ05C,MAAMrrE,QAAQ,SAAU7G,GAC5BA,EAAE6G,QAAQ,SAAUoS,GACXA,EAAE84D,WACH94D,EAAE84D,UAAW,EACb+iC,EAAazyC,QAAO,GAAIjK,GAAQ+8C,MAAOM,OAAOx8F,EAAEpH,KAAMoH,EAAEyK,GAAGgyF,OAAOz8F,EAAElH,MAAOkH,EAAEyK,GAAGpO,QAAQqgG,OAAO18F,EAAEmf,MAAOnf,EAAE3gB,YAItH4yE,EAAQ7I,OAAOyyC,IAnF3B,GAKazxG,GACIjM,EALT0+G,EAAQlyF,KAAK83B,KAAKhqC,EAAOla,MAAQ1C,EAAQ2+G,WACzCsC,EAAQnyF,KAAK83B,KAAKhqC,EAAOja,OAAS3C,EAAQm+G,YAC1CQ,EAAY7vF,KAAK83B,KAAK5mD,EAAQ2+G,UAAY/hG,EAAOuF,OACjDg8F,EAAarvF,KAAK83B,KAAK5mD,EAAQm+G,WAAavhG,EAAOuF,MACvD,KAAS5T,EAAI,EAAGA,EAAI0yG,IAAS1yG,EACzB,IAASjM,EAAI,EAAGA,EAAI0+G,IAAS1+G,EACzBw9G,EAAQvxG,EAAGjM,GAgFvB,QAASguE,GAASp7D,EAAMkhE,EAASp2E,GAAjC,GAGQkvE,GAQIgyC,EAUJ3xG,EAEImC,EACA0uG,EAGA3gH,EAAG0V,EA1BP45C,EAAI,GAAIuU,GAAQ68C,KAqBpB,IApBA/pC,EAAQ7I,OAAOxe,GACXmgB,EAAO,GAAIqxC,GAAIC,MACftrG,EAAK6H,KACL7H,EAAKmI,MAELnI,EAAKxS,MACLwS,EAAKvS,UAELuS,EAAK0uB,YAAc1uB,EAAKurB,UACpBygF,EAAOhyC,EACPlvE,EAAQuvG,aACR2R,EAAOhyC,EAAKnkD,QACZm2F,EAAKhnG,OAAOvR,GAAKo4G,EAAkB,EAAI,GACvCG,EAAKhnG,OAAO0U,GAAKmyF,EAAkB,EAAI,GACvCG,EAAK19G,KAAKd,OAASq+G,EAAkB,GACrCG,EAAK19G,KAAKb,QAAUo+G,EAAkB,IAE1ChyD,EAAEwe,OAAO,GAAIjK,GAAQk9C,KAAKU,GAAMrkD,KAAK3nD,EAAK0uB,YAAc,QAAQi9E,OAAO,QAEvEtxG,EAAM2F,EAAKrR,MACJ,MAAP0L,EAAa,CAkBb,GAjBImC,EAAqB,gBAAPnC,GAAkB,SAAW,KAC3C6wG,EAAO,GAAI98C,GAAQ68C,MACvBC,EAAKA,KAAK98C,EAAQ+8C,KAAKC,SAASpxC,IAChCngB,EAAEwe,OAAO6yC,GACFjrG,EAASD,EAAKC,OAChBA,GAAkB,UAARzD,GAAoBnC,GAAOuf,KAAK+F,MAAMtlB,KACjD4F,EAAS,oBAETA,GACA1V,EAAIqV,EAAWyyE,aAAah4E,EAAK4F,GACjC5F,EAAM9P,EAAEgC,KACJhC,EAAEiS,OACFA,EAAOjS,EAAEiS,OAGbnC,GAAO,IAEN2F,EAAK6uB,UACN,OAAQryB,GACR,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,WACDwD,EAAK6uB,UAAY,OACjB,MACJ,KAAK,UACD7uB,EAAK6uB,UAAY,SAIzBo9E,EAAS5xG,EAAK9P,GAAKA,EAAE6jC,OAASpuB,EAAKouB,OAAS,OAAQpuB,EAAMkrG,IAGlE,QAAS9uC,GAAYp8D,EAAMpS,GACvB,GAAIoS,EAAK2lD,OAAQ,CACb,GAAIA,GAAS,IAAM3lD,EAAK2lD,MACxB,QAAQ/3D,EAAMihC,WACd,IAAK,MACL,IAAK,OACDjhC,EAAMs+G,YAAcvmD,EAAS,IAC7B,MACJ,KAAK,QACD/3D,EAAMu+G,aAAexmD,EAAS,IAC9B,MACJ,KAAK,SACD/3D,EAAMs+G,YAAcvmD,EAAS,EAAI,KACjC/3D,EAAMu+G,aAAexmD,EAAS,EAAI,OAM9C,QAASsmD,GAAS1/G,EAAM6hC,EAAOpuB,EAAMguD,GAArC,GA8BQo+C,GAcAC,CAbJ,QA9BKC,IACDA,EAAOl9G,SAASC,cAAc,OAC9Bi9G,EAAK1+G,MAAMymB,SAAW,WACtBi4F,EAAK1+G,MAAMia,KAAO,MAClBykG,EAAK1+G,MAAMua,IAAM,MACjBmkG,EAAK1+G,MAAM0mB,WAAa,SACxBg4F,EAAK1+G,MAAMmW,SAAW,SACtBuoG,EAAK1+G,MAAM2+G,UAAY,aACvBD,EAAK1+G,MAAM4+G,WAAa,SACxBp9G,SAASc,KAAKD,YAAYq8G,IAE1BA,EAAK79F,YACL69F,EAAK/7G,YAAY+7G,EAAK79F,YAE1B69F,EAAK1+G,MAAM6+G,QAAU,UACrBH,EAAK1+G,MAAMwgC,MAAQA,EACnBk+E,EAAK1+G,MAAM85D,KAAOglD,EAAY1sG,GAC9BssG,EAAK1+G,MAAMJ,MAAQwS,EAAKxS,MAAQ,KAChC8+G,EAAK1+G,MAAMihC,UAAY7uB,EAAK6uB,WAAa,OACzCy9E,EAAK1+G,MAAM4tE,eAAiBx7D,EAAKnC,UAAY,YAAc,OAC3Du+D,EAAYp8D,EAAMssG,EAAK1+G,OACnBoS,EAAKhB,MACLstG,EAAK1+G,MAAM2mB,WAAa,WACxB+3F,EAAK1+G,MAAMquE,aAAeqwC,EAAK1+G,MAAMsuE,SAAW,eAEhDowC,EAAK1+G,MAAM2mB,WAAa,MACxB+3F,EAAK1+G,MAAMquE,aAAeqwC,EAAK1+G,MAAMsuE,SAAW,UAEpDowC,EAAKr8G,YAAYb,SAASu9G,eAAepgH,IACrC6/G,EAAS,EACLpsG,EAAK8uB,eACb,IAAK,SACDs9E,EAASpsG,EAAKvS,OAAS6+G,EAAKl8G,cAAgB,CAC5C,MACJ,KAAKsI,QACL,IAAK,MACL,IAAK,SACD0zG,EAASpsG,EAAKvS,OAAS6+G,EAAKl8G,aAG5Bg8G,EAAS,IACTA,EAAS,GAETC,EAAa5hH,MAAM2jE,QAAQw+C,QAAQX,SAASK,GAChDD,EAAWpkC,UAAUojC,EAAI57E,OAAO+7E,UAAUxrG,EAAK6H,KAAM7H,EAAKmI,IAAMikG,IAChEp+C,EAAMqK,OAAOg0C,GAEjB,QAASK,GAAY1sG,GACjB,GAAI0nD,KASJ,OARI1nD,GAAK2uB,QACL+4B,EAAKt8D,KAAK,UAEV4U,EAAK4uB,MACL84B,EAAKt8D,KAAK,QAEds8D,EAAKt8D,MAAM4U,EAAKyuB,UAAY,IAAM,MAClCi5B,EAAKt8D,KAAK4U,EAAKuxB,YAAc,SACtBm2B,EAAKz6D,KAAK,KAErB,QAAS6oC,GAAKh5B,EAAOlB,EAAO9Q,EAAS4R,GAArC,GA4BQsxD,GACA6+C,EAYApD,EACAR,EAOAvhG,CAhDW,OAAX5c,GAA+B,MAAZ4R,IACnBA,EAAWd,EACX9Q,KACA8Q,EAAQN,EAAY4qB,UAER,MAAZxpB,IACAA,EAAW5R,EACP8Q,YAAiBN,GAAY8J,OAASxJ,YAAiBN,GAAY2kB,KAAuB,gBAATrkB,GACjF9Q,MAEAA,EAAU8Q,EACVA,EAAQN,EAAY4qB,WAG5Bp7B,EAAUL,MAAMgG,OAAO7F,QACnBsvG,UAAW,KACX4F,WAAW,EACXD,OAAQ,MACRxF,YAAY,EACZuR,WAAY,OACZvB,YAAY,EACZ3K,UAAU,EACVzT,QAAQ,EACRkd,WAAY,KACZD,SAAU,GACVj8F,MAAO,GACRniB,GACCkjE,EAAQ,GAAII,GAAQ68C,MACpB4B,EAAQpiH,MAAM2f,IAAI0iG,gBAAgBhiH,GACtCkjE,EAAMljE,QAAQsyB,IAAI,OACdkiF,OAAQx0G,EAAQw0G,OAChBG,QAAS30G,EAAQ20G,QACjB1mE,KAAMjuC,EAAQiuC,KACdymE,SAAU10G,EAAQ00G,SAClBK,OAAQgN,EAAMhN,OACdkN,WAAW,EACX7S,UAAW2S,EAAM3S,UACjBqF,QAASz0G,EAAQy0G,QACjBljG,MAAOvR,EAAQuR,QAEfotG,EAAYoD,EAAM3S,UAAU,GAC5B+O,EAAa4D,EAAM3S,UAAU,GAC7B2S,EAAMhN,SACN4J,GAAaoD,EAAMhN,OAAOh4F,KAAOglG,EAAMhN,OAAO93F,MAAQ,EACtDkhG,GAAc4D,EAAMhN,OAAO13F,IAAM0kG,EAAMhN,OAAOz3F,OAAS,GAE3Dtd,EAAQ2+G,UAAYA,EACpB3+G,EAAQm+G,WAAaA,EACjBvhG,EAAS4/D,EAASxqE,EAAOA,EAAMF,KAAKhB,GAAQ9Q,GAChD6/G,EAAW7tG,EAAO4K,EAAQsmD,EAAOljE,GACjC4R,EAASsxD,GAYb,QAASg/C,MAST,QAASrlC,KAGL,QAAShrC,GAAI38B,EAAMlD,GAAnB,GAEYmwG,GACA5mF,CAFJvpB,KACImwG,EAAKnwG,EAAM62B,YACXtN,EAAOvpB,EAAMwpB,MACjBtmB,EAAKe,WAAaksG,EAAG/9G,IAAI,WAAYm3B,EAAK3wB,MAAMsK,EAAKT,IAAKS,EAAKD,MAC/DC,EAAKkB,YAAc+rG,EAAG/9G,IAAI,WAAYm3B,EAAK3wB,MAAMsK,EAAKT,IAAKS,EAAKD,IAAMC,EAAKqlE,UAC3ErlE,EAAKqB,UAAY4rG,EAAG/9G,IAAI,WAAYm3B,EAAK3wB,MAAMsK,EAAKT,IAAKS,EAAKD,MAC9DC,EAAKwB,aAAeyrG,EAAG/9G,IAAI,WAAYm3B,EAAK3wB,MAAMsK,EAAKT,IAAMS,EAAKslE,QAAStlE,EAAKD,OAEhFC,EAAKe,YACLmsG,EAAQltG,EAAKT,IAAKS,EAAKD,IAAKC,EAAKe,WAAYf,EAAK6H,KAAM7H,EAAKmI,IAAKnI,EAAKoI,QAEvEpI,EAAKkB,aACLgsG,EAAQltG,EAAKT,IAAKS,EAAKD,IAAMC,EAAKqlE,QAASrlE,EAAKkB,YAAalB,EAAK+H,MAAO/H,EAAKmI,IAAKnI,EAAKoI;AAExFpI,EAAKqB,WACL8rG,EAASntG,EAAKT,IAAKS,EAAKD,IAAKC,EAAKqB,UAAWrB,EAAKmI,IAAKnI,EAAK6H,KAAM7H,EAAK+H,OAEvE/H,EAAKwB,cACL2rG,EAASntG,EAAKT,IAAMS,EAAKslE,QAAStlE,EAAKD,IAAKC,EAAKwB,aAAcxB,EAAKoI,OAAQpI,EAAK6H,KAAM7H,EAAK+H,OAGpG,QAASmlG,GAAQ3tG,EAAKQ,EAAKM,EAAQ5M,EAAG0U,EAAKC,GAA3C,GACQpS,GAAI8xE,EAAK/nE,KAAS+nE,EAAK/nE,GAAO,GAAIitG,IAClC15G,EAAOiM,EAAM,GAAKvJ,EAAEuJ,EAAM,EAC1BjM,IAAQo3G,EAAWp3G,EAAM+M,IACzBrK,EAAEuJ,GAAOjM,EACTA,EAAK8U,OAASA,GAEdpS,EAAEuJ,IACEjR,KAAM+R,EAAO/R,KACb8/B,MAAO/tB,EAAO+tB,MACd36B,EAAGA,EACH0U,IAAKA,EACLC,OAAQA,GAIpB,QAAS+kG,GAAS5tG,EAAKQ,EAAKM,EAAQqZ,EAAG7R,EAAME,GAA7C,GACQ/R,GAAIkyE,EAAM3oE,KAAS2oE,EAAM3oE,GAAO,GAAIytG,IACpC15G,EAAOyM,EAAM,GAAK/J,EAAE+J,EAAM,EAC1BzM,IAAQo3G,EAAWp3G,EAAM+M,IACzBrK,EAAE+J,GAAOzM,EACTA,EAAKyU,MAAQA,GAEb/R,EAAE+J,IACEzR,KAAM+R,EAAO/R,KACb8/B,MAAO/tB,EAAO+tB,MACd1U,EAAGA,EACH7R,KAAMA,EACNE,MAAOA,GArDvB,GACQmgE,GAAQ,GAAI8kC,GACZllC,EAAO,GAAIklC,EAuDf,QACIrwE,IAAKA,EACLurC,MAAOA,EACPJ,KAAMA,GAGd,QAASslC,GAAgBtiH,GAyBrB,QAASuiH,GAAU1+G,GAAnB,GAEYnB,GACKJ,CAFb,IAAa,MAATuB,EAAe,CAEf,IADInB,EAAQ,GACHJ,EAAIuB,EAAM7C,SAAUsB,GAAK,GAC9BI,GAAS8/G,EAAU3+G,EAAMmF,OAAO1G,GAEpC,OAAOI,GAEX,MAAO,GAMX,QAAS+/G,GAAOh4G,GACZ,MAAK8K,GAGEwV,EAAMtgB,GACTwL,WAAYV,EACZgB,UAAWhB,EACXa,YAAab,EACbmB,aAAcnB,IANP9K,EAzCnB,GAwBQ+3G,GAWAjtG,EAlCA68C,EAAW,GAAI7wD,GAAEuyD,SACjBK,EAAU/B,EAAS+B,SA4HvB,OA3HAn0D,GAAU+qB,EAAM/qB,GACZkmB,WAAY,KACZqpF,YAAY,EACZuR,WAAY,OACZlpG,QAAS,KACT8qG,iBAAkB,OAClBC,YAAa,OACbC,cAAe,KACfC,eAAgB,KAChBp8E,WAAY,QACZ9C,SAAU,GACVyrE,UAAW,KACX2F,OAAQ,MACRC,WAAW,EACXJ,UAAU,EACVzyF,MAAO,EACP1P,UAAW,GACX2rG,SAAU,EACV0E,eAAe,IAEnBnjH,MAAM2jE,QAAQhkD,IAAIyjG,WAAWpjH,MAAM2jE,QAAQw+C,QAAQkB,aAAa1+G,WAC5Dk+G,EAAYS,EAAkBjjH,EAAQymC,WAAYzmC,EAAQ2jC,UAW1DpuB,EAASvV,EAAQuvG,YACjB/rG,KAAM,EACN8/B,MAAOtjC,EAAQ8gH,YACf,KAYJ9gH,EAAQkmB,WAAWwrB,MAAM,WAAA,GAKjB95B,GAUAsrG,EAGAC,EACAxrG,EA+BA3F,EAjDAvH,EAAOzK,EAAQkmB,WAAWzb,MAC9B,OAAKA,GAAKzJ,QAGN4W,EAAU5X,EAAQ4X,QAAQ9T,IAAI,SAAUmR,GACxC,MAAkB,gBAAPA,IAEH1D,MAAO0D,EACPgV,MAAOhV,GAGJA,IAGXiuG,EAAetrG,EAAQ9T,IAAI,SAAUmR,GACrC,MAAOA,GAAI1D,OAAS0D,EAAIgV,QAExBk5F,EAAeD,EAAap/G,IAAIy+G,GAChC5qG,EAAOlN,EAAK3G,IAAI,SAAU2Q,EAAK2E,GAC/B,OACInC,MAAOW,EAAQ9T,IAAI,SAAUmR,EAAK0f,GAC9B,GAAI9wB,GAAQ4Q,EAAIQ,EAAIgV,MAWpB,OAVIjqB,GAAQ8iH,gBACK,MAATj/G,IACIoR,EAAIE,OACJtR,EAAQlE,MAAMwV,OAAOF,EAAIE,OAAQtR,GAEjCA,GAAS,IAGjBs/G,EAAaxuF,GAAY7F,KAAKoK,IAAIqpF,EAAU1+G,GAAQs/G,EAAaxuF,KAE9D8tF,GACH5+G,MAAOA,EACPsR,OAAQnV,EAAQ8iH,cAAgB,KAAO7tG,EAAIE,OAC3CyuB,WAAYxqB,EAAW,EAAIpZ,EAAQ6iH,eAAiB7iH,EAAQ4iH,qBAK5EjrG,EAAK0U,SACDpV,MAAOisG,EAAap/G,IAAI,SAAUs/G,GAC9B,MAAOX,IACH5+G,MAAOu/G,EACPx/E,WAAY5jC,EAAQ0iH,iBACpBp/E,MAAOtjC,EAAQ2iH,kBAIvB3wG,EAAQ,GAAIrS,OAAM6Q,YAAYsoC,MAAMnhC,EAAK3W,OAAS,EAAG4W,EAAQ5W,OAAS,EAAGhB,EAAQyS,UAAW,GAAI,GAAI,IACpGg0B,WAAYzmC,EAAQymC,WACpB9C,SAAU3jC,EAAQ2jC,SAClBK,cAAe,WAEnBhyB,EAAM8hB,UACF7nB,KAAM,SACN0L,KAAMA,EACNC,QAASurG,EAAar/G,IAAI,SAAUmzE,EAAG30E,GACnC,OACIsI,MAAOtI,EACPI,MAAOu0E,WAInBjlE,GAAMg5B,MACFokE,UAAWpvG,EAAQovG,UACnB4F,UAAWh1G,EAAQg1G,UACnBD,OAAQ/0G,EAAQ+0G,OAChBxF,YAAY,EACZptF,MAAOniB,EAAQmiB,MACfyyF,SAAU50G,EAAQ40G,SAClBwJ,SAAUp+G,EAAQo+G,SAClBC,WAAY,GACbjsD,EAAStmB,QAAQ55B,KAAKkgD,KAvEdA,EAASsQ,OAAO,mBAyExBvO,EA3sBb,GAKM3jD,GACA8kB,EACAguC,EACAxuD,EACAyrG,EACAQ,EA+XAS,EAoUA6B,EACAJ,CA5sBAtjH,OAAMyQ,QAAQC,QAAQC,MAAQ3Q,MAAMyQ,QAAQC,QAAQE,QAAU,IAG9DC,EAAc7Q,MAAM6Q,YACpB8kB,EAAU9kB,EAAY8kB,QACtBguC,EAAU3jE,MAAM2jE,QAChBxuD,EAAatE,EAAYsE,WACzByrG,EAAM5gH,MAAM2jH,SACZvC,EAAkB,GAiftBvwG,EAAYsoC,MAAM3lC,UAAU63B,KAAO,SAAUl6B,EAAO9Q,EAAS4R,GACzD,GAAII,GAAQ7R,IACR6R,GAAMvB,UACNuB,EAAM8G,OAAO9G,EAAMvB,UAAU4vD,SAAU,WACnCr1B,EAAKh5B,EAAOlB,EAAO9Q,EAAS4R,KAGhCo5B,EAAKh5B,EAAOlB,EAAO9Q,EAAS4R,IAKpCswG,EAAU/uG,WACNpB,QAAS,SAAUtS,GACf0J,OAAOiY,KAAKjhB,MAAM4R,QAAQ,SAAU/P,GAChCvC,EAAEU,KAAK6B,GAAMA,EAAK7B,OACnBA,QAkMPkjH,KACAJ,EAAoB,SAAUx8E,EAAY9C,GAAtB,GAIZ2jD,GAAMxjE,EAODxhB,EAMLihH,EAhBJl6G,EAAKs6B,EAAW,IAAM8C,EACtB8G,EAAO81E,EAAiBh6G,EAC5B,KAAKkkC,EAAM,CAQP,IAPUzpB,EAAMxf,SAASC,cAAc,OACvCuf,EAAIhhB,MAAMymB,SAAW,QACrBzF,EAAIhhB,MAAMia,KAAO,WACjB+G,EAAIhhB,MAAMua,IAAM,WAChByG,EAAIhhB,MAAM2jC,WAAaA,EACvB3iB,EAAIhhB,MAAM6gC,SAAWA,EAAW,KAChC7f,EAAIhhB,MAAM2mB,WAAa,MACdnnB,EAAI,GAAIA,EAAI,MAAOA,EACxBglF,EAAOhjF,SAASC,cAAc,QAC9B+iF,EAAKniF,YAAYb,SAASu9G,eAAengH,OAAOiN,aAAarM,KAC7DwhB,EAAI3e,YAAYmiF,EAIpB,KAFAhjF,SAASc,KAAKD,YAAY2e,GACtBy/F,KACCjhH,EAAI,GAAIglF,EAAOxjE,EAAIH,WAAYrhB,EAAI,KAAOglF,IAAQhlF,EAAGglF,EAAOA,EAAK1jE,YAClE2/F,EAAOjhH,GAAKglF,EAAKjiF,WAErB,MAAOiiF,EAAOxjE,EAAIH,YACdG,EAAIre,YAAY6hF,EAEpB/5C,GAAO81E,EAAiBh6G,GAAM,SAAUI,GAAV,GACtBc,GAAOd,EAAGjH,WAAW,GACrBE,EAAQ6gH,EAAOh5G,EAQnB,OAPa,OAAT7H,IACA4kF,EAAOhjF,SAASC,cAAc,QAC9B+iF,EAAKniF,YAAYb,SAASu9G,eAAengH,OAAOiN,aAAapE,KAC7DuZ,EAAI3e,YAAYmiF,GAChB5kF,EAAQ6gH,EAAOh5G,GAAQ+8E,EAAKjiF,YAC5Bye,EAAIre,YAAY6hF,IAEb5kF,GAGf,MAAO6qC,IAEX/8B,EAAYw6B,MACR6xC,QAASA,EACTL,SAAUA,EACVlL,YAAaA,GAEjB9gE,EAAY8xG,gBAAkBA,IACd,kBAAV5iH,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD,OAEV,SAAU5B,EAAGC,QACVA,OAAO,qBACH,qBACA,oBACA,iBACA,cACA,oBACA,YACA,uBACA,yBACA,2BACA,4BACA,wBACA,0BACA,yBACA,wBACA,0BACA,wBACA,oBACA,oBACA,wBACA,2BACA,uBACA,6BACA,yBACA,mBACA,4BACA,mBACA,mBACA,qBACA,qBACA,sBACA,mBACA,wBACA,gCACA,kCACA,sBACA,sBACA,0BACA,yBACA,qBACA,uBACA,yBACA,qBACDD,IACL,WAkdE,MAtbC,UAAUE,EAAOiO,GAAjB,GAIOrM,GACA6f,EAcAnB,EACAggD,EACAqF,EACAgN,EACAkxC,EACAliE,EAUAzhC,EACA4jG,CAlCA9jH,GAAMyQ,QAAQC,QAAQC,MAAQ3Q,EAAMyQ,QAAQC,QAAQE,QAAU,IAG9DhP,EAAI5B,EAAMgG,OACVyb,EAAO7f,EAAEzB,QACT4jH,IAAK,IACLC,IAAK,IACLptB,EAAG,GACHqtB,EAAG,GACHC,EAAG,GACHjlB,EAAG,GACHklB,EAAG,GACHC,EAAG,GACHl7F,SAAU,GACVD,OAAQ,GACRo7F,OAAQ,GACRC,EAAG,IACJtkH,EAAMyhB,MACLnB,EAAStgB,EAAMqgB,GAAGC,OAClBggD,EAAWtgE,EAAM6Q,YAAYyvD,SAC7BqF,EAAa3lE,EAAM6Q,YAAY80D,WAC/BgN,EAAO3yE,EAAM6Q,YAAY8hE,KACzBkxC,EAAK,oBACLliE,GACAxoC,QAAQ,EACRF,WAAW,EACX7B,YAAY,EACZ6F,QAAQ,EACRglD,gBAAgB,EAChB9kD,QAAQ,EACR+qB,cAAc,EACdkiC,aAAa,GAEblqD,GAAeE,QAAS,0BACxB0jG,EAAc9jH,EAAMqgB,GAAGC,OAAOngB,QAC9BC,KAAM,SAAU2b,EAAS1b,GACrBigB,EAAOhgB,GAAGF,KAAKG,KAAKC,KAAMub,EAAS1b,GACnCG,KAAKub,QAAQpM,SAASm0G,EAAY5jG,WAAWE,SAC7C5f,KAAKoZ,MAAQ,GAAI+4D,GAAKnyE,KAAKub,SACvB43D,SAAUnzE,KAAKH,QAAQszE,SAAS3rD,KAChCuuD,QAAS/1E,KAAKH,QAAQk2E,QACtB9N,UAAWjoE,KAAKH,QAAQooE,YAE5BjoE,KAAKsQ,UAAY,GAAIwvD,GAAS9/D,KAAKH,QAASG,KAAKoZ,OACjDpZ,KAAK+jH,YAAc,GAAI5+C,GAAWnlE,KAAKoZ,MAAOpZ,KAAKsQ,WACnDtQ,KAAKgkH,cAAe,EACpBhkH,KAAKikH,sBACLjkH,KAAKoZ,MAAM7I,SAASvQ,KAAKsQ,WACzBtQ,KAAKoZ,MAAM67D,iBAAgB,GAC3Bj1E,KAAKqhE,UACLrhE,KAAKoZ,MAAM67D,iBAAgB,GAC3Bj1E,KAAKkkH,eAAiB,WAClBlkH,KAAK2c,UACP5K,KAAK/R,MACPoB,EAAE+B,QAAQ4e,GAAG,SAAWshG,EAAIrjH,KAAKkkH,gBACjClkH,KAAKub,QAAQwG,GAAG,UAAYshG,EAAIrjH,KAAKmkH,SAASpyG,KAAK/R,QAEvDmkH,SAAU,SAAUj+F,GAAV,GAkBEgiC,GAjBJrmD,EAAMqkB,EAAEgB,QACRk9F,EAAWhjH,EAAE,mDACjB,IAAIS,IAAQof,EAAKuiG,KAAOt9F,EAAEiJ,SAGtB,MAFAnvB,MAAKoZ,MAAM6uD,UAAUzjB,eACrBt+B,EAAE5N,iBACF,CACG,IAAI4N,EAAEgJ,QAAUrtB,IAAQof,EAAKyH,SAChC1oB,KAAKoZ,MAAM6uD,UAAUvnE,QAAQ,UACzBoL,KAAM9L,KAAKoZ,MAAM6uD,UAAUtsB,QAAQ37C,KAAKoZ,MAAM6uD,UAAUrjB,eAAiB,GAAG94C,OAC5E48C,aAAa,QAEd,IAAIxiC,EAAEgJ,QAAUrtB,IAAQof,EAAKwH,OAChCzoB,KAAKoZ,MAAM6uD,UAAUvnE,QAAQ,UACzBoL,KAAM9L,KAAKoZ,MAAM6uD,UAAUtsB,QAAQ37C,KAAKoZ,MAAM6uD,UAAUrjB,eAAiB,GAAG94C,OAC5E48C,aAAa,QAEd,CAAA,GAAIxiC,EAAEgJ,QAAUrtB,IAAQof,EAAK4iG,OAYhC,MAXI37D,GAAgB,SAAUhiC,GAC1B,GAAIkiC,GAAMliC,EAAEmiC,MACRD,GAAIE,eACJtoD,KAAKoZ,MAAM6uD,UAAUvnE,QAAQ,UACzBoL,KAAM9L,KAAKqY,cAAc+G,QACzBmpC,cAAc,KAGxBx2C,KAAK/R,MACPA,KAAKoZ,MAAM6uD,UAAUxkB,YAAY,gBAAkBpjC,MAAO6nC,IAC1DhiC,EAAE5N,iBACF,CACG,IAAI4N,EAAEgJ,QAAUrtB,IAAQof,EAAK6iG,EAGhC,MAFA9jH,MAAKoZ,MAAM6uD,UAAU1jB,gBACrBr+B,EAAE5N,iBACF,CACG,IAAIzW,IAAQof,EAAKsiG,KAAOvjH,KAAKoZ,MAAM4uD,UAAYnmE,IAAQof,EAAKuH,MAAQtC,EAAEiJ,UAAY/tB,EAAE+C,SAASyiG,eAAe14F,GAAGk2G,GAIlH,MAHApkH,MAAKoZ,MAAM4uD,SAAS4iC,SAAS5qG,KAAKoZ,MAAM4uD,SAASzsD,QAAQ0qB,KAAK,qBAAqB3kC,OAAOiH,eAAegT,QAAQ0qB,KAAK,iDAAiD32B,QACvKtP,KAAKoZ,MAAM4uD,SAAS4iC,SAAS5qG,KAAKoZ,MAAM4uD,SAASzsD,QAAQ0qB,KAAK,qBAAqB3kC,OAAOiH,eAAegT,QAAQ0qB,KAAK,4BAA4B92B,SAAS,mBAC3J+W,EAAE5N,iBACF,CACG,IAAI4N,EAAE+I,SAAWptB,IAAQof,EAAKm1E,EACjCh1F,EAAE,oBAAoB,GAAG2lG,YACtB,IAAI7gF,EAAE+I,SAAWptB,IAAQof,EAAKwiG,EACjCriH,EAAE,sBAAsB,GAAG2lG,YACxB,IAAI7gF,EAAE+I,SAAWptB,IAAQof,EAAKyiG,EACjCtiH,EAAE,yBAAyB,GAAG2lG,YAC3B,CAAA,GAAI7gF,EAAEgJ,QAAUrtB,IAAQof,EAAK0iG,EAGhC,MAFA3jH,MAAKoZ,MAAM4uD,SAASz4D,OAAO,GAC3B2W,EAAE5N,iBACF,CACG,IAAI4N,EAAEgJ,QAAUrtB,IAAQof,EAAKw9E,EAGhC,MAFAz+F,MAAKoZ,MAAM4uD,SAASz4D,OAAO,GAC3B2W,EAAE5N,iBACF,CACG,IAAI4N,EAAEgJ,QAAUrtB,IAAQof,EAAK2iG,EAGhC,MAFA5jH,MAAKoZ,MAAM4uD,SAASz4D,OAAO,GAC3B2W,EAAE5N,iBACF,KAGR68D,QAAS,WACLn1E,KAAKqhE,SAAU5kD,QAAQ,KAE3B4nG,gBAAiB,SAAUn+F,GAIvB,GAHIlmB,KAAKgkH,cACLhkH,KAAKqhE,QAAQn7C,GAEbA,EAAEvN,QAAUuN,EAAExU,IAAK,CACnB,GAAIf,GAAQuV,EAAEvV,OAAS,GAAInR,GAAM6Q,YAAY8J,MAAM+L,EAAExU,IAAK1R,KAAKqY,cAC/DrY,MAAKU,QAAQ,UAAYiQ,MAAOA,MAGxC2zG,aAAc,SAAUp+F,GACpBlmB,KAAKU,QAAQ,MAAOwlB,IAExBq+F,cAAe,SAAUr+F,GACrBlmB,KAAKU,QAAQ,OAAQwlB,IAEzBs+F,eAAgB,SAAUt+F,GACtBlmB,KAAKU,QAAQ,QAASwlB,IAE1B7N,YAAa,SAAUxG,GACnB,MAAO7R,MAAKsQ,UAAU+H,YAAYxG,IAEtCyvD,iBAAkB,SAAUzvD,EAAOpH,GAC/B,MAAOzK,MAAKsQ,UAAUgxD,iBAAiBzvD,EAAOpH,IAElDwpD,YAAa,SAAUp0D,GACnB,MAAOG,MAAKsQ,UAAU2jD,YAAYp0D,IAEtCslD,OAAQ,WACJ,MAAOnlD,MAAKsQ,UAAU60C,UAE1B+c,YAAa,SAAUrwD,GACnB,MAAO7R,MAAKsQ,UAAU4xD,YAAYrwD,IAEtC2pC,YAAa,SAAUmmB,GACnB,MAAO3hE,MAAKsQ,UAAUkrC,YAAYmmB,IAEtChZ,WAAY,SAAU92C,GAClB,MAAO7R,MAAKsQ,UAAUq4C,WAAW92C,IAErCkwD,aAAc,SAAUt3D,GACpB,MAAOzK,MAAKsQ,UAAUyxD,aAAat3D,IAEvCysB,YAAa,SAAUrlB,EAAOulB,GAC1B,MAAOp3B,MAAKsQ,UAAU4mB,YAAYrlB,EAAOulB,IAE7CiqC,QAAS,SAAU/vD,GAef,MAdKA,KACDA,EAAS6vC,GAER7vC,EAAOs4D,cACR5pE,KAAKoZ,MAAMvH,MAAM7R,KAAKsQ,UAAU+H,eAChCrY,KAAK+jH,YAAYlyG,MAAM7R,KAAKsQ,UAAU+H,eACtCrY,KAAKsQ,UAAU+wD,QAAQ/vD,IAEtBA,EAAOo2B,eACR1nC,KAAKoZ,MAAMioD,QAAQ/vD,GACnBtR,KAAK+jH,YAAY1iD,UACjBrhE,KAAKoZ,MAAMyqC,OAAOvyC,GAClBtR,KAAKU,QAAQ,WAEVV,MAEX6e,WAAY,SAAU/S,EAAMjM,GACxB,MAAOG,MAAKoZ,MAAMyF,WAAW/S,EAAMjM,IAEvC4kH,YAAa,SAAU/gH,GACnB,MAAIA,KAAU+J,GACVzN,KAAKgkH,aAAetgH,EAChBA,KAAU,GACV1D,KAAKqhE,UAEFrhE,MAEJA,KAAKgkH,cAEhB37E,OAAQ,WACJ,MAAOroC,MAAKsQ,UAAU+3B,UAE1B1U,SAAU,SAAU8rB,GACZA,EAAK0F,QACLnlD,KAAKsQ,UAAU2P,UACfjgB,KAAKsQ,UAAY,GAAIwvD,GAAS1+D,EAAEzB,UAAWK,KAAKH,QAAS4/C,IACzDz/C,KAAKikH,sBACLjkH,KAAKoZ,MAAM7I,SAASvQ,KAAKsQ,WACzBtQ,KAAK+jH,YAAYxzG,SAASvQ,KAAKsQ,WAC/BtQ,KAAKqY,YAAYrY,KAAKqY,gBAEtBrY,KAAKqhE,WAGb5iD,SAAU,SAAUimG,EAAM54G,GACtB,MAAO9L,MAAKsQ,UAAUmO,SAASimG,EAAM54G,IAEzCoT,UAAW,SAAUrf,GACjBG,KAAKsQ,UAAU4O,UAAU9d,EAAEzB,UAAWK,KAAKH,QAAQsf,IAAKtf,GAAW0Q,SAAUvQ,KAAKsQ,cAEtF2O,YAAa,SAAUpf,GACnBG,KAAKsQ,UAAU2O,YAAYpf,IAE/BgrC,KAAM,SAAUhrC,EAAS4R,GACrBzR,KAAKsQ,UAAUu6B,KAAKhrC,EAAS4R,IAEjCkzG,qBAAsB,SAAUz+F,GACxBlmB,KAAKU,QAAQ,cAAewlB,IAC5BA,EAAE5N,kBAGVssG,qBAAsB,SAAU1+F,GACxBlmB,KAAKU,QAAQ,cAAewlB,GAC5BA,EAAE5N,iBAEFtY,KAAK6kH,cAAc3+F,EAAE8tC,UAG7B6wD,cAAe,SAAUrzD,GAAV,GACPc,GAAUlxD,EAAE,+GAAoIiO,SAASrP,KAAKub,SAC9JymG,EAAK5gH,EAAE,oCAAsCiO,SAASijD,GAASwyD,kBAC/DvzG,KAAM,QACNwzG,WAAY,GACZ/rF,IAAK,EACLD,IAAK,EACLr1B,MAAO,IACR4G,KAAK,mBACRknD,GAASS,SAAS,SAAU/rC,GACxB87F,EAAGt+G,MAAMwiB,EAAE+rC,YACZ+yD,OAAO,WACNxlH,EAAMygB,QAAQqyC,GACdA,EAAQ7iD,YAGhBw1G,mBAAoB,SAAU/+F,GACtBlmB,KAAKU,QAAQ,YAAawlB,IAC1BA,EAAE5N,kBAGV4sG,qBAAsB,SAAUh/F,GACxBlmB,KAAKU,QAAQ,cAAewlB,IAC5BA,EAAE5N,kBAGV6sG,qBAAsB,SAAUj/F,GACxBlmB,KAAKU,QAAQ,cAAewlB,IAC5BA,EAAE5N,kBAGV8sG,qBAAsB,SAAUl/F,GACxBlmB,KAAKU,QAAQ,cAAewlB,IAC5BA,EAAE5N,kBAGV+sG,qBAAsB,SAAUn/F,GACxBlmB,KAAKU,QAAQ,cAAewlB,IAC5BA,EAAE5N,kBAGVgtG,mBAAoB,SAAUp/F,GACtBlmB,KAAKU,QAAQ,YAAawlB,IAC1BA,EAAE5N,kBAGVitG,sBAAuB,SAAUr/F,GACzBlmB,KAAKU,QAAQ,eAAgBwlB,IAC7BA,EAAE5N,kBAGVktG,mBAAoB,SAAUt/F,GACtBlmB,KAAKU,QAAQ,YAAawlB,IAC1BA,EAAE5N,kBAGVmtG,sBAAuB,SAAUv/F,GACzBlmB,KAAKU,QAAQ,eAAgBwlB,IAC7BA,EAAE5N,kBAGVotG,iBAAkB,SAAUx/F,GACpBlmB,KAAKU,QAAQ,UAAWwlB,IACxBA,EAAE5N,kBAGVqtG,oBAAqB,SAAUz/F,GACvBlmB,KAAKU,QAAQ,aAAcwlB,IAC3BA,EAAE5N,kBAGVstG,mBAAoB,SAAU1/F,GACtBlmB,KAAKU,QAAQ,YAAawlB,IAC1BA,EAAE5N,kBAGVutG,sBAAuB,SAAU3/F,GACzBlmB,KAAKU,QAAQ,eAAgBwlB,IAC7BA,EAAE5N,kBAGVwtG,gBAAiB,SAAU5/F,GACvBlmB,KAAKU,QAAQ,SAAUwlB,IAE3B6/F,sBAAuB,SAAU7/F,GAC7BlmB,KAAKU,QAAQ,eAAgBwlB,IAEjC+9F,oBAAqB,WACjBjkH,KAAKsQ,UAAUyB,KAAK,MAAO/R,KAAKskH,aAAavyG,KAAK/R,OAClDA,KAAKsQ,UAAUyB,KAAK,OAAQ/R,KAAKukH,cAAcxyG,KAAK/R,OACpDA,KAAKsQ,UAAUyB,KAAK,QAAS/R,KAAKwkH,eAAezyG,KAAK/R,OACtDA,KAAKsQ,UAAUyB,KAAK,SAAU/R,KAAKqkH,gBAAgBtyG,KAAK/R,OACxDA,KAAKsQ,UAAUyB,KAAK,cAAe/R,KAAK2kH,qBAAqB5yG,KAAK/R,OAClEA,KAAKsQ,UAAUyB,KAAK,cAAe/R,KAAK4kH,qBAAqB7yG,KAAK/R,OAClEA,KAAKsQ,UAAUyB,KAAK,YAAa/R,KAAKilH,mBAAmBlzG,KAAK/R,OAC9DA,KAAKsQ,UAAUyB,KAAK,cAAe/R,KAAKklH,qBAAqBnzG,KAAK/R,OAClEA,KAAKsQ,UAAUyB,KAAK,cAAe/R,KAAKmlH,qBAAqBpzG,KAAK/R,OAClEA,KAAKsQ,UAAUyB,KAAK,cAAe/R,KAAKolH,qBAAqBrzG,KAAK/R,OAClEA,KAAKsQ,UAAUyB,KAAK,cAAe/R,KAAKqlH,qBAAqBtzG,KAAK/R,OAClEA,KAAKsQ,UAAUyB,KAAK,YAAa/R,KAAKslH,mBAAmBvzG,KAAK/R,OAC9DA,KAAKsQ,UAAUyB,KAAK,eAAgB/R,KAAKulH,sBAAsBxzG,KAAK/R,OACpEA,KAAKsQ,UAAUyB,KAAK,YAAa/R,KAAKwlH,mBAAmBzzG,KAAK/R,OAC9DA,KAAKsQ,UAAUyB,KAAK,eAAgB/R,KAAKylH,sBAAsB1zG,KAAK/R,OACpEA,KAAKsQ,UAAUyB,KAAK,UAAW/R,KAAK0lH,iBAAiB3zG,KAAK/R,OAC1DA,KAAKsQ,UAAUyB,KAAK,aAAc/R,KAAK2lH,oBAAoB5zG,KAAK/R,OAChEA,KAAKsQ,UAAUyB,KAAK,YAAa/R,KAAK4lH,mBAAmB7zG,KAAK/R,OAC9DA,KAAKsQ,UAAUyB,KAAK,eAAgB/R,KAAK6lH,sBAAsB9zG,KAAK/R,OACpEA,KAAKsQ,UAAUyB,KAAK,SAAU/R,KAAK8lH,gBAAgB/zG,KAAK/R,OACxDA,KAAKsQ,UAAUyB,KAAK,eAAgB/R,KAAK+lH,sBAAsBh0G,KAAK/R,QAExEigB,QAAS,WACLzgB,EAAMqgB,GAAGC,OAAOhgB,GAAGmgB,QAAQlgB,KAAKC,MAChCA,KAAKsQ,UAAU2P,UACfjgB,KAAK+jH,YAAY9jG,UACjBjgB,KAAKoZ,MAAM6G,UACPjgB,KAAKkkH,gBACL9iH,EAAE+B,QAAQmoB,IAAI,SAAW+3F,EAAIrjH,KAAKkkH,iBAG1CrkH,SACIiM,KAAM,cACNiqE,SAAS,EACT9N,WAAW,EACXzwD,KAAM,IACNC,QAAS,GACTnF,UAAW,GACXF,YAAa,GACb8mC,aAAc,GACdC,YAAa,GACbqpB,OACIK,SAAU,GACV9jD,SAAU,iBAEdo0D,YACAh0D,KACIokD,KAAM,WACNxkD,SAAU,eACV8jD,SAAU,GACVosC,UAAW,KACX4F,WAAW,EACXD,OAAQ,KACRxjG,MAAO,KACPijG,OAAQ,KACRC,QAAS,KACTC,SAAU,KACVC,QAAS,4BAA8Bh1G,EAAM4Q,QAC7C09B,KAAM,MAEVsL,kBACI9S,WAAY,QACZ9C,SAAU,MAEd6d,oBAAoB,GAExB9hC,WAAY,SAAUzT,EAAMpI,EAAOo3C,GAC/B,MAAO96C,MAAKsQ,UAAUiP,WAAWzT,EAAMpI,EAAOo3C,IAElDr7B,aAAc,SAAU3T,GACpB,MAAO9L,MAAKsQ,UAAUmP,aAAa3T,IAEvCimC,UAAW,SAAUjmC,GACjB,MAAO9L,MAAKsQ,UAAUyhC,UAAUjmC,IAEpCk2D,YAAa,SAAU50B,GACnB,MAAOptC,MAAKsQ,UAAU0xD,YAAY50B,IAEtCw6B,gBAAiB,WACb,MAAO5nE,MAAKoZ,MAAMwuD,iBAEtBC,qBAAsB,WAClB,MAAO7nE,MAAKoZ,MAAMyuD,sBAEtBC,qBAAsB,WAClB,MAAO9nE,MAAKoZ,MAAM0uD,sBAEtB5nE,QACI,MACA,OACA,QACA,YACA,cACA,cACA,SACA,SACA,cACA,cACA,cACA,YACA,eACA,YACA,cACA,eACA,UACA,aACA,YACA,eACA,SACA,kBAGRV,EAAM6Q,YAAY8wC,YAAcA,EAChC3hD,EAAMqgB,GAAGmmG,OAAO1C,GAChBliH,EAAEzB,QAAO,EAAM2jH,GAAe5jG,WAAYA,MAC5Cvc,OAAO3D,OACF2D,OAAO3D,OACE,kBAAVD,SAAwBA,OAAOyB,IAAMzB,OAAS,SAAU0B,EAAIC,EAAIC,IACrEA,GAAMD","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        window.kendo.util = window.kendo.util || {};\n        var LRUCache = kendo.Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var map = this._map;\n                var entry = {\n                    key: key,\n                    value: value\n                };\n                map[key] = entry;\n                if (!this._head) {\n                    this._head = this._tail = entry;\n                } else {\n                    this._tail.newer = entry;\n                    entry.older = this._tail;\n                    this._tail = entry;\n                }\n                if (this._length >= this._size) {\n                    map[this._head.key] = null;\n                    this._head = this._head.newer;\n                    this._head.older = null;\n                } else {\n                    this._length++;\n                }\n            },\n            get: function (key) {\n                var entry = this._map[key];\n                if (entry) {\n                    if (entry === this._head && entry !== this._tail) {\n                        this._head = entry.newer;\n                        this._head.older = null;\n                    }\n                    if (entry !== this._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = this._tail;\n                        entry.newer = null;\n                        this._tail.newer = entry;\n                        this._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\n        var SPACE = ' ';\n        function normalizeText(text) {\n            return String(text).replace(REPLACE_REGEX, SPACE);\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var DEFAULT_OPTIONS = { baselineMarkerSize: 1 };\n        var defaultMeasureBox;\n        if (typeof document !== 'undefined') {\n            defaultMeasureBox = document.createElement('div');\n            defaultMeasureBox.style.cssText = 'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: pre!important;';\n        }\n        var TextMetrics = kendo.Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this.options = $.extend({}, DEFAULT_OPTIONS, options);\n            },\n            measure: function (text, style, options) {\n                if (options === void 0) {\n                    options = {};\n                }\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = objectKey(style);\n                var cacheKey = hashKey(text + styleKey);\n                var cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = options.box || defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (typeof value !== 'undefined') {\n                        measureBox.style[key] = value;\n                    }\n                }\n                var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n                measureBox.textContent = textStr;\n                measureBox.appendChild(baselineMarker);\n                document.body.appendChild(measureBox);\n                if (textStr.length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                var marker = document.createElement('div');\n                marker.style.cssText = 'display: inline-block; vertical-align: baseline;width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;overflow: hidden;';\n                return marker;\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.deepExtend(kendo.util, {\n            LRUCache: LRUCache,\n            TextMetrics: TextMetrics,\n            measureText: measureText,\n            objectKey: objectKey,\n            hashKey: hashKey,\n            normalizeText: normalizeText\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend;\n        function sqr(value) {\n            return value * value;\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                return id in cache ? cache[id] : cache[id] = f.apply(this, arguments);\n            };\n        }\n        function isUnicodeLetter(ch) {\n            return RX_UNICODE_LETTER.test(ch);\n        }\n        function withExit(f, obj) {\n            try {\n                return f.call(obj, function (value) {\n                    throw new Return(value);\n                });\n            } catch (ex) {\n                if (ex instanceof Return) {\n                    return ex.value;\n                }\n                throw ex;\n            }\n            function Return(value) {\n                this.value = value;\n            }\n        }\n        deepExtend(kendo, {\n            util: {\n                now: now,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                sqr: sqr,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                isUnicodeLetter: isUnicodeLetter,\n                withExit: withExit\n            }\n        });\n        var RX_UNICODE_LETTER = new RegExp('[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]');\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.range().select();\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    if (this.options.property === 'format') {\n                        this._workbook.trigger('changeFormat', { range: range });\n                    }\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                if (!this.range().enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                if (!this.range().canEditArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                this.getState();\n                var range = this.range().skipHiddenCells();\n                range.clearContent();\n                var validationState = range._getValidationState();\n                if (validationState) {\n                    return this.rejectState(validationState);\n                }\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = options.property || 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            _setRange: function (range) {\n                PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n                this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            _exec: function () {\n                var arrayFormula = this.options.arrayFormula;\n                var editRange = this._editRange;\n                if (!editRange.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                if (!editRange.canEditArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                var value = this._value;\n                this.getState();\n                if (this._property == 'value') {\n                    editRange.value(value);\n                    return;\n                }\n                try {\n                    editRange.link(null);\n                    if (value === '') {\n                        editRange.value(null);\n                    } else {\n                        editRange.input(value, { arrayFormula: arrayFormula });\n                        if (/\\n/.test(editRange.value())) {\n                            editRange.wrap(true);\n                        }\n                    }\n                    editRange._adjustRowHeight();\n                    var validationState = editRange._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._delta = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var delta = this._delta;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (!format) {\n                            var value = cell.value;\n                            if (typeof value == 'number' && /\\./.test(value)) {\n                                format = '0.' + String(value).split('.')[1].replace(/\\d/g, '0');\n                            }\n                        }\n                        if (format || delta > 0) {\n                            format = formatting.adjustDecimals(format || '0', delta);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            _batch: function (f) {\n                return this.range().sheet().batch(f, {});\n            },\n            exec: function () {\n                var self = this;\n                self.getState();\n                self._batch(function () {\n                    self[self._type](self._style);\n                });\n            },\n            noBorders: function () {\n                this.range().insideBorders(null);\n                this.outsideBorders(null);\n            },\n            allBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(style);\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.leftColumn().borderLeft(style);\n                range.topRow().borderTop(style);\n                range.rightColumn().borderRight(style);\n                range.bottomRow().borderBottom(style);\n            },\n            insideBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(null);\n            },\n            insideHorizontalBorders: function (style) {\n                this.range().insideHorizontalBorders(style);\n            },\n            insideVerticalBorders: function (style) {\n                this.range().insideVerticalBorders(style);\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._clipboard.parse();\n                this._event = options.event;\n                this._clipboardContent = this._clipboard._content;\n                this._clipboardPasteRef = this._clipboard.pasteRef();\n                this._sheet = this._workbook.activeSheet();\n                this._range = this._sheet.range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            _exec: function () {\n                var status = this._clipboard.canPaste();\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('paste', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._sheet.range(this._clipboardPasteRef).setState(this._clipboardContent, this._clipboard);\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: this._clipboardPasteRef\n                    });\n                    range._adjustRowHeight();\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            _eventType: 'cut',\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                if (this._eventType == 'cut') {\n                    if (!range.enable()) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    this.getState();\n                }\n                var preventDefault = this._workbook.trigger(this._eventType, { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else if (this._eventType == 'cut') {\n                    this._clipboard.cut();\n                } else {\n                    this._clipboard.copy();\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = kendo.spreadsheet.CutCommand.extend({\n            _eventType: 'copy',\n            undo: $.noop\n        });\n        function copyToClipboard(html) {\n            var textarea = document.createElement('textarea');\n            $(textarea).addClass('k-spreadsheet-clipboard').val(html).appendTo(document.body).focus().select();\n            document.execCommand('copy');\n            $(textarea).remove();\n        }\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                if (range.intersectingArrayFormula()) {\n                    return {\n                        reason: 'error',\n                        type: 'intersectsArray'\n                    };\n                }\n                this.getState();\n                try {\n                    range.fillFrom(this._origin);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            type: ex.code\n                        };\n                    }\n                    throw ex;\n                }\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                var reason = range.cantSort();\n                if (reason) {\n                    return {\n                        reason: 'error',\n                        type: reason.code\n                    };\n                }\n                range.sort({\n                    column: col,\n                    ascending: ascending\n                });\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = Command.extend({\n            exec: function () {\n                this._expandedRange = this._expand(this.range());\n                this._state = this._expandedRange.getState();\n                this._indexes = this._exec(this._expandedRange.sheet());\n            },\n            undo: function () {\n                var self = this;\n                var range = self._expandedRange;\n                var sheet = range.sheet();\n                sheet.batch(function () {\n                    self._indexes.forEach(function (x) {\n                        self._undoOne(sheet, x);\n                        sheet._restoreModifiedFormulas(x.formulas);\n                    });\n                    range.setState(self._state);\n                }, {\n                    layout: true,\n                    recalc: true,\n                    ref: range._ref\n                });\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    left: -Infinity,\n                    right: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedRows();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertRow(x.index);\n                sheet.rowHeight(x.index, x.height);\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    top: -Infinity,\n                    bottom: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedColumns();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertColumn(x.index);\n                sheet.columnWidth(x.index, x.width);\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var self = this;\n                var sheet = self.range().sheet();\n                sheet.batch(function () {\n                    for (var i = self._pos.count; --i >= 0;) {\n                        self._undoOne(sheet, self._pos.base);\n                    }\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddColumn();\n                if (result) {\n                    return result;\n                }\n                if (this._value === 'left') {\n                    this._pos = sheet.axisManager().addColumnLeft();\n                } else {\n                    this._pos = sheet.axisManager().addColumnRight();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteColumn(index);\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddRow();\n                if (result) {\n                    return result;\n                }\n                if (this._value === 'above') {\n                    this._pos = sheet.axisManager().addRowAbove();\n                } else {\n                    this._pos = sheet.axisManager().addRowBelow();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteRow(index);\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var self = this, sheet = self.range().sheet();\n                sheet.withCultureDecimals(function () {\n                    self.range().validation(self._value);\n                });\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.file).then(function () {\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog('importError', { errors: errors });\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n        var NameCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function () {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function () {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger('change', { recalc: true });\n                } catch (ex) {\n                    return {\n                        title: 'Error',\n                        body: ex + '',\n                        reason: 'error'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this)).on('paste', this._paste.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            select: function () {\n                this.setPos(0, this.length());\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                setTimeout(this._sync.bind(this));\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _paste: function (ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData('Text');\n                } else {\n                    text = ev.originalEvent.clipboardData.getData('text/plain');\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n            _move: function (key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enable(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|sym)/.test(left.type)) {\n                            return {\n                                token: left,\n                                replace: true,\n                                end: left.end\n                            };\n                        }\n                        if (/^(?:ref|sym)/.test(right.type)) {\n                            return {\n                                token: right,\n                                replace: true,\n                                end: right.end\n                            };\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (sheet) {\n                var x = this._canInsertRef();\n                if (x) {\n                    var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                    if (sheet !== this.activeSheet) {\n                        ref = ref.setSheet(sheet.name(), true);\n                    }\n                    this._replaceAt(x, ref.print(0, 0));\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n                this._sync();\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, '');\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._staticTokens.length || this._highlightedRefs.length) {\n                        this._staticTokens = [];\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223 || keyCode === 229) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            if (!name && event.key && event.key.length == 1) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start > value.start) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function ValueRange(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            },\n            clone: function () {\n                return new Range(this.start, this.end, this.value);\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(function (value) {\n                    return value.clone();\n                });\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state.clone();\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index] && this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats) {\n                Property.prototype.init.call(this, values);\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    if (!this.formats.value(start, end)) {\n                        this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                    }\n                } else if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'vBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: JsonProperty,\n                    name: 'hBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'indent',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'editor',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                }\n            ],\n            init: function (rowCount, columnCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                var cellCount = rowCount * columnCount - 1;\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this.cellCount = cellCount;\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    var name = spec.name;\n                    var value = defaultValues[name];\n                    if (value === undefined) {\n                        value = spec.value;\n                    }\n                    this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                    var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                    prop.spec = spec;\n                }, this);\n                this.lists.formula.tree.clone = cloneFormulaTree;\n                this.lists.validation.tree.clone = cloneFormulaTree;\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                switch (name) {\n                case 'borderRight':\n                    index += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    index++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                return index > this.cellCount ? null : this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                switch (name) {\n                case 'borderRight':\n                    start += this.rowCount;\n                    end += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    start++;\n                    end++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                if (start <= end && end <= this.cellCount) {\n                    this.properties[name].set(start, end, value);\n                }\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n                [\n                    'borderLeft',\n                    'borderRight',\n                    'borderTop',\n                    'borderBottom'\n                ].forEach(function (b) {\n                    if (value[b] !== undefined) {\n                        this.set(b, index, index, value[b]);\n                    }\n                }, this);\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                var prop = this.properties[name];\n                var iter = prop.iterator(start, end), at = iter.at;\n                var cellCount = this.cellCount;\n                iter.at = function (index) {\n                    return index > cellCount ? null : prop.parse(at.call(iter, index));\n                };\n                iter.name = name;\n                iter.value = prop.spec.value;\n                return iter;\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                return this.specs.reduce(function (ret, spec) {\n                    if (spec.serializable) {\n                        ret.push(this.iterator(spec.name, start, end));\n                    }\n                    return ret;\n                }.bind(this), []);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                var hBorders = this.iterator('hBorders', start, end + 1);\n                var leftBorders = this.iterator('vBorders', start, end);\n                var rightBorders = this.iterator('vBorders', start + this.rowCount, end + this.rowCount);\n                var values, index;\n                function addBorder(name, iterator, index) {\n                    var val = iterator.at(index);\n                    if (val !== iterator.value) {\n                        values[name] = val;\n                    }\n                }\n                for (index = start; index <= end; index++) {\n                    values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    addBorder('borderLeft', leftBorders, index);\n                    addBorder('borderRight', rightBorders, index + this.rowCount);\n                    addBorder('borderTop', hBorders, index);\n                    if ((index + 1) % this.rowCount) {\n                        addBorder('borderBottom', hBorders, index + 1);\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        function cloneFormulaValue(x) {\n            x = x.clone();\n            x.value = x.value.deepClone();\n            return x;\n        }\n        function cloneFormulaTree() {\n            var tree = this.map(cloneFormulaValue);\n            tree.clone = cloneFormulaTree;\n            return tree;\n        }\n        kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function (a, spec) {\n            if (spec.serializable) {\n                a.push(spec.name);\n            }\n            return a;\n        }, [\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft'\n        ]);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        sheet: '',\n        clone: function () {\n            return this;\n        },\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        clone: function () {\n            return new NameRef(this.name).setSheet(this.sheet, this.hasSheet());\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    row = abs.row % 1048576;\n                    col = abs.col % 16384;\n                    if (row < 0) {\n                        row += 1048576;\n                    }\n                    if (col < 0) {\n                        col += 16384;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col = (ret.col + acol) % 16384;\n            }\n            if (ret.rel & 2) {\n                ret.row = (ret.row + arow) % 1048576;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            return NULL;\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (rr1 === rr2 && rc1 === rc2) {\n                if (r1 > r2) {\n                    changes = true;\n                    tmp = r1;\n                    r1 = r2;\n                    r2 = tmp;\n                    tmp = rr1;\n                    rr1 = rr2;\n                    rr2 = tmp;\n                }\n                if (c1 > c2) {\n                    changes = true;\n                    tmp = c1;\n                    c1 = c2;\n                    c2 = tmp;\n                    tmp = rc1;\n                    rc1 = rc2;\n                    rc2 = tmp;\n                }\n                if (changes) {\n                    this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                    this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n                }\n            }\n            return this;\n        },\n        print: function (trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod) + ':' + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef(new CellRef(row, this.topLeft.col), new CellRef(row, this.bottomRight.col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function (col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef(new CellRef(this.topLeft.row, col), new CellRef(this.bottomRight.row, col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function (row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef(row, col, 0).setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(function (ref) {\n                if (ref instanceof UnionRef) {\n                    ref.forEach(callback, obj);\n                } else {\n                    callback.call(obj, ref);\n                }\n            }, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            var refs = [];\n            this.forEach(function (ref) {\n                refs.push(callback.call(obj, ref));\n            });\n            return new UnionRef(refs);\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col, mod) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col, mod);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selTopLeft, selBottomRight;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                var tmp;\n                function setSelection(sel) {\n                    selTopLeft = sel.topLeft;\n                    selBottomRight = sel.bottomRight;\n                }\n                setSelection(sheet.currentNavigationRange());\n                var done = false;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol);\n                            if (column == topLeftCol || column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                tmp = rows.nextVisible(row);\n                                if (tmp == row || tmp > selBottomRight.row) {\n                                    row = selTopLeft.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol);\n                            if (column == topLeftCol || column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                tmp = rows.prevVisible(row);\n                                if (tmp == row || tmp < selTopLeft.row) {\n                                    row = selBottomRight.row;\n                                } else {\n                                    row = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            setSelection(sheet.nextNavigationRange());\n                            row = selTopLeft.row;\n                            column = selTopLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow);\n                            if (row == topLeftRow || row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                tmp = columns.nextVisible(column);\n                                if (tmp == column || tmp > selBottomRight.col) {\n                                    column = selTopLeft.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            setSelection(sheet.previousNavigationRange());\n                            row = selBottomRight.row;\n                            column = selBottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow);\n                            if (row == topLeftRow || row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                tmp = columns.prevVisible(column);\n                                if (tmp == column || tmp < selTopLeft.col) {\n                                    column = selBottomRight.col;\n                                } else {\n                                    column = tmp;\n                                }\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n                    return true;\n                }\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        hint = preview.hint;\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                var indexes = [], delta = 0;\n                this.forEachSelectedColumn(function (sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenColumn(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        width: sheet.columnWidth(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteColumn(index);\n                    });\n                });\n                return indexes;\n            },\n            deleteSelectedRows: function () {\n                var indexes = [], delta = 0;\n                this.forEachSelectedRow(function (sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenRow(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        height: sheet.rowHeight(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteRow(index);\n                    });\n                });\n                return indexes;\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            preventAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.preventInsertRow(0, rowCount);\n            },\n            preventAddColumn: function () {\n                var range = this._sheet.select().toRangeRef();\n                var columnCount = range.width();\n                return this._sheet.preventInsertColumn(0, columnCount);\n            },\n            addColumnLeft: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertColumn(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addColumnRight: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertColumn(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowAbove: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertRow(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowBelow: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertRow(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = false;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = {\n                    canPaste: true,\n                    pasteOnMerged: false,\n                    pasteOnDisabled: false\n                };\n                if (!range.enable()) {\n                    status.canPaste = false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                if (this.origin === kendo.spreadsheet.NULLREF) {\n                    return sheet.select();\n                }\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            paste: function () {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function () {\n                var state = newState();\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = doc.querySelector('table');\n                        if (table) {\n                            state = parseHTML(table);\n                        } else {\n                            state = parseTSV(data.plain);\n                        }\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                    this.origin = state.origRef;\n                }\n                this._content = state;\n            },\n            _isInternal: function () {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._externalContent.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._externalContent.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                return internalHTML || internalPlain;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(row, col, element, hBorders, vBorders) {\n            var styles = window.getComputedStyle(element);\n            var text = element.innerText.replace(/\\t$/, '');\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderTop: borders.borderTop || hBorders.get(row, col) || null,\n                borderBottom: borders.borderBottom || hBorders.get(row + 1, col) || null,\n                borderLeft: borders.borderLeft || vBorders.get(row, col) || null,\n                borderRight: borders.borderRight || vBorders.get(row, col + 1) || null,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            hBorders.set(row, col, state.borderTop);\n            hBorders.set(row + 1, col, state.borderBottom);\n            vBorders.set(row, col, state.borderLeft);\n            vBorders.set(row, col + 1, state.borderRight);\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(table) {\n            var state = newState();\n            var done = [], row = 0, col = 0;\n            for (var i = 0; i < table.rows.length; ++i) {\n                done.push([]);\n            }\n            var hBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            var vBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n                var tr = table.rows[ri];\n                col = 0;\n                for (var ci = 0; ci < tr.cells.length; ++ci) {\n                    var td = tr.cells[ci];\n                    var rowSpan = td.rowSpan;\n                    var colSpan = td.colSpan;\n                    while (done[row][col]) {\n                        col++;\n                    }\n                    var style = td.getAttribute('style');\n                    var ignoreColspan = /mso-ignore:colspan/.test(style);\n                    setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders));\n                    if (rowSpan > 1 || colSpan > 1 && !ignoreColspan) {\n                        state.mergedCells.push(new kendo.spreadsheet.RangeRef(new CellRef(row, col), new CellRef(row + rowSpan - 1, col + colSpan - 1)).toString());\n                    }\n                    for (var dr = row + rowSpan; --dr >= row;) {\n                        for (var dc = col + colSpan; --dc >= col;) {\n                            if (dr < done.length) {\n                                done[dr][dc] = true;\n                                if (!(dr == row && dc == col)) {\n                                    setStateData(state, dr, dc, {});\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics',\n        'util/main'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'indent',\n            'verticalAlign',\n            'background',\n            'format',\n            'link',\n            'editor',\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft'\n        ];\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function (ref) {\n                    ref = self._normalize(ref.toRangeRef());\n                    var tl = ref.topLeft, br = ref.bottomRight;\n                    var rows = partition(tl.row, br.row, skipHiddenRows);\n                    var cols = partition(tl.col, br.col, skipHiddenCols);\n                    for (var i = 0; i < rows.length; ++i) {\n                        for (var j = 0; j < cols.length; ++j) {\n                            refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        range: self,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            input: function (value, options) {\n                options = $.extend({ arrayFormula: false }, options);\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            var existingFormatType = existingFormat && kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == 'date' && existingFormatType != 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent' && existingFormatType != 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format) {\n                                if (!existingFormat || x.currency || existingFormatType == 'number' && x.type == 'number' && x.format.length > existingFormat.length) {\n                                    this.format(x.format);\n                                }\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula, options.arrayFormula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat);\n                                var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                if (t1 == t2) {\n                                    value = t1;\n                                    break OUT;\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = kendo.spreadsheet.calc.runtime.limitPrecision(value * 100) + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            } else if (this._sheet._useCultureDecimals() && typeof value == 'number' && value != Math.floor(value)) {\n                                value = String(value).replace('.', kendo.culture().numberFormat['.']);\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    return !kendo.util.withExit(function (exit) {\n                        this._sheet.forEach(this._ref, function (_, __, data) {\n                            if (data.enable === false) {\n                                exit(true);\n                            }\n                        });\n                    }, this);\n                }\n                return this._property('enable', value);\n            },\n            formula: function (value, arrayFormula) {\n                var self = this;\n                if (value === undefined) {\n                    var f = self._get('formula');\n                    return f ? '' + f : null;\n                }\n                if (arrayFormula) {\n                    var ref = this._ref.toRangeRef();\n                    value = self._sheet.range(ref.topLeft)._set('formula', value)._get('formula');\n                    if (value) {\n                        value.setArrayFormulaRange(ref);\n                    }\n                } else {\n                    self._set('formula', value);\n                }\n                return self;\n            },\n            intersectingArrayFormula: function () {\n                var ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n                return kendo.util.withExit(function (exit) {\n                    this._sheet._forFormulas(function (f) {\n                        var r = f.arrayFormulaRange;\n                        if (r && (r = ref.intersect(r)) !== kendo.spreadsheet.NULLREF) {\n                            exit({\n                                formula: f,\n                                intersection: r\n                            });\n                        }\n                    });\n                }, this);\n            },\n            canEditArrayFormula: function () {\n                var x = this.intersectingArrayFormula();\n                if (x) {\n                    return x.formula.arrayFormulaRange.eq(x.intersection);\n                }\n                return true;\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        if (sheet.isHiddenColumn(ci)) {\n                            continue;\n                        }\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row && !sheet.isHiddenRow(ri)) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                options = options || {};\n                var clearAll = options.clearAll || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options.contentsOnly,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options.formatOnly) {\n                        PROPERTIES.forEach(function (x) {\n                            if (!(options.keepBorders && /^border/i.test(x))) {\n                                this[x](null);\n                            }\n                        }.bind(this));\n                        this.fontSize(null);\n                        this.wrap(null);\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !this.cantSort();\n            },\n            cantSort: function () {\n                if (this._ref instanceof UnionRef) {\n                    return {\n                        code: 'cantSortMultipleSelection',\n                        message: 'Unsupported for multiple ranges.'\n                    };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return {\n                        code: 'cantSortNullRef',\n                        message: 'Unsupported for NULLREF.'\n                    };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function (row, col) {\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        } else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch (ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: 'cantSortMixedCells',\n                        message: 'Unsupported for range containing cells of different shapes.'\n                    };\n                }\n                return false;\n            },\n            sort: function (spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(filter.columns[i].index);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref,\n                    rows: this._sheet._rows.getState()\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        var value = typeof cell[property] == 'undefined' ? null : cell[property];\n                        if (value instanceof kendo.spreadsheet.calc.runtime.Formula || value instanceof kendo.spreadsheet.validation.Validation) {\n                            value = value.deepClone();\n                        }\n                        cellState[property] = value;\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                var internalClipboard = clipboard && !clipboard.isExternal();\n                var externalClipboard = clipboard && !internalClipboard;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    if (!clipboard) {\n                        this._sheet._rows.setState(state.rows);\n                    }\n                    var row = origin.row;\n                    var hasFilter = this.hasFilter();\n                    state.data.forEach(function (data, dr) {\n                        if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        if (!(clipboard && property == 'enable')) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (externalClipboard) {\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set('value', null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), {\n                    recalc: true,\n                    ref: this._ref\n                });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var mc = sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                this.forEachRow(function (rowRange) {\n                    var row = rowRange._ref.topLeft.row;\n                    var height = sheet.rowHeight(row);\n                    rowRange.forEachCell(function (row, col, cell) {\n                        var id = new CellRef(row, col).print();\n                        if (secondary[id]) {\n                            return;\n                        }\n                        var merged = primary[id];\n                        var width;\n                        if (merged) {\n                            width = sheet._columns.sum(merged.topLeft.col, merged.bottomRight.col);\n                        } else {\n                            width = sheet.columnWidth(col);\n                        }\n                        var data = cell.value;\n                        if (cell.format && data != null) {\n                            data = kendo.spreadsheet.formatting.format(data, cell.format);\n                        }\n                        var textHeight = kendo.spreadsheet.util.getTextHeight(data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                        height = Math.max(height, textHeight);\n                    });\n                    sheet.rowHeight(row, height);\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var defStyle = this._sheet._defaultCellStyle;\n                return kendo.util.withExit(function (exit) {\n                    this.forEachCell(function (row, col, cell) {\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== null && val !== defStyle[key]) {\n                                exit(true);\n                            }\n                        }\n                    });\n                }, this);\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this._property('wrap', flag);\n                if (flag !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this._property('fontSize', size);\n                if (size !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            },\n            insideBorders: function (value) {\n                return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n            },\n            insideVerticalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.width() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.col++;\n                        this._sheet.range(ref)._set('vBorders', value);\n                    }\n                }, this);\n                return this;\n            },\n            insideHorizontalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.height() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.row++;\n                        this._sheet.range(ref)._set('hBorders', value);\n                    }\n                }, this);\n                return this;\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap;\" />')[0];\n        function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': wrap === true ? width + 'px' : 'auto',\n                'font-size': (fontSize || 12) + 'px',\n                'font-family': fontFamily || 'Arial',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre',\n                'overflow-wrap': wrap === true ? 'break-word' : 'normal',\n                'word-wrap': wrap === true ? 'break-word' : 'normal'\n            };\n            return kendo.util.measureText(text, styles, {\n                box: measureBox,\n                normalizeText: false\n            }).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            if (f.arrayFormulaRange) {\n                val = this.asMatrix(val) || this.asMatrix([[val]]);\n            } else if (val instanceof RangeRef) {\n                val = this._arrayArg(val);\n            }\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, wantNulls) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val, wantNulls);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val, wantNulls));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data, wantNulls));\n                } else {\n                    ret.push(val);\n                }\n            }\n            return ret;\n        },\n        fetchName: function (ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula) {\n                val = val.clone(f.sheet, f.row, f.col, true);\n                var ss = new spreadsheet.ValidationFormulaContext(this.ss.workbook);\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref) {\n                    val = val.absolute(f.row, f.col);\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError('NAME') : val);\n            }\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        _arrayArg: function (ref) {\n            var f = this.formula;\n            if (!f.arrayFormulaRange && ref instanceof RangeRef) {\n                if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                    return this.getRefData(new CellRef(ref.topLeft.row, f.col).setSheet(ref.sheet));\n                }\n                if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                    return this.getRefData(new CellRef(f.row, ref.topLeft.col).setSheet(ref.sheet));\n                }\n                return new CalcError('VALUE');\n            } else {\n                return this.asMatrix(ref);\n            }\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo, wantNulls) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n        },\n        getRefData: function (ref, wantNulls) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        getNA: function (row, col) {\n            if (row < this.height && col < this.width) {\n                return this.get(row, col);\n            }\n            return new CalcError('N/A');\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col, arrayFormulaRange) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n            this.arrayFormulaRange = arrayFormulaRange;\n        },\n        setArrayFormulaRange: function (ref) {\n            this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n        },\n        clone: function (sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            var range = this.arrayFormulaRange;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n                if (range) {\n                    range = range.clone().setSheet(sheet);\n                }\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col, range);\n        },\n        deepClone: function () {\n            var refs = this.refs.map(function (ref) {\n                return ref.clone();\n            });\n            return new Formula(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                var level = 0;\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                    ++level;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                var next = function () {\n                    if (!this.absrefs) {\n                        this.absrefs = this.refs.map(function (ref) {\n                            return ref.absolute(this.row, this.col);\n                        }, this);\n                    }\n                    this.handler.call(ctx);\n                }.bind(this);\n                if (level < 20) {\n                    next();\n                } else {\n                    setTimeout(next, 0);\n                }\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            var prevRefs = this.refs;\n            var modified = formulaMoves;\n            this.refs = prevRefs.map(function (ref) {\n                var newRef = adjust(ref);\n                if (!modified && !sameRef(newRef, ref)) {\n                    modified = true;\n                }\n                return newRef;\n            });\n            var prevRange = this.arrayFormulaRange;\n            if (prevRange) {\n                this.arrayFormulaRange = adjust(prevRange);\n                if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                    modified = true;\n                }\n            }\n            if (modified) {\n                return new Formula(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n            }\n            function adjust(ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    function sameRef(r1, r2) {\n        if (r1.constructor !== r2.constructor) {\n            return false;\n        }\n        if (r1 instanceof CellRef) {\n            return r1.sheet == r2.sheet && r1.row == r2.row && r1.col == r2.col && r1.rel == r2.rel;\n        }\n        if (r1 instanceof RangeRef) {\n            return sameRef(r1.topLeft, r2.topLeft) && sameRef(r1.bottomRight, r2.bottomRight) && r1.endSheet == r2.endSheet;\n        }\n        if (r1 instanceof UnionRef) {\n            var i = r1.refs.length;\n            if (i != r2.refs.length) {\n                return false;\n            }\n            while (--i >= 0) {\n                if (!sameRef(r1.refs[i], r2.refs[i])) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', 'round', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', 'round', main + ' return { check: check };');\n        }\n        f = f(CalcError, limitPrecision);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'if (i >= args.length) return new CalcError(\\'N/A\\'); ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var wantNulls = /!$/.test(type[0]);\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')' + (wantNulls ? ',true' : '') + ').reduce(function(ret, $' + name + '){ ';\n                    if (type[0].charAt(0) != '#') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'if (' + cond(type[1]) + ') ret.push($' + name + '); ';\n                    code += 'return ret; ';\n                    code += '}.bind(this), []); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum(round) {\n            return '(' + (round ? '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false) || ' : '(typeof ' + force() + ' == \\'number\\') || ') + '(typeof $' + name + ' == \\'boolean\\' ? ($' + name + ' = +$' + name + ', true) : false) || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this._arrayArg(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum(true);\n            }\n            if (type == 'number!') {\n                return '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false)';\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum(true) + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum(true) + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum(true) + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? (($' + name + ' = \\'\\'), true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function limitPrecision(num) {\n        return num === parseInt(num, 10) ? num : +num.toPrecision(14);\n    }\n    function maybeRoundFloatErrors(num) {\n        if (typeof num == 'number') {\n            return limitPrecision(num);\n        } else {\n            return num;\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].getNA(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function validDate(yr, mo, da) {\n        return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth(yr, mo - 1);\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str, format) {\n        if (format) {\n            format = kendo.spreadsheet.formatting.makeDateFormat(format);\n        }\n        return kendo.parseExactDate(str, format) || kendo.parseExactDate(str) || kendo.parseExactDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.validDate = validDate;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    exports.limitPrecision = limitPrecision;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        a = typeof a === 'string' ? a.toLowerCase() : a;\n        b = typeof b === 'string' ? b.toLowerCase() : b;\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    FUNCS[',getname'] = function (callback, args) {\n        this.fetchName(args[0], callback);\n    };\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        if (typeof m == 'string') {\n            m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n        }\n        return m;\n    }).args([[\n            'm',\n            [\n                'or',\n                'matrix',\n                'string'\n            ]\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list' && !validation.fromIsListValue) {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to_value ? this.to_value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from_value : '';\n            var to = this.to ? this.to_value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        deepClone: function () {\n            var v = new Validation(this);\n            v.from = v.from.deepClone();\n            if (v.to) {\n                v.to = v.to.deepClone();\n            }\n            return v;\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n            var calculateFromCallBack = function (val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function (val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            var prevFrom, prevTo, modified;\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            if (this.from) {\n                prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        modified = true;\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        modified = true;\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n            if (modified || prevFrom || prevTo) {\n                var v = new Validation(this);\n                v.from = prevFrom;\n                v.to = prevTo;\n                v.row = formulaRow;\n                v.col = formulaCol;\n                return v;\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                    delete options.fromIsListValue;\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var MODIFIED_FORMULAS;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this._sheet.forEachMergedCell(ref, function (merged) {\n                                ref = merged.topLeft;\n                            });\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            events: [\n                'commandRequest',\n                'afterInsertRow',\n                'afterDeleteRow',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select'\n            ],\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                defaultCellStyle = defaultCellStyle || {};\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap,\n                    verticalAlign: defaultCellStyle.verticalAlign,\n                    textAlign: defaultCellStyle.textAlign\n                };\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            triggerSelect: function (range) {\n                this.trigger('select', { range: range });\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                if (this.trigger('hideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                if (this.trigger('unhideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _saveModifiedFormulas: function (array, callback) {\n                var save = MODIFIED_FORMULAS;\n                MODIFIED_FORMULAS = array;\n                var ret = callback();\n                MODIFIED_FORMULAS = save;\n                return ret;\n            },\n            _restoreModifiedFormulas: function (array) {\n                var wb = this._workbook;\n                array.forEach(function (f) {\n                    var sheet = wb.sheetByName(f.sheet), index;\n                    if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('formula', index, index, f);\n                    }\n                    if (f instanceof kendo.spreadsheet.validation.Validation) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('validation', index, index, f);\n                    }\n                });\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            var prev = formula.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                        sheet._forValidations(function (validation) {\n                            var prev = validation.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            preventInsertRow: function (rowIndex, count) {\n                if (this.selectedHeaders().allRows) {\n                    return {\n                        reason: 'error',\n                        type: 'insertRowWhenColumnIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            preventInsertColumn: function (colIndex, count) {\n                if (this.selectedHeaders().allCols) {\n                    return {\n                        reason: 'error',\n                        type: 'insertColumnWhenRowIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(0, grid.columnCount - count, grid.rowCount, count);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            insertRow: function (rowIndex) {\n                var result = this.preventInsertRow(rowIndex);\n                if (result) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                if (this.trigger('insertRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterInsertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterDeleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                if (this.trigger('insertColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                if (this.trigger('hideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                if (this.trigger('unhideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            gridLinesColor: function (value) {\n                return this._field('_gridLinesColor', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            _getMergedCells: function (range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n                this.forEachMergedCell(range, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n                return {\n                    primary: primary,\n                    secondary: secondary,\n                    hasMerged: hasMerged\n                };\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                var self = this;\n                function forEachRange(ref) {\n                    if (!(ref instanceof RangeRef)) {\n                        ref = ref.toRangeRef();\n                    }\n                    var topLeft = self._grid.normalize(ref.topLeft);\n                    var bottomRight = self._grid.normalize(ref.bottomRight);\n                    var ci, ri;\n                    function doIt(value) {\n                        callback(ri++, ci, value);\n                    }\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        ri = topLeft.row;\n                        var startCellIndex = self._grid.index(ri, ci);\n                        var endCellIndex = self._grid.index(bottomRight.row, ci);\n                        self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                    }\n                }\n                if (!(ref instanceof RangeRef)) {\n                    ref = self._ref(ref);\n                }\n                if (ref instanceof UnionRef) {\n                    ref.forEach(forEachRange);\n                } else {\n                    forEachRange(ref);\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function (key) {\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    clearDefaultStyle(cell);\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        if (cell.formula.arrayFormulaRange) {\n                            cell.formula = {\n                                src: cell.formula.toString(),\n                                ref: cell.formula.arrayFormulaRange.toString()\n                            };\n                        } else {\n                            cell.formula = cell.formula.toString();\n                        }\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        var isArray = typeof cell.formula != 'string';\n                                        var src = isArray ? cell.formula.src : cell.formula;\n                                        var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                        if (isArray) {\n                                            formula.setArrayFormulaRange(kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                        }\n                                        cell.formula = formula;\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef.first();\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                    this._gridLinesColor = json.gridLinesColor;\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    return validation.clone(this._name(), row, col);\n                }\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason || { recalc: true });\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.forEach(ref, function (row, col, props) {\n                    var formula = props.formula;\n                    if (formula) {\n                        var diff = row - formula.row;\n                        if (diff !== 0) {\n                            var start = diff > 0 ? formula.row : formula.row + diff;\n                            formula.adjust(this.name(), 'row', start, diff);\n                        }\n                    }\n                }.bind(this));\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    recalc: true,\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        recalc: true,\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            },\n            _useCultureDecimals: function () {\n                return this._workbook && this._workbook.options.useCultureDecimals;\n            },\n            withCultureDecimals: function (f) {\n                var dot = '.';\n                if (this._useCultureDecimals()) {\n                    dot = kendo.culture().numberFormat['.'];\n                }\n                return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-bare',\n            sheetsBarKArrowW: 'k-i-arrow-60-left',\n            sheetsBarKArrowE: 'k-i-arrow-60-right',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-close',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._openDialog = options.openDialog;\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = outerWidth(addButton) + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = outerWidth(scrollPrevButton) + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: outerWidth(scrollNextButton) + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        if (sheets.length > 1) {\n                            var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                            elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                        }\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                var closeCallback = function (e) {\n                    var dlg = e.sender;\n                    if (dlg.isConfirmed()) {\n                        this.trigger('remove', {\n                            name: removedSheetName,\n                            confirmation: true\n                        });\n                    }\n                }.bind(this);\n                this._openDialog('confirmation', { close: closeCallback });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var Ref = spreadsheet.Ref;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS_STANDARD = Object.create(null);\n    var OPERATORS_COMMA = Object.create(null);\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS_STANDARD[op] = ops.length - i;\n                OPERATORS_COMMA[op == ',' ? ';' : op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var OPERATORS = OPERATORS_STANDARD;\n    var SEPARATORS = {\n        DEC: '.',\n        ARG: ',',\n        COL: ','\n    };\n    function setDecimalSeparator(sep) {\n        SEPARATORS.DEC = sep;\n        SEPARATORS.ARG = sep == ',' ? ';' : ',';\n        SEPARATORS.COL = sep == ',' ? '\\\\' : ',';\n        OPERATORS = sep == ',' ? OPERATORS_COMMA : OPERATORS_STANDARD;\n    }\n    exports.withDecimalSeparator = function (sep, f) {\n        if (SEPARATORS.DEC == sep) {\n            return f();\n        }\n        var save = SEPARATORS.DEC;\n        setDecimalSeparator(sep);\n        try {\n            return f();\n        } finally {\n            setDecimalSeparator(save);\n        }\n    };\n    exports._separators = SEPARATORS;\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 1048576 && col < 16384) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', SEPARATORS.ARG)) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else if (!allowEOF) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            while (1) {\n                if (is('punc', ')')) {\n                    break;\n                }\n                if (is('op', SEPARATORS.ARG)) {\n                    args.push({ type: 'null' });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is('punc', ')')) {\n                    break;\n                }\n                skip('op', SEPARATORS.ARG);\n            }\n            skip('punc', ')', true);\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom() {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')', true);\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}', true);\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseAtom()\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else if (is('punc', '[')) {\n                input.croak('External reference not supported');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is(null, ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip(null, SEPARATORS.COL);\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != SEPARATORS.ARG)) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value == ';' ? ',' : tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef)) {\n            throw new ParseError('Invalid name: ' + name);\n        }\n        nameRef = nameRef.ast;\n        if (!(def instanceof Ref)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref) {\n                def = defAST.ast;\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value;\n            } else {\n                def = makeFormula(defAST);\n            }\n        }\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    function makePrinter(exp) {\n        return makeClosure('function(row, col, mod){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n                return '(kendo.spreadsheet.calc._separators.DEC == \\'.\\' ? ' + JSON.stringify(JSON.stringify(node.value)) + ' : ' + JSON.stringify(JSON.stringify(node.value)) + '.replace(\\'.\\' , kendo.spreadsheet.calc._separators.DEC))';\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col, mod)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    if (/^[,;]/.test(node.op)) {\n                        return left + ' + kendo.spreadsheet.calc._separators.ARG + ' + right;\n                    } else {\n                        return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                    }\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + kendo.spreadsheet.calc._separators.ARG + \\' \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + kendo.spreadsheet.calc._separators.COL + \\' \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'prefix' && prec == OPERATORS[op] && parent.op == '-' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n                return cpsRef(node, k);\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsRef(node, k) {\n            return node.ref == 'name' ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsNameRef(node, k) {\n            return {\n                type: 'func',\n                func: ',getname',\n                args: [\n                    makeContinuation(k),\n                    node\n                ]\n            };\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\r\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    var EOF = { type: 'eof' };\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || util.isUnicodeLetter(ch);\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '\\\\!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == SEPARATORS.DEC) {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            if (number == SEPARATORS.DEC) {\n                return {\n                    type: 'punc',\n                    value: SEPARATORS.DEC\n                };\n            } else {\n                return {\n                    type: 'num',\n                    value: parseFloat(number.replace(SEPARATORS.DEC, '.'))\n                };\n            }\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return null;\n            }\n            if (!a && !c || a && c) {\n                var num = b ? parseInt(b, 10) : 0;\n                return a ? num : num - 1;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) | (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == SEPARATORS.DEC) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character with code: ' + ch.charCodeAt(0));\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input, format) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^-?[0-9]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input, format);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            format = null;\n            if (num != Math.floor(num)) {\n                format = '0.' + String(num).split('.')[1].replace(/\\d/g, '0');\n            }\n            return {\n                type: 'number',\n                value: num,\n                format: format\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    function parseSqref(input, row, col) {\n        row = row || 0;\n        col = col || 0;\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var refs = [];\n        while (!input.eof()) {\n            var ref = input.next();\n            if (ref.type != 'ref') {\n                throw new ParseError('Expecting a reference but got: ' + JSON.stringify(ref));\n            }\n            refs.push(ref.absolute(row, col));\n        }\n        return refs;\n    }\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.parseSqref = parseSqref;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m, date = 0, format = '';\n        if (m = /^(\\d+)([-\\/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input)) {\n            var mo = parseInt(m[1], 10);\n            var sep = m[2];\n            var da = parseInt(m[3], 10);\n            var yr = parseInt(m[4], 10);\n            if (yr < 30) {\n                yr += 2000;\n            } else if (yr < 100) {\n                yr += 1900;\n            }\n            var monthFirst = true;\n            if (mo > 12) {\n                var tmp = mo;\n                mo = da;\n                da = tmp;\n                monthFirst = false;\n            }\n            if (!runtime.validDate(yr, mo, da)) {\n                return null;\n            }\n            date = runtime.packDate(yr, mo - 1, da);\n            if (date < 0) {\n                date--;\n            }\n            if (monthFirst) {\n                format = [\n                    'mm',\n                    'dd',\n                    'yyyy'\n                ].join(sep);\n            } else {\n                format = [\n                    'dd',\n                    'mm',\n                    'yyyy'\n                ].join(sep);\n            }\n            format += m[5];\n            input = input.substr(m[0].length);\n        }\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: format + 'hh:mm',\n                value: date + runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: format + 'mm:ss.00',\n                value: date + runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: format + 'hh:mm:ss',\n                value: date + runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: format + 'hh:mm:ss.00',\n                value: date + runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        var has_percent = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '#';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n            has_percent = true;\n            suffix = m[0];\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format += ',#';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        value = parseFloat(value);\n        if (has_percent) {\n            value /= 100;\n        }\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n        return {\n            type: 'number',\n            currency: has_currency,\n            format: format,\n            value: sign * value\n        };\n    });\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input)) {\n            return {\n                type: 'number',\n                value: parseFloat(input) / 100,\n                format: '0.' + repeat('0', m[2].length) + m[3]\n            };\n        }\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    var MAP_EXCEL_OPERATOR = {\n        greaterThanOrEqual: 'greaterThanOrEqualTo',\n        lessThanOrEqual: 'lessThanOrEqualTo'\n    };\n    var ERROR_LOG = null;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    var SEL_VALIDATION = [\n        'dataValidations',\n        'dataValidation'\n    ];\n    var SEL_VALIDATION_FORMULA1 = [\n        'dataValidations',\n        'dataValidation',\n        'formula1'\n    ];\n    var SEL_VALIDATION_FORMULA2 = [\n        'dataValidations',\n        'dataValidation',\n        'formula2'\n    ];\n    var SEL_VALIDATION_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation'\n    ];\n    var SEL_VALIDATION_SQREF_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'xm:sqref'\n    ];\n    var SEL_VALIDATION_FORMULA1_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'x14:formula1',\n        'xm:f'\n    ];\n    var SEL_VALIDATION_FORMULA2_INSANE = [\n        'x14:dataValidations',\n        'x14:dataValidation',\n        'x14:formula2',\n        'xm:f'\n    ];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            file = 'xl/' + file;\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        ERROR_LOG = workbook.excelImportErrors = [];\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                    workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (name != '_xlnm._FilterDatabase') {\n                        if (sheet) {\n                            name = '\\'' + sheet.replace(/\\'/g, '\\\\\\'') + '\\'!' + name;\n                        }\n                        withErrorLog(sheet, null, function () {\n                            workbook.defineName(name, text, bool(attrs.hidden));\n                        }, 'reading user-defined name: ' + name);\n                    }\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return fraction * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * (4 / 3);\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var sharedFormulas = {};\n        var ref, type, value, formula, formulaRange, isArrayFormula;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        var formula1, formula2;\n        var filterRef;\n        var filterColumn;\n        var customFilterLogic;\n        var customFilterCriteria;\n        var valueFilterBlanks;\n        var valueFilterValues;\n        var filters = [];\n        ERROR_LOG = sheet._workbook.excelImportErrors;\n        parse(zip, xl(file), {\n            enter: function (tag, attrs, closed) {\n                var tmp;\n                if (this.is(SEL_FORMULA)) {\n                    if (closed) {\n                        if (attrs.t == 'shared' && attrs.si != null) {\n                            formula = sheet.range(sharedFormulas[attrs.si])._get('formula');\n                        }\n                    }\n                } else if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    ref = attrs.r;\n                    formulaRange = null;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === '1' || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        applyStyle(sheet, new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity, start), new kendo.spreadsheet.CellRef(+Infinity, stop)), styles, attrs.style);\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === '1' || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                } else if (this.is(['autoFilter'])) {\n                    filterRef = attrs.ref;\n                    if (closed) {\n                        addAutoFilter();\n                    }\n                } else if (filterRef) {\n                    if (this.is(['filterColumn'])) {\n                        filterColumn = parseInt(attrs.colId, 10);\n                    } else if (this.is(['customFilters'])) {\n                        customFilterLogic = bool(attrs.and) ? 'and' : 'or';\n                        customFilterCriteria = [];\n                    } else if (this.is(['customFilter'])) {\n                        tmp = getCustomFilter(attrs.operator, attrs.val);\n                        if (tmp) {\n                            customFilterCriteria.push({\n                                operator: tmp.operator,\n                                value: tmp.value\n                            });\n                        }\n                    } else if (this.is(['dynamicFilter'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.DynamicFilter({ type: dynamicFilterType(attrs.type) })\n                        });\n                    } else if (this.is(['top10'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.TopFilter({\n                                value: getFilterVal(attrs.val),\n                                type: function (percent, top) {\n                                    return percent && top ? 'topPercent' : top ? 'topNumber' : percent ? 'bottomPercent' : 'bottomNumber';\n                                }(bool(attrs.percent), bool(attrs.top))\n                            })\n                        });\n                    } else if (this.is(['filters'])) {\n                        valueFilterBlanks = bool(attrs.blank);\n                        valueFilterValues = [];\n                    } else if (this.is(['filter'])) {\n                        valueFilterValues.push(getFilterVal(attrs.val));\n                    }\n                }\n            },\n            leave: function (tag, attrs) {\n                if (this.is(SEL_FORMULA)) {\n                    if (!formula && attrs.t == 'shared' && attrs.si != null) {\n                        formula = sheet.range(sharedFormulas[attrs.si])._get('formula');\n                    }\n                } else if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        var failed = withErrorLog(sheet, formulaRange || ref, function () {\n                            sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                        }, 'parsing formula');\n                        if (failed) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (this.is(SEL_VALIDATION) || this.is(SEL_VALIDATION_INSANE)) {\n                    (function () {\n                        var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                        var type = attrs.type.toLowerCase();\n                        var operator = attrs.operator;\n                        if (/^(?:whole|decimal)$/.test(type)) {\n                            type = 'number';\n                        } else if (type == 'list') {\n                            operator = 'list';\n                        }\n                        if (!operator && /^(?:number|date)$/.test(type)) {\n                            operator = 'between';\n                        }\n                        refs.forEach(function (ref) {\n                            withErrorLog(sheet, ref, function () {\n                                sheet.range(ref).validation({\n                                    type: bool(attrs.showErrorMessage, true) ? 'reject' : 'warning',\n                                    from: formula1,\n                                    to: formula2,\n                                    dataType: type,\n                                    comparerType: MAP_EXCEL_OPERATOR[operator] || operator,\n                                    allowNulls: bool(attrs.allowBlank),\n                                    showButton: bool(attrs.showDropDown) || type == 'date' || type == 'list',\n                                    messageTemplate: attrs.error,\n                                    titleTemplate: attrs.errorTitle\n                                });\n                            }, 'parsing validation');\n                        });\n                    }());\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                } else if (tag == 'autoFilter') {\n                    addAutoFilter();\n                } else if (filterRef) {\n                    if (tag == 'customFilters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.CustomFilter({\n                                logic: customFilterLogic,\n                                criteria: customFilterCriteria\n                            })\n                        });\n                    } else if (tag == 'filters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.ValueFilter({\n                                values: valueFilterValues,\n                                blanks: valueFilterBlanks\n                            })\n                        });\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    isArrayFormula = attrs.t == 'array';\n                    if (isArrayFormula) {\n                        formulaRange = attrs.ref;\n                    } else if (attrs.t == 'shared') {\n                        sharedFormulas[attrs.si] = ref;\n                    }\n                } else if (this.is(SEL_VALIDATION_FORMULA1) || this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                    formula1 = text;\n                } else if (this.is(SEL_VALIDATION_FORMULA2) || this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                    formula2 = text;\n                } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                    this.stack[this.stack.length - 2].sqref = text;\n                }\n            }\n        });\n        function addAutoFilter() {\n            sheet.range(filterRef).filter(filters);\n            filterRef = null;\n        }\n    }\n    function getCustomFilter(op, value) {\n        var ourOp = {\n            equal: 'eq',\n            notEqual: 'ne',\n            greaterThan: 'gt',\n            greaterThanOrEqual: 'gte',\n            lessThan: 'lt',\n            lessThanOrEqual: 'lte'\n        }[op];\n        value = getFilterVal(value);\n        if (ourOp && typeof value == 'number') {\n            return {\n                operator: ourOp,\n                value: value\n            };\n        }\n        if ((op == 'notEqual' || !op) && typeof value == 'string') {\n            return {\n                operator: op ? 'doesnotmatch' : 'matches',\n                value: value\n            };\n        }\n    }\n    function dynamicFilterType(type) {\n        return {\n            Q1: 'quarter1',\n            Q2: 'quarter2',\n            Q3: 'quarter3',\n            Q4: 'quarter4',\n            M1: 'january',\n            M2: 'february',\n            M3: 'march',\n            M4: 'april',\n            M5: 'may',\n            M6: 'june',\n            M7: 'july',\n            M8: 'august',\n            M9: 'september',\n            M10: 'october',\n            M11: 'november',\n            M12: 'december'\n        }[type.toUpperCase()] || type;\n    }\n    function getFilterVal(val) {\n        var tmp = parseFloat(val);\n        if (!isNaN(tmp) && tmp == val) {\n            return tmp;\n        }\n        return val;\n    }\n    function withErrorLog(sheet, ref, func, context) {\n        try {\n            func();\n            return false;\n        } catch (ex) {\n            var err = {\n                context: context,\n                error: String(ex)\n            };\n            if (sheet) {\n                err.sheet = sheet.name();\n            }\n            if (ref) {\n                err.location = String(ref);\n            }\n            ERROR_LOG.push(err);\n            return true;\n        }\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'indent')) {\n            range.indent(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            if (f.size) {\n                range._property('fontSize', f.size * 4 / 3);\n            }\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n            if (f.underline) {\n                range.underline(true);\n            }\n            if (f.color) {\n                range.color(f.color);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    } else if (tag == 'u') {\n                        font.underline = attrs.val == null || attrs.val == 'single';\n                    } else if (tag == 'color') {\n                        font.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag)) {\n                        border[tag] = { style: attrs.style || 'none' };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                        if (attrs.indent != null) {\n                            xf.indent = integer(attrs.indent);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return INDEXED_COLORS[0];\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'change',\n                'excelImport',\n                'excelExport',\n                'insertSheet',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetInsertRow: function (e) {\n                if (this.trigger('insertRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetInsertColumn: function (e) {\n                if (this.trigger('insertColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (this.trigger('deleteRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideRow: function (e) {\n                if (this.trigger('hideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideColumn: function (e) {\n                if (this.trigger('hideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideRow: function (e) {\n                if (this.trigger('unhideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                var self = this;\n                return self._sheet.withCultureDecimals(function () {\n                    return new kendo.spreadsheet.Range(ref, self._sheet).input();\n                });\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    if (command.cannotUndo) {\n                        this.undoRedoStack.clear();\n                    } else {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth, options.defaultCellStyle || this.options.defaultCellStyle);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                this._bindSheetEvents(sheet);\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            _bindSheetEvents: function (sheet) {\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('insertRow', this._sheetInsertRow.bind(this));\n                sheet.bind('insertColumn', this._sheetInsertColumn.bind(this));\n                sheet.bind('deleteRow', this._sheetDeleteRow.bind(this));\n                sheet.bind('deleteColumn', this._sheetDeleteColumn.bind(this));\n                sheet.bind('hideRow', this._sheetHideRow.bind(this));\n                sheet.bind('hideColumn', this._sheetHideColumn.bind(this));\n                sheet.bind('unhideRow', this._sheetUnhideRow.bind(this));\n                sheet.bind('unhideColumn', this._sheetUnhideColumn.bind(this));\n                sheet.bind('select', this._sheetSelect.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n                if (!newSheetName || oldSheetName === newSheetName.toLowerCase() || this.sheetByName(newSheetName)) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (this.trigger('renameSheet', {\n                        sheet: sheet,\n                        newSheetName: newSheetName\n                    })) {\n                    return;\n                }\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                this.forEachName(function (def, name) {\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                if (this.trigger('removeSheet', { sheet: sheet })) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n                if (json.names) {\n                    json.names.forEach(function (def) {\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function (name) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + '';\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value: val,\n                        hidden: def.hidden,\n                        name: def.name,\n                        sheet: def.nameref.sheet,\n                        localName: def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            nameForRef: function (ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + '';\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || val.sheet && sheet == val.sheet.toLowerCase()) {\n                            if (val + '' == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n            defineName: function (name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value: x.value,\n                    hidden: hidden,\n                    name: name,\n                    nameref: x.name\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name.toLowerCase()];\n            },\n            nameValue: function (name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            nameDefinition: function (name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n            forEachName: function (func) {\n                Object.keys(this._names).forEach(function (name) {\n                    func(this._names[name], name);\n                }, this);\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref && x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    } else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? 'row' : 'col', start, delta);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (wantNulls || formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (wantNulls || formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{ value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError('NAME') : val }];\n            }\n            return [];\n        },\n        nameValue: function (ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                val = this.workbook.nameValue(ref.print());\n            } else {\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(ref.print());\n                if (val == null) {\n                    val = this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n        getData: function (ref, fsheet, frow, fcol, wantNulls) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function (cell) {\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            var arrayRange = f.arrayFormulaRange;\n            if (arrayRange) {\n                var tlRow, tlCol;\n                var width = value.width;\n                var height = value.height;\n                sheet.forEach(arrayRange, function (row, col) {\n                    if (tlRow === undefined) {\n                        tlRow = row;\n                        tlCol = col;\n                    }\n                    var vrow = row - tlRow;\n                    var vcol = col - tlCol;\n                    var val;\n                    if (vrow < height && vcol < width) {\n                        val = value.get(vrow, vcol);\n                    } else {\n                        val = new kendo.spreadsheet.calc.runtime.CalcError('N/A');\n                    }\n                    sheet._value(row, col, val);\n                });\n            } else {\n                if (value instanceof Ref) {\n                    value = this.getData(value, f.sheet, row, col);\n                    if (Array.isArray(value)) {\n                        value = value[0];\n                    }\n                    if (value === undefined) {\n                        value = null;\n                    }\n                }\n                if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    value = value.get(0, 0);\n                }\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            'alt+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            'pageup': 'onPageUp',\n            'pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur',\n            'shift+ctrl+enter': 'onEditorArrayFormula'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                view.nameEditor.bind('enter', this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind('cancel', this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind('select', this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind('delete', this.onNameEditorDelete.bind(this));\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === 'error') {\n                        this.editor.deactivate(true);\n                        this.view.showError(result, function () {\n                            this.activateEditor(false);\n                            this.editor.value(this._lastEditorValue);\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    if (this._workbook.trigger('insertSheet')) {\n                        return;\n                    }\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger('selectSheet', { sheet: sheet })) {\n                        return;\n                    }\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({\n                        reason: 'error',\n                        type: 'duplicateSheetName'\n                    });\n                    return;\n                }\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    this.resetEditorValue();\n                }\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n            onScroll: function () {\n                this.view.render({ scroll: true });\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    var casual = action !== ':edit';\n                    if (action == 'delete' || action == 'backspace') {\n                        if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || !casual) {\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (casual) {\n                            this.editor.value('');\n                        }\n                        this.activateEditor(casual);\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (object.type === 'editor') {\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    clientX: event.clientX,\n                    clientY: event.clientY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                var sel = this._workbook.activeSheet().selection();\n                this.activateEditor(!sel.value() && !sel.formula());\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = this.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            this.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: {\n                                    workbook: this.view._workbook,\n                                    event: e.originalEvent || e\n                                }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                if (!location) {\n                    return;\n                }\n                var box = this.container[0].getBoundingClientRect();\n                return this.view.objectAt(location.clientX - box.left, location.clientY - box.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openCustomEditor: function () {\n                this.view.openCustomEditor();\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            _saveEditorValue: function (arrayFormula) {\n                var sheet = this.editor._range.sheet();\n                var value = this.editor.value();\n                if (this._workbook.activeSheet() !== sheet) {\n                    this._workbook.activeSheet()._setFormulaSelections();\n                    this._workbook.activeSheet(sheet);\n                }\n                sheet.isInEditMode(false);\n                this._lastEditorValue = value;\n                this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        value: value,\n                        arrayFormula: arrayFormula\n                    }\n                });\n            },\n            onEditorChange: function () {\n                this._saveEditorValue(false);\n            },\n            onEditorArrayFormula: function () {\n                this._saveEditorValue(true);\n                this.editor.deactivate(true);\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.resetEditorValue();\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this._preventNavigation = false;\n                this.editor.deactivate();\n                if (!this._preventNavigation) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n                    this.deactivateEditor();\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    event.preventDefault();\n                } else if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            resetEditorValue: function () {\n                var sheet = this._workbook.activeSheet();\n                var ref = sheet.activeCell();\n                var input = this._workbook._inputForRef(ref);\n                var x = sheet.range(ref).intersectingArrayFormula();\n                if (x) {\n                    input = '=' + x.formula;\n                }\n                this.editor.value(input, !!x);\n            },\n            activateEditor: function (casual) {\n                this._casualEditing = casual;\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n            deactivateEditor: function () {\n                this.view.editor.deactivate();\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            },\n            onNameEditorEnter: function () {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n                this._execute({\n                    command: 'DefineNameCommand',\n                    options: {\n                        name: name,\n                        value: ref\n                    }\n                });\n                this.clipboardElement.focus();\n            },\n            onNameEditorCancel: function () {\n                this.clipboardElement.focus();\n            },\n            onNameEditorSelect: function (ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.focus();\n            },\n            onNameEditorDelete: function (ev) {\n                this._execute({\n                    command: 'DeleteNameCommand',\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.focus();\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar',\n        'util/main'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon',\n            iconFilterDefault: 'k-i-arrow-60-down',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            nameBox: 'Name Box',\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                insertColumnWhenRowIsSelected: 'Cannot insert column when all columns are selected.',\n                insertRowWhenColumnIsSelected: 'Cannot insert row when all rows are selected.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                cantSortMultipleSelection: 'Cannot sort multiple selection',\n                cantSortNullRef: 'Cannot sort empty selection',\n                cantSortMixedCells: 'Cannot sort range containing cells of mixed shapes',\n                validationError: 'The value that you entered violates the validation rules set on the cell.',\n                cannotModifyDisabled: 'Cannot modify disabled cells.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return (value.size || 1) + 'px solid ' + (value.color || '#000');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            var shouldDraw = cell.value != null || cell.validation != null && !cell.validation.value || cell.background || cell.merged;\n            if (!cls && !shouldDraw) {\n                return;\n            }\n            var style = {};\n            var background = cell.background;\n            if (background) {\n                var defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n                style.outline = defaultBorder;\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.overflowWrap = 'break-word';\n                style.wordWrap = 'break-word';\n            } else {\n                style.whiteSpace = 'pre';\n                style.overflowWrap = 'normal';\n                style.wordWrap = 'normal';\n            }\n            style.left = cell.left + 1 + 'px';\n            style.top = cell.top + 1 + 'px';\n            style.width = cell.width - 1 + 'px';\n            style.height = cell.height - 1 + 'px';\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == 'number' && data != Math.floor(data)) {\n                format = '0.##############';\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            kendo.spreadsheet.draw.applyIndent(cell, style);\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == 'number' && data != Math.floor(data)) {\n                format = '0.##############';\n            }\n            if (format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation.message;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var actionBar = $(this.formulaBar.element).parents('.k-spreadsheet-action-bar');\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var wrapper = $('<div class=\\'k-spreadsheet-action-bar\\' />').prependTo(this.element);\n                var nameEditor = $('<div class=\\'k-spreadsheet-name-editor\\' />').appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n                var formulaBar = $('<div />').appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, { openDialog: this.openDialog.bind(this) }, this.options.sheetsbar);\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._sheet.trigger('commandRequest', e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                workbook._view = this;\n                this.nameEditor._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, col) {\n                x -= this._sheet._grid._headerWidth;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                col = this._sheet._grid._columns.locate(0, col, function (w) {\n                    return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH / 2;\n                });\n                return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n            },\n            isRowResizer: function (y, pane, row) {\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                row = this._sheet._grid._rows.locate(0, row, function (h) {\n                    return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH / 2;\n                });\n                return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var self = this;\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n                x -= self._sheet._grid._headerWidth - scrollLeft;\n                y -= self._sheet._grid._headerHeight - scrollTop;\n                return kendo.util.withExit(function (exit) {\n                    self._sheet.forEachFilterHeader(ref, function (ref) {\n                        var rect = self._rectangle(pane, ref);\n                        if (pane.filterIconRect(rect).intersects(x, y)) {\n                            exit(true);\n                        }\n                    });\n                });\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            isEditButton: function (x, y, pane) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    if (y >= r.top && y <= r.bottom) {\n                        return pane._editorInLastColumn ? x < r.left && x >= r.left - 20 : x > r.right && x <= r.right + 20;\n                    }\n                }\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    if (!pane) {\n                        object = { type: 'outside' };\n                    } else {\n                        var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n                        var type = 'cell';\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = 'autofill';\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = 'filtericon';\n                        } else if (!selecting && x < grid._headerWidth) {\n                            type = 'rowheader';\n                            if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                                ref = new CellRef(row, -Infinity);\n                                type = 'rowresizehandle';\n                            }\n                        } else if (!selecting && y < grid._headerHeight) {\n                            type = 'columnheader';\n                            if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                                ref = new CellRef(-Infinity, column);\n                                type = 'columnresizehandle';\n                            }\n                        } else if (this.isEditButton(x, y, pane)) {\n                            type = 'editor';\n                        }\n                        if (type == 'cell') {\n                            this._sheet.forEachMergedCell(ref, function (merged) {\n                                ref = merged.topLeft;\n                            });\n                        }\n                        object = {\n                            type: type,\n                            ref: ref\n                        };\n                    }\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openCustomEditor: function () {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range: range,\n                    rect: self.activeCellRectangle(),\n                    view: this,\n                    validation: this._sheet.validation(cell),\n                    callback: function (value, parse) {\n                        self._executeCommand({\n                            command: 'EditCommand',\n                            options: {\n                                operatingRange: range,\n                                property: parse ? 'input' : 'value',\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                return sheet.withCultureDecimals(function () {\n                    var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                    if (dialog) {\n                        dialog.bind('action', this._executeCommand.bind(this));\n                        dialog.bind('deactivate', this._destroyDialog.bind(this));\n                        this._dialogs.push(dialog);\n                        var ref = sheet.activeCell();\n                        var range = new kendo.spreadsheet.Range(ref, sheet);\n                        dialog.open(range);\n                        return dialog;\n                    }\n                }.bind(this));\n            },\n            showError: function (options, reopenEditor) {\n                var errorMessages = this.options.messages.errors;\n                var focusButton = function (e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find('.k-button:first').focus();\n                    cont.find('.k-button, input').on('keydown', function (ev) {\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n                var onClose = function (e) {\n                    var dlg = e.sender;\n                    this.selectClipBoardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = { close: onClose };\n                    if (options.type === 'validationError') {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || 'Error',\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function (reason) {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                });\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                result.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    result.push(this.renderResizeHint());\n                }\n                this.tree.render(result);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!(reason.resize || reason.scroll || sheet.selectionInProgress() || sheet.resizingInProgress() || sheet.isInEditMode())) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = grid.normalize(sheet.select().toRangeRef());\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            vborder: 'k-spreadsheet-vborder',\n            hborder: 'k-spreadsheet-hborder',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    if (!sheet.resizeHintPosition()) {\n                        this.renderResizeHandle(children);\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var borders = kendo.spreadsheet.draw.Borders();\n                var activeCellRange = sheet.activeCell().toRangeRef();\n                var activeCell = activeCellRange.topLeft;\n                layout.cells.forEach(function (cell) {\n                    var cls = null;\n                    if (cell.row + view.ref.topLeft.row == activeCell.row && cell.col + view.ref.topLeft.col == activeCell.col) {\n                        cls = [Pane.classNames.activeCell].concat(this._activeFormulaColor(), this._directionClasses(activeCellRange));\n                        if (sheet.singleCellSelection()) {\n                            cls.push(Pane.classNames.single);\n                        }\n                        cls = cls.join(' ');\n                    }\n                    borders.add(cell);\n                    drawCell(cont.children, cell, cls, showGridLines);\n                }, this);\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                left: b.x + 'px',\n                                top: b.top + 'px',\n                                height: b.bottom - b.top + 1 + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateX(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                top: b.y + 'px',\n                                left: b.left + 'px',\n                                width: b.right - b.left + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateY(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.hborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                return cont;\n            },\n            renderResizeHandle: function (container) {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    if (this._grid.rows._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    if (this._grid.columns._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                container.push(kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                }));\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var selection = sheet.select();\n                selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._renderCustomEditorButton(selections, activeCell);\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _renderCustomEditorButton: function (collection, ref) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                var columnCount = self._grid.columns._axis._count;\n                var ed = sheet.activeCellCustomEditor();\n                if (ed && view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        var btnClass = 'k-button k-spreadsheet-editor-button';\n                        var isLastColumn = col == columnCount - 1;\n                        if (isLastColumn) {\n                            btnClass += ' k-spreadsheet-last-column';\n                        }\n                        self._editorInLastColumn = isLastColumn;\n                        var btn = kendo.dom.element('div', {\n                            className: btnClass,\n                            style: {\n                                left: cell.left + (isLastColumn ? 0 : cell.width) + 'px',\n                                top: cell.top + 'px',\n                                height: cell.height + 'px'\n                            }\n                        });\n                        if (ed.icon) {\n                            btn.children.push(kendo.dom.element('span', { className: 'k-icon ' + ed.icon }));\n                        }\n                        collection.push(btn);\n                    });\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/customeditors', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.calendar',\n        'kendo.listview',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var EDITORS = {};\n        var registerEditor = kendo.spreadsheet.registerEditor = function (name, editor) {\n            EDITORS[name] = editor;\n        };\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function () {\n            var cell = this.activeCell().first();\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get('editor', this._grid.cellRefIndex(cell));\n                var editor;\n                if (key != null) {\n                    editor = EDITORS[key];\n                } else if (val && val.showButton) {\n                    key = '_validation_' + val.dataType;\n                    editor = EDITORS[key];\n                }\n                if (typeof editor == 'function') {\n                    editor = EDITORS[key] = editor();\n                }\n                return editor;\n            }\n        };\n        registerEditor('_validation_date', function () {\n            var context, calendar, popup;\n            function create() {\n                if (!calendar) {\n                    calendar = $('<div>').kendoCalendar();\n                    popup = $('<div>').kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n                    calendar.bind('change', function () {\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format('yyyy-mm-dd');\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var date = context.range.value();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        min = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    if (val.comparerType == 'between') {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                    if (val.comparerType == 'lessThan') {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    calendar.setOptions({\n                        disableDates: function (date) {\n                            var from = val.from ? val.from.value | 0 : 0;\n                            var to = val.to ? val.to.value | 0 : 0;\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation.validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({\n                        disableDates: null,\n                        min: null,\n                        max: null\n                    });\n                }\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-calendar'\n            };\n        });\n        registerEditor('_validation_list', function () {\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $('<ul class=\\'k-list k-reset\\'/>').kendoStaticList({\n                        template: '#:value#',\n                        selectable: true,\n                        autoBind: false\n                    });\n                    popup = $('<div>').kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n                    list.bind('change', function () {\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var items = context.validation.from.value;\n                var data = [], add = function (el) {\n                        data.push({ value: el });\n                    };\n                if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    items.each(add);\n                } else {\n                    (items + '').split(/\\s*,\\s*/).forEach(add);\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-arrow-60-down'\n            };\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n                return ref;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    var hidden = this._hidden.value(idx, idx);\n                    if (value === this._value && !hidden) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        if (hidden) {\n                            item.hidden = hidden;\n                        }\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var el = values[idx];\n                    var index = el.index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    var value = el[field];\n                    if (value === 0) {\n                        if (el.hidden) {\n                            this.value(index, index, el.hidden);\n                        }\n                        this.hide(index);\n                    } else {\n                        this.value(index, index, value);\n                    }\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index) {\n                var end = this._count - 1, i = index;\n                while (++i <= end) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index) {\n                var i = index;\n                while (--i >= 0) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            locate: function (start, end, predicate) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                    var val = predicate(sum);\n                    if (val) {\n                        return idx;\n                    }\n                }\n                return null;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            indexVisible: function (value) {\n                var index = this.index(value);\n                if (this.hidden(index)) {\n                    index = this.prevVisible(index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            indexVisible: function (value, offset) {\n                return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val,\n                        custom: true\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            if (!condition.custom) {\n                code += 'value = Math.abs(value); ';\n            }\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n            code += 'var isNegative = parseInt(intPart[0]) < 0;';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        code += 'var matchedCurrency = false;';\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                if (currency.test(tok.value)) {\n                    code += 'type = \\'currency\\'; ';\n                    code += 'if (isNegative) { output += \\'-\\'; matchedCurrency = true; }';\n                }\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace(\\'-\\', \\'\\');}';\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    var compile = util.memoize(function (format) {\n        var tree = parse(format);\n        var code = tree.map(compileFormatPart);\n        code.push(TEXT);\n        code = code.join('\\n');\n        code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n        return new Function('runtime', code)(runtime);\n    });\n    var makeDateFormat = util.memoize(function (format) {\n        var tree = parse(format);\n        var section, found = false, hasAmpm = false;\n        for (var i = 0; i < tree.length; ++i) {\n            section = tree[i];\n            for (var j = 0; j < section.body.length; ++j) {\n                if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                    found = true;\n                    if (section.body[j].type == 'ampm') {\n                        hasAmpm = true;\n                    }\n                }\n            }\n            if (found) {\n                break;\n            }\n        }\n        if (!found) {\n            return null;\n        }\n        return section.body.map(printToken).join('');\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += padLeft('', Math.max(tok.fraction, 3), 'f');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                var part = tok.part;\n                if (tok.type == 'date' && /^m/.test(part)) {\n                    part = 'M';\n                } else if (tok.type == 'time' && /^h/.test(part)) {\n                    if (!hasAmpm) {\n                        part = part.toUpperCase();\n                    }\n                }\n                return maybeFraction(padLeft('', tok.format, part), tok);\n            } else if (tok.type == 'ampm') {\n                return 'tt';\n            } else if (tok.type == 'str') {\n                return tok.value;\n            } else if (tok.type == 'space') {\n                return ' ';\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            } else {\n                return '';\n            }\n        }\n    });\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = runtime.toFixed(value, declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        if (value == '0' && chf == '?') {\n                            add(' ');\n                        } else {\n                            add(value.charAt(iv));\n                        }\n                        iv--;\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = runtime.toFixed(value, declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        },\n        toFixed: function (value, decimals) {\n            return function toFixed(value) {\n                if (value < 0) {\n                    return '-' + toFixed(-value);\n                }\n                if (decimals === 0) {\n                    return String(Math.round(value));\n                }\n                if (value === parseInt(value, 10)) {\n                    return value.toFixed(decimals);\n                }\n                var str = String(value);\n                var pos = str.indexOf('.');\n                var intpart = str.substr(0, pos);\n                var decpart = str.substr(pos + 1);\n                if (decpart.length <= decimals) {\n                    while (decpart.length < decimals) {\n                        decpart += '0';\n                    }\n                    return intpart + '.' + decpart;\n                }\n                var f = Math.pow(10, decimals);\n                return toFixed(Math.round(value * f) / f);\n            }(Math.round(value * 100000000000000) / 100000000000000);\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        },\n        makeDateFormat: makeDateFormat\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return numbers.length ? Math.min.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('max', function (numbers) {\n        return numbers.length ? Math.max.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                'matrix'\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number!'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (callback, ref, row, col, areanum) {\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if (!row && !col || !ref) {\n            return callback(new CalcError('N/A'));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError('REF'));\n                }\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([cell], function () {\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([colRange], function () {\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([rowRange], function () {\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function (row) {\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function (col) {\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        } else {\n            callback(new CalcError('REF'));\n        }\n    }).argsAsync([\n        [\n            'range',\n            [\n                'or',\n                'ref',\n                'matrix'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        if (typeof value != 'number') {\n            approx = false;\n        }\n        if (typeof value == 'string') {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == 'string') {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function (args) {\n        var out = '';\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0DECIMALS;($#,##0DECIMALS)';\n        var dec = '';\n        var denomitator = 1;\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        while (++decimals < 0) {\n            denomitator *= 10;\n        }\n        if (dec !== '') {\n            dec = '.' + dec;\n        } else if (denomitator !== 1) {\n            number = Math.round(number / denomitator) * denomitator;\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var scale = Math.pow(10, decimals);\n        number = Math.round(number * scale) / scale;\n        var format = noCommas ? '0' : '#,##0';\n        if (decimals > 0) {\n            format += '.';\n            while (decimals-- > 0) {\n                format += '0';\n            }\n        }\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            var num, str;\n            if (typeof a == 'string') {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return !compEQ(a, b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == 'string' || typeof b == 'string') {\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect!',\n                'anything',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect!',\n                'anything',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        whipNumberArrays(x_, y_);\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n    function whipNumberArrays(a, b) {\n        for (var i = a.length; --i >= 0;) {\n            if (typeof a[i] != 'number' || typeof b[i] != 'number') {\n                a.splice(i, 1);\n                b.splice(i, 1);\n            }\n        }\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border'\n        };\n        var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + COLOR_PICKER_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + COLOR_PICKER_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-i-reset-color\\'></span>' + COLOR_PICKER_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + COLOR_PICKER_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                text: 'Text',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sort: 'Sort',\n            sortButtons: {\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'file-excel'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'file-excel'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decimal-decrease'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'decimal-increase'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'align-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'paint'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'foreground-color'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'font-family'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'custom-format'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'cells-merge'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'pane-freeze'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'borders-all'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'link-horizontal',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'border-no',\n                togglable: true\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'table-column-insert-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'table-column-insert-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'table-row-insert-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'table-row-insert-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'table-column-delete'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'table-row-delete'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                var that = this;\n                this.element.on('keydown', function (e) {\n                    var tool;\n                    if (e.keyCode === 9) {\n                        tool = that._nextTool(e.shiftKey ? -1 : 1);\n                        if (tool) {\n                            document.activeElement.blur();\n                            if ($(tool).is('.k-upload-button')) {\n                                $(tool).addClass('k-state-focused');\n                            }\n                            if ($(tool).find('input').length) {\n                                $(tool).find('input').focus();\n                            } else {\n                                tool.focus();\n                            }\n                            e.preventDefault();\n                        }\n                    }\n                });\n                this.element.on('focusout', function () {\n                    $(this).find('.k-toolbar-first-visible').removeClass('k-state-focused');\n                });\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _nextTool: function (direction) {\n                var that = this;\n                var tools = that.element.find('.k-widget, .k-button, .k-button-group > a');\n                var activeIndex = tools.index($(document.activeElement).closest('.k-widget, .k-button, .k-button-group > a'));\n                if (activeIndex > 0) {\n                    return tools[activeIndex + direction];\n                }\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        button: { showText: 'overflow' },\n                        colorPicker: {\n                            toolIcon: spriteCssClass,\n                            spriteCssClass: spriteCssClass\n                        },\n                        borders: { spriteCssClass: spriteCssClass },\n                        alignment: { spriteCssClass: spriteCssClass },\n                        merge: { spriteCssClass: spriteCssClass },\n                        freeze: { spriteCssClass: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        icon: options.iconClass,\n                        attributes: {\n                            title: MESSAGES[options.name || toolName],\n                            'aria-label': MESSAGES[options.name || toolName]\n                        }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n                this.resize();\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').attr('title', options.attributes.title).attr('aria-label', options.attributes.title).kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth > 0) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var that = this;\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    setTimeout(function () {\n                        that.toolbar.dialog({ name: popupName });\n                    });\n                } else {\n                    that.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-60-down\\'></span>' + '</a>');\n                this.element.on('click touchend', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click touchend', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this._title = options.attributes.title;\n                this.element = $('<button type=\\'button\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-download\\' />' + '</button>').attr('title', this._title).attr('aria-label', this._title).data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click touchend', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').attr('aria-label', options.attributes.title).kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    clearButton: false,\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: '@',\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.text,\n                        name: MESSAGES.formatTypes.text\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        property: 'textAlign',\n                        value: 'left',\n                        iconClass: 'align-left',\n                        text: MESSAGES.alignmentButtons.justtifyLeft\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'center',\n                        iconClass: 'align-center',\n                        text: MESSAGES.alignmentButtons.justifyCenter\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'right',\n                        iconClass: 'align-right',\n                        text: MESSAGES.alignmentButtons.justifyRight\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'justify',\n                        iconClass: 'align-justify',\n                        text: MESSAGES.alignmentButtons.justifyFull\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'top',\n                        iconClass: 'align-top',\n                        text: MESSAGES.alignmentButtons.alignTop\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'center',\n                        iconClass: 'align-middle',\n                        text: MESSAGES.alignmentButtons.alignMiddle\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'bottom',\n                        iconClass: 'align-bottom',\n                        text: MESSAGES.alignmentButtons.alignBottom\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'cells',\n                        iconClass: 'cells-merge',\n                        text: MESSAGES.mergeButtons.mergeCells\n                    },\n                    {\n                        value: 'horizontally',\n                        iconClass: 'cells-merge-horizontally',\n                        text: MESSAGES.mergeButtons.mergeHorizontally\n                    },\n                    {\n                        value: 'vertically',\n                        iconClass: 'cells-merge-vertically',\n                        text: MESSAGES.mergeButtons.mergeVertically\n                    },\n                    {\n                        value: 'unmerge',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.mergeButtons.unmerge\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'panes',\n                        iconClass: 'pane-freeze',\n                        text: MESSAGES.freezeButtons.freezePanes\n                    },\n                    {\n                        value: 'rows',\n                        iconClass: 'row-freeze',\n                        text: MESSAGES.freezeButtons.freezeRows\n                    },\n                    {\n                        value: 'columns',\n                        iconClass: 'column-freeze',\n                        text: MESSAGES.freezeButtons.freezeColumns\n                    },\n                    {\n                        value: 'unfreeze',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.freezeButtons.unfreeze\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.find('input').remove();\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).attr('aria-label', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\' aria-label=\\'#= title #\\'><span class=\\'k-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('data-action');\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', kendo._outerWidth(this.quickAccessToolBar));\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            retry: 'Retry',\n            revert: 'Revert',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            confirmationDialog: {\n                text: 'Are you sure you want to remove this sheet?',\n                title: 'Sheet remove'\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank',\n                    showListButton: 'Display button to show list',\n                    showCalendarButton: 'Display button to show calendar'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            rangeDisabledDialog: { errorMessage: 'Destination range contains disabled cells.' },\n            intersectsArrayDialog: { errorMessage: 'You cannot alter part of an array' },\n            incompatibleRangesDialog: { errorMessage: 'Incompatible ranges' },\n            noFillDirectionDialog: { errorMessage: 'Cannot determine fill direction' },\n            duplicateSheetNameDialog: { errorMessage: 'Duplicate sheet name' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    var options = {\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    };\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window k-popup-edit-form\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        errors: this.options.errors\n                    })).kendoWindow(options).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close', { action: this._action });\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n                this.dialog().element.find('.k-primary').focus();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this._action = 'close';\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-edit-form-container\\'>' + '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: 'k-spreadsheet-message',\n                messageId: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: confirm\\'>' + '#= messages.okText #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function () {\n                return this._confirmed;\n            },\n            confirm: function () {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('confirmation', ConfirmationDialog);\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: retry\\'>' + '#= messages.retry #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function () {\n                this._retry = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validationError', ValidationErrorDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'align-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'align-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'align-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'align-justify',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'cells-merge',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'cells-merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'cells-merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'pane-freeze',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'row-freeze',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'column-freeze',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                this.set('showButton', validation.showButton);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-i-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.criteria #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"listShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showListButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showCalendarButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.ignoreBlank #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-hr\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\" class=\"hint-wrapper\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">' + ' #: messages.validationDialog.labels.showHint #' + '</label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.exportAsDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                var dialog = this.dialog();\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                        dialog.center();\n                    }\n                });\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'k-export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<hr class=\\'k-hr\\' />' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<div class=\\'k-button-group\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' />' + '<label class=\\'k-button k-button-icon k-group-start k-orientation-button\\' for=\\'k-orientation-portrait\\'><span class=\\'k-icon k-i-page-portrait\\'></span></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' />' + '<label class=\\'k-button k-button-icon k-group-end k-orientation-button\\' for=\\'k-orientation-landscape\\'><span class=\\'k-icon k-i-page-landscape\\'></span></label>' + '</div>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\'>' + '<span class=\\'k-icon k-i-page-portrait\\' data-bind=\\'invisible: pdf.landscape\\'></span>' + '<span class=\\'k-icon k-i-page-landscape\\' data-bind=\\'visible: pdf.landscape\\'></span>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(id, MessageDialog.extend({ options: { messageId: msg } }));\n        }\n        basicErrorDialog('modifyMerged', 'modifyMergedDialog.errorMessage');\n        basicErrorDialog('rangeDisabled', 'rangeDisabledDialog.errorMessage');\n        basicErrorDialog('intersectsArray', 'intersectsArrayDialog.errorMessage');\n        basicErrorDialog('overflow', 'overflowDialog.errorMessage');\n        basicErrorDialog('unsupportedSelection', 'unsupportedSelectionDialog.errorMessage');\n        basicErrorDialog('incompatibleRanges', 'incompatibleRangesDialog.errorMessage');\n        basicErrorDialog('noFillDirection', 'noFillDirectionDialog.errorMessage');\n        basicErrorDialog('duplicateSheetName', 'duplicateSheetNameDialog.errorMessage');\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: 'Errors in import',\n                template: '<div class=\\'k-spreadsheet-message-content k-spreadsheet-import-errors\\'>' + '<div class=\\'k--header-message\\'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>' + '<div class=\\'k--errors\\'>' + '<table>' + '<thead>' + '<tr><th>Context</th><th>Error message</th></tr>' + '</thead>' + '# for (var i = 0; i < errors.length; ++i) { #' + '# var err = errors[i]; #' + '<tr><td>#: err.context #</td><td>#: err.error #</td></tr>' + '# } #' + '</table>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#: messages.okText #' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('importError', ImportErrorDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.useKeyboardDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n            },\n            options: { template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><input class=\\'k-textbox\\' data-bind=\\'value: url\\' title=\\'#: messages.linkDialog.labels.url #\\' /></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button class=\\'k-button k-left\\' data-bind=\\'click: remove\\'>#= messages.linkDialog.labels.removeLink #</button>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#= messages.okText #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button>') + '</div>',\n                title: MESSAGES.linkDialog.title,\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').focus().on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = kendo.jQuery.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('afterDeleteRow', this._sheetDeleteRowHandler).bind('afterInsertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow || e.deleteRow) {\n                    return;\n                }\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var fields;\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    var getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    var normalizedRef = this.sheet._grid.normalize(e.ref);\n                    var values = this.sheet.range(normalizedRef).values();\n                    normalizedRef.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, getters[ci](values[valueIndex][colValueIndex++]));\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon',\n            iconCollapse: 'k-i-arrow-45-down-right',\n            iconExpand: 'k-i-arrow-60-right',\n            iconSearch: 'k-i-zoom',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with',\n                    matches: 'Text matches',\n                    doesnotmatch: 'Text does not match'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-i-zoom\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                if (query.length || values && !values.length) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1) {\n                    item.checked = true;\n                }\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                if (!this.get('customFilter')) {\n                    this.reset();\n                }\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent' || dataType === 'currency') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with',\n                        matches: 'Text matches',\n                        doesnotmatch: 'Text does not match'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _blur: function () {\n                this.deactivate();\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this._range = options.range;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n                this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function (noChange) {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                this._active = false;\n                if (!noChange && cellInput.value() != this._value) {\n                    this.trigger('change', {\n                        value: cellInput.value(),\n                        range: this._range\n                    });\n                }\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value, isArrayFormula) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n                this.barInput.element.toggleClass('k-spreadsheet-array-formula', !!isArrayFormula);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n            select: function () {\n                this.activeEditor().select();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var ERR_INCOMPATIBLE = 'incompatibleRanges';\n    var ERR_NO_DIRECTION = 'noFillDirection';\n    var FillError = Range.FillError = function (msg) {\n        this.code = msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        var hint = null;\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n                if (cell.value != null) {\n                    hint = cell.value;\n                }\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange,\n            hint: hint\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/nameeditor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CLASS_NAMES = {\n            input: 'k-spreadsheet-name-editor',\n            list: 'k-spreadsheet-name-list'\n        };\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n                var comboBoxTitle = options.messages.nameBox || 'Name Box';\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function (options) {\n                            var data = [];\n                            this._workbook.forEachName(function (def) {\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n                var comboElement = $('<input />').attr('title', comboBoxTitle).attr('aria-label', comboBoxTitle);\n                this.combo = comboElement.appendTo(element).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: 'name',\n                    dataValueField: 'name',\n                    template: '#:data.name#<a class=\\'k-button-delete\\' href=\\'\\\\#\\'><span class=\\'k-icon k-i-close\\'></span></a>',\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: '<div></div>',\n                    open: function () {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n                this.combo.input.on('keydown', this._on_keyDown.bind(this)).on('focus', this._on_focus.bind(this));\n                this.combo.popup.element.addClass('k-spreadsheet-names-popup').on('mousemove', function (ev) {\n                    ev.stopPropagation();\n                }).on('click', '.k-button-delete', function (ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest('.k-item');\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n            },\n            value: function (val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function (name) {\n                this.trigger('delete', { name: name });\n            },\n            _on_keyDown: function (ev) {\n                switch (ev.keyCode) {\n                case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger('cancel');\n                    break;\n                case 13:\n                    this.trigger('enter');\n                    break;\n                }\n            },\n            _on_focus: function () {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function () {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger('select', { name: name });\n                }\n            }\n        });\n        kendo.spreadsheet.NameEditor = NameEditor;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n        var curr = 0;\n        var out = [];\n        var bottom = pageHeight;\n        var header = 0;\n        if (pageHeight && maxEmpty) {\n            maxEmpty *= pageHeight;\n        }\n        heights.forEach(function (h, i) {\n            if (headerRows != null && i < headerRows) {\n                header += h;\n            }\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < maxEmpty) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                    if (header > 0) {\n                        headerCoords.push(curr - header);\n                    }\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function doLayout(sheet, range, options) {\n        var grid = sheet._grid;\n        range = grid.normalize(range);\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = sheet._getMergedCells(range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row) || !rh || !cw) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = options.scale || 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n            }\n        }\n        pageWidth = Math.ceil(pageWidth / scaleFactor);\n        pageHeight = Math.ceil(pageHeight / scaleFactor);\n        var hyCoords = [];\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty, options.headerRows, hyCoords);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        var headerCells = [];\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            if (options.headerRows && cell.row < options.headerRows) {\n                headerCells.push(cell);\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.width();\n                cell.rowspan = ref.height();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cell.row = relrow;\n                    cell.col = relcol;\n                    cells.push(cell);\n                }\n            });\n        });\n        if (options.headerRows) {\n            hyCoords.forEach(function (y) {\n                headerCells.forEach(function (cell) {\n                    cell = clone(cell);\n                    cell.top += y;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                });\n                yCoords.push(y);\n            });\n            yCoords.sort(orderCoords);\n        }\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(orderCells),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function clone(hash, target) {\n        if (!target) {\n            target = {};\n        }\n        if (Object.assign) {\n            return Object.assign(target, hash);\n        }\n        return Object.keys(hash).reduce(function (copy, key) {\n            copy[key] = hash[key];\n            return copy;\n        }, target);\n    }\n    function sameBorder(a, b) {\n        return a.size === b.size && a.color === b.color;\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderRight != null || cell.borderBottom != null || cell.validation != null && !cell.validation.value;\n    }\n    function orderCells(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function orderCoords(a, b) {\n        return a < b ? -1 : a > b ? 1 : 0;\n    }\n    function drawLayout(sheet, layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = Math.ceil(options.pageWidth / layout.scale);\n        var pageHeight = Math.ceil(options.pageHeight / layout.scale);\n        for (var j = 0; j < nrows; ++j) {\n            for (var i = 0; i < ncols; ++i) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            endbottom = Math.min(endbottom, bottom);\n            endright = Math.min(endright, right);\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                var content = new drawing.Group();\n                page.append(content);\n                content.clip(drawing.Path.fromRect(new geo.Rect([\n                    left - 1,\n                    top - 1\n                ], [\n                    endright + 1,\n                    endbottom + 1\n                ])));\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke(options.guideColor, GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke(options.guideColor, GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = Borders();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, options);\n                    borders.add(cell, sheet);\n                });\n                var bordersGroup = new drawing.Group();\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new drawing.Path().moveTo(b.x, b.top).lineTo(b.x, b.bottom).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new drawing.Path().moveTo(b.left, b.y).lineTo(b.right, b.y).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                content.append(bordersGroup);\n            }\n        }\n    }\n    function drawCell(cell, content, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2 + 0.1;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2 + 0.1;\n                r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n                r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f, format = cell.format;\n            if (!format && type == 'number' && val != Math.floor(val)) {\n                format = '0.##############';\n            }\n            if (format) {\n                f = formatting.textAndColor(val, format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function applyIndent(cell, style) {\n        if (cell.indent) {\n            var indent = 1.4 * cell.indent;\n            switch (style.textAlign) {\n            case null:\n            case 'left':\n                style.paddingLeft = indent + 'ch';\n                break;\n            case 'right':\n                style.paddingRight = indent + 'ch';\n                break;\n            case 'center':\n                style.paddingLeft = indent / 2 + 'ch';\n                style.paddingRight = indent / 2 + 'ch';\n                break;\n            }\n        }\n    }\n    var CONT;\n    function drawText(text, color, cell, group) {\n        if (!CONT) {\n            CONT = document.createElement('div');\n            CONT.style.position = 'absolute';\n            CONT.style.left = '0px';\n            CONT.style.top = '0px';\n            CONT.style.visibility = 'hidden';\n            CONT.style.overflow = 'hidden';\n            CONT.style.boxSizing = 'border-box';\n            CONT.style.lineHeight = 'normal';\n            document.body.appendChild(CONT);\n        }\n        if (CONT.firstChild) {\n            CONT.removeChild(CONT.firstChild);\n        }\n        CONT.style.padding = '2px 4px';\n        CONT.style.color = color;\n        CONT.style.font = makeFontDef(cell);\n        CONT.style.width = cell.width + 'px';\n        CONT.style.textAlign = cell.textAlign || 'left';\n        CONT.style.textDecoration = cell.underline ? 'underline' : 'none';\n        applyIndent(cell, CONT.style);\n        if (cell.wrap) {\n            CONT.style.whiteSpace = 'pre-wrap';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'break-word';\n        } else {\n            CONT.style.whiteSpace = 'pre';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'normal';\n        }\n        CONT.appendChild(document.createTextNode(text));\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = cell.height - CONT.offsetHeight >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = cell.height - CONT.offsetHeight;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        var text_group = kendo.drawing.drawDOM.drawText(CONT);\n        text_group.transform(geo.Matrix.translate(cell.left, cell.top + vtrans));\n        group.append(text_group);\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            guideColor: '#aaa',\n            emptyCells: true,\n            fitWidth: false,\n            center: false,\n            headerRows: null,\n            maxEmpty: 0.2,\n            scale: 1\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right + 1;\n            pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(sheet, layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    function Container() {\n    }\n    Container.prototype = {\n        forEach: function (f) {\n            Object.keys(this).forEach(function (key) {\n                f(this[key], key, this);\n            }, this);\n        }\n    };\n    function Borders() {\n        var horiz = new Container();\n        var vert = new Container();\n        function add(cell, sheet) {\n            if (sheet) {\n                var pb = sheet._properties;\n                var grid = sheet._grid;\n                cell.borderLeft = pb.get('vBorders', grid.index(cell.row, cell.col));\n                cell.borderRight = pb.get('vBorders', grid.index(cell.row, cell.col + cell.colspan));\n                cell.borderTop = pb.get('hBorders', grid.index(cell.row, cell.col));\n                cell.borderBottom = pb.get('hBorders', grid.index(cell.row + cell.rowspan, cell.col));\n            }\n            if (cell.borderLeft) {\n                addVert(cell.row, cell.col, cell.borderLeft, cell.left, cell.top, cell.bottom);\n            }\n            if (cell.borderRight) {\n                addVert(cell.row, cell.col + cell.colspan, cell.borderRight, cell.right, cell.top, cell.bottom);\n            }\n            if (cell.borderTop) {\n                addHoriz(cell.row, cell.col, cell.borderTop, cell.top, cell.left, cell.right);\n            }\n            if (cell.borderBottom) {\n                addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom, cell.bottom, cell.left, cell.right);\n            }\n        }\n        function addVert(row, col, border, x, top, bottom) {\n            var a = vert[col] || (vert[col] = new Container());\n            var prev = row > 0 && a[row - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[row] = prev;\n                prev.bottom = bottom;\n            } else {\n                a[row] = {\n                    size: border.size,\n                    color: border.color,\n                    x: x,\n                    top: top,\n                    bottom: bottom\n                };\n            }\n        }\n        function addHoriz(row, col, border, y, left, right) {\n            var a = horiz[row] || (horiz[row] = new Container());\n            var prev = col > 0 && a[col - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[col] = prev;\n                prev.right = right;\n            } else {\n                a[col] = {\n                    size: border.size,\n                    color: border.color,\n                    y: y,\n                    left: left,\n                    right: right\n                };\n            }\n        }\n        return {\n            add: add,\n            horiz: horiz,\n            vert: vert\n        };\n    }\n    function drawTabularData(options) {\n        var progress = new $.Deferred();\n        var promise = progress.promise();\n        options = clone(options, {\n            dataSource: null,\n            guidelines: true,\n            guideColor: '#000',\n            columns: null,\n            headerBackground: '#999',\n            headerColor: '#000',\n            oddBackground: null,\n            evenBackground: null,\n            fontFamily: 'Arial',\n            fontSize: 12,\n            paperSize: 'A4',\n            margin: '1cm',\n            landscape: true,\n            fitWidth: false,\n            scale: 1,\n            rowHeight: 20,\n            maxEmpty: 1,\n            useGridFormat: true\n        });\n        kendo.drawing.pdf.defineFont(kendo.drawing.drawDOM.getFontFaces(document));\n        var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n        function textWidth(value) {\n            if (value != null) {\n                var width = 12;\n                for (var i = value.length; --i >= 0;) {\n                    width += charWidth(value.charAt(i));\n                }\n                return width;\n            }\n            return 0;\n        }\n        var border = options.guidelines ? {\n            size: 1,\n            color: options.guideColor\n        } : null;\n        function mkCell(data) {\n            if (!border) {\n                return data;\n            }\n            return clone(data, {\n                borderLeft: border,\n                borderTop: border,\n                borderRight: border,\n                borderBottom: border\n            });\n        }\n        options.dataSource.fetch(function () {\n            var data = options.dataSource.data();\n            if (!data.length) {\n                return progress.reject('Empty dataset');\n            }\n            var columns = options.columns.map(function (col) {\n                if (typeof col == 'string') {\n                    return {\n                        title: col,\n                        field: col\n                    };\n                } else {\n                    return col;\n                }\n            });\n            var columnTitles = columns.map(function (col) {\n                return col.title || col.field;\n            });\n            var columnWidths = columnTitles.map(textWidth);\n            var rows = data.map(function (row, rowIndex) {\n                return {\n                    cells: columns.map(function (col, colIndex) {\n                        var value = row[col.field];\n                        if (options.useGridFormat) {\n                            if (value != null) {\n                                if (col.format) {\n                                    value = kendo.format(col.format, value);\n                                } else {\n                                    value += '';\n                                }\n                            }\n                            columnWidths[colIndex] = Math.max(textWidth(value), columnWidths[colIndex]);\n                        }\n                        return mkCell({\n                            value: value,\n                            format: options.useGridFormat ? null : col.format,\n                            background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                        });\n                    })\n                };\n            });\n            rows.unshift({\n                cells: columnTitles.map(function (label) {\n                    return mkCell({\n                        value: label,\n                        background: options.headerBackground,\n                        color: options.headerColor\n                    });\n                })\n            });\n            var sheet = new kendo.spreadsheet.Sheet(rows.length + 1, columns.length + 1, options.rowHeight, 50, 20, 20, {\n                fontFamily: options.fontFamily,\n                fontSize: options.fontSize,\n                verticalAlign: 'center'\n            });\n            sheet.fromJSON({\n                name: 'Sheet1',\n                rows: rows,\n                columns: columnWidths.map(function (w, i) {\n                    return {\n                        index: i,\n                        width: w\n                    };\n                })\n            });\n            sheet.draw({\n                paperSize: options.paperSize,\n                landscape: options.landscape,\n                margin: options.margin,\n                guidelines: false,\n                scale: options.scale,\n                fitWidth: options.fitWidth,\n                maxEmpty: options.maxEmpty,\n                headerRows: 1\n            }, progress.resolve.bind(progress));\n        });\n        return promise;\n    }\n    var CACHE_CHAR_WIDTH = {};\n    var charWidthFunction = function (fontFamily, fontSize) {\n        var id = fontSize + ':' + fontFamily;\n        var func = CACHE_CHAR_WIDTH[id];\n        if (!func) {\n            var span, div = document.createElement('div');\n            div.style.position = 'fixed';\n            div.style.left = '-10000px';\n            div.style.top = '-10000px';\n            div.style.fontFamily = fontFamily;\n            div.style.fontSize = fontSize + 'px';\n            div.style.whiteSpace = 'pre';\n            for (var i = 32; i < 128; ++i) {\n                span = document.createElement('span');\n                span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                div.appendChild(span);\n            }\n            document.body.appendChild(div);\n            var widths = {};\n            for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                widths[i] = span.offsetWidth;\n            }\n            while (span = div.firstChild) {\n                div.removeChild(span);\n            }\n            func = CACHE_CHAR_WIDTH[id] = function (ch) {\n                var code = ch.charCodeAt(0);\n                var width = widths[code];\n                if (width == null) {\n                    span = document.createElement('span');\n                    span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                    div.appendChild(span);\n                    width = widths[code] = span.offsetWidth;\n                    div.removeChild(span);\n                }\n                return width;\n            };\n        }\n        return func;\n    };\n    spreadsheet.draw = {\n        Borders: Borders,\n        doLayout: doLayout,\n        applyIndent: applyIndent\n    };\n    spreadsheet.drawTabularData = drawTabularData;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/customeditors',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/nameeditor',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var keys = $.extend({\n            F10: 121,\n            F11: 122,\n            B: 66,\n            I: 73,\n            U: 85,\n            N: 78,\n            H: 72,\n            A: 65,\n            PAGEDOWN: 34,\n            PAGEUP: 33,\n            DELETE: 46,\n            R: 82\n        }, kendo.keys);\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this._view.enableClipboard(false);\n                this.refresh();\n                this._view.enableClipboard(true);\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n                this.element.on('keydown' + NS, this._keyDown.bind(this));\n            },\n            _keyDown: function (e) {\n                var key = e.keyCode;\n                var redoTool = $('.k-spreadsheet-quick-access-toolbar [title=Redo]');\n                if (key === keys.F11 && e.shiftKey) {\n                    this._view.sheetsbar._onAddSelect();\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.PAGEDOWN) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.PAGEUP) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.DELETE) {\n                    var closeCallback = function (e) {\n                        var dlg = e.sender;\n                        if (dlg.isConfirmed()) {\n                            this._view.sheetsbar.trigger('remove', {\n                                name: this.activeSheet()._name(),\n                                confirmation: true\n                            });\n                        }\n                    }.bind(this);\n                    this._view.sheetsbar._openDialog('confirmation', { close: closeCallback });\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.R) {\n                    this._view.sheetsbar._createEditor();\n                    e.preventDefault();\n                    return;\n                } else if (key === keys.F10 && this._view.tabstrip || key === keys.TAB && !e.shiftKey && $(document.activeElement).is(redoTool)) {\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find(':not(.k-overflow-anchor):kendoFocusable:first').focus();\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find('.k-toolbar-first-visible').addClass('k-state-focused');\n                    e.preventDefault();\n                    return;\n                } else if (e.ctrlKey && key === keys.B) {\n                    $('[data-tool=bold]')[0].click();\n                } else if (e.ctrlKey && key === keys.I) {\n                    $('[data-tool=italic]')[0].click();\n                } else if (e.ctrlKey && key === keys.U) {\n                    $('[data-tool=underline]')[0].click();\n                } else if (e.altKey && key === keys.H) {\n                    this._view.tabstrip.select(0);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.N) {\n                    this._view.tabstrip.select(1);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.A) {\n                    this._view.tabstrip.select(2);\n                    e.preventDefault();\n                    return;\n                }\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            _workbookCut: function (e) {\n                this.trigger('cut', e);\n            },\n            _workbookCopy: function (e) {\n                this.trigger('copy', e);\n            },\n            _workbookPaste: function (e) {\n                this.trigger('paste', e);\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render(reason);\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertSheet: function (e) {\n                if (this.trigger('insertSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRemoveSheet: function (e) {\n                if (this.trigger('removeSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelectSheet: function (e) {\n                if (this.trigger('selectSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRenameSheet: function (e) {\n                if (this.trigger('renameSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertRow: function (e) {\n                if (this.trigger('insertRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertColumn: function (e) {\n                if (this.trigger('insertColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteRow: function (e) {\n                if (this.trigger('deleteRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideRow: function (e) {\n                if (this.trigger('hideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideColumn: function (e) {\n                if (this.trigger('hideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideRow: function (e) {\n                if (this.trigger('unhideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _workbookChangeFormat: function (e) {\n                this.trigger('changeFormat', e);\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('cut', this._workbookCut.bind(this));\n                this._workbook.bind('copy', this._workbookCopy.bind(this));\n                this._workbook.bind('paste', this._workbookPaste.bind(this));\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n                this._workbook.bind('insertSheet', this._workbookInsertSheet.bind(this));\n                this._workbook.bind('removeSheet', this._workbookRemoveSheet.bind(this));\n                this._workbook.bind('selectSheet', this._workbookSelectSheet.bind(this));\n                this._workbook.bind('renameSheet', this._workbookRenameSheet.bind(this));\n                this._workbook.bind('insertRow', this._workbookInsertRow.bind(this));\n                this._workbook.bind('insertColumn', this._workbookInsertColumn.bind(this));\n                this._workbook.bind('deleteRow', this._workbookDeleteRow.bind(this));\n                this._workbook.bind('deleteColumn', this._workbookDeleteColumn.bind(this));\n                this._workbook.bind('hideRow', this._workbookHideRow.bind(this));\n                this._workbook.bind('hideColumn', this._workbookHideColumn.bind(this));\n                this._workbook.bind('unhideRow', this._workbookUnhideRow.bind(this));\n                this._workbook.bind('unhideColumn', this._workbookUnhideColumn.bind(this));\n                this._workbook.bind('select', this._workbookSelect.bind(this));\n                this._workbook.bind('changeFormat', this._workbookChangeFormat.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: 'Arial',\n                    fontSize: '12'\n                },\n                useCultureDecimals: false\n            },\n            defineName: function (name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n            undefineName: function (name) {\n                return this._workbook.undefineName(name);\n            },\n            nameValue: function (name) {\n                return this._workbook.nameValue(name);\n            },\n            forEachName: function (func) {\n                return this._workbook.forEachName(func);\n            },\n            cellContextMenu: function () {\n                return this._view.cellContextMenu;\n            },\n            rowHeaderContextMenu: function () {\n                return this._view.rowHeaderContextMenu;\n            },\n            colHeaderContextMenu: function () {\n                return this._view.colHeaderContextMenu;\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'change',\n                'render',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'insertSheet',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"]}